#  漏洞通告|致远OA文件上传漏洞   
原创 微步情报局  微步在线研究响应中心   2023-08-08 16:58  
  
![](https://mmbiz.qpic.cn/mmbiz_png/fFyp1gWjicMKNkm4Pg1Ed6nv0proxQLEKJ2CUCIficfAwKfClJ84puialc9eER0oaibMn1FDUpibeK1t1YvgZcLYl3A/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1 "")  
  
01 漏洞概况****  
  
  
  
致远OA是一款企业级的办公自动化软件，提供全方位的企业管理解决方案。该软件包括了办公自动化、流程自动化、知识管理、文档管理、协同办公等功能模块，可以帮助企业实现信息化管理、流程优化、人力资源管理、财务管理等方面的需求。微步漏洞团队通过“X漏洞奖励计划”获取到致远OA前台任意文件上传漏洞情报。攻击者可通过该漏洞上传文件实现远程命令执行，导致系统被攻击与控制。**经过分析与研判，该漏洞利用难度低，可以远程命令执行，微步近日仍捕获到该漏洞的利用行为，建议尽快修复。**  
****  
  
02 漏洞处置优先级（VPT）  
  
  
  
**综合处置优先级：**  
**高**  
****  
  
<table><tbody style="visibility: visible;"><tr style="height: 23.3pt;visibility: visible;"><td style="border-color: rgb(191, 191, 191);border-style: solid;border-width: 1pt;padding: 0cm 5.4pt;word-break: break-all;visibility: visible;" width="111" valign="top" height="23"><p style="visibility: visible;"><strong style="visibility: visible;"><span style="font-size: 15px;visibility: visible;">漏洞编号</span></strong></p></td><td style="border-color: rgb(191, 191, 191) rgb(191, 191, 191) rgb(191, 191, 191) currentcolor;border-style: solid solid solid none;border-width: 1pt 1pt 1pt medium;padding: 0cm 5.4pt;word-break: break-all;visibility: visible;" width="76" valign="top" height="23"><p style="visibility: visible;"><span style="font-size: 14px;visibility: visible;">微步编号</span></p></td><td style="border-color: rgb(191, 191, 191) rgb(191, 191, 191) rgb(191, 191, 191) currentcolor;border-style: solid solid solid none;border-width: 1pt 1pt 1pt medium;padding: 0cm 5.4pt;word-break: break-all;visibility: visible;" width="227" valign="top" height="23"><p style="visibility: visible;"><span style="font-size: 14px;letter-spacing: 0.578px;text-decoration: rgba(0, 0, 0, 0.9);visibility: visible;"></span><span style="font-size: 14px;letter-spacing: 0.578px;text-decoration: rgba(0, 0, 0, 0.9);visibility: visible;"><span style="font-size: 14px;letter-spacing: 0.578px;text-decoration: rgba(0, 0, 0, 0.9);visibility: visible;"><span style="font-size: 14px;letter-spacing: 0.578px;text-decoration: rgba(0, 0, 0, 0.9);visibility: visible;"><span style="font-size: 14px;letter-spacing: 0.578px;text-decoration: rgba(0, 0, 0, 0.9);visibility: visible;"><span style="font-size: 14px;letter-spacing: 0.578px;text-decoration: rgba(0, 0, 0, 0.9);">XVE-2022-15941</span></span></span></span></span><span style="font-size: 14px;letter-spacing: 0.578px;text-decoration: rgba(0, 0, 0, 0.9);visibility: visible;"><span style="font-size: 14px;letter-spacing: 0.578px;text-decoration: rgba(0, 0, 0, 0.9);visibility: visible;"><span style="font-size: 14px;letter-spacing: 0.578px;text-decoration: rgba(0, 0, 0, 0.9);visibility: visible;"></span></span></span><span style="font-size: 14px;letter-spacing: 0.578px;text-decoration: rgba(0, 0, 0, 0.9);visibility: visible;"></span></p></td></tr><tr style="height: 23.3pt;visibility: visible;"><td rowspan="6" style="border-color: currentcolor rgb(191, 191, 191) rgb(191, 191, 191);border-style: none solid solid;border-width: medium 1pt 1pt;padding: 0cm 5.4pt;visibility: visible;" width="131" valign="top" height="23"><p style="visibility: visible;"><strong style="visibility: visible;"><span style="font-size: 15px;visibility: visible;">漏洞评估</span></strong></p></td><td style="border-color: currentcolor rgb(191, 191, 191) rgb(191, 191, 191) currentcolor;border-style: none solid solid none;border-width: medium 1pt 1pt medium;padding: 0cm 5.4pt;visibility: visible;" width="76" valign="top" height="23"><p style="visibility: visible;"><span style="font-size: 14px;visibility: visible;">危害评级</span></p></td><td style="border-color: currentcolor rgb(191, 191, 191) rgb(191, 191, 191) currentcolor;border-style: none solid solid none;border-width: medium 1pt 1pt medium;padding: 0cm 5.4pt;word-break: break-all;visibility: visible;" width="227" valign="top" height="23"><p style="visibility: visible;"><span style="font-size: 14px;visibility: visible;">高危</span></p></td></tr><tr style="height: 23.3pt;visibility: visible;"><td style="border-color: currentcolor rgb(191, 191, 191) rgb(191, 191, 191) currentcolor;border-style: none solid solid none;border-width: medium 1pt 1pt medium;padding: 0cm 5.4pt;visibility: visible;" width="132" valign="top" height="23"><p style="visibility: visible;"><span style="font-size: 14px;visibility: visible;">漏洞类型</span></p></td><td style="border-color: currentcolor rgb(191, 191, 191) rgb(191, 191, 191) currentcolor;border-style: none solid solid none;border-width: medium 1pt 1pt medium;padding: 0cm 5.4pt;word-break: break-all;visibility: visible;" width="235" valign="top" height="23"><p style="visibility: visible;"><span style="font-size: 14px;letter-spacing: 0.578px;text-decoration: rgba(0, 0, 0, 0.9);"><span style="font-size: 14px;letter-spacing: 0.578px;text-decoration: rgba(0, 0, 0, 0.9);"><span style="font-size: 14px;letter-spacing: 0.578px;text-decoration: rgba(0, 0, 0, 0.9);">RCE</span></span></span><span style="font-size: 14px;letter-spacing: 0.578px;text-decoration: rgba(0, 0, 0, 0.9);visibility: visible;"><span style="font-size: 14px;letter-spacing: 0.578px;text-decoration: rgba(0, 0, 0, 0.9);visibility: visible;"></span></span></p></td></tr><tr style="visibility: visible;"><td style="border-color: currentcolor rgb(191, 191, 191) rgb(191, 191, 191) currentcolor;border-style: none solid solid none;border-width: medium 1pt 1pt medium;padding: 0cm 5.4pt;visibility: visible;" width="132" valign="top"><p style="visibility: visible;"><span style="font-size: 14px;">公开程度</span></p></td><td style="border-color: currentcolor rgb(191, 191, 191) rgb(191, 191, 191) currentcolor;border-style: none solid solid none;border-width: medium 1pt 1pt medium;padding: 0cm 5.4pt;word-break: break-all;" width="235" valign="top"><p><span style="font-size: 14px;"><span style="font-size: 14px;letter-spacing: 0.578px;text-decoration: rgba(0, 0, 0, 0.9);">PoC未公开</span></span></p></td></tr><tr style="mso-yfti-irow:4;"><td style="border-color: currentcolor rgb(191, 191, 191) rgb(191, 191, 191) currentcolor;border-style: none solid solid none;border-width: medium 1pt 1pt medium;padding: 0cm 5.4pt;" width="132" valign="top"><p><span style="font-size: 14px;">利用条件</span></p></td><td style="border-color: currentcolor rgb(191, 191, 191) rgb(191, 191, 191) currentcolor;border-style: none solid solid none;border-width: medium 1pt 1pt medium;padding: 0cm 5.4pt;word-break: break-all;" width="235" valign="top"><p><span style="font-size: 14px;letter-spacing: 0.578px;text-decoration: rgba(0, 0, 0, 0.9);"></span><span style="font-size: 14px;letter-spacing: 0.578px;text-decoration: rgba(0, 0, 0, 0.9);"></span><span style="font-size: 14px;letter-spacing: 0.578px;text-decoration: rgba(0, 0, 0, 0.9);">无权限要求</span></p></td></tr><tr style="mso-yfti-irow:5;"><td style="border-color: currentcolor rgb(191, 191, 191) rgb(191, 191, 191) currentcolor;border-style: none solid solid none;border-width: medium 1pt 1pt medium;padding: 0cm 5.4pt;" width="132" valign="top"><p><span style="font-size: 14px;">交互要求</span></p></td><td style="border-color: currentcolor rgb(191, 191, 191) rgb(191, 191, 191) currentcolor;border-style: none solid solid none;border-width: medium 1pt 1pt medium;padding: 0cm 5.4pt;word-break: break-all;" width="235" valign="top"><p><span style="font-size: 14px;"><span style="font-size: 14px;font-family: 黑体;" lang="EN-US">0-</span>click</span></p></td></tr><tr style="mso-yfti-irow:6;"><td style="border-color: currentcolor rgb(191, 191, 191) rgb(191, 191, 191) currentcolor;border-style: none solid solid none;border-width: medium 1pt 1pt medium;padding: 0cm 5.4pt;" width="132" valign="top"><p><span style="font-size: 14px;">威胁类型</span></p></td><td style="border-color: currentcolor rgb(191, 191, 191) rgb(191, 191, 191) currentcolor;border-style: none solid solid none;border-width: medium 1pt 1pt medium;padding: 0cm 5.4pt;word-break: break-all;" width="235" valign="top"><p><span style="font-size: 14px;">远程</span></p></td></tr><tr style="mso-yfti-irow:7;"><td rowspan="1" style="border-color: currentcolor rgb(191, 191, 191) rgb(191, 191, 191);border-style: none solid solid;border-width: medium 1pt 1pt;padding: 0cm 5.4pt;" width="131" valign="top"><p><strong><span style="font-size: 15px;">利用情报</span></strong></p></td><td style="border-color: currentcolor rgb(191, 191, 191) rgb(191, 191, 191) currentcolor;border-style: none solid solid none;border-width: medium 1pt 1pt medium;padding: 0cm 5.4pt;word-break: break-all;" width="76" valign="top"><p><span style="font-size: 14px;">微步已捕获攻击行为</span></p></td><td style="border-color: currentcolor rgb(191, 191, 191) rgb(191, 191, 191) currentcolor;border-style: none solid solid none;border-width: medium 1pt 1pt medium;padding: 0cm 5.4pt;word-break: break-all;" width="227" valign="top"><section style="line-height: 1.6em;text-align: justify;margin: 0px;text-indent: 0em;"><span style="font-size: 14px;letter-spacing: 0.578px;text-decoration: rgba(0, 0, 0, 0.9);">是</span><span style="font-size: 14px;"></span></section></td></tr><tr style="mso-yfti-irow:9;"><td rowspan="4" style="border-color: currentcolor rgb(191, 191, 191) rgb(191, 191, 191);border-style: none solid solid;border-width: medium 1pt 1pt;padding: 0cm 5.4pt;" width="131" valign="top"><p><strong><span style="font-size: 15px;">影响产品</span></strong></p></td><td style="border-color: currentcolor rgb(191, 191, 191) rgb(191, 191, 191) currentcolor;border-style: none solid solid none;border-width: medium 1pt 1pt medium;padding: 0cm 5.4pt;" width="76" valign="top"><p><span style="font-size: 14px;">产品名称</span></p></td><td style="border-color: currentcolor rgb(191, 191, 191) rgb(191, 191, 191) currentcolor;border-style: none solid solid none;border-width: medium 1pt 1pt medium;padding: 0cm 5.4pt;word-break: break-all;" width="227" valign="top"><p><span style="font-size: 14px;letter-spacing: 0.578px;text-decoration: rgba(0, 0, 0, 0.9);"><span style="font-size: 14px;letter-spacing: 0.578px;text-decoration: rgba(0, 0, 0, 0.9);"></span></span><span style="font-size: 14px;letter-spacing: 0.578px;text-decoration: rgba(0, 0, 0, 0.9);"><span style="font-size: 14px;letter-spacing: 0.578px;text-decoration: rgba(0, 0, 0, 0.9);"><span style="font-size: 14px;letter-spacing: 0.578px;text-decoration: rgba(0, 0, 0, 0.9);">北京致远互联软件股份有限公司-致远OA</span></span></span></p></td></tr><tr style="mso-yfti-irow:10;"><td style="border-color: currentcolor rgb(191, 191, 191) rgb(191, 191, 191) currentcolor;border-style: none solid solid none;border-width: medium 1pt 1pt medium;padding: 0cm 5.4pt;word-break: break-all;" width="132" valign="top"><p><span style="font-size: 14px;">受影响版本</span></p></td><td style="border-color: currentcolor rgb(191, 191, 191) rgb(191, 191, 191) currentcolor;border-style: none solid solid none;border-width: medium 1pt 1pt medium;padding: 0cm 5.4pt;word-break: break-all;" width="235" valign="top"><section style="line-height: 1.6em;text-align: justify;margin: 0px;text-indent: 0em;"><span style="font-size: 14px;letter-spacing: 0.578px;text-decoration: rgba(0, 0, 0, 0.9);">1. A6、A8、A8N的V8.0SP2、V8.1、V8.1SP1</span></section><section style="line-height: 1.6em;text-align: justify;margin: 0px;text-indent: 0em;"><span style="font-size: 14px;letter-spacing: 0.578px;text-decoration: rgba(0, 0, 0, 0.9);"> 2. G6、G6N的V8.1、V8.1SP1</span></section><section style="line-height: 1.6em;text-align: justify;margin: 0px;text-indent: 0em;"><span style="font-size: 14px;letter-spacing: 0.578px;text-decoration: rgba(0, 0, 0, 0.9);"></span></section><section style="line-height: 1.6em;text-align: justify;margin: 0px;text-indent: 0em;"><span style=""></span></section><section style="line-height: 1.6em;text-align: justify;margin: 0px;text-indent: 0em;"><span style="font-size: 14px;letter-spacing: 0.578px;text-decoration: rgba(0, 0, 0, 0.9);"></span></section><section style="line-height: 1.6em;text-align: justify;margin: 0px;text-indent: 0em;"><span style="font-size: 14px;letter-spacing: 0.578px;text-decoration: rgba(0, 0, 0, 0.9);"></span></section></td></tr><tr style="mso-yfti-irow:11;"><td style="border-color: currentcolor rgb(191, 191, 191) rgb(191, 191, 191) currentcolor;border-style: none solid solid none;border-width: medium 1pt 1pt medium;padding: 0cm 5.4pt;" width="132" valign="top"><p><span style="font-size: 14px;">影响范围</span></p></td><td style="border-color: currentcolor rgb(191, 191, 191) rgb(191, 191, 191) currentcolor;border-style: none solid solid none;border-width: medium 1pt 1pt medium;padding: 0cm 5.4pt;word-break: break-all;" width="235" valign="top"><p><span style="font-size: 14px;"><span style="font-size: 14px;letter-spacing: 0.578px;text-decoration: rgba(0, 0, 0, 0.9);"><span style="font-size: 14px;letter-spacing: 0.578px;text-decoration: rgba(0, 0, 0, 0.9);"><span style="font-size: 14px;letter-spacing: 0.578px;text-decoration: rgba(0, 0, 0, 0.9);">万级</span></span></span></span></p></td></tr><tr style="mso-yfti-irow:12;mso-yfti-lastrow:yes;height:26.7pt;"><td style="border-color: currentcolor rgb(191, 191, 191) rgb(191, 191, 191) currentcolor;border-style: none solid solid none;border-width: medium 1pt 1pt medium;padding: 0cm 5.4pt;" width="132" valign="top" height="26"><p><span style="font-size: 14px;">有无修复补丁</span></p></td><td style="border-color: currentcolor rgb(191, 191, 191) rgb(191, 191, 191) currentcolor;border-style: none solid solid none;border-width: medium 1pt 1pt medium;padding: 0cm 5.4pt;word-break: break-all;" width="235" valign="top" height="26"><p><span style="font-size: 14px;">有</span></p></td></tr></tbody></table>  
### 03 漏洞复现 04 修复方案 1、官方修复方案：官方已发布修复方案，受影响的用户建议联系官方获取安全补丁。http://service.seeyon.com/patchtools/tp.html#/patchList?type=%E5%AE%89%E5%85%A8%E8%A1%A5%E4%B8%81&id=1192、临时修复方案：（1）非必要不建议将该系统暴露在公网；（2）匹配包含..;和wpsAssistServlet的路径，强化访问控制策略，加强监控。05 微步在线产品侧支持情况  微步在线威胁感知平台TDP已支持检测，规则ID为S3100028004、S3100028005。---End---微步漏洞情报订阅服务微步漏洞情报订阅服务是由微步漏洞团队面向企业推出的一项高级分析服务，致力于通过微步自有产品强大的高价值漏洞发现和收集能力以及微步核心的威胁情报能力，为企业提供0day漏洞预警、最新公开漏洞预警、漏洞分析及评估等漏洞相关情报，帮助企业应对最新0day/1day等漏洞威胁并确定漏洞修复优先级，快速收敛企业的攻击面，保障企业自身业务的正常运转。X 漏洞奖励计划“X漏洞奖励计划”是微步X情报社区推出的一款0day漏洞奖励计划，我们鼓励白帽子提交挖掘到的0day漏洞，并给予白帽子可观的奖励。我们期望通过该计划与白帽子共同努力，提升0day防御能力，守护数字世界安全。  
  
