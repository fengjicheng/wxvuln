#  CVE-2022-37969 CLFS 提权漏洞   
hml189  看雪学苑   2023-06-10 18:15  
  
大佬可直接转至https://www.zscaler.com/blogs/security-research/technical-analysis-windows-clfs-zero-day-vulnerability-cve-2022-37969-part  
照着文章复现一遍。  
  
  
通用日志文件系统（CLFS）是一种通用的日志记录子系统，可供运行在内核模式和用户模式下的应用程序使用，用于构建高性能的事务日志，并在驱动程序CLFS.sys中进行实现。通用日志文件系统在基本日志文件（BLF）中生成事务日志。  
  
CLFS的官方文档：https://learn.microsoft.com/en-us/windows-hardware/drivers/kernel/introduction-to-the-common-log-file-system  
  
CLFS的非官方文档：https://github.com/ionescu007/clfs-docs/blob/main/README.md  
  
  
```
```  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/1UG7KPNHN8GibpU3NlYsY0CMsn93QviaFeaH3xfaGA6w5H4dNXvdib1se3HjLVt73bJNgO0wibQjxMDl3IL8hiajYSA/640?wx_fmt=png "")  
  
  
基本日志文件由六个不同的元数据块组成，控制块（Control Block）、基本块（Base Block）和截断块（Truncate Block）以及它们对应的影子块。三种类型的记录（控制记录、基本记录和截断记录（(Control Record, Base Record, and Truncate Record)）可以驻留在这些块中。Base Record包含符号表，这些符号表存储有关与基本日志文件关联的客户端上下文、容器上下文和安全上下文的信息。  
  
每个日志块的都有一个日志块头CLFS_LOG_BLOCK_HEADER，大小为0x70字节的CLFS_LOG_BLOCK_HEADER结构的内存布局如上图所示，结构如下：  
  
  
```
```  
  
  
  
基本块在.BLF文件的偏移0x800到0x71FF，以Log Block Header (0x70 bytes)开始，然后是基础记录头与记录。  
  
基础记录头的的CLFS_BASE_RECORD_HEADER结构如下：  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/1UG7KPNHN8GibpU3NlYsY0CMsn93QviaFeBX0ERGSsLuOCOwXg7Qxh7Mt9vUUdc2nnqUTic7LWB2dk0u9vYRSJDIg/640?wx_fmt=png "")  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/1UG7KPNHN8GibpU3NlYsY0CMsn93QviaFefibYG5fREMEiaGQRw4kkpV5e3vwibuhEZlzqqV1TY6ffYMRKK8IsDCicZQ/640?wx_fmt=png "")  
  
  
Base Record以大小为 0x1338 字节的标头 (CLFS_BASE_RECORD_HEADER) 开始，后面是相关的上下文数据。在CLFS_BASE_RECORD_HEADER中，与该漏洞相关的一些重要字段说明如下：rgClients表示指向客户端上下文对象的偏移数组。  
  
rgContainers表示指向容器上下文对象的偏移数组。cbSymbolZone表示符号区域中新符号的下一个可用偏移量。在Base Record中 Client Context, Container Context, 和Shared Security Context 用符号表示，他们前面是CLFSHASHSYM。  
  
  
```
```  
  
  
  
CLFSHASHSYM 的内存布局如下：  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/1UG7KPNHN8GibpU3NlYsY0CMsn93QviaFemwl92icbSoP7Z5utk7Zl7UMNOuKmwyF6lm0icZwsYCEvE4FAElDLo6Bg/640?wx_fmt=png "")  
  
  
在Base Record,中，客户端上下文（client context ）用于标识日志文件的客户端。在基础日志文件中至少可以创建一个客户端上下文。  
  
  
CLFS_CLIENT_CONTEXT结构如下：  
  
  
```
```  
  
  
  
在Base Record中，container context与为一个base log文件添加一个容器文件有关。  
  
CLFS_CONTAINER_CONTEXT结构如下：  
  
  
```
```  
  
  
  
pContainer是指向运行时表示容器的CClfsContainer对象的内核指针，该指针位于CLFS_CONTAINER_CONTEXT结构的偏移0x18处。  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/1UG7KPNHN8GibpU3NlYsY0CMsn93QviaFerKE3W6oKaspBRibvdzl0p9XYmicGz8JqNNcNicdatibsnB9FENDIUgVDlw/640?wx_fmt=png "")  
  
```
```  
  
  
文章中给出了部分poc。  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/1UG7KPNHN8GibpU3NlYsY0CMsn93QviaFe1JJ2M5ibXrcc3Vt0mrfnfHHr6PofB6KsmM4auzibO98LomNfA3qia1icEQ/640?wx_fmt=png "")  
  
   
  
0x09a8: |68 13 00 00| => |30 1B 00 00|把0x1386的Offset修改为了0x1B30，弃用0x1BD8=0x1386+0x870的Client Context，在0x23A0=0x1B30+0x870的地方重新伪造一个  
  
   
  
0x1B98: |F8 00 00 00| => |4B 11 01 00|cbSymbolZone 0x1114B改大cbSymbolZone，以使得AddLogContainer时，造成堆越界写  
  
   
  
poc中包含的步骤：  
  
  
1 通过CreateLogFile 在C:\Users\Public\ 目录下创建日志文件MyLog.blf。  
  
2 创建数十个MyLog_xxx.blf基础日志文件，使用一个常数计数器来创建基本日志文件，因此可能不会使连续创建的两个内存区域之间的偏移量保持恒定（0x11000字节）。因此，常量值必须针对这种情况进行调整。  
  
  
3 重新计算Base Block的crc32，然后将新的校验值写入偏移量0x80C处。然后打开MyLog.blf。  
  
  
4 调用CreateLogFile 在文件夹C:\Users\Public\中创建一个基本日志文件  
MyLxg_xxx.blf。  
  
  
5 调用AddLogContainer 为步骤4中创建的MyLxg_xxx.blf添加日志容器。  
  
6 调用GetProcAddress(LoadLibraryA("ntdll.dll"), "NtSetInformationFile")来获取NtSetInformationFile的函数地址。  
  
  
7 调用AddLogContainer 为步骤3中打开的MyLog.blf添加日志容器。  
  
8 调用NtSetInformationFile(v55, (PIO_STATUS_BLOCK)v33, v28, 1, (FILE_INFORMATION_CLASS)13)，最后一个参数是FileInformationClass类型。当值为FileDispositionInformation（13）时，该函数将在关闭文件时删除该文件或取消之前请求的删除。  
  
  
9 调用CloseHandle 关闭MyLxg_xxx.blf的句柄，触发此漏洞。  
  
  
还原poc，poc见附件。  
  
  
运行poc，触发崩溃。  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/1UG7KPNHN8GibpU3NlYsY0CMsn93QviaFeLjAPGKKAXaA8cz5OnA0fkuwKEpm0GOxwCc6cBBkbLXOusXrhZ1iavDw/640?wx_fmt=png "")  
  
  
```
```  
  
  
poc中的第5和第7步分别调用AddLogContainer将容器添加到与日志句柄关联的日志。在 CLFS.sys 中，CClfsRequest类负责处理来自用户空间的请求。CClfsRequest ::AllocContainer函数用于处理向物理日志添加容器的请求。CClfsRequest ::AllocContainer函数调用CClfsLogFcbPhysical::AllocContainer。  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/1UG7KPNHN8GibpU3NlYsY0CMsn93QviaFejIticyuBMzkvWAqTJic23PBTKwnKic45xZoxIQpjfHa9QvhTv9qspa8hA/640?wx_fmt=png "")  
  
  
CClfsLogFcbPhysical::AllocContainer声明如下：  
  
  
```
```  
  
  
  
bu CLFS!CClfsLogFcbPhysical::AllocContainer断点被触发，rcx存放的是CClfsLogFcbPhysical类的this指针。  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/1UG7KPNHN8GibpU3NlYsY0CMsn93QviaFesD5PnfFuvfALIgSgFPEkBZwShTyImibnE7eVM2fMPs47Hwkic4840lRQ/640?wx_fmt=png "")  
  
  
CClfsLogFcbPhysical类中vftable的地址存储在偏移量 0x00 处。在this+0x30 处，存储了指向日志名称的指针。this +0x2B0 存储了指向CClfsBaseFilePersisted类的指针。AddLogContainer fail的情况下这里为0(win10 this +0x2B0指向的是自己（this +0x2B0），找不到CLFS!CClfsBaseFilePersisted::vftable)。  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/1UG7KPNHN8GibpU3NlYsY0CMsn93QviaFeictwteve0gLwN9CrmKibmzwvbqCrqPGxqib65bOusMo0BvfYeoFL8fK3g/640?wx_fmt=png "")  
  
  
win11  
  
  
在内存中 一个CLFS基本日志文件可以由CClfsBaseFile类表示，可由CClfsBaseFilePersisted 类拓展，CClfsBaseFilePersisted的指针+0x30处储存了一个指向0x90字节大小的堆的指针。  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/1UG7KPNHN8GibpU3NlYsY0CMsn93QviaFeFiagGzIyXjbiaqSg6mZv1Sg5rRJHDnCr0m7SX0CM56N9FVpZfibI9U3nQ/640?wx_fmt=png "")  
  
  
在CClfsBaseFilePersisted的this指针偏移 0x1C0 处，存储了指向CClfsContainer对象的指针，该指针来自CLFS_CONTAINER_CONTEXT 结构中的字段pContainer。添加容器成功后可看到：  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/1UG7KPNHN8GibpU3NlYsY0CMsn93QviaFeAiaSCiaJhyvOf9SpmaskibapyktEmS6al3ZXI91LxdzOxRHqic4yFPaXkg/640?wx_fmt=png "")  
  
  
此时可以在CLFS_CONTAINER_CONTEXT+0x18处设置内存写断点，跟踪CLFS_CONTAINER_CONTEXT结构中CClfsContainer对象的指针何时损坏。CClfsBaseFilePersisted 对象中偏移量 0x1C0 处的另一个内存写入断点可以设置如下：1: kd> ba w8 ffffe689 255374f0 //CLFS_CONTAINER_CONTEXT+0x181: kd> ba w8 ffffe689 25159b20 //CClfsBaseFilePersisted+0x1C0到第七步给Mylog AllocContainer时  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/1UG7KPNHN8GibpU3NlYsY0CMsn93QviaFekMmicBHz6FmEJ1fB9p2W8cHnLwIZXDPpvB1Uib06QDgmplthTPpibv6FA/640?wx_fmt=png "")  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/1UG7KPNHN8GibpU3NlYsY0CMsn93QviaFeia9Mt7jOxmsibGiazkzVTFR7EganEYwSyZApG2uuGQCAzPjpLgPNeic8hA/640?wx_fmt=png "")  
  
  
最初在 MyLog.blf 文件中设置为 0x00000050 的 SignaturesOffset 字段在内存中已设置为 0xFFFF0050。  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/1UG7KPNHN8GibpU3NlYsY0CMsn93QviaFe67y11aGnJgznibmY6AnqwJgSHgdfkKyP7OflgZc9taKAwmKowDh4gaA/640?wx_fmt=png "")  
  
  
CLFS_CONTAINER_CONTEXT 结构中偏移量 0x18 处的CClfsContainer指针损坏。FFFF E689 2514 9B20==》30c1fdf0`06159b20  
  
继续运行代码。将命中内存写入断点CLFS_CONTAINER_CONTEXT: +0x18。  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/1UG7KPNHN8GibpU3NlYsY0CMsn93QviaFeSxRLFgKiaayknB1jqVfHhwiaXF3EUicuGYho2f752UicSNJZP4mGtKxxdg/640?wx_fmt=png "")  
  
  
CClfsBaseFilePersisted::AllocSymbol函数中调用memset函数触发内存写断点，Base Record 中的CLFS_CONTAINER_CONTEXT产生越界写入，这会导致CClfsContainer对象中的指针损坏。  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/1UG7KPNHN8GibpU3NlYsY0CMsn93QviaFeRQEDoj3xWHP52iaM9Yds0PMasE1KWYVn1BRiaQCZjoFwndb8tSdWYuIg/640?wx_fmt=png "")  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/1UG7KPNHN8GibpU3NlYsY0CMsn93QviaFewlH88LyNlofTaZDrlaIPUepPU5a2JS6RI9qmsLRDRzzos2gsen3CRg/640?wx_fmt=png "")  
  
根据栈回溯，CClfsBaseFilePersisted::AllocSymbol函数中调用memset函数触发内存写断点。  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/1UG7KPNHN8GibpU3NlYsY0CMsn93QviaFembWEJibD8V61HiapS3CWRuYX6GK9J5P5Ay5zlq1hQ12ZFmVeeu3RdbxQ/640?wx_fmt=png "")  
  
  
下图展示越界写入是如何发生的，以及如何导致CClfsContainer对象中的指针损坏。  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/1UG7KPNHN8GibpU3NlYsY0CMsn93QviaFeUMzCUtDuNGYdLcQZ6wd7iaCFX3LGNvWnpKxQIR1tzeU0j6FWpIw3TibQ/640?wx_fmt=png "")  
  
  
当在用户空间调用CloseHandle函数时， CClfsRequest::Close(PIRP Irp)处理这个请求。在内核中，另一个内存断点 (0x1c0+CClfsBaseFilePersisted) 在ClfsBaseFilePersisted::WriteMetadataBlock函数中命中。  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/1UG7KPNHN8GibpU3NlYsY0CMsn93QviaFeyA2KiaSOPCJEa4HfQ3vUy57zClhq8GrfA44BmbRT56jY3ibjXs2EaasQ/640?wx_fmt=png "")  
  
  
从CLFS_CONTAINER_CONTEXT中的CClfsContainer将损坏的指针复制到Base Record中CClfsBaseFilePersisted+0x1c0处。  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/1UG7KPNHN8GibpU3NlYsY0CMsn93QviaFenficnl9JDuib5N8aEeiaophC79CAxr7Ogyewcb38998szAibgibjFqOcUhQ/640?wx_fmt=png "")  
  
  
最后，在CLFS!CClfsBaseFilePersisted::RemoveContainer中取消引用指向CClfsContainter对象的损坏指针会导致内存冲突，造成崩溃。  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/1UG7KPNHN8GibpU3NlYsY0CMsn93QviaFe1yAibnSYFvqvkXenYwWr4chYWibN4CQY6zhibtn2rkLIeUMNjAAicQfv1Q/640?wx_fmt=png "")  
  
  
CClfsBaseFilePersisted::RemoveContainer函数伪代码：  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/1UG7KPNHN8GibpU3NlYsY0CMsn93QviaFeQs3sjC8JjV4vlNpgEb6gqfMdpoYSHmFibkR5ib6TNqr3aCt4n3yvxrbg/640?wx_fmt=png "")  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/1UG7KPNHN8GibpU3NlYsY0CMsn93QviaFecLcTWGbSa6NZKT76Dj0jDw2c9YcPs1RnVBLGKQGczDda9qHvYk516Q/640?wx_fmt=png "")  
  
  
CClfsBaseFilePersisted::RemoveContainer函数执行有以下步骤。  
  
  
1.获取 Base Record 中偏移 0x398 处的container context的偏移量（0x1468）。  
  
  
2.调用CClfsBaseFile::GetSymbol获取指向 CLFS_CONTAINER_CONTEXT 结构的指针并将其存储在第 4 个参数中。  
  
  
3.将步骤2中获取的CLFS_CONTAINER_CONTEXT结构中指向CClfsContainter对象的指针的值赋给局部变量v13。  
  
  
4.将CLFS_CONTAINER_CONTEXT 结构中指向CClfsContainter对象的指针清零。  
  
  
5.依次调用CClfsContainer::Remove和CClfsContainer::Release删除关联的  
  
容器日志文件并释放CClfsContainer对象。  
  
## 补丁  
  
  
补丁补在了CClfsBaseFilePersisted::LoadContainerQ中，如下：  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/1UG7KPNHN8GibpU3NlYsY0CMsn93QviaFe5BGWFox4iaCqHnYsohicYp2MiaRj3MeXQR0zRnvQ9ugl04ZAnK7KNTMxw/640?wx_fmt=png "")  
  
  
当用户空间调用CreateLogFile函数时，CLFS!CClfsRequest::Create负责处理这个请求。当 CreateLogFile函数用于打开现有的基本日志文件时，会调用CClfsLogFcbPhysical::Initialize。  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/1UG7KPNHN8GibpU3NlYsY0CMsn93QviaFeRJiacDCQltqoxB5zISsvib4oNgOueulvkexn3Cl56GsXbAcawibPbxODA/640?wx_fmt=png "")  
  
  
CClfsLogFcbPhysical::Initialize调用CClfsBaseFilePersisted::LoadContainerQ  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/1UG7KPNHN8GibpU3NlYsY0CMsn93QviaFeGXluM1p7WTt76cmAEYeYcHicpv8UnQjKrSVicQGjRzPhHGECu7Cvs7aQ/640?wx_fmt=png "")  
###   
### SignaturesOffset被覆盖的过程  
  
  
CClfsLogFcbPhysical::Initialize中的5步：  
  
1.调用CClfsBaseFilePersisted::OpenImage函数为基础日志文件中的基础块创建一个bigpool（大小：0x7a00）。  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/1UG7KPNHN8GibpU3NlYsY0CMsn93QviaFeRuGdw2Yn7FuibN3R35ux019J7VXgpfheSQcLn8SxysUbRnEibkPjg3bQ/640?wx_fmt=png "")  
  
  
OpenImage最终会调用ReadMetadataBlockCClfsBaseFilePersisted::OpenImage -> CClfsBaseFilePersisted::ReadImage -> CClfsBaseFile::AcquireMetadataBlock -> CClfsBaseFilePersisted::ReadMetadataBlock  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/1UG7KPNHN8GibpU3NlYsY0CMsn93QviaFembq8YMiaIjMjN0BiaiacjC6cK8aQ9hUqSwo0Y8OIpZE8UzAcj650CRB0Q/640?wx_fmt=png "")  
  
  
2.调用CClfsBaseFile::AcquireClientContext函数从基块获取客户端上下文。  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/1UG7KPNHN8GibpU3NlYsY0CMsn93QviaFev0br3icUReAEjBpjaiadgTDdOrqq1njNTc22U2Au4DdUwyntsnAlHn5Q/640?wx_fmt=png "")  
  
  
对.blf文件的修改![](https://mmbiz.qpic.cn/sz_mmbiz_png/1UG7KPNHN8GibpU3NlYsY0CMsn93QviaFermC5kib9GjjIDLiaEbWhAZZmWPSGO3a9K4Rswpfw2icViaTx6EGQAxpCuQ/640?wx_fmt=png "")  
  
  
  
3.检查eState字段是否为CLFS_LOG_SHUTDOWN。  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/1UG7KPNHN8GibpU3NlYsY0CMsn93QviaFeozOz0gjWgNYibqCWmPNPfYVtwwKkLeLMmkqIuwlnRKfgCcZekwxUYEQ/640?wx_fmt=png "")  
  
  
4.调用CClfsLogFcbPhysical::ResetLog函数。  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/1UG7KPNHN8GibpU3NlYsY0CMsn93QviaFe3NW1GxQutDYp4YtibRnCps5PWwHLdyxuNehnelyC207ViaqZf8FJbXJw/640?wx_fmt=png "")  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/1UG7KPNHN8GibpU3NlYsY0CMsn93QviaFezSGOlNXSTks3bmVwhDmK4n9czOZRLHZ2gC8ALBFQGibySlACnUNHkTQ/640?wx_fmt=png "")  
  
  
(文中的原图)  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/1UG7KPNHN8GibpU3NlYsY0CMsn93QviaFeaxX8siaWV7ZO3mg57frC2cLibNMibuqwMfvQ5VYibWPVQIxIr4AbiaQicsvg/640?wx_fmt=png "")  
  
  
5.调用CClfsLogFcbPhysical::FlushMetaData函数。  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/1UG7KPNHN8GibpU3NlYsY0CMsn93QviaFeLhIDfHFvmG6AFLQB9EkZraFvuhztTQnJCWkPs9joCJJvZDll8IagIQ/640?wx_fmt=png "")  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/1UG7KPNHN8GibpU3NlYsY0CMsn93QviaFeRQYVpYWTdibUpu8occQO5Mn3pPagbBsGc1JQT7Y6ow7D0Hy0B5kAluQ/640?wx_fmt=png "")  
  
  
ClfsEncodeBlockPrivate从基块中的每个扇区获取扇区签名，并用扇区签名覆盖扇区签名数组，扇区签名数组位于偏移 0x50 处，与基块中的 SignaturesOffset 字段重叠。第 14 个扇区的扇区签名已设置为 0xFFFF， 在基本块中的偏移量 0x6C (0x50+0xE*2) 处的两个字节被覆盖(0xFFFF)。  
  
SignaturesOffset 字段的值为 0xFFFF0050。  
  
(文中的原图)  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/1UG7KPNHN8GibpU3NlYsY0CMsn93QviaFeWxpQIw2UZIUgjg5ibqcNJNMO7JOXEiaJvicofLiao2UZFoic50RMRt1iciaKA/640?wx_fmt=png "")  
  
  
覆盖 SignaturesOffset 字段的过程：  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/1UG7KPNHN8GibpU3NlYsY0CMsn93QviaFep7pKuceDjc7Hkdicn8NAqjSYf3X5mRVG8OgaL3iah06hcDrp9jNIeAyQ/640?wx_fmt=png "")  
  
  
**参考链接：**  
  
https://www.zscaler.com/blogs/security-research/technical-analysis-windows-clfs-zero-day-vulnerability-cve-2022-37969-part  
  
https://www.coresecurity.com/core-labs/articles/understanding-cve-2022-37969-windows-clfs-lpe  
  
https://paper.seebug.org/1920  
  
https://bbs.kanxue.com/thread-275566.htm#msg_header_h2_4  
  
  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/1UG7KPNHN8GibpU3NlYsY0CMsn93QviaFeaIZ9lZNUTUEPjgeV9vTXSt4OrZNHl4KwXTbnZN0iaJZubYdMchbG55Q/640?wx_fmt=png "")  
  
  
**看雪ID：hml189**  
  
https://bbs.kanxue.com/user-home-865065.htm  
  
*本文为看雪论坛优秀文章，由 hml189 原创，转载请注明来自看雪社区  
  
  
[](http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&mid=2458499288&idx=1&sn=b2b9cd6ff7388a8658d254e13c72f9ad&chksm=b18e885286f9014436a590f2531fda167be67e1e227ea395812968e828932bd44eade34b0dbf&scene=21#wechat_redirect)  
  
  
**#****往期推荐**  
  
1、[在 Windows下搭建LLVM 使用环境](http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&mid=2458500602&idx=1&sn=4bcc2af3c62e79403737ce6eb197effc&chksm=b18e8d7086f9046631a74245c89d5029c542976f21a98982b34dd59c0bda4624d49d1d0d246b&scene=21#wechat_redirect)  
  
  
2、[深入学习smali语法](http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&mid=2458500599&idx=1&sn=8afbdf12634cbf147b7ca67986002161&chksm=b18e8d7d86f9046b55ff3f6868bd6e1133092b7b4ec7a0d5e115e1ad0a4bd0cb5004a6bb06d1&scene=21#wechat_redirect)  
  
  
3、[安卓加固脱壳分享](http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&mid=2458500598&idx=1&sn=d783cb03dc6a3c1a9f9465c5053bbbee&chksm=b18e8d7c86f9046a67659f598242acb74c822aaf04529433c5ec2ccff14adeafa4f45abc2b33&scene=21#wechat_redirect)  
  
  
4、[Flutter 逆向初探](http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&mid=2458500574&idx=1&sn=06344a7d18a72530077fbc8f93a40d8f&chksm=b18e8d5486f904424874d7308e840523ebfb2db20811d99e4b0249d42fa8e38c4e80c3f622c6&scene=21#wechat_redirect)  
  
  
5、[一个简单实践理解栈空间转移](http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&mid=2458500315&idx=1&sn=19b12ab150dd49325f93ae9d73aef0c4&chksm=b18e8c5186f90547f3b615b160d803a320c103d9d892c7253253db41124ac6993d83d13c5789&scene=21#wechat_redirect)  
  
  
6、[记一次某盾手游加固的脱壳与修复](http://mp.weixin.qq.com/s?__biz=MjM5NTc2MDYxMw==&mid=2458500165&idx=1&sn=b16710232d3c2799c4177710f0ea6d41&chksm=b18e8ccf86f905d9a0b6c2c40997e9b859241a4d7f798c4aeab21352b0a72b6135afce349262&scene=21#wechat_redirect)  
  
  
  
![](https://mmbiz.qpic.cn/mmbiz_jpg/Uia4617poZXP96fGaMPXib13V1bJ52yHq9ycD9Zv3WhiaRb2rKV6wghrNa4VyFR2wibBVNfZt3M5IuUiauQGHvxhQrA/640?wx_fmt=jpeg&wxfrom=5&wx_lazy=1&wx_co=1 "")  
  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_gif/1UG7KPNHN8FHJ5XNqGmzLUOYeEJc9zylullBt3UKTEQsoxy2icCZlrib0kGSnnibUmPhrtv1ic2HR4SZvjH2PiaQASw/640?wx_fmt=gif "")  
  
**球分享**  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_gif/1UG7KPNHN8FHJ5XNqGmzLUOYeEJc9zylullBt3UKTEQsoxy2icCZlrib0kGSnnibUmPhrtv1ic2HR4SZvjH2PiaQASw/640?wx_fmt=gif "")  
  
**球点赞**  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_gif/1UG7KPNHN8FHJ5XNqGmzLUOYeEJc9zylullBt3UKTEQsoxy2icCZlrib0kGSnnibUmPhrtv1ic2HR4SZvjH2PiaQASw/640?wx_fmt=gif "")  
  
**球在看**  
  
