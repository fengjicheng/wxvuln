#  漏洞风险提示｜Openfire控制台权限绕过漏洞（CVE-2023-32315）   
长亭安全应急响应  黑伞安全   2023-06-14 09:24  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/FOh11C4BDicRRVzLmQjSLiavxtAic7KOwrGOib06SdVslHao1lrd7jvKLZEJW3NdJqlib3ENQcic2qDT8iaGUXib3wjTBw/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1 "")  
  
Openfire（前身为Wildfire）是一个基于XMPP（Extensible Messaging and Presence Protocol，可扩展消息处理和呈现协议）的开源实时协作服务器，同时提供了Web管理界面。近期，长亭科技监测到Openfire发布新版本修复了一个漏洞。长亭应急团队经过漏洞分析后，发现该漏洞类型为后台权限绕过，可利用其实现RCE。公网仍有较多相关系统尚未修复漏洞。应急团队根据该漏洞的原理，编写了X-POC远程检测工具和牧云本地检测工具，目前工具已向公众开放下载使用。  
**漏洞描述**  
  
   
Description   
  
  
  
**0****1**  
  
Openfire的管理控制台是一个基于 Web 的应用程序，被发现可以使用路径遍历的方式绕过权限校验。成功利用后，未经身份验证的用户可以访问 Openfire 管理控制台中的后台页面。同时由于Openfire管理控制台的后台提供了安装插件的功能，所以攻击者可以通过安装恶意插件达成远程代码执行的效果。  
**检测工具**  
  
   
Detection   
  
  
  
**0****2**  
#   
# X-POC远程检测工具  
检测方法：xpoc -r 103 -t 10.0.0.1/24 -p 80,443,8080,8000  
工具获取方式：  
  
https://github.com/chaitin/xpochttps://stack.chaitin.com/tool/detail?id=1036#   
# 牧云本地检测工具  
检测方法：在本地主机上执行以下命令即可无害化扫描：./openfire_console_auth_bypass_scanner_linux_amd64 scan --output result.json  
工具获取方式：  
https://stack.chaitin.com/tool/detail?id=1181影响范围 Affects 033.10.0 <= Openfire < 4.6.8、4.7.5  
**解决方案**  
  
   
Solution   
  
  
  
**0****4**  
临时缓解方案使用网络ACL限制访问控制台的来源，而且建议如非必要，不要将Openfire 管理控制台暴露在互联网上。升级修复方案该问题已在Openfire的4.7.4和4.6.8版本中得到修补，建议访问参考链接升级到不受漏洞影响的版本。  
  
**产品支持**  
  
   
Support   
  
  
  
**0****5******  
雷池：默认支持该漏洞利用行为的检测。洞鉴：支持以自定义PoC的形式进行检测，已发布自定义PoC。牧云：使用管理平台 23.05.001 及以上版本的用户可通过升级平台下载应急漏洞情报库升级包（EMERVULN-23.06.006）在“漏洞应急”功能中支持该漏洞的检测；其它版本用户可通过漏洞匹配升级包（VULN-23.06.008）支持该漏洞检测。云图：默认支持该产品的指纹识别，同时支持该漏洞的PoC原理检测。全悉：已发布升级包，支持该漏洞利用行为的检测。  
  
**时间线**  
  
   
Timeline   
  
  
  
**0****7**  
5月26日 漏洞在互联网公开6月8日 漏洞细节在互联网披露6月13日 长亭安全应急响应中心发布通告  
参考资料：  
  
✦  
https://igniterealtime.org/projects/openfire/  
  
✦  
https://github.com/igniterealtime/Openfire/security/advisories/GHSA-gw42-f939-fhvm  
✦ https://learningsomecti.medium.com/path-traversal-to-rce-openfire-cve-2023-32315-6a8bf0285fcc  
  
  
**长亭应急响应服务**  
  
  
  
  
全力进行产品升级  
  
及时将风险提示预案发送给客户  
  
检测业务是否收到此次漏洞影响  
  
请联系长亭应急团队  
  
7*24小时，守护您的安全  
  
  
第一时间找到我们：  
  
邮箱：support@chaitin.com  
  
应急响应热线：4000-327-707  
  
  
