#  GeoServer CQL_FILTER SQL注入漏洞(CVE-2023-25157)   
深瞳漏洞实验室  深信服千里目安全技术中心   2023-06-10 13:44  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/w8NHw6tcQ5zJUnRwpZuk7O1qDNVdnuXdqwIxNHcUHibeX9BkjSEnvq2uzZvoS32Ew3FnolicuK7DpOr2g8utrs5w/640?wx_fmt=gif "")  
  
**漏洞名称：**  
  
GeoServer CQL_FILTER SQL注入漏洞  
  
**组件名称：**  
  
GeoServer   
  
**影响范围：**  
  
GeoServer < 2.21.4  
  
2.22.0 ≤ GeoServer < 2.22.2  
  
**漏洞类型：**  
  
SQL注入漏洞  
  
**利用条件：**  
  
1、用户认证：不需要  
  
2、前置条件：默认配置  
  
3、触发方式：远程  
  
**综合评价：**  
  
<综合评定利用难度>：容易，无需用户授权。  
  
<综合评定威胁等级>：高危，能造成代码执行。  
  
**官方解决方案：**  
  
已发布  
  
  
  
  
  
**漏洞分析**  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/w8NHw6tcQ5zJUnRwpZuk7O1qDNVdnuXd4YV5gBNmtTsxDNnJsRsTx8pVNBwbjOCAV5lVYjPibb5h2ibPxV1lKwfA/640?wx_fmt=gif "")  
  
**组件介绍**  
  
GeoServer是一个用Java编写的开源服务器，允许用户共享、处理和编辑地理空间数据。它专为互操作性而设计，使用开放标准发布来自任何主要空间数据源的数据。  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/w8NHw6tcQ5zJUnRwpZuk7O1qDNVdnuXd4YV5gBNmtTsxDNnJsRsTx8pVNBwbjOCAV5lVYjPibb5h2ibPxV1lKwfA/640?wx_fmt=gif "")  
  
**漏洞简介**  
  
2023年6月9日，深信服安全团队监测到一则GeoServer组件存在SQL注入漏洞的信息，漏洞威胁等级：高危。  
  
当使用GeoServer预览图层时，可以通过对图层进行数据过滤来渲染出指定位置的图层。然而在使用需要以数据库作为数据存储的功能时，GeoServer未对用户输入进行过滤，**攻击者可以构造畸形的过滤语法，绕过GeoServer的词法解析，造成SQL注入攻击。最终造成服务器敏感性信息泄露或代码执行。**  
  
  
**影响范围**  
  
目前受影响的版本：  
  
GeoServer < 2.21.4  
  
2.22.0 ≤ GeoServer < 2.22.2  
  
  
**解决方案**  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/w8NHw6tcQ5zJUnRwpZuk7O1qDNVdnuXd4YV5gBNmtTsxDNnJsRsTx8pVNBwbjOCAV5lVYjPibb5h2ibPxV1lKwfA/640?wx_fmt=gif "")  
  
**官方修复建议**  
  
  
当前官方已发布最新版本，建议受影响的用户及时更新升级到最新版本。链接如下：  
  
https://github.com/geoserver/geoserver/releases  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/w8NHw6tcQ5zJUnRwpZuk7O1qDNVdnuXd4YV5gBNmtTsxDNnJsRsTx8pVNBwbjOCAV5lVYjPibb5h2ibPxV1lKwfA/640?wx_fmt=gif "")  
  
**深信服解决方案**  
  
  
**1.风险资产发现**  
  
支持对 GeoServer 组件 的主动检测，可**批量检出**业务场景中该事件的**受影响资产**情况，相关产品如下：  
  
**【深信服云镜YJ】**已发布资产检测方案。  
  
**【深信服主机安全检测响应平台CWPP】**已发布资产检测方案。  
  
**2.漏洞主动检测**  
  
支持对GeoServer CQL_FILTER SQL注入漏洞的主动检测，可**批量快速检出**业务场景中是否存在**漏洞风险**，相关产品如下：  
  
**【深信服云镜YJ】**预计2023年6月11日发布检测方案。  
  
**【深信服漏洞评估工具TSS】**预计2023年6月12日发布检测方案。  
  
**【深信服安全托管服务MSS】**预计2023年6月11日发布检测方案。  
  
**【深信服安全检测与响应平台XDR】**预计2023年6月11日发布检测方案。  
  
  
**3.漏洞安全监测**  
  
支持对GeoServer CQL_FILTER SQL注入漏洞攻击事件的监测，可依据流量收集**实时监控**业务场景中的**受影响资产****情况，快速检查受影响范围**，相关产品及服务如下：  
  
**【深信服安全感知管理平台SIP】**预计2023年6月13日发布检测方案。  
  
**【深信服安全托管服务MSS】**预计2023年6月13日发布检测方案。  
  
**【深信服安全检测与响应平台XDR】**预计2023年6月13日发布检测方案。  
  
  
**4.漏洞安全防护**  
  
支持对GeoServer CQL_FILTER SQL注入漏洞攻击事件的防御，**可阻断攻击者针对该事件的入侵行为**，相关产品及服务如下：  
  
**【深信服下一代防火墙AF】**预计2023年6月13日发布防护方案。  
  
**【深信服Web应用防火墙WAF】**预计2023年6月13日发布防护方案。  
  
**【深信服安全托管服务MSS】**预计2023年6月13日发布防护方案。  
  
**【深信服安全检测与响应平台XDR】**预计2023年6月13日发布防护方案。  
  
  
**参考链接**  
  
https://github.com/advisories/GHSA-7g5f-wrx8-5ccf  
  
  
**时间轴**  
  
  
  
**2023/6/9**  
  
深信服监测到GeoServer CQL_FILTER SQL注入漏洞的攻击信息。  
  
  
**2023/6/9**  
  
深信服千里目安全技术中心发布漏洞通告。  
  
  
点击**阅读原文**，及时关注并登录深信服**智安全平台**，可轻松查询漏洞相关解决方案。  
  
![](https://mmbiz.qpic.cn/mmbiz_png/w8NHw6tcQ5zJUnRwpZuk7O1qDNVdnuXdOyxoGsXczNJ5QqGxLHCfON6nCSqLhlxZ8EGibibVA7C443d6wKMMiazjg/640?wx_fmt=png "")  
  
  
![](https://mmbiz.qpic.cn/mmbiz_jpg/w8NHw6tcQ5zJUnRwpZuk7O1qDNVdnuXdDGzI6u2nMxicnOrn2kj0jeJWbicg0ckFb0XKyEqk35IiawqyjloXXmrOA/640?wx_fmt=jpeg "")  
  
  
