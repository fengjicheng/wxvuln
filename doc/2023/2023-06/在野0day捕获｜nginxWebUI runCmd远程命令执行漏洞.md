#  在野0day捕获｜nginxWebUI runCmd远程命令执行漏洞   
 长亭安全应急响应中心   2023-06-27 20:42  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/FOh11C4BDicQ71w3PeHZ64icicc4wibpVFsbZCjibzpURVic8MUkP5Ppico6GJRvw9IluicwGlGUhwEiciaRu2gztuY1G8nw/640?wx_fmt=png "")  
  
nginxWebUI是一款图形化管理nginx配置的工具，能通过网页快速配置nginx的各种功能，包括HTTP和TCP协议转发、反向代理、负载均衡、静态HTML服务器以及SSL证书的自动申请、续签和配置，配置完成后可以一键生成nginx.conf文件，并控制nginx使用此文件进行启动和重载。近期，长亭科技监测到官方发布新版本修复了一处远程命令执行漏洞。长亭应急团队经过分析后发现该漏洞为前台命令执行漏洞，而目前仍有较多公网系统仍未修复漏洞。根据漏洞原理编写了无害化的X-POC远程检测工具和牧云本地检测工具，目前已向公众开放下载使用。  
**漏洞描述**  
  
   
Description   
  
  
  
**0****1**  
  
nginxWebUI后台提供执行nginx相关命令的接口，由于未对用户的输入进行过滤，导致可在后台执行任意命令。并且该系统权限校验存在问题，导致存在权限绕过，在前台可直接调用后台接口，最终可以达到无条件远程命令执行的效果。长亭安全应急实验室经过深入分析，发现该漏洞修复方式为修复权限绕过问题，并且在命令执行前添加了一些过滤。但是由于过滤的方式并不严格，导致后台可能仍然存在命令执行漏洞。  
**检测工具**  
  
   
Detection   
  
  
  
**0****2**  
#   
# X-POC远程检测工具  
检测方法：xpoc -r 106 -t 目标URL  
工具获取方式：  
https://github.com/chaitin/xpochttps://stack.chaitin.com/tool/detail?id=1036  
#   
# 牧云本地检测工具  
检测方法：在本地主机上执行以下命令即可无害化扫描：./nginx_webui_runcmd_rce_scanner_linux_amd64  
工具获取方式：  
https://stack.chaitin.com/tool/detail?id=1190  
  
**影响范围**  
  
   
Affects  
   
  
  
  
**0****3**  
```
```  
  
**解决方案**  
  
   
Solution   
  
  
  
**0****4**  
临时缓解方案该漏洞属于命令拼接漏洞，所以可使用WAF进行防护。但是低版本同时存在权限绕过问题，该问题使用防护设备无法缓解。建议如非必要，不要将该系统暴露在互联网上。升级修复方案官方已发布了新版本修复了权限绕过漏洞，并且在一定程度上缓解了远程命令执行的风险。建议用户前往参考链接中的官网[2]更新至最新版本。另外由于官方过滤用户输入的方式并不严格，导致后台可能依旧存在命令执行的风险，可通过使用强口令降低风险。  
  
**产品支持**  
  
   
Support   
  
  
  
**0****5**  
云图：默认支持该产品的指纹识别，同时支持该漏洞的PoC原理检测。雷池：默认支持该漏洞利用行为的检测。洞鉴：升级至最新引擎与漏洞库版本即可检测该漏洞。牧云：使用管理平台 23.05.001 及以上版本的用户可通过升级平台下载应急漏洞情报库升级包（EMERVULN-23.06.010）“漏洞应急”功能支持该漏洞的检测；其它管理平台版本暂不支持该漏洞检测。全悉：已发布规则升级包，支持该漏洞利用行为的检测。  
  
**时间线**  
  
   
Timeline   
  
  
  
**0****6**  
5月19日 官方发布新版本修复漏洞5月22日 长亭社区获取漏洞情报5月22日 长亭扫描类产品支持检测5月26日 漏洞细节在安全社区[1]公开披露6月27日 长亭发布漏洞通告  
参考资料：  
  
【1】https://zone.huoxian.cn/d/1210-nginx  
【2】https://www.nginxwebui.cn/  
  
  
**长亭应急响应服务**  
  
  
  
  
全力进行产品升级  
  
及时将风险提示预案发送给客户  
  
检测业务是否收到此次漏洞影响  
  
请联系长亭应急团队  
  
7*24小时，守护您的安全  
  
  
第一时间找到我们：  
  
邮箱：support@chaitin.com  
  
应急响应热线：4000-327-707  
  
  
