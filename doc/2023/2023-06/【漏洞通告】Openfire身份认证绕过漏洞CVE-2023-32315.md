#  【漏洞通告】Openfire身份认证绕过漏洞CVE-2023-32315   
深瞳漏洞实验室  深信服千里目安全技术中心   2023-06-15 20:09  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/w8NHw6tcQ5zRxX3tHd95gfibiaAFcibTjqEN1TEK9qgXw6RMicw91jF6LiaxIX2V4laEaOrdNZ3hoxbyhUHVx8qzRAw/640?wx_fmt=gif "")  
  
**漏洞名称：**  
  
Openfire身份认证绕过漏洞(CVE-2023-32315)  
  
**组件名称：**  
  
Openfire  
  
**影响范围：**  
  
3.10.0 ≤ Openfire < 4.6.8  
  
4.7.0 ≤ Openfire < 4.7.5  
  
**漏洞类型：**  
  
认证绕过  
  
**利用条件：**  
  
1、用户认证：否  
  
2、前置条件：默认配置  
  
3、触发方式：远程  
  
**综合评价：**  
  
<综合评定利用难度>：容易，无需授权即可远程代码执行。  
  
<综合评定威胁等级>：高危，能造成远程代码执行。  
  
**官方解决方案：**  
  
已发布  
  
  
  
  
  
**漏洞分析**  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/w8NHw6tcQ5zRxX3tHd95gfibiaAFcibTjqEfLA54NMeRqvOX7w9opZx4MUqkQ3YjErRtPwhuIB88cqKDAibLHUu1Yg/640?wx_fmt=gif "")  
  
**组件介绍**  
  
Openfire是一款开源的即时通讯服务器，它基于XMPP协议，可以提供安全、可扩展、可定制的即时通讯服务。Openfire提供了丰富的插件和扩展机制，可以满足不同用户的需求，例如支持聊天室、文件传输、在线状态、群组管理等功能。Openfire还提供了易于使用的Web管理界面，方便管理员进行配置和管理。  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/w8NHw6tcQ5zRxX3tHd95gfibiaAFcibTjqEfLA54NMeRqvOX7w9opZx4MUqkQ3YjErRtPwhuIB88cqKDAibLHUu1Yg/640?wx_fmt=gif "")  
  
**漏洞简介**  
  
2023年6月15日，深信服安全团队监测到一则Openfire组件存在身份认证绕过漏洞的信息，漏洞编号：CVE-2023-32315，漏洞威胁等级：高危。  
  
该漏洞是由于Openfire定义了一种机制，用于从Web身份验证中排除某些URL。由于此机制允许使用通配符，通配符模式匹配和路径遍历漏洞的组合导致恶意用户可以绕过管理控制台的身份验证。攻击者绕过管理控制台身份认证后，可通过上传恶意插件进一步执行任意代码，获得服务器权限。  
  
  
**影响范围**  
  
目前受影响的Openfire版本：  
  
3.10.0 ≤ Openfire < 4.6.8  
  
4.7.0 ≤ Openfire < 4.7.5  
  
  
**漏洞验证**  
  
  
搭建Openfire组件4.4.4版本环境，复现该漏洞，效果如下：  
  
![](https://mmbiz.qpic.cn/mmbiz_png/w8NHw6tcQ5zRxX3tHd95gfibiaAFcibTjqEd5HbJtTNRetj7EHWhH3bmVpXBhQibiabquJpBpDo9iaOetOYdFMeDC6MA/640?wx_fmt=png "")  
  
  
  
**解决方案**  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/w8NHw6tcQ5zRxX3tHd95gfibiaAFcibTjqEfLA54NMeRqvOX7w9opZx4MUqkQ3YjErRtPwhuIB88cqKDAibLHUu1Yg/640?wx_fmt=gif "")  
  
**修复建议**  
  
  
访问管理控制台登陆页面即可查看版本。  
  
![](https://mmbiz.qpic.cn/mmbiz_png/w8NHw6tcQ5zRxX3tHd95gfibiaAFcibTjqELXh3Keia3kD1lyoDZ13oicicKYiae5zV5HhGqAnDvLibqtuEriaicU8568GUQ/640?wx_fmt=png "")  
  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/w8NHw6tcQ5zRxX3tHd95gfibiaAFcibTjqEfLA54NMeRqvOX7w9opZx4MUqkQ3YjErRtPwhuIB88cqKDAibLHUu1Yg/640?wx_fmt=gif "")  
  
**官方修复建议**  
  
  
当前官方已发布最新版本，建议受影响的用户及时更新升级到最新版本。链接如下：  
  
https://github.com/igniterealtime/Openfire/security/advisories/GHSA-gw42-f939-fhvm  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/w8NHw6tcQ5zRxX3tHd95gfibiaAFcibTjqEfLA54NMeRqvOX7w9opZx4MUqkQ3YjErRtPwhuIB88cqKDAibLHUu1Yg/640?wx_fmt=gif "")  
  
**深信服解决方案**  
  
  
**1.风险资产发现**  
  
支持对Openfire的主动检测，可批量检出业务场景中该事件的受影响资产情况，相关产品如下：  
  
**【深信服主机安全检测响应平台CWPP】**已发布资产检测方案。  
  
**【深信服云镜YJ】**已发布资产检测方案。  
  
  
**2.漏洞主动检测**  
  
支持对Openfire身份认证绕过漏洞的主动检测，可批量快速检出业务场景中是否存在漏洞风险，相关产品如下：  
  
**【深信服云镜YJ】**预计2023年6月20日发布检测方案。  
  
**【深信服漏洞评估工具TSS】**预计2023年6月22日发布检测方案。  
  
**【深信服主机安全检测响应平台CWPP】**预计2023年6月20日发布检测方案。  
  
**【深信服安全托管服务MSS】**预计预计2023年6月20日发布检测方案。  
  
**【深信服安全检测与响应平台XDR】**预计2023年6月20日发布检测方案。  
  
  
**3.漏洞安全监测**  
  
支持对Openfire身份认证绕过漏洞的监测，可依据流量收集实时监控业务场景中的受影响资产情况，快速检查受影响范围，相关产品及服务如下：  
  
**【深信服安全感知管理平台SIP】**预计2023年6月19日发布检测方案。  
  
**【深信服安全托管服务MSS】**预计2023年6月19日发布检测方案。  
  
**【深信服安全检测与响应平台XDR】**预计2023年6月19日发布检测方案。  
  
  
**4.漏洞安全防护**  
  
支持对Openfire身份认证绕过漏洞的防御，可阻断攻击者针对该事件的入侵行为，相关产品及服务如下：  
  
**【深信服下一代防火墙AF】**预计2023年6月19日发布防护方案。  
  
**【深信服终端安全管理系统EDR】**预计2023年6月19日发布防护方案。  
  
**【深信服Web应用防火墙WAF】**预计2023年6月19日发布防护方案。  
  
**【深信服安全托管服务MSS】**预计2023年6月19日发布防护方案。  
  
**【深信服安全检测与响应平台XDR】**预计2023年6月19日发布防护方案。  
  
  
**时间轴**  
  
  
  
**2023/6/15**  
  
深信服监测到Openfire官方发布安全版本  
  
  
**2023/6/15**  
  
深信服千里目安全技术中心发布漏洞通告。  
  
  
点击**阅读原文**，及时关注并登录深信服**智安全平台**，可轻松查询漏洞相关解决方案。  
  
![](https://mmbiz.qpic.cn/mmbiz_png/w8NHw6tcQ5zRxX3tHd95gfibiaAFcibTjqEAdsBeQLVW8UttK0j1RXDibXzpnYgPtXa8x2uvf8ibh9m0IpD6nzJ7dcA/640?wx_fmt=png "")  
  
  
![](https://mmbiz.qpic.cn/mmbiz_jpg/w8NHw6tcQ5zRxX3tHd95gfibiaAFcibTjqEkeRyBXgRq0PP5G9HJQQna39fStTsT6mU1xjdygYJOunCyuS9cy1bMw/640?wx_fmt=jpeg "")  
  
  
  
