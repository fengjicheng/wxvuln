#  【已复现】Google libwebp 远程代码执行漏洞(CVE-2023-4863)安全风险通告第二次更新   
原创 QAX CERT  奇安信 CERT   2023-09-28 18:21  
  
●   
点击↑蓝字关注我们，获取更多安全风险通告  
  
  
<table><tbody><tr><td valign="middle" align="center" rowspan="1" colspan="4" style="background-color: #4676d9;border-color: #4676d9;"><p style="line-height: 1em;"><span style="color: #ffffff;letter-spacing: 0px;"><strong><span style="font-size: 13px;letter-spacing: 0px;">漏洞概述</span></strong><br/></span></p></td></tr><tr><td valign="middle" align="left" style="border-color: #4676d9;" width="135"><p style="line-height: 1em;"><span style="font-size: 13px;letter-spacing: 0px;"><strong><span style="font-size: 13px;letter-spacing: 0px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">漏洞名称</span></strong></span></p></td><td valign="middle" align="left" rowspan="1" colspan="3" style="border-color: #4676d9;"><p style="line-height: 1em;"><span style="color: #000000;font-size: 13px;text-align: -webkit-left;caret-color: #ff0000;text-decoration-thickness: initial;letter-spacing: 0px;display: inline !important;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">Google libwebp 远程代码执行漏洞</span></p></td></tr><tr><td valign="middle" align="left" rowspan="1" colspan="1" style="border-color: #4676d9;" width="135"><p style="line-height:1em;"><span style="font-size: 13px;letter-spacing: 0px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong>漏洞编号</strong></span></p></td><td valign="middle" align="left" rowspan="1" colspan="3" style="border-color: #4676d9;"><p style="line-height:1em;"><span style="color: #000000;font-size: 13px;text-align: -webkit-left;caret-color: #ff0000;text-decoration-thickness: initial;display: inline !important;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">QVD-2023-21923、CVE-2023-4863</span></p></td></tr><tr><td valign="middle" align="left" style="border-color: #4676d9;" width="135"><p style="line-height: 1em;"><span style="font-size: 13px;"><strong><span style="font-size: 13px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">公开时间</span></strong></span></p></td><td valign="middle" align="left" style="border-color: #4676d9;" width="151"><p style="line-height: 1em;"><span style="font-size: 13px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">2023-09-11</span></p></td><td valign="middle" align="left" style="border-color: #4676d9;" width="177"><p style="line-height: 1em;"><span style="font-size: 13px;"><strong><span style="font-size: 13px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">影响对象数量级</span></strong></span></p></td><td valign="middle" align="left" style="border-color: #4676d9;" width="94"><p style="line-height: 1em;"><span style="font-size: 13px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">亿级</span></p></td></tr><tr><td valign="middle" align="left" style="border-color: #4676d9;" width="135"><p style="line-height: 1em;"><span style="font-size: 13px;"><strong><span style="font-size: 13px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">奇安信评级</span></strong></span></p></td><td valign="middle" align="left" style="border-color: #4676d9;" width="151"><p style="line-height: 1em;"><span style="font-size: 13px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong style="max-inline-size: 100%;margin: 0px;padding: 0px;box-sizing: border-box !important;overflow-wrap: break-word !important;outline: none 0px !important;cursor: text;color: #000000;font-size: 13px;text-align: -webkit-left;caret-color: #ff0000;text-decoration-thickness: initial;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;, sans-serif;"><span style="max-inline-size: 100%;margin: 0px;padding: 0px;box-sizing: border-box !important;overflow-wrap: break-word !important;outline: none 0px !important;cursor: text;color: #ff0000;font-size: 13px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">高危</span></strong></span></p></td><td valign="middle" align="left" style="border-color: #4676d9;" width="177"><p style="line-height: 1em;"><span style="font-size: 13px;"><strong><span style="font-size: 13px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong style="max-inline-size: 100%;margin: 0px;padding: 0px;box-sizing: border-box !important;overflow-wrap: break-word !important;outline: none 0px !important;cursor: text;color: #000000;font-size: 13px;text-align: -webkit-left;caret-color: #ff0000;text-decoration-thickness: initial;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;, sans-serif;">CVSS 3.1分数</strong></span></strong></span></p></td><td valign="middle" align="left" style="border-color: #4676d9;" width="94"><p style="line-height: 1em;"><strong><span style="text-align: -webkit-left;caret-color: #ff0000;text-decoration-thickness: initial;font-size: 13px;color: #ff0000;display: inline !important;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">8.8</span></strong></p></td></tr><tr><td valign="middle" align="left" style="border-color: #4676d9;" width="135"><p style="line-height: 1em;"><span style="font-size:13px;"><strong><span style="font-size: 13px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">威胁类型</span></strong><strong><span style="font-size: 13px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"></span></strong></span></p></td><td valign="middle" align="left" style="border-color: #4676d9;" width="151"><p style="line-height: 1em;"><span style="font-size:13px;">代码执行</span></p></td><td valign="middle" align="left" style="border-color: #4676d9;" width="177"><p style="line-height:1em;"><strong><span style="font-size:13px;">利用可能性</span></strong></p></td><td valign="middle" align="left" style="border-color: #4676d9;" width="94"><p style="line-height: 1em;"><span style="color: #ff0000;"><strong><span style="font-size: 13px;">高</span></strong></span></p></td></tr><tr><td valign="middle" colspan="1" rowspan="1" align="left" style="border-color: #4676d9;" width="135"><p style="line-height: 1em;"><span style="font-size: 13px;"><strong><span style="font-size: 13px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">POC状态</span></strong></span></p></td><td valign="middle" colspan="1" rowspan="1" align="left" style="border-color: #4676d9;" width="151"><p style="line-height: 1em;"><span style="color: #ff0000;font-size: 13px;"><strong><span style="color: #ff0000;font-size: 13px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">已公开</span></strong></span></p></td><td valign="middle" colspan="1" rowspan="1" align="left" style="border-color: #4676d9;" width="177"><p style="line-height: 1em;"><span style="font-size: 13px;"><strong><span style="font-size: 13px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">在野利用状态</span></strong></span></p></td><td valign="middle" colspan="1" rowspan="1" align="left" style="border-color: #4676d9;" width="94"><p style="line-height: 1em;"><span style="color:#ff0000;"><strong><span style="font-size: 13px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">已发现</span></strong></span></p></td></tr><tr><td valign="middle" colspan="1" rowspan="1" align="left" style="border-color: #4676d9;" width="135"><p style="line-height: 1em;"><span style="font-size: 13px;"><strong><span style="font-size: 13px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">EXP状态</span></strong></span></p></td><td valign="middle" colspan="1" rowspan="1" align="left" style="border-color: #4676d9;" width="151"><p style="line-height: 1em;"><span style="font-size: 13px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">未公开</span></p></td><td valign="middle" colspan="1" rowspan="1" align="left" style="border-color: #4676d9;" width="177"><p style="line-height: 1em;"><span style="font-size: 13px;"><strong><span style="font-size: 13px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">技术细节状态</span></strong></span></p></td><td valign="middle" colspan="1" rowspan="1" align="left" style="border-color: #4676d9;" width="94"><p style="line-height: 1em;"><span style="font-size: 13px;"><strong><span style="color: #ff0000;font-size: 13px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">已公开</span></strong></span></p></td></tr><tr><td valign="middle" colspan="4" rowspan="1" align="left" style="border-color: #4676d9;"><p style="line-height:1em;"><strong><span style="font-size:13px;">利用条件：</span></strong><span style="color: rgba(0, 0, 0, 0.9);font-size: 13px;letter-spacing: 0.544px;text-align: -webkit-left;text-decoration-thickness: initial;display: inline !important;font-family: system-ui, -apple-system, BlinkMacSystemFont, &#34;Helvetica Neue&#34;, &#34;PingFang SC&#34;, &#34;Hiragino Sans GB&#34;, &#34;Microsoft YaHei UI&#34;, &#34;Microsoft YaHei&#34;, Arial, sans-serif;">需要交互。</span></p></td></tr></tbody></table>  
  
  
**（注：奇安信CERT的漏洞深度分析报告包含此漏洞的POC及技术细节，订阅方式见文末。）**  
  
  
**0****1**  
  
**漏洞详情**  
  
**>**  
**>**  
**>**  
**>**  
  
**影响组件**  
  
Libwebp是一个开源的用于编码和解码WebP图像格式的C/C++库。它提供了一组函数和工具，用于将图像数据编码为WebP格式，并将WebP格式的图像解码为原始图像数据。Libwebp库可以作为其他程序的依赖库，用于添加WebP图像格式的支持。Libwebp应用范围非常广泛，被使用到各个软件上面。  
  
  
**>**  
**>**  
**>**  
**>**  
  
**漏洞描述**  
  
近日，奇安信CERT监测到**Google libwebp远程代码执行漏洞(CVE-2023-4863)：**  
libwebp在解析无损的WebP图片时，会使用霍夫曼编码（Huffman coding） 来构造霍夫曼编码表，并进行解码得到原始图像。在分配霍夫曼编码表的内存空间时，解码器提前会将所有一级表和二级表的空间同时分配。但是由于霍夫曼编码表数据读取自图片，未正确校验数据大小。当攻击者构造非法的霍夫曼表时，可以使得表的总内存大小超过预分配的大小，导致堆缓冲区溢出漏洞。  
  
  
**目前，奇安信CERT已监测到此漏洞在野利用。鉴于此漏洞影响范围极大，建议客户尽快做好自查及防护。**  
  
  
**本次更新内容：**  
  
**新增奇安信产品解决方案；**  
  
**处置建议增加各厂商受该漏洞影响产品更新链接；**  
  
**新增 Google libwebp远程代码执行漏洞(CVE-2023-4863)复现截图。**  
  
  
  
**02**  
  
**影响范围**  
  
**>**  
**>**  
**>**  
**>**  
  
**影响版本**  
  
libwebp < 1.3.2  
  
  
**>**  
**>**  
**>**  
**>**  
  
**其他受影响组件**  
  
包含libwebp库的主流浏览器、Linux操作系统以及大量开源软件。  
  
  
  
**03**  
  
**复现情况**  
  
目前，奇安信CERT已成功复现**Google libwebp远程代码执行漏洞(CVE-2023-4863)**  
，截图如下：  
  
![](https://mmbiz.qpic.cn/mmbiz_png/EkibxOB3fs4icsM6yib6pLTHpbpCIulnnicOECPdcVKmo0CeV3DgiaH5NUaadKETOjdFjLkibApldsqMmgC5ia9TMwJ3A/640 "")  
  
  
  
  
**04**  
  
**处置建议**  
  
**>**  
**>**  
**>**  
**>**  
  
**安全更新**  
  
目前官方已发布安全修复更新，受影响用户可以更新到**libwebp 1.3.2及以上版本**  
。  
  
  
此外，Google公司及受影响的产品（服务）厂商已陆续发布新版本修复该漏洞，建议受漏洞影响的产品（服务）厂商、信息系统运营者和用户尽快进行自查，及时进行版本更新和漏洞修复。  
  
<table><tbody><tr><td align="left" valign="middle" style="border-color: rgb(221, 221, 221);" width="99"><p style="line-height: 1.6em;"><span style="font-size: 14px;letter-spacing: 0px;">Google libwebp</span></p></td><td align="left" valign="middle" style="border-color: rgb(221, 221, 221);" width="458"><p style="line-height: 1.6em;"><span style="font-size: 14px;letter-spacing: 0px;">https://storage.googleapis.com/downloads.webmproject.org/releases/webp/index.html</span></p></td></tr><tr><td align="left" valign="middle" style="border-color: rgb(221, 221, 221);" width="99"><p style="line-height: 1.6em;"><span style="font-size: 14px;letter-spacing: 0px;">Google Chrome</span></p></td><td align="left" valign="middle" style="border-color: rgb(221, 221, 221);" width="458"><p style="line-height: 1.6em;"><span style="font-size: 14px;letter-spacing: 0px;">https://chromereleases.googleblog.com/2023/09/stable-channel-update-for-desktop_11.html</span></p></td></tr><tr><td align="left" valign="middle" style="border-color: rgb(221, 221, 221);" width="99"><p style="line-height: 1.6em;"><span style="font-size: 14px;letter-spacing: 0px;">Microsoft Edge</span></p></td><td align="left" valign="middle" style="border-color: rgb(221, 221, 221);" width="458"><p style="line-height: 1.6em;"><span style="font-size: 14px;letter-spacing: 0px;">https://msrc.microsoft.com/update-guide/vulnerability/CVE-2023-4863</span></p></td></tr><tr><td align="left" valign="middle" style="border-color: rgb(221, 221, 221);" width="99"><p style="line-height: 1.6em;"><span style="font-size: 14px;letter-spacing: 0px;">Mozilla Firefox</span></p></td><td align="left" valign="middle" style="border-color: rgb(221, 221, 221);" width="458"><p style="line-height: 1.6em;"><span style="font-size: 14px;letter-spacing: 0px;">https://www.mozilla.org/en-US/security/advisories/mfsa2023-40/</span></p></td></tr><tr><td align="left" valign="middle" style="border-color: rgb(221, 221, 221);" width="99"><p style="line-height: 1.6em;"><span style="font-size: 14px;letter-spacing: 0px;">Electron</span></p></td><td align="left" valign="middle" style="border-color: rgb(221, 221, 221);" width="458"><p style="line-height: 1.6em;"><span style="font-size: 14px;letter-spacing: 0px;">https://github.com/electron/electron/pull/39828</span></p></td></tr><tr><td align="left" valign="middle" style="border-color: rgb(221, 221, 221);" width="99"><p style="line-height: 1.6em;"><span style="font-size: 14px;letter-spacing: 0px;">Ubuntu</span></p></td><td align="left" valign="middle" style="border-color: rgb(221, 221, 221);" width="458"><p style="line-height: 1.6em;"><span style="font-size: 14px;letter-spacing: 0px;">https://launchpad.net/ubuntu/+source/libwebp/1.2.4-0.3</span></p></td></tr><tr><td align="left" valign="middle" style="border-color: rgb(221, 221, 221);" width="99"><p style="line-height: 1.6em;"><span style="font-size: 14px;letter-spacing: 0px;">Debian</span></p></td><td align="left" valign="middle" style="border-color: rgb(221, 221, 221);" width="458"><p style="line-height: 1.6em;"><span style="font-size: 14px;letter-spacing: 0px;">https://www.debian.org/security/2023/dsa-5497-2</span></p></td></tr><tr><td align="left" valign="middle" style="border-color: rgb(221, 221, 221);" width="99"><p style="line-height: 1.6em;"><span style="font-size: 14px;letter-spacing: 0px;">Redhat</span></p></td><td align="left" valign="middle" style="border-color: rgb(221, 221, 221);" width="458"><p style="line-height: 1.6em;"><span style="font-size: 14px;letter-spacing: 0px;">https://access.redhat.com/errata/RHSA-2023:5309</span></p></td></tr><tr><td align="left" valign="middle" style="border-color: rgb(221, 221, 221);" width="99"><p style="line-height: 1.6em;"><span style="font-size: 14px;letter-spacing: 0px;">Alpine</span></p></td><td align="left" valign="middle" style="border-color: rgb(221, 221, 221);" width="458"><p style="line-height: 1.6em;"><span style="font-size: 14px;letter-spacing: 0px;">https://security.alpinelinux.org/vuln/CVE-2023-4863</span></p></td></tr><tr><td align="left" valign="middle" style="border-color: rgb(221, 221, 221);" width="99"><p style="line-height: 1.6em;"><span style="font-size: 14px;letter-spacing: 0px;">Gentoo</span></p></td><td align="left" valign="middle" style="border-color: rgb(221, 221, 221);" width="458"><p style="line-height: 1.6em;"><span style="font-size: 14px;letter-spacing: 0px;">https://security.gentoo.org/glsa/202309-05</span></p></td></tr><tr><td align="left" valign="middle" style="border-color: rgb(221, 221, 221);" width="99"><p style="line-height: 1.6em;"><span style="font-size: 14px;letter-spacing: 0px;">SUSE</span></p></td><td align="left" valign="middle" style="border-color: rgb(221, 221, 221);" width="458"><p style="line-height: 1.6em;"><span style="font-size: 14px;letter-spacing: 0px;">https://www.suse.com/security/cve/CVE-2023-4863.html</span></p></td></tr><tr><td align="left" valign="middle" style="border-color: rgb(221, 221, 221);" width="99"><p style="line-height: 1.6em;"><span style="font-size: 14px;letter-spacing: 0px;">Oracle</span></p></td><td align="left" valign="middle" style="border-color: rgb(221, 221, 221);" width="458"><p style="line-height: 1.6em;"><span style="font-size: 14px;letter-spacing: 0px;">https://linux.oracle.com/cve/CVE-2023-4863.html</span></p></td></tr><tr><td align="left" valign="middle" style="border-color: rgb(221, 221, 221);" width="99"><p style="line-height: 1.6em;"><span style="font-size: 14px;letter-spacing: 0px;">Fedora</span></p></td><td align="left" valign="middle" style="border-color: rgb(221, 221, 221);" width="458"><p style="line-height: 1.6em;"><span style="font-size: 14px;letter-spacing: 0px;">https://bodhi.fedoraproject.org/updates/FEDORA-2023-c4fa8a204d</span></p></td></tr><tr><td align="left" valign="middle" style="border-color: rgb(221, 221, 221);" width="99"><p style="line-height: 1.6em;"><span style="font-size: 14px;letter-spacing: 0px;">Anolis 龙蜥</span></p></td><td align="left" valign="middle" style="border-color: rgb(221, 221, 221);" width="458"><p style="line-height: 1.6em;"><span style="font-size: 14px;letter-spacing: 0px;">https://anas.openanolis.cn/cves/detail/CVE-2023-4863</span></p></td></tr></tbody></table>  
  
  
**>**  
**>**  
**>**  
**>**  
  
**产品解决方案**  
  
**奇安信开源卫士已支持**  
  
奇安信开源卫士20230928. 398版本已支持对Google libwebp远程代码执行漏洞(CVE-2023-4863)的检测。  
  
  
**05**  
  
**参考资料**  
  
[1]https://chromereleases.googleblog.com/2023/09/stable-channel-update-for-desktop_11.html  
  
[2]https://github.com/advisories/GHSA-hhrh-69hc-fgg7  
  
[3]https://storage.googleapis.com/downloads.webmproject.org/releases/webp/index.html  
  
[4]https://chromium.googlesource.com/webm/libwebp/+/902bc9190331343b2017211debcec8d2ab87e17a  
  
[5]https://mp.weixin.qq.com/s/PBHkHB97Q_ivgfQL8Me60g  
  
  
  
**06**  
  
**时间线**  
  
2023年9月12日，奇安信CERT监测到Google Chrome 远程代码执行漏洞(CVE-2023-4863)存在在野利用，创建初始报告；  
  
  
2023年9月27日，谷歌确认Chrome在野0day漏洞(CVE-2023-4863)实际上是存在于libwebp库中的漏洞：CVE-2023-5129，奇安信 CERT发布安全风险通告；  
  
  
2023年9月28日，目前由于CVE-2023-5129与CVE-2023-4863重复，CVE-2023-5129编号已被撤回，奇安信 CERT复现此漏洞，发布第二次更新通告。  
  
  
  
**07**  
  
**漏洞情报服务**  
  
奇安信ALPH  
A威胁分析平台已支持漏洞情报订阅服务：  
  
![](https://mmbiz.qpic.cn/mmbiz_png/EkibxOB3fs4ibUhhAQkqA4UaEJvRBB1DbaAOmXXibCXnxurOa2n3vQkMfic8TlJ42pFzCSDvIPRaWbWtZva7YD7iatw/640 "漏洞订阅上线.png")  
  
  
  
![](https://mmbiz.qpic.cn/mmbiz_png/3tG2LbK7WG3tezJEzJsicLSWCGsIggLbcfk4LB5WK7pdSwMksxPOAoHuibjQpBlEId4nyIIw52n2J8N8MowYZcjA/640 "")  
  
  
![](https://mmbiz.qpic.cn/mmbiz_png/EkibxOB3fs4ibUhhAQkqA4UaEJvRBB1DbaHck6KxjUw68yJPHnfFdwEibicTWbrhJAj2lH7QFcophT3UiceAuZEOL2A/640 "CERT LOGO.png")  
  
**奇安信 CERT**  
  
**致力于**  
第一时间为企业级用户提供**权威**漏洞情报和**有效**  
解决方案。  
  
  
点击↓**阅读原文**，到**ALPHA威胁分析平台**  
订阅  
更多漏洞信息。  
  
