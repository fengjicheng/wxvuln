#  风险提示｜JumpServer 密码重置漏洞（CVE-2023-42820）   
 长亭安全应急响应中心   2023-09-28 18:29  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/FOh11C4BDicRvInzVjvAxoq9A77oIHJ7qkFQMR3GavAkZIVoyVoVMZ716nuibbmFqY96oZgtTl4p6OYpiaz94c7wQ/640?wx_fmt=png "")  
  
JumpServer 是广受欢迎的开源堡垒机，是符合 4A 规范的专业运维安全审计系统。近期，长亭科技监测到JumpServer官方发布了新版本修复了一处重置密码验证码被预测导致账号劫持漏洞（CVE-2023-42820）。长亭应急团队经过分析后发现该漏洞是利用相关api造成随机数种子泄漏，进而构造恶意请求重置密码，从而登录JumpServer。为了方便用户排查受影响的资产，已经根据漏洞原理编写了牧云本地检测工具，工具向公众开放下载使用。  
**漏洞描述**  
  
   
Description   
  
  
  
**0****1**  
  
未经身份认证的攻击者利用该漏洞可以重置管理员密码，如与CVE-2023-42819[2]组合利用最终可达到远程代码执行的效果。漏洞复现 Vulnerability Reproduction 02目前长亭应急响应实验室已确认漏洞原理，漏洞复现如下：  
**检测工具**  
  
   
Detection   
  
  
  
**0****3**  
#   
# 牧云本地检测工具  
检测方法：在本地主机上执行以下命令即可扫描：./jumpserver_pass_reset_cve_2023_42820_scanner_linux_amd64  
工具获取方式：  
https://stack.chaitin.com/tool/detail/1237  
  
**影响范围**  
  
   
Affects  
   
  
  
  
**0****4**  
```
```  
  
**解决方案**  
  
   
Solution   
  
  
  
**0****5**  
临时缓解方案通过网络ACL策略限制访问来源，例如只允许来自特定IP地址或地址段的访问请求。升级修复方案官方已发布安全修复版本，建议受影响用户升级至安全版本：v2 version: >= v2.28.20v3 version: >= v3.7.1下载地址：https://github.com/jumpserver/jumpserver/releases  
  
**产品支持**  
  
   
Support   
  
  
  
**0****6**  
云图：默认支持该产品的指纹识别，同时支持该漏洞的POC原理检测。洞鉴：将以自定义POC的形式进行检测（无害化版本匹配）牧云：使用管理平台 23.05.001 及以上版本的用户可通过升级平台下载应急漏洞情报库升级包（EMERVULN-23.09.028）“漏洞应急”功能支持该漏洞的检测；其它管理平台版本请联系牧云技术支持团队获取该功能。时间线 Timeline 079月26日 互联网公开漏洞情报9月27日 长亭应急响应实验室漏洞分析与复现9月28日 长亭安全应急响应中心发布通告参考资料：[1].https://github.com/jumpserver/jumpserver/security/advisories/GHSA-7prv-g565-82qp[2].https://github.com/jumpserver/jumpserver/security/advisories/GHSA-ghg2-2whp-6m33  
  
  
**长亭应急响应服务**  
  
  
  
  
全力进行产品升级  
  
及时将风险提示预案发送给客户  
  
检测业务是否收到此次漏洞影响  
  
请联系长亭应急团队  
  
7*24小时，守护您的安全  
  
  
第一时间找到我们：  
  
邮箱：support@chaitin.com  
  
应急响应热线：4000-327-707  
  
