#  别急着修！GitLab满分漏洞（CVE-2023-2825）实际几乎无法利用   
原创 微步情报局  微步在线研究响应中心   2023-05-26 18:41  
  
![](https://mmbiz.qpic.cn/mmbiz_png/fFyp1gWjicMKKIwzXUMSTRxJbmEAibibMabggxYnpFRmPXP4YIicg335GmW5s2lb5jibiaEImQXzbHnA7icXL3Z8Skpwg/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1 "")  
  
01 漏洞概况****  
  
  
  
GitLab是美国GitLab公司的一个开源的端到端软件开发平台，具有内置的版本控制、问题跟踪、代码审查、CI/CD（持续集成和持续交付）等功能。近日，微步在线漏洞团队监测到GitLab发布了安全更新，更新了一处任意文件读取漏洞（CVE-2023-2825），GitLab官方给出的CVSS 3.1评分为10.0。经过微步在线漏洞团队复现、分析及研判，该漏洞利用成功（实现非认证的任意文件读取）的条件较为苛刻。具体利用条件可见下方分析。从攻击者视角出发，该漏洞的利用前置条件在绝大多数场景下都不满足。除非是具备创建group权限的账户存在弱口令/密码泄露等权限问题时，攻击者自行创建一个符合条件项目组和该项目组下的公开项目，再利用这个漏洞读取GitLab服务器上的敏感文件。  
**综合判断，该漏洞实际互联网受影响面极小，可酌情修复。**  
****  
  
02 漏洞处置优先级（VPT）  
  
  
  
**综合处置优先级：****低**  
  
<table><tbody><tr style="mso-yfti-irow:0;mso-yfti-firstrow:yes;height:23.3pt;"><td style="border-color: rgb(191, 191, 191);border-style: solid;border-width: 1pt;padding: 0cm 5.4pt;" width="128" valign="top" height="23"><p><strong><span style="font-size: 15px;">漏洞编号</span></strong></p></td><td style="border-color: rgb(191, 191, 191) rgb(191, 191, 191) rgb(191, 191, 191) currentcolor;border-style: solid solid solid none;border-width: 1pt 1pt 1pt medium;padding: 0cm 5.4pt;" width="135" valign="top" height="23"><p><span style="font-size: 14px;">微步编号</span></p></td><td style="border-color: rgb(191, 191, 191) rgb(191, 191, 191) rgb(191, 191, 191) currentcolor;border-style: solid solid solid none;border-width: 1pt 1pt 1pt medium;padding: 0cm 5.4pt;" width="214" valign="top" height="23"><p><span style="font-size: 14px;">XVE-2023-16170</span></p></td></tr><tr style="mso-yfti-irow:1;height:23.3pt;"><td rowspan="6" style="border-color: currentcolor rgb(191, 191, 191) rgb(191, 191, 191);border-style: none solid solid;border-width: medium 1pt 1pt;padding: 0cm 5.4pt;" width="112" valign="top" height="23"><p><strong><span style="font-size: 15px;">漏洞评估</span></strong></p></td><td style="border-color: currentcolor rgb(191, 191, 191) rgb(191, 191, 191) currentcolor;border-style: none solid solid none;border-width: medium 1pt 1pt medium;padding: 0cm 5.4pt;" width="147" valign="top" height="23"><p><span style="font-size: 14px;">危害评级</span></p></td><td style="border-color: currentcolor rgb(191, 191, 191) rgb(191, 191, 191) currentcolor;border-style: none solid solid none;border-width: medium 1pt 1pt medium;padding: 0cm 5.4pt;" width="234" valign="top" height="23"><p><span style="font-size: 14px;">中危</span></p></td></tr><tr style="mso-yfti-irow:2;height:23.3pt;"><td style="border-color: currentcolor rgb(191, 191, 191) rgb(191, 191, 191) currentcolor;border-style: none solid solid none;border-width: medium 1pt 1pt medium;padding: 0cm 5.4pt;" width="112" valign="top" height="23"><p><span style="font-size: 14px;">漏洞类型</span></p></td><td style="border-color: currentcolor rgb(191, 191, 191) rgb(191, 191, 191) currentcolor;border-style: none solid solid none;border-width: medium 1pt 1pt medium;padding: 0cm 5.4pt;" width="172" valign="top" height="23"><p><span style="font-size: 14px;">任意文件读取</span></p></td></tr><tr style="mso-yfti-irow:3;"><td style="border-color: currentcolor rgb(191, 191, 191) rgb(191, 191, 191) currentcolor;border-style: none solid solid none;border-width: medium 1pt 1pt medium;padding: 0cm 5.4pt;" width="112" valign="top"><p><span style="font-size: 14px;">公开程度</span></p></td><td style="border-color: currentcolor rgb(191, 191, 191) rgb(191, 191, 191) currentcolor;border-style: none solid solid none;border-width: medium 1pt 1pt medium;padding: 0cm 5.4pt;" width="172" valign="top"><p><span style="font-size: 14px;">PoC已公开</span></p></td></tr><tr style="mso-yfti-irow:4;"><td style="border-color: currentcolor rgb(191, 191, 191) rgb(191, 191, 191) currentcolor;border-style: none solid solid none;border-width: medium 1pt 1pt medium;padding: 0cm 5.4pt;" width="112" valign="top"><p><span style="font-size: 14px;">利用条件</span></p></td><td style="border-color: currentcolor rgb(191, 191, 191) rgb(191, 191, 191) currentcolor;border-style: none solid solid none;border-width: medium 1pt 1pt medium;padding: 0cm 5.4pt;" width="172" valign="top"><p><br/></p><p><span style="font-size: 14px;">1. 存在一个公开的至少5级目录的项目组（复现过程中发现直到9级才利用成功）</span></p><p><span style="font-size: 14px;">2. 该项目组下的存在公开项目</span></p><p><span style="font-size: 14px;">3. 该公开项目有附件</span></p><p><span style="font-size: 14px;">4. GitLab版本为16.0.0</span></p><p><br/></p></td></tr><tr style="mso-yfti-irow:5;"><td style="border-color: currentcolor rgb(191, 191, 191) rgb(191, 191, 191) currentcolor;border-style: none solid solid none;border-width: medium 1pt 1pt medium;padding: 0cm 5.4pt;" width="112" valign="top"><p><span style="font-size: 14px;">交互要求</span></p></td><td style="border-color: currentcolor rgb(191, 191, 191) rgb(191, 191, 191) currentcolor;border-style: none solid solid none;border-width: medium 1pt 1pt medium;padding: 0cm 5.4pt;" width="172" valign="top"><p><span style="font-size: 14px;"><span style="font-size: 14px;font-family: 黑体;" lang="EN-US">0-</span>click</span></p></td></tr><tr style="mso-yfti-irow:6;"><td style="border-color: currentcolor rgb(191, 191, 191) rgb(191, 191, 191) currentcolor;border-style: none solid solid none;border-width: medium 1pt 1pt medium;padding: 0cm 5.4pt;" width="112" valign="top"><p><span style="font-size: 14px;">威胁类型</span></p></td><td style="border-color: currentcolor rgb(191, 191, 191) rgb(191, 191, 191) currentcolor;border-style: none solid solid none;border-width: medium 1pt 1pt medium;padding: 0cm 5.4pt;" width="172" valign="top"><p><span style="font-size: 14px;">远程</span></p></td></tr><tr style="mso-yfti-irow:7;"><td rowspan="2" style="border-color: currentcolor rgb(191, 191, 191) rgb(191, 191, 191);border-style: none solid solid;border-width: medium 1pt 1pt;padding: 0cm 5.4pt;" width="112" valign="top"><p><strong><span style="font-size: 15px;">利用情报</span></strong></p></td><td style="border-color: currentcolor rgb(191, 191, 191) rgb(191, 191, 191) currentcolor;border-style: none solid solid none;border-width: medium 1pt 1pt medium;padding: 0cm 5.4pt;" width="147" valign="top"><p><span style="font-size: 14px;">在野利用</span></p></td><td style="border-color: currentcolor rgb(191, 191, 191) rgb(191, 191, 191) currentcolor;border-style: none solid solid none;border-width: medium 1pt 1pt medium;padding: 0cm 5.4pt;" width="234" valign="top"><p><span style="font-size: 14px;">无</span></p></td></tr><tr style="mso-yfti-irow:8;"><td style="border-color: currentcolor rgb(191, 191, 191) rgb(191, 191, 191) currentcolor;border-style: none solid solid none;border-width: medium 1pt 1pt medium;padding: 0cm 5.4pt;" width="112" valign="top"><p><span style="font-size: 14px;">漏洞活跃度</span></p></td><td style="border-color: currentcolor rgb(191, 191, 191) rgb(191, 191, 191) currentcolor;border-style: none solid solid none;border-width: medium 1pt 1pt medium;padding: 0cm 5.4pt;" width="172" valign="top"><p><span style="font-size: 14px;">高</span></p></td></tr><tr style="mso-yfti-irow:9;"><td rowspan="4" style="border-color: currentcolor rgb(191, 191, 191) rgb(191, 191, 191);border-style: none solid solid;border-width: medium 1pt 1pt;padding: 0cm 5.4pt;" width="112" valign="top"><p><strong><span style="font-size: 15px;">影响产品</span></strong></p></td><td style="border-color: currentcolor rgb(191, 191, 191) rgb(191, 191, 191) currentcolor;border-style: none solid solid none;border-width: medium 1pt 1pt medium;padding: 0cm 5.4pt;" width="147" valign="top"><p><span style="font-size: 14px;">产品名称</span></p></td><td style="border-color: currentcolor rgb(191, 191, 191) rgb(191, 191, 191) currentcolor;border-style: none solid solid none;border-width: medium 1pt 1pt medium;padding: 0cm 5.4pt;" width="234" valign="top"><p><span style="font-size: 14px;">GitLab-GitLab CE/EE</span></p></td></tr><tr style="mso-yfti-irow:10;"><td style="border-color: currentcolor rgb(191, 191, 191) rgb(191, 191, 191) currentcolor;border-style: none solid solid none;border-width: medium 1pt 1pt medium;padding: 0cm 5.4pt;" width="112" valign="top"><p><span style="font-size: 14px;">受影响版本</span></p></td><td style="border-color: currentcolor rgb(191, 191, 191) rgb(191, 191, 191) currentcolor;border-style: none solid solid none;border-width: medium 1pt 1pt medium;padding: 0cm 5.4pt;" width="182" valign="top"><p><span style="font-size: 14px;">Version==16.0.0</span></p></td></tr><tr style="mso-yfti-irow:11;"><td style="border-color: currentcolor rgb(191, 191, 191) rgb(191, 191, 191) currentcolor;border-style: none solid solid none;border-width: medium 1pt 1pt medium;padding: 0cm 5.4pt;" width="112" valign="top"><p><span style="font-size: 14px;">影响范围</span></p></td><td style="border-color: currentcolor rgb(191, 191, 191) rgb(191, 191, 191) currentcolor;border-style: none solid solid none;border-width: medium 1pt 1pt medium;padding: 0cm 5.4pt;" width="182" valign="top"><p><span style="font-size: 14px;">极少</span></p></td></tr><tr style="mso-yfti-irow:12;mso-yfti-lastrow:yes;height:26.7pt;"><td style="border-color: currentcolor rgb(191, 191, 191) rgb(191, 191, 191) currentcolor;border-style: none solid solid none;border-width: medium 1pt 1pt medium;padding: 0cm 5.4pt;" width="112" valign="top" height="26"><p><span style="font-size: 14px;">有无修复补丁</span></p></td><td style="border-color: currentcolor rgb(191, 191, 191) rgb(191, 191, 191) currentcolor;border-style: none solid solid none;border-width: medium 1pt 1pt medium;padding: 0cm 5.4pt;" width="182" valign="top" height="26"><p><span style="font-size: 14px;">有</span></p></td></tr></tbody></table>  
  
03 漏洞复现   
  
  
  
![](https://mmbiz.qpic.cn/mmbiz_png/fFyp1gWjicMJgBbKyaSXC71DLyNChz2uqWlDMry9GWEEMHZo7h9gLM9zg4ibq8t8YyjWdWMHUCvAxoqLbYcEm0SA/640?wx_fmt=png "")  
### 04 修复方案 1、官方修复方案由于该漏洞修复优先级较低，受影响的用户可酌情升级至最新版本https://about.gitlab.com/releases/2023/05/23/critical-security-release-gitlab-16-0-1-released/2、临时修复方案•	优先排查GitLab管理员权限是否存在弱口令，如果有尽快修改•	检查是否存在层级过多的项目组，以及该组下的项目是否存在公开项目。如果有，在不影响业务的前提下，可以酌情减少层级或者将项目变更为私有项目•	非必要不建议将该系统暴露在公网  
### 05 微步在线产品侧支持情况  微步在线威胁感知平台TDP默认支持该类型的漏洞检测。  
### 06 时间线 2023.5.25 获取该漏洞相关情报2022.5.25 漏洞分析与研究2022.5.25 微步在线威胁感知平台TDP默认支持检测2023.5.26 微步发布报告  
  
****  
**---End---**  
  
**CSOP 2023**  
  
网络安全领域最具专业性的年度盛会之一 CSOP 2023 网络安全运营与实战大会将于6月8日在深圳继续，安全负责人和CISO不能错过~  
  
长按识别下方二维码即可报名：  
  
![](https://mmbiz.qpic.cn/mmbiz_jpg/fFyp1gWjicMJgBbKyaSXC71DLyNChz2uq2kY5VibvESCibg6ich9ibTUBANVKwcxzzSkD7ITThHTp1kaQSkxgmR3Z1A/640?wx_fmt=jpeg "")  
  
  
**微步在线漏洞情报订阅服务**  
  
微步在线漏洞情报订阅服务是由微步在线漏洞团队面向企业推出的一项高级分析服务，致力于通过微步在线自有产品强大的高价值漏洞发现和收集能力以及微步在线核心的威胁情报能力，为企业提供0day漏洞预警、最新公开漏洞预警、漏洞分析及评估等漏洞相关情报，帮助企业应对最新0day/1day等漏洞威胁并确定漏洞修复优先级，快速收敛企业的攻击面，保障企业自身业务的正常运转。  
  
点击“  
**阅读原文**”，报名 CSOP 2023 大会  
  
