#  Gitlab任意文件读取漏洞CVE-2023-2825   
深瞳漏洞实验室  深信服千里目安全技术中心   2023-05-25 20:46  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/w8NHw6tcQ5z4Dwm0N8cicAjQAmxr8Ucotrs6UlkYEgFA2deBxlgwzBRdpQW0Xxe0UNyRLkQF5YuBJicRmfrsljFw/640?wx_fmt=gif "")  
  
**漏洞名称：**  
  
Gitlab任意文件读取漏洞  
  
**组件名称：**  
  
Gitlab  
  
**影响范围：**  
  
GitLab CE 16.0.0  
  
GitLab EE 16.0.0  
  
**漏洞类型：**  
  
任意文件读取  
  
**利用条件：**  
  
1、用户认证：是  
  
2、前置条件：嵌套在至少五个组中的公共项目中存在附件  
  
3、触发方式：远程  
  
**综合评价：**  
  
<综合评定利用难度>：容易。  
  
<综合评定威胁等级>：高危，能造成信息泄露。  
  
  
  
  
  
**漏洞分析**  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/w8NHw6tcQ5z4Dwm0N8cicAjQAmxr8Ucot17R2cUUVSsCynCkfzItapd4UXcQPlqo80OicFDXVYVTqRqmg61qyVfA/640?wx_fmt=gif "")  
  
**组件介绍**  
  
Gitlab是目前被广泛使用的基于Git的开源代码管理平台, 基于Ruby on Rails构建, 主要针对软件开发过程中产生的代码和文档进行管理，同时可以搭建Web服务。  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/w8NHw6tcQ5z4Dwm0N8cicAjQAmxr8Ucot17R2cUUVSsCynCkfzItapd4UXcQPlqo80OicFDXVYVTqRqmg61qyVfA/640?wx_fmt=gif "")  
  
**漏洞简介**  
  
近日，深信服安全团队监测到一则Gitlab组件存在任意文件读取漏洞的信息，漏洞编号：(CVE-2023-2825)，漏洞威胁等级：高危。  
  
该漏洞由于未对文件路径进行过滤，**攻击者可利用该漏洞，构造恶意数据执行目录遍历攻击，读取任意文件，最终造成服务器敏感性信息泄露。**  
  
  
**影响范围**  
  
目前受影响的Gitlab版本：  
  
GitLab CE 16.0.0  
  
GitLab EE 16.0.0  
  
  
**解决方案**  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/w8NHw6tcQ5z4Dwm0N8cicAjQAmxr8Ucot17R2cUUVSsCynCkfzItapd4UXcQPlqo80OicFDXVYVTqRqmg61qyVfA/640?wx_fmt=gif "")  
  
**如何检测组件版本**  
  
  
在安装Gitlab的机器上执行命令  
  
cat/opt/gitlab/embedded/service/gitlab-rails/VERSION  
  
即可查看当前版本。  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/w8NHw6tcQ5z4Dwm0N8cicAjQAmxr8Ucot17R2cUUVSsCynCkfzItapd4UXcQPlqo80OicFDXVYVTqRqmg61qyVfA/640?wx_fmt=gif "")  
  
**官方修复建议**  
  
  
当前官方已发布最新版本，建议受影响的用户及时更新升级到最新版本。链接如下：  
  
https://about.gitlab.com/install/  
  
  
![](https://mmbiz.qpic.cn/mmbiz_png/w8NHw6tcQ5z4Dwm0N8cicAjQAmxr8Ucot1NS3V5XmH9cQRgQ06s7csviavCxq3NlIgpMMMZrcS93tEHdfsAW36JQ/640?wx_fmt=png "")  
  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/w8NHw6tcQ5z4Dwm0N8cicAjQAmxr8Ucot17R2cUUVSsCynCkfzItapd4UXcQPlqo80OicFDXVYVTqRqmg61qyVfA/640?wx_fmt=gif "")  
  
**深信服解决方案**  
  
  
**1.风险资产发现**  
  
支持对 Gitlab 组件的主动检测，可**批量检出**业务场景中该事件的**受影响资产**情况，相关产品如下：  
  
**【深信服主机安全检测响应平台CWPP】**预计 23 年 5 月 27 日发布资产检测方案。  
  
**【深信服云镜YJ】**预计 23 年 5 月 27 日发布资产检测方案。  
  
  
**2.漏洞主动检测**  
  
支持对 Gitlab 任意文件读取漏洞的主动检测，可批量**快速检出**业务场景中是否存在**漏洞风险**，相关产品如下：  
  
**【深信服云镜YJ】**预计 2023 年 5 月 27 日发布检测方案。  
  
**【深信服漏洞评估工具TSS】**预计 2023 年 5 月 27 日发布检测方案。  
  
**【深信服主机安全检测响应平台CWPP】**预计 2023 年 5 月 30 日发布检测方案。  
  
**【深信服安全托管服务MSS】**预计 2023 年 5 月 27 日发布检测方案。  
  
**【深信服安全检测与响应平台XDR】**预计 2023 年 5 月 27 日发布检测方案。  
  
  
**3.漏洞安全监测**  
  
支持对 Gitlab任意文件读取漏洞的安全监测，可依据流量收集**实时监控**业务场景中的受影响资产情况，快速检查**受影响范围**，相关产品及服务如下：  
  
**【深信服安全感知管理平台SIP】**预计2023年5月29日发布检测方案。  
  
**【深信服安全托管服务MSS】**预计2023年5月29日  
  
发布检测方案。  
  
**【深信服安全检测与响应平台XDR】**预计2023年5月29日  
发布检测方案。  
  
  
**4.漏洞安全防护**  
  
支持对Gitlab任意文件读取漏洞事件的防御，可阻断攻击者针对该事件的入侵行为，相关产品及服务如下：  
  
**【深信服下一代防火墙AF】**预计2023年5月29日发布防护方案。  
  
**【深信服Web应用防火墙WAF】**预计2023年5月29日发布防护方案。  
  
**【深信服安全托管服务MSS】**预计2023年5月29日发布防护方案。  
  
**【深信服安全检测与响应平台XDR】**预计2023年5月29日发布防护方案。  
  
  
**参考链接**  
  
https://about.gitlab.com/releases/2023/05/23/critical-security-release-gitlab-16-0-1-released/  
  
  
**时间轴**  
  
  
  
**2023/5/25**  
  
深信服监测到Gitlab任意文件读取漏洞信息。  
  
  
**2023/5/25**  
  
深信服千里目安全技术中心发布漏洞通告。  
  
  
点击**阅读原文**，及时关注并登录深信服**智安全平台**，可轻松查询漏洞相关解决方案。  
  
![](https://mmbiz.qpic.cn/mmbiz_png/w8NHw6tcQ5z4Dwm0N8cicAjQAmxr8UcotgOA81xZlHCkNzVuUDrnffj8Ca4m2pP6SBMlvSDWEAutKRIGA3yicATw/640?wx_fmt=png "")  
  
  
![](https://mmbiz.qpic.cn/mmbiz_jpg/w8NHw6tcQ5z4Dwm0N8cicAjQAmxr8UcotDTG4mTRg8r4AicqNTGt48raGkslblD9tXF1CB4JJHlZY3uOgTpW5wNQ/640?wx_fmt=jpeg "")  
  
  
  
