#  CVE-2023-32233 linux内核提权   
原创 67626d  暗影安全   2023-05-16 15:22  
  
## Linux NetFilter 内核缺陷（编号为 CVE-2023-32233）可被非特权本地用户利用，将其权限提升至 root。  
  
  
Netfilter  
   
是 Linux 内核提供的一个框架，它允许以自定义处理程序的形式实现各种与网络相关的操作。  
Netfilter 为数据包过滤、网络地址转换和端口转换提供了各种功能和操作，它们提供了通过网络引导数据包和禁止数据包到达网络中的敏感位置所需的功能。  
  
Linux NetFilter 内核受到一个漏洞的影响，该漏洞被跟踪为 CVE-2023-32233，该漏洞可能允许非特权本地用户将其权限提升为“root”，从而可能导致系统完全受损。  
  
影响范围：  
```
漏洞影响多个 Linux 内核版本，包括 Linux 6.3.1（当前稳定版）。
```  
  
  
“在 6.3.1 之前的 Linux 内核中，处理批处理请求时 Netfilter nf_tables 中的 use-after-free 可能会被滥用以对内核内存执行任意读写操作” 。“非特权本地用户可以获得root权限。发生这种情况是因为匿名集处理不当。”  
  
问题的根本原因在于 tfilter nf_tables 如何处理批处理请求，允许经过身份验证的本地攻击者通过发送导致 Netfilter nf_tables 内部状态损坏的特制请求来获得提升的特权。  
  
“Netfilter nf_tables 允许使用将多个基本操作分组为原子事务的批处理请求来更新其配置。在特定情况下，无效的批处理请求可能包含一个隐式删除现有 nft 匿名集的操作，然后另一个操作试图在删除后对同一个 nft 匿名集进行操作。  
  
漏洞利用：  
```
请在实验环境中进行验证：https://www.openwall.com/lists/oss-security/2023/05/15/5/3
```  
  
  
漏洞修复：  
```
修复程序可从主线内核 git 存储库获得：https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/patch/?id=c1592a89942e9678f7d9c8030efa777c0d57edab 
```  
  
  
  
  
