#  【漏洞通告】Linux OverlayFS权限提升漏洞（CVE-2023-0386）   
原创 NS-CERT  绿盟科技CERT   2023-05-06 17:17  
  
**通告编号:NS-2023-0021**  
  
2023-05-06  
  
<table><tbody><tr><td style="margin: 5px 10px;border-color: rgb(216, 216, 216);word-break: break-all;" valign="top" width="107"><strong><span style="font-size: 14px;">TA</span></strong><strong><span style="font-size: 14px;">G：</span></strong></td><td style="margin: 5px 10px;border-color: rgb(216, 216, 216);word-break: break-all;" valign="top" width="405"><p style="vertical-align: inherit;line-height: 1.75em;font-size: 14px;color: rgb(0, 0, 0);font-family: 微软雅黑;"><strong style="caret-color: red;line-height: 1.57em;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;, sans-serif;"><span style="font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">Linux、OverlayFS、权限提升、CVE-2023-0386</span></strong></p></td></tr><tr><td style="margin: 5px 10px;border-color: rgb(216, 216, 216);word-break: break-all;" valign="top" width="95"><span style="color: rgb(0, 0, 0);"><strong><span style="font-size: 14px;">漏洞危害：</span></strong></span><span style="color: rgb(255, 0, 0);"><strong><span style="font-size: 14px;"></span></strong></span></td><td style="margin: 5px 10px;border-color: rgb(216, 216, 216);word-break: break-all;" valign="top" width="425"><p><strong style="caret-color: red;font-size: 14px;line-height: 1.5em;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">攻击者利用漏洞可实现权限提升</strong></p></td></tr><tr><td style="margin: 5px 10px;border-color: rgb(216, 216, 216);word-break: break-all;" valign="top" width="95"><strong><span style="font-size: 14px;">版本：</span></strong></td><td style="margin: 5px 10px;border-color: rgb(216, 216, 216);word-break: break-all;" valign="top" width="425"><strong><span style="font-size: 14px;">1.0<br/></span></strong></td></tr></tbody></table>  
  
**1**  
  
  
**漏洞概述**  
  
  
近日，绿盟科技CERT监测发现网上公开披露了一个Linux OverlayFS权限提升漏洞（CVE-2023-0386）的PoC。由于Linux内核的OverlayFS子系统存在缺陷，攻击者可以利用该漏洞通过将具有特权的可执行文件从“nosuid mount”复制到另一个文件夹，且该文件夹中的挂载启用了uid映射功能。在复制过程中，会发生uid映射错误，攻击者可实现在目标系统上提升至ROOT权限。该漏洞的CVSS评分为7.8，建议受影响的用户尽快采取措施进行防护。  
  
OverlayFS是一种用于Linux内核的文件系统，可以将多个目录树合并到一个单一的虚拟文件系统中。它的作用类似于一种文件叠加技术，能够将不同的文件系统叠加在一起，从而形成一个新的文件系统，其中包含了所有原始文件系统中的文件和目录。  
  
  
CVE-2023-0386漏洞状态：  
<table><tbody><tr><td valign="top" style="border-top-width: 2px;border-left-width: 2px;border-color: windowtext;" width="136"><p style="text-align:center;line-height: 1.75em;"><span style="font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong><span style="line-height: 125%;color: rgb(55, 61, 65);letter-spacing: 1px;">漏洞细节</span></strong></span></p></td><td valign="top" style="border-top-width: 2px;border-color: windowtext;" width="123"><p style="text-align:center;line-height: 1.75em;"><span style="font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong><span style="line-height: 125%;color: rgb(55, 61, 65);letter-spacing: 1px;"><strong>漏洞</strong><strong>PoC</strong></span></strong></span></p></td><td valign="top" style="border-top-width: 2px;border-color: windowtext;" width="135"><p style="text-align:center;line-height: 1.75em;"><span style="font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong><span style="line-height: 125%;color: rgb(55, 61, 65);letter-spacing: 1px;"><strong>漏洞</strong><strong>EXP</strong></span></strong></span></p></td><td valign="top" style="border-top-width: 2px;border-right-width: 2px;border-color: windowtext;" width="106"><p style="text-align:center;line-height: 1.75em;"><span style="font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong><span style="line-height: 125%;color: rgb(55, 61, 65);letter-spacing: 1px;">在野利用</span></strong></span></p></td></tr><tr><td valign="top" style="border-bottom-width: 2px;border-left-width: 2px;border-color: windowtext;" width="136"><p style="text-align:center;line-height: 1.75em;"><span style="line-height: 125%;color: rgb(51, 51, 51);letter-spacing: 1px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">未公开</span></p></td><td valign="top" style="border-bottom-width: 2px;border-color: windowtext;" width="143"><p style="text-align:center;line-height: 1.75em;"><span style="line-height: 125%;color: rgb(51, 51, 51);letter-spacing: 1px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">已公开</span></p></td><td valign="top" style="border-bottom-width: 2px;border-color: windowtext;" width="135"><p style="text-align:center;line-height: 1.75em;"><span style="line-height: 125%;color: rgb(51, 51, 51);letter-spacing: 1px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">已公开</span></p></td><td valign="top" style="border-right-width: 2px;border-bottom-width: 2px;border-color: windowtext;" width="126"><p style="text-align:center;line-height: 1.75em;"><span style="line-height: 125%;color: rgb(55, 61, 65);letter-spacing: 1px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">暂不存在</span></p></td></tr></tbody></table>  
  
绿盟科技研究员已成功复现此漏洞：  
  
![](https://mmbiz.qpic.cn/mmbiz_png/VvfsuOanecqxZKXAyUezh2gxUbluEDByMSrsyjh5QVaFZ4a4vcg9H09iaOElB9LukuHicDoJUcu9qUB74iceEFkNA/640?wx_fmt=png "")  
  
   
  
参考链接：  
  
https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=4f11ada10d0a  
  
  
**SEE MORE →******  
  
**2****影响范围**  
  
**受影响版本：**  
  
- v5.11-rc1 <= Linux Kernel <= v6.2-rc5  
  
  
  
  
**不受影响版本：**  
  
- Linux Kernel >= 6.2-rc6  
  
- Linux Kernel < v5.11  
  
  
  
  
**3****漏洞检测**  
  
**3.1 版本检测**  
  
Linux系统用户可以通过查看版本来判断当前系统是否在受影响范围内，查看操作系统版本信息命令如下：  
<table><tbody><tr><td valign="top" style="border-width: 2px;border-color: windowtext;background: rgb(190, 190, 190);" width="550"><p style="text-align:left;line-height: 125%;"><span style="font-size: 14px;letter-spacing: normal;line-height: 2em;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">cat /proc/version</span></p></td></tr></tbody></table>  
![](https://mmbiz.qpic.cn/mmbiz_png/VvfsuOanecqxZKXAyUezh2gxUbluEDBy0mtsK67SsHbwNTjWAI3IWPQ3bDRtE6qk1EicYty9HQm0MWVv00awVyw/640?wx_fmt=png "")  
  
  
**4****漏洞防护**  
  
**4.1 补丁更新**  
  
1、目前官方已发布补丁修复此漏洞，建议受影响的用户及时安装防护：  
https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=4f11ada10d0ad3fd53e2bd67806351de63a4f9c3  
  
2、目前主流Linux发行版已发布安全补丁或更新版本修复此漏洞，建议用户尽快安装补丁或参照官方措施进行防护：  
<table><tbody><tr><td valign="top" style="border-top-width: 2px;border-left-width: 2px;border-color: windowtext;" width="132"><p style="text-align:left;line-height: 1.75em;"><span style="color: #000000;background: #ffffff;font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">Linux发行版</span></p></td><td valign="top" style="border-top-width: 2px;border-right-width: 2px;border-color: windowtext;" width="426"><p style="text-align:left;line-height: 1.75em;"><span style="color: #000000;font-size: 14px;background: #ffffff;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">官方通告</span></p></td></tr><tr><td valign="top" style="border-left-width: 2px;border-color: windowtext;" width="49"><p style="text-align:left;line-height: 1.75em;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">Ubuntu</span></p></td><td valign="top" style="border-right-width: 2px;border-color: windowtext;" width="406"><p style="text-align:left;line-height: 1.75em;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">https://ubuntu.com/security/CVE-2023-0386</span></p></td></tr><tr><td valign="top" style="border-left-width: 2px;border-color: windowtext;" width="49"><p style="text-align:left;line-height: 1.75em;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">Debain</span></p></td><td valign="top" style="border-right-width: 2px;border-color: windowtext;" width="406"><p style="text-align:left;line-height: 1.75em;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">https://security-tracker.debian.org/tracker/CVE-2023-0386</span></p></td></tr><tr><td valign="top" style="border-bottom-width: 2px;border-left-width: 2px;border-color: windowtext;" width="49"><p style="text-align:left;line-height: 1.75em;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">Redhat</span></p></td><td valign="top" style="border-right-width: 2px;border-bottom-width: 2px;border-color: windowtext;" width="406"><p style="text-align:left;line-height: 1.75em;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">https://access.redhat.com/security/cve/CVE-2023-0386</span></p></td></tr></tbody></table>  
  
**END**  
  
![](https://mmbiz.qpic.cn/mmbiz_png/qR4ORTNELImFwJM2rh6GKbnrurdFA28jJ8chUPyC1U6aW3jhenqEiaXkmeGVmfOnvAJy8j3My901JQ7emHaicYzA/640?wx_fmt=png "")  
           
  
![](https://mmbiz.qpic.cn/mmbiz_jpg/qR4ORTNELImFwJM2rh6GKbnrurdFA28jib7icfic0lJJHh3eLRpIXiaia08KqOSEibBsz64vlOH9aqicu3lmjccEeAFWQ/640?wx_fmt=jpeg "")  
          
  
**声明**  
  
本安全公告仅用来描述可能存在的安全问题，绿盟科技不为此安全公告提供任何保证或承诺。由于传播、利用此安全公告所提供的信息而造成的任何直接或者间接的后果及损失，均由使用者本人负责，绿盟科技以及安全公告作者不为此承担任何责任。              
  
绿盟科技拥有对此安全公告的修改和解释权。如欲转载或传播此安全公告，必须保证此安全公告的完整性，包括版权声明等全部内容。未经绿盟科技允许，不得任意修改或者增减此安全公告内容，不得以任何方式将其用于商业目的。              
  
![](https://mmbiz.qpic.cn/mmbiz_jpg/qR4ORTNELImFwJM2rh6GKbnrurdFA28jib7icfic0lJJHh3eLRpIXiaia08KqOSEibBsz64vlOH9aqicu3lmjccEeAFWQ/640?wx_fmt=jpeg "")  
  
  
**绿盟科技CERT**  
****  
∣  
微信公众号  
  
![](https://mmbiz.qpic.cn/mmbiz_jpg/VvfsuOanecqxZKXAyUezh2gxUbluEDBy4z3ERe7aN4suotaveACjeO9DdxxuUsSGP7EmPRpFuH5vzhs8QgyBJQ/640?wx_fmt=jpeg "绿盟科技CERT公众号.jpg")  
  
![](https://mmbiz.qpic.cn/mmbiz/Hu8hctxHqSW0nSJn8p8OHVEQwHicSwTibFJMBE650AxdzfISoeY8woe2QsgCINIBrccBOOUft2HuU0GsNQWibSG7g/640?wx_fmt=png "")  
  
长按识别二维码，关注网络安全威胁信息  
  
  
  
