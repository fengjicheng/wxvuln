#  【漏洞通告】Apache RocketMQ远程命令执行漏洞（CVE-2023-37582）   
深瞳漏洞实验室  深信服千里目安全技术中心   2023-07-17 20:51  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/w8NHw6tcQ5x36xaDtRvFaUfx4y4vUoNQiaGxM0riaAkn0xSOr30SVepHM5sG6BTAN2Dbw41QbajOdW43JvgZhQCA/640?wx_fmt=gif "")  
  
**漏洞名称：**  
  
Apache RocketMQ远程命令执行漏洞CVE-2023-37582  
  
**组件名称：**  
  
Apache RocketMQ  
  
**影响范围：**  
  
Apache RocketMQ < 4.9.7  
  
Apache RocketMQ < 5.1.2  
  
**漏洞类型：**  
  
远程代码执行  
  
**利用条件：**  
  
1、用户认证：不需要用户认证  
  
2、前置条件：默认配置  
  
3、触发方式：远程  
  
**综合评价：**  
  
<综合评定利用难度>：容易，无需授权即可远程命令执行。  
  
<综合评定威胁等级>：高危，能造成远程命令执行。  
  
**官方解决方案：**  
  
已发布  
  
  
  
  
**漏洞分析**  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/w8NHw6tcQ5x36xaDtRvFaUfx4y4vUoNQsZnJTo4YxBon9icQRicL1UT1cENyb0iavdzUAeJhDroBrTkAevrEG5ialw/640?wx_fmt=gif "")  
  
**组件介绍**  
  
**Apache RocketMQ 是一个高可靠性、高性能、可扩展的分布式消息中间件系统，适用于大规模分布式系统中的消息传递和异步通信。**  
  
  
RocketMQ 提供了可靠的消息传递机制，支持高吞吐量和低延迟的消息处理，并具有可横向扩展的能力。它适用于各种场景，包括实时数据处理、大规模数据集成、日志收集和分析、异步通信等。  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/w8NHw6tcQ5x36xaDtRvFaUfx4y4vUoNQsZnJTo4YxBon9icQRicL1UT1cENyb0iavdzUAeJhDroBrTkAevrEG5ialw/640?wx_fmt=gif "")  
  
**漏洞简介**  
  
2023年7月17日，深信服安全团队监测到一则Apache RocketMQ组件存在远程命令执行漏洞的信息，漏洞编号：CVE-2023-37582，漏洞威胁等级：高危。  
  
  
该漏洞是由于RocketMQ的NameServer组件缺乏有效的身份认证，**攻击者可利用该漏洞在未授权的情况下，利用更新配置功能构造恶意数据远程命令执行攻击，最终获取服务器最高权限。**  
  
  
**影响范围**  
  
目前受影响的Apache RocketMQ版本：  
  
Apache RocketMQ < 4.9.7  
  
Apache RocketMQ < 5.1.2  
  
  
**解决方案**  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/w8NHw6tcQ5x36xaDtRvFaUfx4y4vUoNQsZnJTo4YxBon9icQRicL1UT1cENyb0iavdzUAeJhDroBrTkAevrEG5ialw/640?wx_fmt=gif "")  
  
**如何检测组件版本**  
  
  
在根目录下执行sh bin/mqadmin --version可获取当前安装版本日期。  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/w8NHw6tcQ5x36xaDtRvFaUfx4y4vUoNQsZnJTo4YxBon9icQRicL1UT1cENyb0iavdzUAeJhDroBrTkAevrEG5ialw/640?wx_fmt=gif "")  
  
**官方修复建议**  
  
  
当前官方已发布最新版本，建议受影响的用户及时更新升级到最新版本。链接如下：  
  
https://github.com/apache/rocketmq  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/w8NHw6tcQ5x36xaDtRvFaUfx4y4vUoNQsZnJTo4YxBon9icQRicL1UT1cENyb0iavdzUAeJhDroBrTkAevrEG5ialw/640?wx_fmt=gif "")  
  
**深信服解决方案**  
  
  
**1.风险资产发现**  
  
****  
支持对Apache RocketMQ 的主动检测，可**批量检出**业务场景中该事件的**受影响资产**情况，相关产品如下：  
  
**【深信服主机安全检测响应平台CWPP】**已发布资产检测方案。  
  
  
**2.漏洞主动检测**  
  
****  
支持对Apache RocketMQ的主动检测，可**批量快速检出**业务场景中是否存在**漏洞风险**，相关产品如下：  
  
**【深信服云镜YJ】**预计2023年07月30日发布检测方案。  
  
**【深信服漏洞评估工具TSS】**预计2023年07月31日发布检测方案。  
  
**【深信服安全托管服务MSS】**预计2023年07月31日发布检测方案。  
  
**【深信服安全检测与响应平台XDR】**预计2023年07月30日发布检测方案。  
  
  
**3.漏洞安全监测**  
  
  
支持对Apache RocketMQ的监测，可依据流量收集**实时监控**业务场景中的**受影响资产情况，快速检查受影响范围**，相关产品及服务如下：  
  
**【深信服安全感知管理平台SIP】**预计2023年07月21日发布检测方案。  
  
**【深信服安全托管服务MSS】**预计2023年07月21日发布检测方案。  
  
**【深信服安全检测与响应平台XDR】**预计2023年07月21日发布检测方案。  
  
  
**4.漏洞安全防护**  
  
****  
支持对Apache RocketMQ 的防御，**可阻断攻击者针对该事件的入侵行为**，相关产品及服务如下：  
  
**【深信服下一代防火墙AF】**预计2023年07月21日发布防护方案。  
  
**【深信服Web应用防火墙WAF】**预计2023年07月21日发布防护方案。  
  
**【深信服安全托管服务MSS】**预计2023年07月21日发布防护方案。  
  
**【深信服安全检测与响应平台XDR】**预计2023年07月21日发布防护方案。  
  
  
**参考链接**  
  
  
https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-37582  
  
  
**时间轴**  
  
  
  
**2023/7/17**  
  
深信服监测到Apache RocketMQ官方发布安全通告。  
  
  
**2023/7/17**  
  
深信服千里目安全技术中心发布漏洞通告。  
  
  
点击**阅读原文**，及时关注并登录深信服**智安全平台**，可轻松查询漏洞相关解决方案。  
  
![](https://mmbiz.qpic.cn/mmbiz_png/w8NHw6tcQ5x36xaDtRvFaUfx4y4vUoNQ2XAiaY3vaoLWenVRx00XFklfAwib1GKd2picOE4G7kadiczQxwAbnEhCsA/640?wx_fmt=png "")  
  
![](https://mmbiz.qpic.cn/mmbiz_jpg/w8NHw6tcQ5x36xaDtRvFaUfx4y4vUoNQYrg2dneFhjN6pzbFyhlOshEj1wEMuD5Nsu0RMlicIMKQorWvC4icNwOg/640?wx_fmt=jpeg "")  
  
  
