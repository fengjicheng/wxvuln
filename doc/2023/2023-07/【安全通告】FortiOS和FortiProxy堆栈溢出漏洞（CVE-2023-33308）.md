#  【安全通告】FortiOS和FortiProxy堆栈溢出漏洞（CVE-2023-33308）   
原创 NS-CERT  绿盟科技CERT   2023-07-14 14:41  
  
**通告编号:NS-2023-0032**  
  
2023-07-14  
  
<table><tbody><tr><td style="margin: 5px 10px;border-color: rgb(216, 216, 216);word-break: break-all;" valign="top" width="103.33333333333333"><strong><span style="font-size: 14px;">TA</span></strong><strong><span style="font-size: 14px;">G：</span></strong></td><td style="margin: 5px 10px;border-color: rgb(216, 216, 216);word-break: break-all;" valign="top" width="413.3333333333333"><p style="vertical-align: inherit;line-height: 1.75em;font-size: 14px;color: rgb(0, 0, 0);font-family: 微软雅黑;"><strong style="caret-color: red;line-height: 1.57em;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;, sans-serif;"><span style="font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">Fortinet、FortiOS、FortiProxy、堆栈溢出、CVE-2023-33308</span></strong></p></td></tr><tr><td style="margin: 5px 10px;border-color: rgb(216, 216, 216);word-break: break-all;" valign="top" width="51"><span style="color: rgb(0, 0, 0);"><strong><span style="font-size: 14px;">漏洞危害：</span></strong></span><span style="color: rgb(255, 0, 0);"><strong><span style="font-size: 14px;"></span></strong></span></td><td style="margin: 5px 10px;border-color: rgb(216, 216, 216);word-break: break-all;" valign="top" width="413.3333333333333"><p><strong style="caret-color: red;font-size: 14px;line-height: 1.5em;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">攻击者可以通过精心设计的数据包执行任意代码或命令</strong></p></td></tr><tr><td style="margin: 5px 10px;border-color: rgb(216, 216, 216);word-break: break-all;" valign="top" width="51"><strong><span style="font-size: 14px;">版本：</span></strong></td><td style="margin: 5px 10px;border-color: rgb(216, 216, 216);word-break: break-all;" valign="top" width="413.3333333333333"><strong><span style="font-size: 14px;">1.0<br/></span></strong></td></tr></tbody></table>  
  
**1**  
  
  
**漏洞概述**  
  
  
近日，绿盟科技CERT监测发现Fortinet官方发布安全通告，修复了FortiOS和FortiProxy 堆栈溢出漏洞。未经身份验证的远程攻击者可通过特殊构造的数据包实现代码执行或者命令执行，CVSS评分为9.8。  
  
Fortinet FortiOS是Fortinet公司的一套专用于FortiGate网络安全平台上的安全操作系统。该系统为用户提供防火墙、防病毒、IPSec/SSLVPN、Web内容过滤和反垃圾邮件等多种安全功能。  
  
FortiProxy是一种安全的网络代理，通过结合Web过滤、DNS过滤、DLP、反病毒、入侵防御和高级威胁保护等多种检测技术来保护员工免受网络攻击。  
  
  
漏洞状态：  
<table><tbody><tr><td style="border-top-width: 2px;border-left-width: 2px;border-color: windowtext;"><p style="text-align:center;line-height: 1.75em;"><span style="font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong><span style="line-height: 125%;color: black;background: white;">漏洞细节</span></strong></span></p></td><td style="border-top-width: 2px;border-top-color: windowtext;border-left: none;border-bottom-color: windowtext;border-right-color: windowtext;"><p style="text-align:center;line-height: 1.75em;"><span style="font-family:微软雅黑, Microsoft YaHei;"><strong><span style="line-height: 125%;color: black;background: white;">漏洞</span></strong><strong><span style="line-height: 125%;color: black;background: white;">PoC</span></strong></span></p></td><td style="border-top-width: 2px;border-top-color: windowtext;border-left: none;border-bottom-color: windowtext;border-right-color: windowtext;"><p style="text-align:center;line-height: 1.75em;"><span style="font-family:微软雅黑, Microsoft YaHei;"><strong><span style="line-height: 125%;color: black;background: white;">漏洞</span></strong><strong><span style="line-height: 125%;color: black;background: white;">EXP</span></strong></span></p></td><td style="border-top-width: 2px;border-top-color: windowtext;border-left: none;border-bottom-color: windowtext;border-right-width: 2px;border-right-color: windowtext;"><p style="text-align:center;line-height: 1.75em;"><span style="font-family:微软雅黑, Microsoft YaHei;"><strong><span style="line-height: 125%;color: black;background: white;">在野利用</span></strong></span></p></td></tr><tr><td style="border-top: none;border-left-width: 2px;border-left-color: windowtext;border-bottom-width: 2px;border-bottom-color: windowtext;border-right-color: windowtext;"><p style="text-align:center;line-height: 1.75em;"><span style="line-height: 125%;color: black;background: white;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">未公开</span></p></td><td style="border-top: none;border-left: none;border-bottom-width: 2px;border-bottom-color: windowtext;border-right-color: windowtext;"><p style="text-align:center;line-height: 1.75em;"><span style="line-height: 125%;color: black;background: white;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">未公开</span></p></td><td style="border-top: none;border-left: none;border-bottom-width: 2px;border-bottom-color: windowtext;border-right-color: windowtext;"><p style="text-align:center;line-height: 1.75em;"><span style="line-height: 125%;color: black;background: white;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">未公开</span></p></td><td style="border-top: none;border-left: none;border-bottom-width: 2px;border-bottom-color: windowtext;border-right-width: 2px;border-right-color: windowtext;"><p style="text-align:center;line-height: 1.75em;"><span style="line-height: 125%;color: black;background: white;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">暂不存在</span></p></td></tr></tbody></table>  
  
参考链接：  
  
https://www.fortiguard.com/psirt/FG-IR-23-183  
  
  
**SEE MORE →******  
  
**2****影响范围**  
  
**受影响版本：**  
  
- 7.2.0 <=FortiOS <=7.2.3  
  
- 7.0.0 <=FortiOS <=7.0.10  
  
- 7.2.0 <= FortiProxy <=7.2.2  
  
- 7.0.0 <= FortiProxy <=7.0.9  
  
  
  
**不受影响版本：**  
  
- FortiOS 6.4 所有版本  
  
- FortiOS 6.2 所有版本  
  
- FortiOS 6.0 所有版本  
  
- FortiProxy 2.x 所有版本  
  
- FortiProxy 1.x 所有版本  
  
  
  
  
**3****漏洞防护**  
  
**3.1 官方升级**  
  
目前官方已发布新版本修复了上述漏洞，请受影响的用户尽快升级至最新版本进行防护，  
   
官方下载链接：  
  
https://docs.fortinet.com/product/fortiproxy/7.2  
  
https://docs.fortinet.com/product/fortigate/7.4  
  
其他产品可参考：https://www.fortiguard.com/psirt  
  
**3.2 临时防护措施**  
  
针对  
CVE-2023-33308  
，若相关用户暂时无法进行升级操作，可对代理策略或具有代理模式的防火墙策略使用的  
SSL  
检查配置文件禁用  
HTTP/2  
支持。  
  
自定义深度检查配置文件的示例：  
<table><tbody><tr><td valign="top" style="border-width: 2px;border-color: windowtext;" width="566.3333333333334"><p style="text-align:left;line-height: 1.75em;"><span style="font-size: 14px;caret-color: red;letter-spacing: normal;line-height: 2.07em;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">config firewall ssl-ssh-profile</span></p><p style="text-align:left;line-height: 1.75em;"><span style="font-size: 14px;caret-color: red;letter-spacing: normal;line-height: 2.07em;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">   edit &#34;custom-deep-inspection&#34;</span></p><p style="text-align:left;line-height: 1.75em;"><span style="font-size: 14px;caret-color: red;letter-spacing: normal;line-height: 2.07em;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">      set supported-alpn http1-1</span></p><p style="text-align:left;line-height: 1.75em;"><span style="font-size: 14px;caret-color: red;letter-spacing: normal;line-height: 2.07em;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">   next</span></p><p style="text-align:left;line-height: 1.75em;"><span style="font-size: 14px;caret-color: red;letter-spacing: normal;line-height: 2.07em;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">end</span></p></td></tr></tbody></table>  
https://docs.fortinet.com/document/fortigate/7.0.0/new-features/710924/http-2-support-in-proxy-mode-ssl-inspection  
  
  
**END**  
  
![](https://mmbiz.qpic.cn/mmbiz_png/qR4ORTNELImFwJM2rh6GKbnrurdFA28jJ8chUPyC1U6aW3jhenqEiaXkmeGVmfOnvAJy8j3My901JQ7emHaicYzA/640?wx_fmt=png "")  
           
  
![](https://mmbiz.qpic.cn/mmbiz_jpg/qR4ORTNELImFwJM2rh6GKbnrurdFA28jib7icfic0lJJHh3eLRpIXiaia08KqOSEibBsz64vlOH9aqicu3lmjccEeAFWQ/640?wx_fmt=jpeg "")  
          
  
**声明**  
  
本安全公告仅用来描述可能存在的安全问题，绿盟科技不为此安全公告提供任何保证或承诺。由于传播、利用此安全公告所提供的信息而造成的任何直接或者间接的后果及损失，均由使用者本人负责，绿盟科技以及安全公告作者不为此承担任何责任。              
  
绿盟科技拥有对此安全公告的修改和解释权。如欲转载或传播此安全公告，必须保证此安全公告的完整性，包括版权声明等全部内容。未经绿盟科技允许，不得任意修改或者增减此安全公告内容，不得以任何方式将其用于商业目的。              
  
![](https://mmbiz.qpic.cn/mmbiz_jpg/qR4ORTNELImFwJM2rh6GKbnrurdFA28jib7icfic0lJJHh3eLRpIXiaia08KqOSEibBsz64vlOH9aqicu3lmjccEeAFWQ/640?wx_fmt=jpeg "")  
  
  
**绿盟科技CERT**  
****  
∣  
微信公众号  
  
![](https://mmbiz.qpic.cn/mmbiz_jpg/VvfsuOanecpJN0Tw7vqLGQBshAM0NFOG5vdGKh9LcjUjAOK1W92OJnK5UzqGibmOPia0fZEyNK5qCbssBvOHKw7A/640?wx_fmt=jpeg "绿盟科技CERT公众号.jpg")  
  
![](https://mmbiz.qpic.cn/mmbiz/Hu8hctxHqSW0nSJn8p8OHVEQwHicSwTibFJMBE650AxdzfISoeY8woe2QsgCINIBrccBOOUft2HuU0GsNQWibSG7g/640?wx_fmt=png "")  
  
长按识别二维码，关注网络安全威胁信息  
  
  
