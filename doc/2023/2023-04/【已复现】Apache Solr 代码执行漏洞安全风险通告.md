#  【已复现】Apache Solr 代码执行漏洞安全风险通告   
原创 QAX CERT  奇安信 CERT   2023-04-15 20:38  
  
![](https://mmbiz.qpic.cn/mmbiz_png/EkibxOB3fs4icrhoWdKnhTgicSjB9pXdeZwDibNIBAEMegibEdG1vrjOibsq887TUz3ztMkM6Qvibic7r26sqbUIbicOMYg/640?wx_fmt=png "https://image.ipaiban.com/upload-ueditor-image-20201112-1605175807303084927.png")  
  
奇安信CERT  
  
**致力于**  
第一时间  
为企业级用户提供  
**权威**  
漏洞情报和  
**有效**  
解决方案。  
  
**（注：奇安信CERT的漏洞深度分析报告包含此漏洞的POC及技术细节，订阅方式见文末。）**  
  
**安全通告**  
  
  
  
Apache Solr是一个开源搜索服务引擎，Solr 使用 Java 语言开发，主要基于 HTTP 和 Apache Lucene 实现。  
  
  
近日，奇安信CERT监测到**Apache Solr 代码执行漏洞**，Apache Solr 默认配置下存在服务端请求伪造漏洞，当Solr以cloud模式启动且可出网时，远程攻击者可利用此漏洞在目标系统上执行任意代码。  
**鉴于该漏洞影响范围较大，建议客户尽快做好自查及防护。**  
  
****  
<table><tbody><tr style="height:25px;"><td style="border-color: rgb(221, 221, 221);" height="25" width="81"><p style="text-align:justify;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong>漏洞名称</strong></span></p></td><td colspan="3" style="border-color: rgb(221, 221, 221);border-left-width: initial;border-left-style: none;" height="25"><p style="text-align:justify;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">Apache Solr 代码执行漏洞</span></p></td></tr><tr style="height:25px;"><td style="border-color: rgb(221, 221, 221);border-top-width: initial;border-top-style: none;" height="25" width="102"><p style="text-align:justify;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong>公开时间</strong></span></p></td><td style="border-top: none rgb(221, 221, 221);border-left: none rgb(221, 221, 221);border-bottom-color: rgb(221, 221, 221);border-right-color: rgb(221, 221, 221);" height="25" width="130"><p style="text-align:justify;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">2021-03-24</span></p></td><td style="border-top: none rgb(221, 221, 221);border-left: none rgb(221, 221, 221);border-bottom-color: rgb(221, 221, 221);border-right-color: rgb(221, 221, 221);" height="25" width="129"><p style="text-align:justify;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong>更新时间</strong></span></p></td><td style="border-top: none rgb(221, 221, 221);border-left: none rgb(221, 221, 221);border-bottom-color: rgb(221, 221, 221);border-right-color: rgb(221, 221, 221);" height="25" width="153"><p style="text-align:justify;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">2023-04-15</span></p></td></tr><tr style="height:25px;"><td style="border-color: rgb(221, 221, 221);border-top-width: initial;border-top-style: none;" height="25" width="119"><p style="text-align:justify;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong>CVE</strong><strong>编号</strong></span></p></td><td style="border-top: none rgb(221, 221, 221);border-left: none rgb(221, 221, 221);border-bottom-color: rgb(221, 221, 221);border-right-color: rgb(221, 221, 221);" height="25" width="142"><span style="font-size: 14px;">暂无</span><br/></td><td style="border-top: none rgb(221, 221, 221);border-left: none rgb(221, 221, 221);border-bottom-color: rgb(221, 221, 221);border-right-color: rgb(221, 221, 221);" height="25" width="138"><p style="text-align:justify;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong>其他编号</strong></span></p></td><td style="border-top: none rgb(221, 221, 221);border-left: none rgb(221, 221, 221);border-bottom-color: rgb(221, 221, 221);border-right-color: rgb(221, 221, 221);" height="25" width="157"><p style="text-align:justify;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">QVD-2021-11381</span></p><p style="text-align:justify;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">CNVD-2023-27598</span></p></td></tr><tr style="height:25px;"><td style="border-color: rgb(221, 221, 221);border-top-width: initial;border-top-style: none;" height="25" width="127"><p style="text-align:justify;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong>威胁类型</strong></span></p></td><td style="border-top: none rgb(221, 221, 221);border-left: none rgb(221, 221, 221);border-bottom-color: rgb(221, 221, 221);border-right-color: rgb(221, 221, 221);" height="25" width="145"><p style="text-align:justify;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">代码执行</span></p></td><td style="border-top: none rgb(221, 221, 221);border-left: none rgb(221, 221, 221);border-bottom-color: rgb(221, 221, 221);border-right-color: rgb(221, 221, 221);" height="25" width="141"><p style="text-align:justify;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong>技术类型</strong></span></p></td><td style="border-top: none rgb(221, 221, 221);border-left: none rgb(221, 221, 221);border-bottom-color: rgb(221, 221, 221);border-right-color: rgb(221, 221, 221);" height="25" width="157"><p style="text-align:justify;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">服务端伪造请求</span></p></td></tr><tr style="height:25px;"><td style="border-color: rgb(221, 221, 221);border-top-width: initial;border-top-style: none;" height="25" width="131"><p style="text-align:justify;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong>厂商</strong></span></p></td><td style="border-top: none rgb(221, 221, 221);border-left: none rgb(221, 221, 221);border-bottom-color: rgb(221, 221, 221);border-right-color: rgb(221, 221, 221);" height="25" width="146"><p style="text-align:justify;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">Apache</span></p></td><td style="border-top: none rgb(221, 221, 221);border-left: none rgb(221, 221, 221);border-bottom-color: rgb(221, 221, 221);border-right-color: rgb(221, 221, 221);" height="25" width="142"><p style="text-align:justify;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong>产品</strong></span></p></td><td style="border-top: none rgb(221, 221, 221);border-left: none rgb(221, 221, 221);border-bottom-color: rgb(221, 221, 221);border-right-color: rgb(221, 221, 221);" height="25" width="155"><p style="text-align:justify;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">Solr</span></p></td></tr><tr style="height:25px;"><td colspan="4" style="border-color: rgb(221, 221, 221);border-top-width: initial;border-top-style: none;" height="25"><p style="text-align:center;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong>风险等级</strong></span></p></td></tr><tr style="height:25px;"><td colspan="2" style="border-color: rgb(221, 221, 221);border-top-width: initial;border-top-style: none;" height="25"><p style="text-align:center;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong>奇安信</strong><strong>CERT</strong><strong>风险评级</strong></span></p></td><td colspan="2" style="border-top: none rgb(221, 221, 221);border-left: none rgb(221, 221, 221);border-bottom-color: rgb(221, 221, 221);border-right-color: rgb(221, 221, 221);" height="25"><p style="text-align:center;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong>风险等级</strong></span></p></td></tr><tr style="height:25px;"><td colspan="2" style="border-color: rgb(221, 221, 221);border-top-width: initial;border-top-style: none;" height="25"><p style="text-align:center;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong><span style="color: red;">高危</span></strong></span></p></td><td colspan="2" style="border-top: none rgb(221, 221, 221);border-left: none rgb(221, 221, 221);border-bottom-color: rgb(221, 221, 221);border-right-color: rgb(221, 221, 221);" height="25"><p style="text-align:center;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong><span style="color: rgb(0, 112, 192);">蓝色（一般事件）</span></strong></span></p></td></tr><tr style="height:25px;"><td colspan="4" style="border-color: rgb(221, 221, 221);border-top-width: initial;border-top-style: none;" height="25"><p style="text-align:center;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong>现时威胁状态</strong></span></p></td></tr><tr style="height:25px;"><td style="border-color: rgb(221, 221, 221);border-top-width: initial;border-top-style: none;" height="25" width="133"><p style="text-align:center;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong>POC</strong><strong>状态</strong></span></p></td><td style="border-top: none rgb(221, 221, 221);border-left: none rgb(221, 221, 221);border-bottom-color: rgb(221, 221, 221);border-right-color: rgb(221, 221, 221);" height="25" width="146"><p style="text-align:center;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong>EXP</strong><strong>状态</strong></span></p></td><td style="border-top: none rgb(221, 221, 221);border-left: none rgb(221, 221, 221);border-bottom-color: rgb(221, 221, 221);border-right-color: rgb(221, 221, 221);" height="25" width="142"><p style="text-align:center;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong>在野利用状态</strong></span></p></td><td style="border-top: none rgb(221, 221, 221);border-left: none rgb(221, 221, 221);border-bottom-color: rgb(221, 221, 221);border-right-color: rgb(221, 221, 221);" height="25" width="155"><p style="text-align:center;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong>技术细节状态</strong></span></p></td></tr><tr style="height:25px;"><td style="border-color: rgb(221, 221, 221);border-top-width: initial;border-top-style: none;" height="25" width="135"><p style="text-align:center;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">未发现</span></p></td><td style="border-top: none rgb(221, 221, 221);border-left: none rgb(221, 221, 221);border-bottom-color: rgb(221, 221, 221);border-right-color: rgb(221, 221, 221);" height="25" width="145"><p style="text-align:center;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">未发现</span></p></td><td style="border-top: none rgb(221, 221, 221);border-left: none rgb(221, 221, 221);border-bottom-color: rgb(221, 221, 221);border-right-color: rgb(221, 221, 221);" height="25" width="142"><p style="text-align:center;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">未发现</span></p></td><td style="border-top: none rgb(221, 221, 221);border-left: none rgb(221, 221, 221);border-bottom-color: rgb(221, 221, 221);border-right-color: rgb(221, 221, 221);" height="25" width="154"><p style="text-align:center;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong><span style="color: red;">已公开</span></strong></span></p></td></tr><tr style="height:75px;"><td style="border-color: rgb(221, 221, 221);border-top-width: initial;border-top-style: none;" height="75" width="136"><p style="text-align:justify;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong>漏洞描述</strong></span></p></td><td colspan="3" style="border-top: none rgb(221, 221, 221);border-left: none rgb(221, 221, 221);border-bottom-color: rgb(221, 221, 221);border-right-color: rgb(221, 221, 221);" height="75"><p style="text-align:justify;margin-bottom: 8px;line-height: 150%;"><span style="line-height: 150%;font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">Apache Solr 默认配置下存在服务端请求伪造漏洞，当Solr以cloud模式启动且可出网时，远程攻击者可利用此漏洞在目标系统上执行任意代码。</span></p></td></tr><tr style="height:75px;"><td style="border-color: rgb(221, 221, 221);border-top-width: initial;border-top-style: none;" height="75" width="137"><p style="text-align:justify;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong>影响版本</strong></span></p></td><td colspan="3" style="border-top: none rgb(221, 221, 221);border-left: none rgb(221, 221, 221);border-bottom-color: rgb(221, 221, 221);border-right-color: rgb(221, 221, 221);" height="75"><p style="text-align:justify;margin-top: 8px;margin-bottom: 8px;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">8.10.0 &lt;= Apache Solr &lt; 9.2.0</span></p></td></tr><tr style="height:75px;"><td style="border-color: rgb(221, 221, 221);border-top-width: initial;border-top-style: none;" height="75" width="137"><p style="text-align:justify;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong>不受影响版本</strong></span></p></td><td colspan="3" style="border-top: none rgb(221, 221, 221);border-left: none rgb(221, 221, 221);border-bottom-color: rgb(221, 221, 221);border-right-color: rgb(221, 221, 221);" height="75"><p style="text-align:justify;margin-top: 8px;margin-bottom: 8px;"><span style="font-size: 14px;">A</span><span style="font-size: 14px;">pache Solr &gt;= 9.2.0</span></p><p><span style="font-size: 14px;">Apache Solr &lt; 8.10.0</span></p></td></tr><tr style="height:75px;"><td style="border-color: rgb(221, 221, 221);border-top-width: initial;border-top-style: none;" height="75" width="137"><p style="text-align:justify;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong>其他受影响组件</strong></span></p></td><td colspan="3" style="border-top: none rgb(221, 221, 221);border-left: none rgb(221, 221, 221);border-bottom-color: rgb(221, 221, 221);border-right-color: rgb(221, 221, 221);" height="75"><p style="text-align:justify;margin-top: 8px;margin-bottom: 8px;line-height: 150%;"><span style="line-height: 150%;font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">无</span></p></td></tr></tbody></table>  
  
奇安信CERT已成功复现该漏洞，截图如下：  
  
  
![](https://mmbiz.qpic.cn/mmbiz_png/EkibxOB3fs48rialoC9A3J3pv59Lnur1TBNvGDj6wwic6ZkXTv7VibfurI408pVwXavsj9ZHZoAjwxxP5p5BasWD1w/640?wx_fmt=png "")  
  
  
  
威胁评估  
  
<table><tbody><tr style="height:25px;"><td style="border-color: rgb(221, 221, 221);" height="25" width="73"><p style="text-align:justify;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong>漏洞名称</strong></span></p></td><td colspan="4" style="border-color: rgb(221, 221, 221);border-left-width: initial;border-left-style: none;" height="25" width="464"><p style="text-align:center;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">Apache Solr 代码执行漏洞</span></p></td></tr><tr style="height:25px;"><td style="border-color: rgb(221, 221, 221);border-top-width: initial;border-top-style: none;" height="25" width="73"><p style="text-align:justify;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong>CVE</strong><strong>编号</strong></span></p></td><td style="border-top: none rgb(221, 221, 221);border-left: none rgb(221, 221, 221);border-bottom-color: rgb(221, 221, 221);border-right-color: rgb(221, 221, 221);" height="25" width="77"><p style="text-align:center;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">暂无</span></p></td><td colspan="2" style="border-top: none rgb(221, 221, 221);border-left: none rgb(221, 221, 221);border-bottom-color: rgb(221, 221, 221);border-right-color: rgb(221, 221, 221);" height="25" width="216"><p style="text-align:justify;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong>其他编号</strong></span></p></td><td style="border-top: none rgb(221, 221, 221);border-left: none rgb(221, 221, 221);border-bottom-color: rgb(221, 221, 221);border-right-color: rgb(221, 221, 221);" height="25" width="118"><p style="text-align:center;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">QVD-2021-11381</span></p></td></tr><tr style="height:25px;"><td style="border-color: rgb(221, 221, 221);border-top-width: initial;border-top-style: none;" height="25" width="71"><p style="text-align:justify;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong>CVSS 3.1</strong><strong>评级</strong></span></p></td><td style="border-top: none rgb(221, 221, 221);border-left: none rgb(221, 221, 221);border-bottom-color: rgb(221, 221, 221);border-right-color: rgb(221, 221, 221);" height="25" width="77"><p style="text-align:center;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong><span style="color: red;">高危</span></strong></span></p></td><td colspan="2" style="border-top: none rgb(221, 221, 221);border-left: none rgb(221, 221, 221);border-bottom-color: rgb(221, 221, 221);border-right-color: rgb(221, 221, 221);" height="25" width="225"><p style="text-align:justify;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong>CVSS 3.1</strong><strong>分数</strong></span></p></td><td style="border-top: none rgb(221, 221, 221);border-left: none rgb(221, 221, 221);border-bottom-color: rgb(221, 221, 221);border-right-color: rgb(221, 221, 221);word-break: break-all;" height="25" width="118"><p style="text-align:center;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong>8.6</strong></span></p></td></tr><tr style="height:25px;"><td rowspan="8" style="border-color: rgb(221, 221, 221);border-top-width: initial;border-top-style: none;" height="25" width="73"><p style="text-align:justify;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong>CVSS</strong><strong>向量</strong></span></p></td><td colspan="2" style="border-top: none rgb(221, 221, 221);border-left: none rgb(221, 221, 221);border-bottom-color: rgb(221, 221, 221);border-right-color: rgb(221, 221, 221);" height="25" width="261"><p style="text-align:center;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong>访问途径（</strong><strong>AV</strong><strong>）</strong></span></p></td><td colspan="2" style="border-top: none rgb(221, 221, 221);border-left: none rgb(221, 221, 221);border-bottom-color: rgb(221, 221, 221);border-right-color: rgb(221, 221, 221);" height="25"><p style="text-align:center;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong>攻击复杂度（</strong><strong>AC</strong><strong>）</strong></span></p></td></tr><tr style="height:25px;"><td colspan="2" style="border-top: none rgb(221, 221, 221);border-left: none rgb(221, 221, 221);border-bottom-color: rgb(221, 221, 221);border-right-color: rgb(221, 221, 221);" height="25" width="249"><p style="text-align:center;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">网络</span></p></td><td colspan="2" style="border-top: none rgb(221, 221, 221);border-left: none rgb(221, 221, 221);border-bottom-color: rgb(221, 221, 221);border-right-color: rgb(221, 221, 221);" height="25" width="216"><p style="text-align:center;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">低</span></p></td></tr><tr style="height:25px;"><td colspan="2" style="border-top: none rgb(221, 221, 221);border-left: none rgb(221, 221, 221);border-bottom-color: rgb(221, 221, 221);border-right-color: rgb(221, 221, 221);" height="25" width="249"><p style="text-align:center;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong>用户认证（</strong><strong>Au</strong><strong>）</strong></span></p></td><td colspan="2" style="border-top: none rgb(221, 221, 221);border-left: none rgb(221, 221, 221);border-bottom-color: rgb(221, 221, 221);border-right-color: rgb(221, 221, 221);" height="25" width="216"><p style="text-align:center;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong>用户交互（</strong><strong>UI</strong><strong>）</strong></span></p></td></tr><tr style="height:25px;"><td colspan="2" style="border-top: none rgb(221, 221, 221);border-left: none rgb(221, 221, 221);border-bottom-color: rgb(221, 221, 221);border-right-color: rgb(221, 221, 221);" height="25" width="249"><p style="text-align:center;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">无</span></p></td><td colspan="2" style="border-top: none rgb(221, 221, 221);border-left: none rgb(221, 221, 221);border-bottom-color: rgb(221, 221, 221);border-right-color: rgb(221, 221, 221);" height="25" width="216"><p style="text-align:center;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">不需要</span></p></td></tr><tr style="height:25px;"><td colspan="2" style="border-top: none rgb(221, 221, 221);border-left: none rgb(221, 221, 221);border-bottom-color: rgb(221, 221, 221);border-right-color: rgb(221, 221, 221);" height="25" width="249"><p style="text-align:center;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong>影响范围（</strong><strong>S</strong><strong>）</strong></span></p></td><td colspan="2" style="border-top: none rgb(221, 221, 221);border-left: none rgb(221, 221, 221);border-bottom-color: rgb(221, 221, 221);border-right-color: rgb(221, 221, 221);" height="25" width="216"><p style="text-align:center;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong>机密性影响（</strong><strong>C</strong><strong>）</strong></span></p></td></tr><tr style="height:25px;"><td colspan="2" style="border-top: none rgb(221, 221, 221);border-left: none rgb(221, 221, 221);border-bottom-color: rgb(221, 221, 221);border-right-color: rgb(221, 221, 221);" height="25" width="249"><p style="text-align:center;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">不改变</span></p></td><td colspan="2" style="border-top: none rgb(221, 221, 221);border-left: none rgb(221, 221, 221);border-bottom-color: rgb(221, 221, 221);border-right-color: rgb(221, 221, 221);" height="25" width="216"><p style="text-align:center;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">高</span></p></td></tr><tr style="height:25px;"><td colspan="2" style="border-top: none rgb(221, 221, 221);border-left: none rgb(221, 221, 221);border-bottom-color: rgb(221, 221, 221);border-right-color: rgb(221, 221, 221);" height="25" width="249"><p style="text-align:center;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong>完整性影响（</strong><strong>I</strong><strong>）</strong></span></p></td><td colspan="2" style="border-top: none rgb(221, 221, 221);border-left: none rgb(221, 221, 221);border-bottom-color: rgb(221, 221, 221);border-right-color: rgb(221, 221, 221);" height="25" width="216"><p style="text-align:center;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong>可用性影响（</strong><strong>A</strong><strong>）</strong></span></p></td></tr><tr style="height:25px;"><td colspan="2" style="border-top: none rgb(221, 221, 221);border-left: none rgb(221, 221, 221);border-bottom-color: rgb(221, 221, 221);border-right-color: rgb(221, 221, 221);word-break: break-all;" height="25" width="249"><p style="text-align:center;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">低</span></p></td><td colspan="2" style="border-top: none rgb(221, 221, 221);border-left: none rgb(221, 221, 221);border-bottom-color: rgb(221, 221, 221);border-right-color: rgb(221, 221, 221);" height="25" width="216"><p style="text-align:center;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">低</span></p></td></tr><tr style="height:75px;"><td style="border-color: rgb(221, 221, 221);border-top-width: initial;border-top-style: none;" height="75" width="73"><p style="text-align:justify;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong>危害描述</strong></span></p></td><td colspan="4" style="border-top: none rgb(221, 221, 221);border-left: none rgb(221, 221, 221);border-bottom-color: rgb(221, 221, 221);border-right-color: rgb(221, 221, 221);word-break: break-all;" height="75" width="463"><p style="text-align:justify;margin-top: 8px;margin-bottom: 8px;line-height: 150%;"><span style="line-height: 150%;font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">当Solr以cloud模式启动且可出网时，远程攻击者可利用此漏洞在目标系统上执行任意代码。</span></p></td></tr></tbody></table>  
  
处置建议  
  
目前官方已发布安全更新，受影响用户可以更新到 Apache Solr  9.2.0 及以上版本。  
  
不要将Apache Solr开放在公网或配置Solr身份校验。  
  
配置Solr身份校验：在security.json启用身份验证插件，代码示例：  
  
```
{
  "authentication" : {
"class": "class.that.implements.authentication"
  },
  "authorization": {
    "class": "class.that.implements.authorization"
  }
}
```  
  
  
在SolrCloud模式下需要将security.json上传到ZooKeeper。以下命令在上传文件时将其写入文件：  
```
>server/scripts/cloud-scripts/zkcli.sh -zkhost localhost:2181 -cmd put /security.json '{"authentication":{"class":"org.apache.Solr.security.KerberosPlugin"}}'
```  
  
  
在独立模式下需要创建security.json并将其放在$SOLR_HOME安装目录中。  
  
参考链接：https://Solr.apache.org/guide/6_6/authentication-and-authorization-plugins.html  
  
  
产品解决方案  
  
**奇安信网站应用安全云防护系统已更新防护特征库**  
  
奇安信网神网站应用安全云防护系统已全面支持对Apache Solr 代码执行漏洞 (CNVD-2023-27598)的防护。  
  
  
参考资料  
  
[1]  
https://blog.noah.360.net/apache-Solr-rce/  
  
[2]https://Solr.apache.org/guide/6_6/authentication-and-authorization-plugins.html  
  
  
时间线  
  
2023年4月15日，  
奇安信 CERT发布安全风险通告。  
  
  
点击**阅读原文**  
  
到奇安信NOX-安全监测平台查询更多漏洞详情  
  
  
  
![](https://mmbiz.qpic.cn/mmbiz_png/EkibxOB3fs4ibkA8uV41iamOvDUH54YoYa7apy12rWyWNciaaVJCSSzwI1tIficJBsdPWicLU9V25nsIDKaMicyBausRA/640?wx_fmt=png "")  
  
深度分析报告（含PoC和技术细节）已开通订阅  
  
↓ ↓ ↓ 向下滑动图片扫码申请↓ ↓ ↓  
  
