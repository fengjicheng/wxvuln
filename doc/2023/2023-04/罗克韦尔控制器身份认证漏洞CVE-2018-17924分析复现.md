#  罗克韦尔控制器身份认证漏洞CVE-2018-17924分析复现   
 网络安全应急技术国家工程中心   2023-04-21 15:15  
  
Rockwell Automation是全球最大的自动化和信息化公司之一，拥有众多的产品，涵盖高级过程控制、变频器、运动控制、HMI、马达控制中心、分布式控制系统、可编程控制器等。  
  
**Part1 漏洞状态**  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/iaz5iaQYxGogsSQzLBmbC3ibr40KH9pEELIUw3zuH0dqrNx6woHq29NPmiaHPEibhqBeRXkHX6tPKiaWPWhzNvFjibVVA/640?wx_fmt=other "")  
  
  
**Part2 漏洞描述**  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/iaz5iaQYxGogsSQzLBmbC3ibr40KH9pEELIVTaI5ibnvXGT3A6Aicoicw6omb9PdyypXM5icichtnrO6N3Cib8BAZv9LgNg/640?wx_fmt=jpeg "")  
  
****  
**测试设备: AB1756**  
  
**Part3 漏洞分析**  
  
AB PLC使用ENIP协议通信，未判断数据来源，分析RS linx与PLC通信的数据包，确认只需要获取session后建立连接，便可向PLC发送修改IP的指令，使得PLC与现有设备的连接断开。  
  
![](https://mmbiz.qpic.cn/mmbiz_jpg/ll2PVky3MmaHcE0t73DWXBtG0kP8NeX0Vw4341IBAmcxzGyLyKasTz3uhibPyb5EdzyB6jQgRiciaThuia3IqJZmhA/640?wx_fmt=jpeg&tp=wxpic&wxfrom=5&wx_lazy=1&wx_co=1 "")  
  
构  
建POC  
  
先使用命令码0x65，注册session，并将返回的session拼接到修改IP的命令内，即可完成远程修改IP的行为。  
  
![](https://mmbiz.qpic.cn/mmbiz_jpg/ll2PVky3MmaHcE0t73DWXBtG0kP8NeX0SKlMHJOQ8GVOQOibhmmlBGdeVziaE9o5Mwz1ibZCFcaQSG45RJMmc5O6w/640?wx_fmt=jpeg&tp=wxpic&wxfrom=5&wx_lazy=1&wx_co=1 "")  
  
  
![](https://mmbiz.qpic.cn/mmbiz_jpg/ll2PVky3MmbRB9PpsHAOWic4iaQ415ibTvNwWzWqoSLZAtcbhKh2EcAibXrtL1icq7NPamNxC6W1ibmTVbZib3lcjQKRg/640?wx_fmt=jpeg&tp=wxpic&wxfrom=5&wx_lazy=1&wx_co=1 "")  
  
![](https://mmbiz.qpic.cn/mmbiz_jpg/ll2PVky3MmaHcE0t73DWXBtG0kP8NeX08cdialvw8EEZsukwUVn7nhI7Q9MoLcTnewRibxfUBur09uYyBvhajcHA/640?wx_fmt=jpeg&tp=wxpic&wxfrom=5&wx_lazy=1&wx_co=1 "")  
  
![](https://mmbiz.qpic.cn/mmbiz_jpg/ll2PVky3MmaHcE0t73DWXBtG0kP8NeX0HicmThnlLQwibz5lOSWKHIoNFMWcgQ4iaqKibGZPWsnmMiayLXhYdjCq6BA/640?wx_fmt=jpeg&tp=wxpic&wxfrom=5&wx_lazy=1&wx_co=1 "")  
- ## 验证  
  
修改之前PLC IP为192.168.1.44  
  
![](https://mmbiz.qpic.cn/mmbiz_jpg/ll2PVky3MmaHcE0t73DWXBtG0kP8NeX0Yf9etc0X7KcScBQGqcvmv7ugM8jDmuX8nN5efVIKyvvEhJnWib9feqQ/640?wx_fmt=jpeg&tp=wxpic&wxfrom=5&wx_lazy=1&wx_co=1 "")  
  
![](https://mmbiz.qpic.cn/mmbiz_jpg/ll2PVky3MmaHcE0t73DWXBtG0kP8NeX00R0YOzg8CgGWwOwGWcyfriaxX9expia5RaAmOiaqxvXa9LjTtQSqqWg0w/640?wx_fmt=jpeg&tp=wxpic&wxfrom=5&wx_lazy=1&wx_co=1 "")  
  
运行POC，可以到看PLC 的IP 已经修改为192.168.1.144  
  
![](https://mmbiz.qpic.cn/mmbiz_jpg/ll2PVky3MmaHcE0t73DWXBtG0kP8NeX0pG3VVtkmjJ4DZmaNlUywCFOYexmlrYicJg4xE5PJabv6pSUdo38OPEA/640?wx_fmt=jpeg&tp=wxpic&wxfrom=5&wx_lazy=1&wx_co=1 "")  
  
![](https://mmbiz.qpic.cn/mmbiz_jpg/ll2PVky3MmaHcE0t73DWXBtG0kP8NeX0Z3hbyNJvXxf8hxbxLIlbJyddicFPIfiaUGXfvNC6LoJteT3QM299LT5Q/640?wx_fmt=jpeg&tp=wxpic&wxfrom=5&wx_lazy=1&wx_co=1 "")  
  
![](https://mmbiz.qpic.cn/mmbiz_jpg/ll2PVky3MmaHcE0t73DWXBtG0kP8NeX0S1eXRt1BXhjAIpNCxGFvFgTEwwWiacQRRQziadObJZCek7QcUg9hfT0w/640?wx_fmt=jpeg&tp=wxpic&wxfrom=5&wx_lazy=1&wx_co=1 "")  
  
**Part4 修复建议**  
  
厂家已发布修复漏洞的补丁和固件，尽快升级到最新版本。  
  
  
  
原文来源：安帝Andisec  
  
“投稿联系方式：孙中豪 010-82992251   sunzhonghao@cert.org.cn”  
  
![](https://mmbiz.qpic.cn/mmbiz_jpg/GoUrACT176n1NvL0JsVSB8lNDX2FCGZjW0HGfDVnFao65ic4fx6Rv4qylYEAbia4AU3V2Zz801UlicBcLeZ6gS6tg/640?wx_fmt=jpeg "")  
  
  
