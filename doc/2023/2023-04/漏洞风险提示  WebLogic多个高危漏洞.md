#  漏洞风险提示 | WebLogic多个高危漏洞   
 长亭安全应急响应中心   2023-04-20 11:45  
  
        长亭漏洞风险提示         
  
# WebLogic多个高危漏洞  
  
  
Oracle 官方在 4 月 19 日发布了重要补丁更新 CPU（Critical Patch Update），其中修复了存在于 Oracle WebLogic Server 中的多个高危漏洞：https://www.oracle.com/security-alerts/cpuapr2023.html  
**漏洞描述**  
  
<table><tbody><tr><td width="154" valign="top" style="border-width: 1pt;border-color: white;padding: 0cm 5.4pt;"><p style="margin: 0cm 0cm 12pt;font-size: 12pt;font-family: 宋体;"><span style="font-size: 15px;color: rgb(255, 255, 255);">CVE编号<o:p></o:p></span></p></td><td width="146" valign="top" style="border-top-width: 1pt;border-top-color: white;border-right-width: 1pt;border-right-color: white;border-bottom-width: 1pt;border-bottom-color: white;border-left: none;padding: 0cm 5.4pt;"><p style="margin: 0cm 0cm 12pt;font-size: 12pt;font-family: 宋体;"><span style="font-size: 15px;color: rgb(255, 255, 255);">影响组件</span><o:p></o:p></p></td><td width="74" valign="top" style="border-top-width: 1pt;border-top-color: white;border-right-width: 1pt;border-right-color: white;border-bottom-width: 1pt;border-bottom-color: white;border-left: none;padding: 0cm 5.4pt;"><p style="margin: 0cm 0cm 12pt;font-size: 12pt;font-family: 宋体;"><span style="font-size: 15px;color: rgb(255, 255, 255);">协议</span><o:p></o:p></p></td><td width="78" valign="top" style="border-top-width: 1pt;border-top-color: white;border-right-width: 1pt;border-right-color: white;border-bottom-width: 1pt;border-bottom-color: white;border-left: none;padding: 0cm 5.4pt;"><p style="margin: 0cm 0cm 12pt;font-size: 12pt;font-family: 宋体;"><span style="font-size: 15px;color: rgb(255, 255, 255);">CVSS评分<o:p></o:p></span></p></td></tr><tr><td width="154" valign="top" style="border-right-width: 1pt;border-right-color: white;border-bottom-width: 1pt;border-bottom-color: white;border-left-width: 1pt;border-left-color: white;border-top: none;padding: 0cm 5.4pt;"><p style="margin: 0cm 0cm 12pt;font-size: 12pt;font-family: 宋体;"><span style="font-size: 15px;color: rgb(255, 255, 255);">CVE-2023-21996<o:p></o:p></span></p></td><td width="146" valign="top" style="border-top: none;border-left: none;border-bottom-width: 1pt;border-bottom-color: white;border-right-width: 1pt;border-right-color: white;padding: 0cm 5.4pt;"><p style="margin: 0cm 0cm 12pt;font-size: 12pt;font-family: 宋体;"><span style="font-size: 15px;color: rgb(255, 255, 255);">Web Services</span><o:p></o:p></p></td><td width="80" valign="top" style="border-top: none;border-left: none;border-bottom-width: 1pt;border-bottom-color: white;border-right-width: 1pt;border-right-color: white;padding: 0cm 5.4pt;"><p style="margin: 0cm 0cm 12pt;font-size: 12pt;font-family: 宋体;"><span style="font-size: 15px;color: rgb(255, 255, 255);">HTTP</span><o:p></o:p></p></td><td width="78" valign="top" style="border-top: none;border-left: none;border-bottom-width: 1pt;border-bottom-color: white;border-right-width: 1pt;border-right-color: white;padding: 0cm 5.4pt;"><p style="margin: 0cm 0cm 12pt;font-size: 12pt;font-family: 宋体;"><span style="font-size: 15px;color: rgb(255, 255, 255);">7.5<o:p></o:p></span></p></td></tr><tr><td width="154" valign="top" style="border-right-width: 1pt;border-right-color: white;border-bottom-width: 1pt;border-bottom-color: white;border-left-width: 1pt;border-left-color: white;border-top: none;padding: 0cm 5.4pt;"><p style="margin: 0cm 0cm 12pt;font-size: 12pt;font-family: 宋体;"><span style="font-size: 15px;color: rgb(255, 255, 255);">CVE-2023-21931<o:p></o:p></span></p></td><td width="146" valign="top" style="border-top: none;border-left: none;border-bottom-width: 1pt;border-bottom-color: white;border-right-width: 1pt;border-right-color: white;padding: 0cm 5.4pt;"><p style="margin: 0cm 0cm 12pt;font-size: 12pt;font-family: 宋体;"><span style="font-size: 15px;color: rgb(255, 255, 255);">Core</span><o:p></o:p></p></td><td width="80" valign="top" style="border-top: none;border-left: none;border-bottom-width: 1pt;border-bottom-color: white;border-right-width: 1pt;border-right-color: white;padding: 0cm 5.4pt;"><p style="margin: 0cm 0cm 12pt;font-size: 12pt;font-family: 宋体;"><span style="font-size: 15px;color: rgb(255, 255, 255);">T3</span><o:p></o:p></p></td><td width="78" valign="top" style="border-top: none;border-left: none;border-bottom-width: 1pt;border-bottom-color: white;border-right-width: 1pt;border-right-color: white;padding: 0cm 5.4pt;"><p style="margin: 0cm 0cm 12pt;font-size: 12pt;font-family: 宋体;"><span style="font-size: 15px;color: rgb(255, 255, 255);">7.5<o:p></o:p></span></p></td></tr><tr><td width="154" valign="top" style="border-right-width: 1pt;border-right-color: white;border-bottom-width: 1pt;border-bottom-color: white;border-left-width: 1pt;border-left-color: white;border-top: none;padding: 0cm 5.4pt;"><p style="margin: 0cm 0cm 12pt;font-size: 12pt;font-family: 宋体;"><span style="font-size: 15px;color: rgb(255, 255, 255);">CVE-2023-21964<o:p></o:p></span></p></td><td width="146" valign="top" style="border-top: none;border-left: none;border-bottom-width: 1pt;border-bottom-color: white;border-right-width: 1pt;border-right-color: white;padding: 0cm 5.4pt;"><p style="margin: 0cm 0cm 12pt;font-size: 12pt;font-family: 宋体;"><span style="font-size: 15px;color: rgb(255, 255, 255);">Core</span><o:p></o:p></p></td><td width="80" valign="top" style="border-top: none;border-left: none;border-bottom-width: 1pt;border-bottom-color: white;border-right-width: 1pt;border-right-color: white;padding: 0cm 5.4pt;"><p style="margin: 0cm 0cm 12pt;font-size: 12pt;font-family: 宋体;"><span style="font-size: 15px;color: rgb(255, 255, 255);">T3</span><o:p></o:p></p></td><td width="78" valign="top" style="border-top: none;border-left: none;border-bottom-width: 1pt;border-bottom-color: white;border-right-width: 1pt;border-right-color: white;padding: 0cm 5.4pt;"><p style="margin: 0cm 0cm 12pt;font-size: 12pt;font-family: 宋体;"><span style="font-size: 15px;color: rgb(255, 255, 255);">7.5<o:p></o:p></span></p></td></tr><tr><td width="154" valign="top" style="border-right-width: 1pt;border-right-color: white;border-bottom-width: 1pt;border-bottom-color: white;border-left-width: 1pt;border-left-color: white;border-top: none;padding: 0cm 5.4pt;"><p style="margin: 0cm 0cm 12pt;font-size: 12pt;font-family: 宋体;"><span style="font-size: 15px;color: rgb(255, 255, 255);">CVE-2023-21979<o:p></o:p></span></p></td><td width="146" valign="top" style="border-top: none;border-left: none;border-bottom-width: 1pt;border-bottom-color: white;border-right-width: 1pt;border-right-color: white;padding: 0cm 5.4pt;"><p style="margin: 0cm 0cm 12pt;font-size: 12pt;font-family: 宋体;"><span style="font-size: 15px;color: rgb(255, 255, 255);">Core</span><o:p></o:p></p></td><td width="80" valign="top" style="border-top: none;border-left: none;border-bottom-width: 1pt;border-bottom-color: white;border-right-width: 1pt;border-right-color: white;padding: 0cm 5.4pt;"><p style="margin: 0cm 0cm 12pt;font-size: 12pt;font-family: 宋体;"><span style="font-size: 15px;color: rgb(255, 255, 255);">T3</span><o:p></o:p></p></td><td width="78" valign="top" style="border-top: none;border-left: none;border-bottom-width: 1pt;border-bottom-color: white;border-right-width: 1pt;border-right-color: white;padding: 0cm 5.4pt;"><p style="margin: 0cm 0cm 12pt;font-size: 12pt;font-family: 宋体;"><span style="font-size: 15px;color: rgb(255, 255, 255);">7.5<o:p></o:p></span></p></td></tr><tr><td width="154" valign="top" style="border-right-width: 1pt;border-right-color: white;border-bottom-width: 1pt;border-bottom-color: white;border-left-width: 1pt;border-left-color: white;border-top: none;padding: 0cm 5.4pt;"><p style="margin: 0cm 0cm 12pt;font-size: 12pt;font-family: 宋体;"><span style="font-size: 15px;color: rgb(255, 255, 255);">CVE-2023-21956<o:p></o:p></span></p></td><td width="146" valign="top" style="border-top: none;border-left: none;border-bottom-width: 1pt;border-bottom-color: white;border-right-width: 1pt;border-right-color: white;padding: 0cm 5.4pt;"><p style="margin: 0cm 0cm 12pt;font-size: 12pt;font-family: 宋体;"><span style="font-size: 15px;color: rgb(255, 255, 255);">Web Container</span><o:p></o:p></p></td><td width="80" valign="top" style="border-top: none;border-left: none;border-bottom-width: 1pt;border-bottom-color: white;border-right-width: 1pt;border-right-color: white;padding: 0cm 5.4pt;"><p style="margin: 0cm 0cm 12pt;font-size: 12pt;font-family: 宋体;"><span style="font-size: 15px;color: rgb(255, 255, 255);">HTTP</span><o:p></o:p></p></td><td width="78" valign="top" style="border-top: none;border-left: none;border-bottom-width: 1pt;border-bottom-color: white;border-right-width: 1pt;border-right-color: white;padding: 0cm 5.4pt;"><p style="margin: 0cm 0cm 12pt;font-size: 12pt;font-family: 宋体;"><span style="font-size: 15px;color: rgb(255, 255, 255);">6.1<o:p></o:p></span></p></td></tr><tr><td width="154" valign="top" style="border-right-width: 1pt;border-right-color: white;border-bottom-width: 1pt;border-bottom-color: white;border-left-width: 1pt;border-left-color: white;border-top: none;padding: 0cm 5.4pt;"><p style="margin: 0cm 0cm 12pt;font-size: 12pt;font-family: 宋体;"><span style="font-size: 15px;color: rgb(255, 255, 255);">CVE-2023-21960<o:p></o:p></span></p></td><td width="146" valign="top" style="border-top: none;border-left: none;border-bottom-width: 1pt;border-bottom-color: white;border-right-width: 1pt;border-right-color: white;padding: 0cm 5.4pt;"><p style="margin: 0cm 0cm 12pt;font-size: 12pt;font-family: 宋体;"><span style="font-size: 15px;color: rgb(255, 255, 255);">Core</span><o:p></o:p></p></td><td width="80" valign="top" style="border-top: none;border-left: none;border-bottom-width: 1pt;border-bottom-color: white;border-right-width: 1pt;border-right-color: white;padding: 0cm 5.4pt;"><p style="margin: 0cm 0cm 12pt;font-size: 12pt;font-family: 宋体;"><span style="font-size: 15px;color: rgb(255, 255, 255);">HTTP</span><o:p></o:p></p></td><td width="78" valign="top" style="border-top: none;border-left: none;border-bottom-width: 1pt;border-bottom-color: white;border-right-width: 1pt;border-right-color: white;padding: 0cm 5.4pt;word-break: break-all;"><p style="margin: 0cm 0cm 12pt;font-size: 12pt;font-family: 宋体;"><span style="font-size: 15px;color: rgb(255, 255, 255);">5.6</span></p></td></tr></tbody></table>  
其中 CVE-2023-21931 和 CVE-2023-21979 为 WebLogic Server T3 和 IIOP 协议中的**高危漏洞（长亭科技技术人员已确认，这两个漏洞并非只影响官方公告里所描述的 T3 协议**），攻击者可在远程且未经授权的状态下通过 T3 / IIOP 协议交互利用此漏洞，在服务端执行任意恶意代码，获取系统权限。  
  
CVE-2023-21996为 WebLogic Web Services 组件中的漏洞，攻击者可在远程且未经授权的状态下通过 HTTP 协议交互利用这些漏洞。但目前相关漏洞均暂无任何公开细节。  
  
  
**影响范围**  
  
  
<table><tbody><tr><td width="149" valign="top" style="border-width: 1pt;border-color: white;padding: 0cm 5.4pt;"><p style="margin: 0cm 0cm 12pt;font-size: 12pt;font-family: 宋体;"><span style="font-size: 15px;color: rgb(255, 255, 255);">CVE编号<o:p></o:p></span></p></td><td width="342" valign="top" style="border-top-width: 1pt;border-top-color: white;border-right-width: 1pt;border-right-color: white;border-bottom-width: 1pt;border-bottom-color: white;border-left: none;padding: 0cm 5.4pt;"><p style="margin: 0cm 0cm 12pt;font-size: 12pt;font-family: 宋体;"><span style="font-size: 15px;color: rgb(255, 255, 255);">影响版本<o:p></o:p></span></p></td></tr><tr><td width="155" valign="top" style="border-right-width: 1pt;border-right-color: white;border-bottom-width: 1pt;border-bottom-color: white;border-left-width: 1pt;border-left-color: white;border-top: none;padding: 0cm 5.4pt;"><p style="margin: 0cm 0cm 12pt;font-size: 12pt;font-family: 宋体;"><span style="font-size: 15px;color: rgb(255, 255, 255);">CVE-2023-21996<o:p></o:p></span></p></td><td width="348" valign="top" style="border-top: none;border-left: none;border-bottom-width: 1pt;border-bottom-color: white;border-right-width: 1pt;border-right-color: white;padding: 0cm 5.4pt;"><p style="margin: 0cm 0cm 12pt;font-size: 12pt;font-family: 宋体;"><span style="font-size: 15px;color: rgb(255, 255, 255);">12.2.1.3.0, 12.2.1.4.0, 14.1.1.0.0<o:p></o:p></span></p></td></tr><tr><td width="155" valign="top" style="border-right-width: 1pt;border-right-color: white;border-bottom-width: 1pt;border-bottom-color: white;border-left-width: 1pt;border-left-color: white;border-top: none;padding: 0cm 5.4pt;"><p style="margin: 0cm 0cm 12pt;font-size: 12pt;font-family: 宋体;"><span style="font-size: 15px;color: rgb(255, 255, 255);">CVE-2023-21931<o:p></o:p></span></p></td><td width="348" valign="top" style="border-top: none;border-left: none;border-bottom-width: 1pt;border-bottom-color: white;border-right-width: 1pt;border-right-color: white;padding: 0cm 5.4pt;"><p style="margin: 0cm 0cm 12pt;font-size: 12pt;font-family: 宋体;"><span style="font-size: 15px;color: rgb(255, 255, 255);">12.2.1.3.0, 12.2.1.4.0, 14.1.1.0.0<o:p></o:p></span></p></td></tr><tr><td width="155" valign="top" style="border-right-width: 1pt;border-right-color: white;border-bottom-width: 1pt;border-bottom-color: white;border-left-width: 1pt;border-left-color: white;border-top: none;padding: 0cm 5.4pt;"><p style="margin: 0cm 0cm 12pt;font-size: 12pt;font-family: 宋体;"><span style="font-size: 15px;color: rgb(255, 255, 255);">CVE-2023-21964<o:p></o:p></span></p></td><td width="348" valign="top" style="border-top: none;border-left: none;border-bottom-width: 1pt;border-bottom-color: white;border-right-width: 1pt;border-right-color: white;padding: 0cm 5.4pt;"><p style="margin: 0cm 0cm 12pt;font-size: 12pt;font-family: 宋体;"><span style="font-size: 15px;color: rgb(255, 255, 255);">12.2.1.3.0, 12.2.1.4.0, 14.1.1.0.0<o:p></o:p></span></p></td></tr><tr><td width="155" valign="top" style="border-right-width: 1pt;border-right-color: white;border-bottom-width: 1pt;border-bottom-color: white;border-left-width: 1pt;border-left-color: white;border-top: none;padding: 0cm 5.4pt;"><p style="margin: 0cm 0cm 12pt;font-size: 12pt;font-family: 宋体;"><span style="font-size: 15px;color: rgb(255, 255, 255);">CVE-2023-21979<o:p></o:p></span></p></td><td width="348" valign="top" style="border-top: none;border-left: none;border-bottom-width: 1pt;border-bottom-color: white;border-right-width: 1pt;border-right-color: white;padding: 0cm 5.4pt;"><p style="margin: 0cm 0cm 12pt;font-size: 12pt;font-family: 宋体;"><span style="font-size: 15px;color: rgb(255, 255, 255);">12.2.1.3.0, 12.2.1.4.0, 14.1.1.0.0<o:p></o:p></span></p></td></tr><tr><td width="155" valign="top" style="border-right-width: 1pt;border-right-color: white;border-bottom-width: 1pt;border-bottom-color: white;border-left-width: 1pt;border-left-color: white;border-top: none;padding: 0cm 5.4pt;"><p style="margin: 0cm 0cm 12pt;font-size: 12pt;font-family: 宋体;"><span style="font-size: 15px;color: rgb(255, 255, 255);">CVE-2023-21956<o:p></o:p></span></p></td><td width="348" valign="top" style="border-top: none;border-left: none;border-bottom-width: 1pt;border-bottom-color: white;border-right-width: 1pt;border-right-color: white;padding: 0cm 5.4pt;"><p style="margin: 0cm 0cm 12pt;font-size: 12pt;font-family: 宋体;"><span style="font-size: 15px;color: rgb(255, 255, 255);">12.2.1.4.0, 14.1.1.0.0  <o:p></o:p></span></p></td></tr><tr><td width="155" valign="top" style="border-right-width: 1pt;border-right-color: white;border-bottom-width: 1pt;border-bottom-color: white;border-left-width: 1pt;border-left-color: white;border-top: none;padding: 0cm 5.4pt;"><p style="margin: 0cm 0cm 12pt;font-size: 12pt;font-family: 宋体;"><span style="font-size: 15px;color: rgb(255, 255, 255);">CVE-2023-21960<o:p></o:p></span></p></td><td width="348" valign="top" style="border-top: none;border-left: none;border-bottom-width: 1pt;border-bottom-color: white;border-right-width: 1pt;border-right-color: white;padding: 0cm 5.4pt;word-break: break-all;"><p style="margin: 0cm 0cm 12pt;font-size: 12pt;font-family: 宋体;"><span style="font-size: 15px;color: rgb(255, 255, 255);">12.2.1.3.0, 12.2.1.4.0<o:p></o:p></span></p></td></tr></tbody></table>  
  
  
**解决方案**  
  
  
使用 Oracle 官方安全补丁进行更新修复： https://www.oracle.com/security-alerts/cpuapr2023.html另外针对 CVE-2023-21931 和 CVE-2023-21979 这两个漏洞，用户还需要更新 Java 版本才能完全修复（Java > 8u191）。对于无法更新 Java 版本或漏洞补丁的用户，建议不要将 WebLogic T3/IIOP 协议服务暴露在不可信网络中，可在确认不影响业务的情况下可以考虑配置 WebLogic 对外部禁用 T3、IIOP 协议。配置 WebLogic 对外部禁用 T3 协议的具体步骤：1、登入 WebLogic 控制台，在对应域设置中选择 “安全”-“筛选器” 选项卡：2、在 “连接筛选器” 输入框中输入：weblogic.security.net.ConnectionFilterImpl3、在 “连接筛选器规则” 输入框中输入（即配置为仅允许本机使用 T3/T3S 协议通信，禁用除本机以外其他主机使用 T3/T3S 协议通信）：127.0.0.1 * * allow t3 t3s0.0.0.0/0 * * deny t3 t3s4、输入后保存提交即可。配置 WebLogic 禁用 IIOP 协议的具体步骤：1、登入 WebLogic 控制台，在对应域设置中选择 “环境”-“服务器”，并选中要设置的服务器。然后在对应服务器设置中选择 “协议”-“IIOP” 选项卡，并取消 “启用IIOP” 前面的勾选：2、保存后，重启服务器使设置生效。  
  
产品支持云图：默认支持该产品的指纹识别，同时支持该漏洞的PoC原理检测。全悉：默认支持该漏洞利用行为的检测。洞鉴：支持通过升级应急版本的方式进行检测。  
**参考链接**  
  
  
- https://www.oracle.com/security-alerts/cpuapr2023.html  
  
  
  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/7QRTvkK2qC7ia5uzmRe9JvNErXe95W4qTgEKhVa7kdaxpwJXC0oKXeFt5vGN4KmJv2mvcYkYtrd7cev0vkAhY7A/640?wx_fmt=gif "")  
  
![](https://mmbiz.qpic.cn/mmbiz_png/FOh11C4BDicTKZibgoTgDW27o7LkCgI9J1v5Pqa3ial4RK8Yr3ib9Y6fctvZ0N44wkMyoRiaU95ETzVDh2V4Lu5V0iag/640?wx_fmt=png "")  
  
  
  
