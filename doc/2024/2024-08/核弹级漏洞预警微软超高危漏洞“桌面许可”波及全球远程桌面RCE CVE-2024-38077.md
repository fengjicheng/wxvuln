#  核弹级漏洞预警微软超高危漏洞“桌面许可”波及全球远程桌面RCE CVE-2024-38077   
 俊杰说黑客   2024-08-09 20:41  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/41JrrYLMbsszwDpqKcIIRmiar7vg9Lq7nD8G6NknwvicsU5iaR60eZ77icfAyZHib0A1MUNBqxnSEl8YCQF2ExyJPIA/640?wx_fmt=png&from=appmsg "")  
  
  
CVE-2024-38077：Windows Remote Desktop Licensing Service远程代码执行漏洞  
  
Windows 远程桌面授权服务中存在堆缓冲区溢出漏洞，该漏洞的  
CVSS评分为9.8，  
**未经身份验证的威胁者可以连接到远程桌面授权服务并发送恶意消息，成功利用可能导致远程代码执行**。如果不需要，可禁用远程桌面授权服务作为缓解措施，Microsoft建议受影响用户安装该漏洞的安全更新，即使计划禁用远程桌面授权服务。微软的可利用性评估为 “被利用的可能性较小”。只能说这样的评价太微软了    
  
这一漏洞存在于Windows远程桌面许可管理服务（RDL）中，该服务被部署于开启了Windows远程桌面（3389端口）的服务器，用于管理远程桌面连接许可。攻击者无需前置条件，便可直接获取开启该服务的Windows服务器最高权限，执行任意操作。  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/41JrrYLMbsszwDpqKcIIRmiar7vg9Lq7nGfBxatXlItRQhckVljV5AVvPKOzI7cw9Py5UMcoWPxLNzkQ1qG29RQ/640?wx_fmt=png&from=appmsg "")  
  
  
除CVE-2024-38023和CVE-2024-38060外，微软的可利用性评估中其他“被利用的可能性较高”的漏洞还包括：  
  
CVE-2024-38021：Microsoft Office 远程代码执行漏洞  
  
威胁者可以制作一个绕过受保护视图协议的恶意链接来利用该漏洞，从而在用户交互的情况下导致远程代码执行。  
  
CVE-2024-38024/ CVE-2024-38094：Microsoft SharePoint Server 远程代码执行漏洞  
  
Microsoft SharePoint Server中存在多个反序列化漏洞，具有站点所有者权限的经过身份验证的威胁者可以利用该漏洞注入任意代码并在 SharePoint Server 上下文中执行。  
  
  
该漏洞位于 Windows 远程桌面许可证管理服务中，攻击者无需任何权限即可实现远程代码执行并获得服务器的最高权限。  
  
由于在解码用户输入的许可证密钥包时，未正确检验解码后数据长度与缓冲区大小之间的关系，导致缓冲区溢出。  
  
该漏洞影响 Windows Server 2008~Windows Server 2025 (预览版) 之间的所有版本，其中 Windows Server 2012 及后续版本目前微软仍提供安全更新支持，因此使用这些操作系统的企业只需要安装更新即可。  
  
对于仍然使用 Windows Server 2008/2008 R2 等老旧版本的企业来说，临时性的防御方法是直接取消安装 RDL 服务，取消安装后至少这个漏洞无法再被利用。  
  
**发现该漏洞的主要研究人员 @EdwardzPeng 已经发布了漏洞的概念验证：**  
  
https://sites.google.com/site/zhiniangpeng/blogs/MadLicense  
  
通常情况下概念验证发布后很快就会有黑客找到漏洞的详细利用方法，因此如果没有意外的话很快就会有黑客开采该漏洞并展开攻击，不过研究人员已经给企业预留了一个月的时间进行修复，如果到现在仍然没有修复而遭到攻击，那就是企业自己的问题了。  
  
**下面是所有受影响的版本：**  
- Windows Server 2025 Preview  
  
- Windows Server 2022, 23H2 Edition (Server Core installation)  
  
- Windows Server 2022 (Server Core installation)  
  
- Windows Server 2022  
  
- Windows Server 2019 (Server Core installation)  
  
- Windows Server 2019  
  
- Windows Server 2016 (Server Core installation)  
  
- Windows Server 2016  
  
- Windows Server 2012 R2 (Server Core installation)  
  
- Windows Server 2012 R2  
  
- Windows Server 2012 (Server Core installation)  
  
- Windows Server 2012  
  
- Windows Server 2008 R2 for x64-based Systems Service Pack 1 (Server Core installation)  
  
- Windows Server 2008 R2 for x64-based Systems Service Pack 1 (Server Core installation)  
  
- Windows Server 2008 R2 for x64-based Systems Service Pack 1  
  
- Windows Server 2008 R2 for x64-based Systems Service Pack 1  
  
- Windows Server 2008 for x64-based Systems Service Pack 2 (Server Core installation)  
  
- Windows Server 2008 for x64-based Systems Service Pack 2 (Server Core installation)  
  
- Windows Server 2008 for x64-based Systems Service Pack 2  
  
- Windows Server 2008 for x64-based Systems Service Pack 2  
  
- Windows Server 2008 for 32-bit Systems Service Pack 2 (Server Core installation)  
  
- Windows Server 2008 for 32-bit Systems Service Pack 2 (Server Core installation)  
  
- Windows Server 2008 for 32-bit Systems Service Pack 2  
  
- Windows Server 2008 for 32-bit Systems Service Pack 2  
  
