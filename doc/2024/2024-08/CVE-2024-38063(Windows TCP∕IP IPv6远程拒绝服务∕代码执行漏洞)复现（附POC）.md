#  CVE-2024-38063(Windows TCP/IP IPv6远程拒绝服务/代码执行漏洞)复现（附POC）   
原创 fl4g  TERRA星环安全团队   2024-08-28 19:07  
  
## 免责声明  
  
  
本文所涉及的任何技术、信息或工具，仅供学习和参考之用。请勿利用本文提供的信息从事任何违法活动或不当行为。任何因使用本文所提供的信息或工具而导致的损失、后果或不良影响，均由使用者个人承担责任，与本文作者及本公众号无关。作者及公众号不对任何因使用本文信息或工具而产生的损失或后果承担任何责任。使用本文所提供的信息或工具即视为同意本免责声明，并承诺遵守相关法律法规和道德规范。  
  
## 漏洞介绍  
  
微软发布8月补丁日安全更新修复  
Windows TCP/IP 远程代码执行漏洞(CVE-2024-38063)，Windows TCP/IP 组件中发现了一个整数下溢漏洞，可能会触发缓冲区溢出。  
未经身份验证的远程攻击者可以通过发送特制的 IPv6 数据包到目标Windows系统机器导致目标蓝屏崩溃，精心构造请求理论上存在远程代码执行的可能性。该漏洞影响了所有受 IPv6 支持的 Windows 版本，包括即将发布的 Windows 11 版本 24H2。  
禁用 IPv6 的系统不受此漏洞的影响，但对于启用 IPv6 的系统，存在很大的利用风险。漏洞被微软标记较大可能被利用，鉴于此漏洞影响范围较大，建议客户尽快做好自查及防护。强烈建议马上安装补丁。  
  
## 影响组件  
  
Windows Server 是由微软开发的操作系统系列，专为服务器环境设计，用于管理网络、数据存储和应用程序的运行。它为企业和组织提供了稳定、可靠的服务器平台，支持各种规模的网络基础设施。Windows TCP/IP 组件是 Windows 操作系统的核心网络功能之一，负责实现网络通信协议，使得计算机能够在网络上进行数据传输和通信。  
  
## 影响版本  
```
Windows 11 Version 24H2 for x64-based Systems
Windows 11 Version 24H2 for ARM64-based Systems
Windows Server 2012 R2 (Server Core installation)
Windows Server 2012 R2
Windows Server 2012 (Server Core installation)
Windows Server 2012
Windows Server 2008 R2 for x64-based Systems Service Pack 1 (Server Core installation)
Windows Server 2008 R2 for x64-based Systems Service Pack 1
Windows Server 2008 for x64-based Systems Service Pack 2 (Server Core installation)
Windows Server 2008 for x64-based Systems Service Pack 2
Windows Server 2008 for 32-bit Systems Service Pack 2 (Server Core installation)
Windows Server 2008 for 32-bit Systems Service Pack 2
Windows Server 2016 (Server Core installation)
Windows Server 2016
Windows 10 Version 1607 for x64-based Systems
Windows 10 Version 1607 for 32-bit Systems
Windows 10 for x64-based Systems
Windows 10 for 32-bit Systems
Windows Server 2022, 23H2 Edition (Server Core installation)
Windows 11 Version 23H2 for x64-based Systems
Windows 11 Version 23H2 for ARM64-based Systems
Windows 10 Version 22H2 for 32-bit Systems
Windows 10 Version 22H2 for ARM64-based Systems
Windows 10 Version 22H2 for x64-based Systems
Windows 11 Version 22H2 for x64-based Systems
Windows 11 Version 22H2 for ARM64-based Systems
Windows 10 Version 21H2 for x64-based Systems
Windows 10 Version 21H2 for ARM64-based Systems
Windows 10 Version 21H2 for 32-bit Systems
Windows 11 version 21H2 for ARM64-based Systems
Windows 11 version 21H2 for x64-based Systems
Windows Server 2022 (Server Core installation)
Windows Server 2022
Windows Server 2019 (Server Core installation)
Windows Server 2019
Windows 10 Version 1809 for ARM64-based Systems
Windows 10 Version 1809 for x64-based Systems
Windows 10 Version 1809 for 32-bit Systems


38063
```  
  
复现成功截图如下：  
  
  
![](https://mmbiz.qpic.cn/mmbiz_png/LibDfs7GHe8sckN3Yv4TsmFQex1ibyntRINKyQP8mLzdOeLx2zuGCcSoObibIZzTbbnM4I9Lpo6yAB1t4iavzZLsMA/640?wx_fmt=png&from=appmsg "")  
### 环境准备：  
#### 0x01 攻击机和靶机都要开启 ipv6  
  
  
  
靶机:192.168.2.161   
  
  
![](https://mmbiz.qpic.cn/mmbiz_png/LibDfs7GHe8sckN3Yv4TsmFQex1ibyntRIhGOaHOMRTd7m9w8Sagibef0pp4bXvSgIcRqnmhxibyOYf5DgUBzRUA5A/640?wx_fmt=png&from=appmsg "")  
  
### 查看 ipv6 地址  
  
![](https://mmbiz.qpic.cn/mmbiz_png/LibDfs7GHe8sckN3Yv4TsmFQex1ibyntRIM1BYL0LlNdicKK60aHl6UW9eIZS0bB7GNxoiaHWAbaWug787ficUPTHMQ/640?wx_fmt=png&from=appmsg "")  
  
攻击机器：192.168.2.150  
  
  
![](https://mmbiz.qpic.cn/mmbiz_png/LibDfs7GHe8sckN3Yv4TsmFQex1ibyntRISG7iciav4oE4wStsLn2ia3iboAvXQz0Ech7hIHsyicIAYAZHTyYOSrPBKicA/640?wx_fmt=png&from=appmsg "")  
####   
#### 0x02 修改 POC  
  
![](https://mmbiz.qpic.cn/mmbiz_png/LibDfs7GHe8sckN3Yv4TsmFQex1ibyntRIHtKiawxrIVr9UMGMn7zUYqSgS7672j27KbFXLGSEpoLvf2cG447VcVA/640?wx_fmt=png&from=appmsg "")  
  
POC  启动!!  
  
  
![](https://mmbiz.qpic.cn/mmbiz_png/LibDfs7GHe8sckN3Yv4TsmFQex1ibyntRIO2BtbMwSZNvcdMiboSYYfKJAGQS1McoZICRPyCvlEjGnZWouWO1uWTw/640?wx_fmt=png&from=appmsg "")  
  
等待一会  
  
![](https://mmbiz.qpic.cn/mmbiz_png/LibDfs7GHe8sckN3Yv4TsmFQex1ibyntRIYce04EuXGJu1ENKvoMdf6yG2vribH99sDU9pPIQ8ulJQeXvlHJOcDicA/640?wx_fmt=png&from=appmsg "")  
## 修复建议  
### 0x01 临时修复  
  
在网络设置里面禁用 ipv6 选项  
  
![](https://mmbiz.qpic.cn/mmbiz_png/LibDfs7GHe8sckN3Yv4TsmFQex1ibyntRIry2lNdb9t6a7AhEe2y8VgBgRmIK1twU2H4rTGCJsicLBS9ynTbMuHSA/640?wx_fmt=png&from=appmsg "")  
  
取消 ipv6 选项  
  
![](https://mmbiz.qpic.cn/mmbiz_png/LibDfs7GHe8sckN3Yv4TsmFQex1ibyntRIiakOOLicicI1zco9TDvPKibBjxrP0jbpr5JFXUr8b4rlSkvLyQPVujbHWA/640?wx_fmt=png&from=appmsg "")  
  
再次查看ip  
  
![](https://mmbiz.qpic.cn/mmbiz_png/LibDfs7GHe8sckN3Yv4TsmFQex1ibyntRIZib8mwq8etwZNicA23OAS1qM5qB2ia6IBsbd0vwtiadW83iaIq7iaiasvEdyA/640?wx_fmt=png&from=appmsg "")  
### 0x02 官方补丁修复  
  
补丁下载链接：  
  
https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-38063  
   
  
####   
  
