#  【已复现，尽快排查修复】Windows RDL存在远程代码执行漏洞（CVE-2024-38077）   
安恒研究院  安恒信息CERT   2024-08-10 14:16  
  
![](https://mmbiz.qpic.cn/mmbiz_png/JAzzLj4nXesCfIew4xDgxHPaichzoa958OaWgTglXPf5mic3dq7TZc3np7PMDpLQPa4pL89cQvD6FAZaN71atsbA/640?wx_fmt=png&from=appmsg&wx_&wx_&wx_&wx_ "")  
  
<table><tbody style="box-sizing:border-box;"><tr style="box-sizing:border-box;"><td colspan="4" rowspan="1" style="border-width:1px;border-color:rgb(69, 119, 218);border-style:solid;background-color:rgb(69, 119, 218);box-sizing:border-box;" width="100.0000%" data-style="border-width:1px;border-color:rgb(69, 119, 218);border-style:solid;background-color:rgb(69, 119, 218);box-sizing:border-box;" class="js_darkmode__0"><section style="margin:5px 0%;box-sizing:border-box;"><section style="padding:0px 5px;font-size:14px;color:rgb(255, 255, 255);box-sizing:border-box;margin-bottom:unset;"><p style="text-align:center;"><strong style="box-sizing:border-box;">漏洞概述</strong></p></section></section></td></tr><tr style="box-sizing:border-box;"><td colspan="1" rowspan="1" style="border-width:1px;border-color:rgb(69, 119, 218);border-style:solid;box-sizing:border-box;" width="25.0000%"><section style="margin:5px 0%;box-sizing:border-box;"><section style="padding:0px 5px;font-size:14px;box-sizing:border-box;margin-bottom:unset;"><p style="text-align:left;"><strong style="box-sizing:border-box;">漏洞名称</strong></p></section></section></td><td colspan="3" rowspan="1" style="border-width:1px;border-color:rgb(69, 119, 218);border-style:solid;box-sizing:border-box;" width="75.0000%"><section style="margin:5px 0%;box-sizing:border-box;"><section style="padding:0px 5px;font-size:14px;box-sizing:border-box;margin-bottom:unset;"><p style="text-align:left;">Windows远程桌面授权服务远程代码执行漏洞(CVE-2024-38077)</p></section></section></td></tr><tr style="box-sizing:border-box;"><td colspan="1" rowspan="1" style="border-width:1px;border-color:rgb(69, 119, 218);border-style:solid;box-sizing:border-box;" width="25.0000%"><section style="margin:5px 0%;box-sizing:border-box;"><section style="padding:0px 5px;font-size:14px;box-sizing:border-box;margin-bottom:unset;"><p style="text-align:left;"><strong style="box-sizing:border-box;">安恒CERT评级</strong></p></section></section></td><td colspan="1" rowspan="1" style="border-width:1px;border-color:rgb(69, 119, 218);border-style:solid;box-sizing:border-box;" width="25.0000%"><section style="margin:5px 0%;box-sizing:border-box;"><section style="padding:0px 5px;font-size:14px;box-sizing:border-box;margin-bottom:unset;"><p style="text-align:left;word-break:break-all;">1级</p></section></section></td><td colspan="1" rowspan="1" style="border-width:1px;border-color:rgb(69, 119, 218);border-style:solid;box-sizing:border-box;" width="25.0000%"><section style="margin:5px 0%;box-sizing:border-box;"><section style="padding:0px 5px;font-size:14px;box-sizing:border-box;margin-bottom:unset;"><p style="text-align:left;"><strong style="box-sizing:border-box;">CVSS3.1评分</strong></p></section></section></td><td colspan="1" rowspan="1" style="border-width:1px;border-color:rgb(69, 119, 218);border-style:solid;box-sizing:border-box;" width="25.0000%"><section style="margin:5px 0%;box-sizing:border-box;"><section style="padding:0px 5px;font-size:14px;box-sizing:border-box;margin-bottom:unset;"><p style="text-align:left;">9.8<br/></p></section></section></td></tr><tr style="box-sizing:border-box;"><td colspan="1" rowspan="1" style="border-width:1px;border-color:rgb(69, 119, 218);border-style:solid;box-sizing:border-box;" width="25.0000%"><section style="margin:5px 0%;box-sizing:border-box;"><section style="padding:0px 5px;font-size:14px;box-sizing:border-box;margin-bottom:unset;"><p style="text-align:left;"><strong style="box-sizing:border-box;">CVE编号</strong></p></section></section></td><td colspan="1" rowspan="1" style="border-width:1px;border-color:rgb(69, 119, 218);border-style:solid;box-sizing:border-box;" width="25.0000%"><section style="margin:5px 0%;box-sizing:border-box;"><section style="padding:0px 5px;font-size:14px;box-sizing:border-box;margin-bottom:unset;"><p style="text-align:left;word-break:break-all;">CVE-2024-38077</p></section></section></td><td colspan="1" rowspan="1" style="border-width:1px;border-color:rgb(69, 119, 218);border-style:solid;box-sizing:border-box;" width="25.0000%"><section style="margin:5px 0%;box-sizing:border-box;"><section style="padding:0px 5px;font-size:14px;box-sizing:border-box;margin-bottom:unset;"><p style="text-align:left;"><strong style="box-sizing:border-box;">CNVD编号</strong></p></section></section></td><td colspan="1" rowspan="1" style="border-width:1px;border-color:rgb(69, 119, 218);border-style:solid;box-sizing:border-box;" width="25.0000%"><section style="margin:5px 0%;box-sizing:border-box;"><section style="padding:0px 5px;font-size:14px;box-sizing:border-box;margin-bottom:unset;"><p style="text-align:left;">CNVD-2024-3491</p></section></section></td></tr><tr style="box-sizing:border-box;"><td colspan="1" rowspan="1" style="border-width:1px;border-color:rgb(69, 119, 218);border-style:solid;box-sizing:border-box;" width="25.0000%"><section style="margin:5px 0%;box-sizing:border-box;"><section style="padding:0px 5px;font-size:14px;box-sizing:border-box;margin-bottom:unset;"><p style="text-align:left;"><strong style="box-sizing:border-box;">CNNVD编号</strong></p></section></section></td><td colspan="1" rowspan="1" style="border-width:1px;border-color:rgb(69, 119, 218);border-style:solid;box-sizing:border-box;" width="25.0000%"><section style="margin:5px 0%;box-sizing:border-box;"><section style="padding:0px 5px;font-size:14px;box-sizing:border-box;margin-bottom:unset;"><p data-v-e4cb35e8="">CNNVD-202407-738</p></section></section></td><td colspan="1" rowspan="1" style="border-width:1px;border-color:rgb(69, 119, 218);border-style:solid;box-sizing:border-box;" width="25.0000%"><section style="margin:5px 0%;box-sizing:border-box;"><section style="padding:0px 5px;font-size:14px;box-sizing:border-box;margin-bottom:unset;"><p style="text-align:left;"><strong style="box-sizing:border-box;">安恒CERT编号</strong></p></section></section></td><td colspan="1" rowspan="1" style="border-width:1px;border-color:rgb(69, 119, 218);border-style:solid;box-sizing:border-box;" width="25.0000%"><section style="margin:5px 0%;box-sizing:border-box;"><section style="padding:0px 5px;font-size:14px;box-sizing:border-box;margin-bottom:unset;"><p>DM-202406-001541</p></section></section></td></tr><tr style="box-sizing:border-box;"><td colspan="1" rowspan="1" style="border-width:1px;border-color:rgb(69, 119, 218);border-style:solid;box-sizing:border-box;" width="25.0000%"><section style="margin:5px 0%;box-sizing:border-box;"><section style="padding:0px 5px;font-size:14px;box-sizing:border-box;margin-bottom:unset;"><p style="text-align:left;"><strong style="box-sizing:border-box;">POC情况</strong></p></section></section></td><td colspan="1" rowspan="1" style="border-width:1px;border-color:rgb(69, 119, 218);border-style:solid;box-sizing:border-box;" width="25.0000%"><section style="margin:5px 0%;box-sizing:border-box;"><section style="padding:0px 5px;font-size:14px;box-sizing:border-box;margin-bottom:unset;"><p style="text-align:left;"><strong>已发现</strong></p></section></section></td><td colspan="1" rowspan="1" style="border-width:1px;border-color:rgb(69, 119, 218);border-style:solid;box-sizing:border-box;" width="25.0000%"><section style="margin:5px 0%;box-sizing:border-box;"><section style="padding:0px 5px;font-size:14px;box-sizing:border-box;margin-bottom:unset;"><p style="text-align:left;"><strong style="box-sizing:border-box;">EXP情况</strong></p></section></section></td><td colspan="1" rowspan="1" style="border-width:1px;border-color:rgb(69, 119, 218);border-style:solid;box-sizing:border-box;" width="25.0000%"><section style="margin:5px 0%;box-sizing:border-box;"><section style="padding:0px 5px;font-size:14px;box-sizing:border-box;margin-bottom:unset;"><p style="text-align:left;">未发现</p></section></section></td></tr><tr style="box-sizing:border-box;"><td colspan="1" rowspan="1" style="border-width:1px;border-color:rgb(69, 119, 218);border-style:solid;box-sizing:border-box;" width="25.0000%"><section style="margin:5px 0%;box-sizing:border-box;"><section style="padding:0px 5px;font-size:14px;box-sizing:border-box;margin-bottom:unset;"><p style="text-align:left;"><strong style="box-sizing:border-box;">在野利用</strong></p></section></section></td><td colspan="1" rowspan="1" style="border-width:1px;border-color:rgb(69, 119, 218);border-style:solid;box-sizing:border-box;" width="25.0000%"><section style="margin:5px 0%;box-sizing:border-box;"><section style="padding:0px 5px;font-size:14px;box-sizing:border-box;margin-bottom:unset;"><p style="text-align:left;">未发现</p></section></section></td><td colspan="1" rowspan="1" style="border-width:1px;border-color:rgb(69, 119, 218);border-style:solid;box-sizing:border-box;" width="25.0000%"><section style="margin:5px 0%;box-sizing:border-box;"><section style="padding:0px 5px;font-size:14px;box-sizing:border-box;margin-bottom:unset;"><p style="text-align:left;"><strong style="box-sizing:border-box;">研究情况</strong></p></section></section></td><td colspan="1" rowspan="1" style="border-width:1px;border-color:rgb(69, 119, 218);border-style:solid;box-sizing:border-box;" width="25.0000%"><section style="margin:5px 0%;box-sizing:border-box;"><section style="padding:0px 5px;font-size:14px;box-sizing:border-box;margin-bottom:unset;"><p style="text-align:left;"><strong>已复现</strong><br/></p></section></section></td></tr><tr style="box-sizing:border-box;"><td colspan="1" rowspan="1" style="border-width:1px;border-color:rgb(69, 119, 218);border-style:solid;box-sizing:border-box;" width="25.0000%"><section style="margin:5px 0%;box-sizing:border-box;"><section style="padding:0px 5px;font-size:14px;box-sizing:border-box;margin-bottom:unset;"><p style="text-align:left;"><strong style="box-sizing:border-box;">危害描述</strong></p></section></section></td><td colspan="3" rowspan="1" style="border-width:1px;border-color:rgb(69, 119, 218);border-style:solid;box-sizing:border-box;" width="75.0000%"><section style="margin:5px 0%;box-sizing:border-box;"><p><span style="font-size:14px;letter-spacing:0.57834px;line-height:22.4px;">该漏洞源于Windows
 
RDL中（通常需要手动开启）的一个堆溢出问题。由于在解码用户输入的许可证密钥包时，未正确检验解码后数据长度与缓冲区大小之间的关系所导致的。攻击者可以通过精心构造的输入触发这个漏洞，并且在不需要用户交互的情况下完全控制受害者的服务器。</span></p><section style="padding:0px 5px;font-size:14px;box-sizing:border-box;margin-bottom:unset;overflow:hidden;line-height:0;"><br/></section></section></td></tr></tbody></table>  
  
由于RDL服务在众多组织中广泛部署，且通常直接暴露在互联网上，受影响的潜在系统数量巨大。  
  
安恒研究院卫兵实验室已复现此漏洞。  
  
**经验证，该漏洞在RDL服务开启下危害性极高，可能造成数据泄露、服务中断、系统瘫痪等后果，务必尽快自我排查修复。**  
  
![](https://mmbiz.qpic.cn/mmbiz_png/JAzzLj4nXesL0N4GRqBCfSK2xee5bCQsLI3tIial8r93rkFUpQmAgb1A385YPeAgZSEneY6BTFRAqRgibPhsubmQ/640?wx_fmt=png&from=appmsg "")  
  
![](https://mmbiz.qpic.cn/mmbiz_png/JAzzLj4nXesL0N4GRqBCfSK2xee5bCQsxkDpLiaUbQic18eJSa9icbbAzXTluBJXO4HVtoXlvppeYA7uJ3eCOMk4g/640?wx_fmt=png&from=appmsg "")  
  
Windows RDL远程代码执行漏洞（CVE-2024-38077）复现截图  
  
  
  
**漏洞信息**  
  
  
  
  
  
**产品描述**  
  
****  
**漏洞危害等级：**  
严重  
  
**漏洞类型：**  
远程代码执行  
  
  
**影响范围**  
  
**影响主体：**  
  
```
Windows Server2008for32-bit SystemsServicePack2
WindowsServer2008for32-bit SystemsServicePack2(ServerCore installation)
WindowsServer2008for x64-based SystemsServicePack2
WindowsServer2008for x64-based SystemsServicePack2(ServerCore installation)
WindowsServer2008 R2 for x64-based SystemsServicePack1
WindowsServer2008 R2 for x64-based SystemsServicePack1(ServerCore installation)
WindowsServer2012
WindowsServer2012(ServerCore installation)
WindowsServer2012 R2
WindowsServer2012 R2 (ServerCore installation)
WindowsServer2016
WindowsServer2016(ServerCore installation)
WindowsServer2019
WindowsServer2019(ServerCore installation)
WindowsServer2022
WindowsServer2022(ServerCore installation)
WindowsServer2022,23H2Edition(ServerCore installation)
```  
  
  
  
**CVSS向量**  
  
访问途径（AV）：网络  
  
攻击复杂度（AC）：低  
  
所需权限（PR）：低  
  
用户交互（UI）：不需要用户交互  
  
影响范围 （S）：改变  
  
机密性影响 （C）：高  
  
完整性影响 （l）：高  
  
可用性影响 （A）：高  
  
  
  
**修复方案**  
  
  
  
  
**官方修复方案：**  
  
目前微软针对支持的产品已发布升级补丁修复了上述漏洞，请用户参考官方通告及时下载更新补丁。  
  
补丁获取：  
  
https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-38077  
  
Windows 更新：  
  
自动更新：Microsoft Update默认启用，当系统检测到可用更新时，将会自动下载更新并在下一次启动时安装。  
  
手动更新：  
  
1、点击“开始菜单”或按Windows快捷键，点击进入“设置”。  
  
2、选择“更新和安全”，进入“Windows更新”（Windows
 8、Windows 8.1、Windows Server 2012以及Windows Server 2012 
R2可通过控制面板进入“Windows更新”，具体步骤为“控制面板”->“系统和安全”->“Windows更新”）。  
  
3、选择“检查更新”，等待系统将自动检查并下载可用更新。  
  
4、重启计算机，安装更新系统重新启动后，可通过进入“Windows更新”->“查看更新历史记录”查看是否成功安装了更新。  
  
**临时缓解方案：**  
  
如果您不需要系统上的远程桌面授权服务，请考虑将其禁用。禁用未使用和不需要的服务有助于减少您受到安全漏洞的影响。  
  
**排查方案：**  
  
研究院已提供自研远程检测工具，可放心使用，文末附获取方式。  
  
**产品支撑**  
  
  
  
  
**明鉴漏扫系统（主机扫描）V1.0.3651.0及以上版本已支持检测。**  
  
  
  
  
**参考资料**  
  
  
  
  
```
https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-38077
```  
  
  
**技术支持**  
  
  
  
  
  
**如有针对该漏洞检测工具的需求请联系400-6059-110获取相关能力支撑。**  
  
