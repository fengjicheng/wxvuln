#  【已复现】SolarWinds Serv-U FTP 目录遍历致文件读取漏洞（CVE-2024-28995）   
长亭应急  黑伞安全   2024-06-14 17:31  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/FOh11C4BDicTdwtf3ySBiavuOxrwxaVl2wvQMwWU0tQfXIMKFGA3mOtzJxoSwZAhjTNGgesicvmHAmtg6VawEbwnQ/640?wx_fmt=png&from=appmsg&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1 "")  
  
Serv-U 是 SolarWinds 公司推出的FTP服务器软件，提供文件传输服务，支持多种协议（FTP、FTPS、SFTP），具有用户管理、文件权限控制等功能，适用于企业级文件传输解决方案。2024年6月，Serv-U 官方 SolarWinds 发布了新补丁，修复了一处目录遍历致文件读取漏洞（CVE-2024-28995）。经分析，该漏洞可以通过特定的路径请求来未授权访问系统文件，进而可能导致敏感信息泄露。该漏洞无前置条件且利用简单，建议受影响的客户尽快修复漏洞。  
**漏洞描述**  
  
   
Description   
  
  
  
**0****1**  
  
漏洞成因Serv-U 的目录遍历漏洞（CVE-2024-28995）是由于在处理路径时缺乏适当的验证。攻击者可以通过传递包含 "../" 的路径段绕过路径验证，访问任意文件。漏洞影响该漏洞允许攻击者读取目标服务器上的任意文件，包括敏感配置和日志文件。漏洞的利用可能导致敏感数据泄露，甚至可能进一步利用其他漏洞进行更严重的攻击。处置优先级：高漏洞类型：目录遍历漏洞危害等级：中权限认证要求：无需任何权限系统配置要求：默认配置可利用用户交互要求：无需用户交互利用成熟度：POC/EXP已公开批量可利用性：可使用通用 POC/EXP，批量检测/利用修复复杂度：低，官方提供热修复方案检测工具 Detection 02X-POC远程检测工具xpoc -r 425 -t http://xpoc.org工具获取方式：https://github.com/chaitin/xpochttps://stack.chaitin.com/tool/detail/1036影响版本 Affects 03主要包含SolarWinds Serv-U 15.4.2 HF 1 及以前的版本：SolarWinds Serv-U FTP Server < 15.4.2 Hotfix 2SolarWinds Serv-U Gateway < 15.4.2 Hotfix 2SolarWinds Serv-U MFT Server < 15.4.2 Hotfix 2解决方案 Solution 04升级修复方案SolarWinds 已发布 15.4.2 Hotfix 2 修复漏洞，强烈建议所有受影响的 Serv-U 版本升级到 15.4.2.157 版本或更高版本。最新版本可在SolarWinds 官方网站（https://www.serv-u.com/downloads）下载。临时缓解方案临时缓解方案可能无法完全阻止漏洞的利用，强烈建议尽快升级到修复版本。1. 确认和限制受影响的 HTTP 请求参数：将所有传入的 InternalDir 和 InternalFile 参数进行严格的路径验证，确保不包含任何目录遍历字符序列（如 ../ 或 ..\）。2. 应用文件系统权限限制：在操作系统层面，限制 Serv-U 进程对敏感文件和目录的访问权限，确保即使通过漏洞进行路径遍历，也无法读取到敏感文件。3. 如非必要，不要将 Serv-U FTP 服务开放在公网上。漏洞复现 Reproduction 05  
**产品支持**  
  
   
Support   
  
  
  
**06**  
云图：默认支持该产品的指纹识别，同时支持该漏洞的PoC原理检测。洞鉴：以自定义POC形式支持该漏洞的原理检测。雷池：默认支持检测该漏洞的利用行为。全悉：默认支持检测该漏洞的利用行为。  
  
  
**时间线**  
  
   
Timeline   
  
  
  
**07**  
6月6日 官方发布漏洞公告6月13日 互联网公开漏洞细节6月14日 长亭安全应急响应中心发布通告  
参考资料：  
  
[1].https://www.solarwinds.com/trust-center/security-advisories/cve-2024-28995  
  
  
**长亭应急响应服务**  
  
  
  
  
全力进行产品升级  
  
及时将风险提示预案发送给客户  
  
检测业务是否收到此次漏洞影响  
  
请联系长亭应急服务团队  
  
7*24小时，守护您的安全  
  
  
第一时间找到我们：  
  
邮箱：support@chaitin.com  
  
应急响应热线：4000-327-707  
  
  
#2024漏洞风险提示  
19  
  
  
#2024漏洞风险提示 · 目录  
  
  
上一篇  
【已复现】PHP-CGI Windows平台远程代码执行漏洞  
  
  
