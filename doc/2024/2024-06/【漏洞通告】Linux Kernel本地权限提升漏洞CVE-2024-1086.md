#  【漏洞通告】Linux Kernel本地权限提升漏洞CVE-2024-1086   
深瞳漏洞实验室  深信服千里目安全技术中心   2024-06-03 19:19  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/w8NHw6tcQ5yUwkuE6WgwfvTkGPcfANcxdblBp12OmvN7WkkUycsq6CQQeGsc2mbtXydJy3BR9wweTxiaT80E0JA/640?wx_fmt=gif&from=appmsg "")  
  
**漏洞名称：**  
  
Linux Kernel本地权限提升漏洞  
  
**组件名称：**  
  
Linux-Kernel  
  
**影响范围：**  
  
3.15 ≤ linux kernel < 6.1.766.2 ≤ linux kernel < 6.6.156.7 ≤ linux kernel < 6.7.3  
  
linux kernel = 6.8-rc1  
  
**漏洞类型：**  
  
资源管理错误  
  
**利用条件：**  
  
1、用户认证：是  
  
2、前置条件：默认配置  
  
3、触发方式：本地  
  
**综合评价：**  
  
<综合评定利用难度>：困难，能造成本地权限提升。  
  
<综合评定威胁等级>：高危，能造成本地权限提升。  
  
**官方解决方案：**  
  
已发布  
  
  
  
  
**漏洞分析**  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/w8NHw6tcQ5yUwkuE6WgwfvTkGPcfANcxWlIzOjKEibibh7s8d7DWicqzaX6WbOgkRic2OfpbSLrqopdLQ4s2lmmaxw/640?wx_fmt=gif&from=appmsg "")  
  
**组件介绍**  
  
Linux内核（Linux Kernel）是一个开源的操作系统内核，它是Linux操作系统的核心组件，负责管理计算机的硬件资源，并提供了许多系统服务，如进程管理、内存管理、文件系统管理和设备驱动程序等。  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/w8NHw6tcQ5yUwkuE6WgwfvTkGPcfANcxWlIzOjKEibibh7s8d7DWicqzaX6WbOgkRic2OfpbSLrqopdLQ4s2lmmaxw/640?wx_fmt=gif&from=appmsg "")  
  
**漏洞简介**  
  
2024年6月3日，深瞳漏洞实验室监测到一则Linux-Kernel组件存在资源管理错误漏洞的信息，漏洞编号：CVE-2024-1086，漏洞威胁等级：高危。  
  
Linux kernel 的netfilter: nf_tables 组件中存在释放后重用，nf_hook_slow() 函数可能会导致双重释放，**攻击者利用该漏洞导致本地权限提升，最高可获取目标服务器root权限。**  
  
  
**影响范围**  
  
目前受影响的Linux-Kernel版本：  
  
3.15 ≤ linux kernel < 6.1.76  
  
6.2 ≤ linux kernel < 6.6.15  
  
6.7 ≤ linux kernel < 6.7.3  
  
linux kernel = 6.8-rc1  
  
  
**解决方案**  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/w8NHw6tcQ5yUwkuE6WgwfvTkGPcfANcxWlIzOjKEibibh7s8d7DWicqzaX6WbOgkRic2OfpbSLrqopdLQ4s2lmmaxw/640?wx_fmt=gif&from=appmsg "")  
  
**如何检测组件系统版本**  
  
  
通过命令uname -r获取当前Kernel版本  
  
![](https://mmbiz.qpic.cn/mmbiz_png/w8NHw6tcQ5yUwkuE6WgwfvTkGPcfANcx9iaW3E48wpz8iaK6QiaH1FAsKo4kQkFVT2lnT9fFDO3jY5iadCQrfaCjDQ/640?wx_fmt=png&from=appmsg "")  
  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/w8NHw6tcQ5yUwkuE6WgwfvTkGPcfANcxWlIzOjKEibibh7s8d7DWicqzaX6WbOgkRic2OfpbSLrqopdLQ4s2lmmaxw/640?wx_fmt=gif&from=appmsg "")  
  
**官方修复建议**  
  
  
官方已发布了漏洞修复方案，请及时关注更新：  
  
https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=f342de4e2f33e0e39165d8639387aa6c19dff660  
  
  
Ubuntu修复方案：https://ubuntu.com/security/CVE-2024-1086  
  
Centos修复方案：https://lists.centos.org/pipermail/centos-announce/2024-March/099235.html  
  
RedHat修复方案：https://access.redhat.com/security/cve/cve-2024-1086  
  
Debian修复方案：https://security-tracker.debian.org/tracker/CVE-2024-1086  
  
统信修复方案：https://src.uniontech.com/#/security_advisory_detail?utsa_id=UTSA-2024-000633  
  
麒麟修复方案：https://kylinos.cn/support/loophole/patch/5561.html  
  
  
修复建议：  
  
（1）升级Linux内核版本修复漏洞。  
  
（2）若暂时无法进行更新且业务不需要，可以通过阻止加载受影响的 netfilter (nf_tables) 内核模块来缓解。  
  
（3）如果无法禁用该模块，可在非容器化部署中，对用户命名空间进行限制。  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/w8NHw6tcQ5yUwkuE6WgwfvTkGPcfANcxWlIzOjKEibibh7s8d7DWicqzaX6WbOgkRic2OfpbSLrqopdLQ4s2lmmaxw/640?wx_fmt=gif&from=appmsg "")  
  
**深信服解决方案**  
  
  
**风险资产发现**  
  
支持对Linux-Kernel的主动检测，可批量检出业务场景中该事件的**受影响资产**情况，相关产品如下：  
  
**【深信服云镜YJ】** 已发布资产检测方案。  
  
  
  
**参考链接**  
  
  
https://news.ycombinator.com/item?id=39828424  
  
https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=f342de4e2f33e0e39165d8639387aa6c19dff660  
  
https://github.com/Notselwyn/CVE-2024-1086  
  
https://pwning.tech/nftables/  
  
  
**时间轴**  
  
  
  
**2024/6/3**  
  
深瞳漏洞实验室监测到Linux Kernel本地权限提升漏洞信息。  
  
  
**2024/6/3**  
  
深瞳漏洞实验室发布漏洞通告。  
  
  
点击**阅读原文**，及时关注并登录深信服**智安全平台**，可轻松查询漏洞相关解决方案。  
  
![](https://mmbiz.qpic.cn/mmbiz_png/w8NHw6tcQ5yUwkuE6WgwfvTkGPcfANcxKNuTCAJicicfMwAcszfNS9K3e4RwFFemNgl8SQKYJqicrjbeZydyFEHkQ/640?wx_fmt=png&from=appmsg "")  
  
  
![](https://mmbiz.qpic.cn/mmbiz_jpg/w8NHw6tcQ5zvcIHbwGGYKbqDVYsVKzNNia1jYtHf49C7133AlDXAgex2W4lFvpia56tjQQDkiauNBrl08YbxqG01A/640?wx_fmt=jpeg&from=appmsg "")  
  
  
