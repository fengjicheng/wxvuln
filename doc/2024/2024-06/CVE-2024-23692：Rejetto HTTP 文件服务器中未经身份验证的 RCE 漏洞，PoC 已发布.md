#  CVE-2024-23692：Rejetto HTTP 文件服务器中未经身份验证的 RCE 漏洞，PoC 已发布   
 Ots安全   2024-06-10 13:51  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/bL2iaicTYdZn7gtxSFZlfuCW6AdQib8Q1onbR0U2h9icP1eRO6wH0AcyJmqZ7USD0uOYncCYIH7ZEE8IicAOPxyb9IA/640?wx_fmt=gif "")  
  
在最新的Rejetto HTTP文件服务器（HFS）2.x版本中，发现了一个严重的安全漏洞，标记为CVE-2024-23692。这一漏洞给使用该软件进行文件分享的组织和个人带来了巨大的风险，因为攻击者可以利用这一漏洞在受影响的服务器上执行任意代码，而无需经过身份验证。这可能导致数据泄露、勒索软件攻击以及整个系统被入侵的风险。  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/rWGOWg48tafYONXf1ZZxgfqhlH174DdYfa0AGBRUnibfw0iamzbnyuy0KFHnEEgNuibHhjl07IoIeO6s9Tf3sHscw/640?wx_fmt=png&from=appmsg "")  
  
Rejetto HFS是一款简单易用的Web文件服务器，可通过网络或互联网共享文件。该软件创建了一个Web界面，让用户可以直接在运行HFS软件的机器上上传或下载文件。尽管它的操作简单，但由于发现了SSTI漏洞，这使得它成为了黑客们的目标。  
  
CVE-2024-23692漏洞特别影响HFS版本2.4.0 RC7和2.3m。漏洞的根本原因在于服务器处理用于呈现HTTP响应的默认模板的方式。这个模板包含了未经正确转义的来自请求的搜索查询参数的内容，从而启用了SSTI漏洞。  
  
  
在正常情况下，符号和宏会被编码以防止SSTI漏洞的发生。然而，通过强制服务器取消转义某些字符，攻击者可以将任意宏注入模板。这是通过巧妙设计的字符序列实现的，就像下面的HTTP请求所示：  
```
echo -ne "GET /?search=%25x%25url%25:%host%}{.exec|notepad.}{.break.} HTTP/1.1\r\nHost:\r\n\r\n" | nc 192.168.86.35 80
```  
  
  
在这个漏洞中，%url%符号没有被转义，这允许了URL的其余部分被回显到服务器端的内容中。  
通过操纵搜索查询参数，攻击者可以关闭默认模板标记并注入任意命令，例如在这个例子中打开记事本。  
  
  
Stephen Fewer评估了该漏洞的利用可能性非常高，因为远程未经身份验证的攻击者可以利用这一漏洞。尽管如此，由于HFS通常不用作企业级Web服务器，因此攻击者的价值被认为很低。尽管如此，受影响系统受到损害的可能性仍然很大，尤其是对于依赖HFS进行个人或小型企业文件共享的用户而言。  
  
  
安全研究员Arseniy Sharoglazov发现了这一漏洞，而Stephen Fewer提供了Metasploit的详细分析和漏洞利用模块。用户可以在AttackerKB上查看Stephen Fewer发表的原始文章，获取有关详细的技术信息和Metasploit模块。  
  
  
这一漏洞最令人担忧的一点是，针对HFS版本2.x的补丁已经缺失，因为该版本的维护者不再支持。强烈建议用户升级到Rejetto HFS的版本3.x，以免受到这一漏洞的影响。  
  
```
CVE-2024-23692: Unauthenticated RCE Flaw in Rejetto HTTP File Server, PoC Published
https://securityonline.info/cve-2024-23692-unauthenticated-rce-flaw-in-rejetto-http-file-server-poc-published/
```  
  
  
  
  
感谢您抽出  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWgdSBqOibtgiaYWjL4pkRXwycNnFvFYVgXoExRy0gqCkqvrAghf8KPXnwQaYq77HMsjcVka7kPcBDQw/640?wx_fmt=gif "")  
  
.  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWgdSBqOibtgiaYWjL4pkRXwycd5KMTutPwNWA97H5MPISWXLTXp0ibK5LXCBAXX388gY0ibXhWOxoEKBA/640?wx_fmt=gif "")  
  
.  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWgdSBqOibtgiaYWjL4pkRXwycU99fZEhvngeeAhFOvhTibttSplYbBpeeLZGgZt41El4icmrBibojkvLNw/640?wx_fmt=gif "")  
  
来阅读本文  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWge7Mibiad1tV0iaF8zSD5gzicbxDmfZCEL7vuOevN97CwUoUM5MLeKWibWlibSMwbpJ28lVg1yj1rQflyQ/640?wx_fmt=gif "")  
  
**点它，分享点赞在看都在这里**  
  
