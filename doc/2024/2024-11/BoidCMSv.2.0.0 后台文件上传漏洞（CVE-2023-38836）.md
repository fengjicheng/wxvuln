#  BoidCMSv.2.0.0 后台文件上传漏洞（CVE-2023-38836）   
原创 張童學  Nick安全   2024-11-26 09:25  
  
### 0x01、漏洞环境  
```
1、春秋云镜：https://yunjing.ichunqiu.com/cve/detail/1130?type=1&pay=2
```  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/iauPABibqVzA7cQ7ly2vChLeiaribv3zJibDHeQyMpPPc0QiamFiblpDHpMv7Oq7faPlrSNa306CNt1WAMZV12DwFKrWw/640?wx_fmt=png&from=appmsg "")  
### 0x02、漏洞详情  
  
BoidCMS是一个免费的开源平面文件 CMS，用于构建简单的网站和博客，使用 PHP 开发并使用 JSON 作为数据库。它的安装无需配置或安装任何关系数据库（如 MySQL）。您只需要一个支持PHP 的Web服务器。在 BoidCMS v.2.0.0 中存在一个安全漏洞，攻击者可以通过更改 MIME 标头来绕过上传文件的限制，并最终执行任意代码。这个漏洞可能导致严重的安全问题，因为攻击者可以上传恶意文件并在服务器上执行它们。  
  
影响范围：BoidCMS <=2.0.0  
### 0x03、漏洞复现  
  
1、打开环境  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/iauPABibqVzA7cQ7ly2vChLeiaribv3zJibDHAliaCbDgIQhjvI0HEkzcEn3ICMRGL42fmoJ2UVg0N7ib5JwROxgUAmzQ/640?wx_fmt=png&from=appmsg "")  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/iauPABibqVzA7cQ7ly2vChLeiaribv3zJibDHEiaDibmde4UGrLRibE4hIIDoKQ7EceoBZ3qGkswQbicpCGCzdQwicdZcDEg/640?wx_fmt=png&from=appmsg "")  
  
2、访问后台/admin,默认用户名密码：admin/password  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/iauPABibqVzA7cQ7ly2vChLeiaribv3zJibDHibGQnV3o3uEDUTuAKTVj2aE7D3x52kDawCSEr1iauRdJ9gj1cngcpNBw/640?wx_fmt=png&from=appmsg "")  
  
3、点击Media，上传shell。  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/iauPABibqVzA7cQ7ly2vChLeiaribv3zJibDHxYK2boSsxjwic0Y1ibwUEFqSjWTVibF4B9raFMm1ynibLdu3yARHYNmlVQ/640?wx_fmt=png&from=appmsg "")  
  
4、抓包重放修改GIF文件头  
```
Content-Type: application/octet-stream   
#文件类型
```  
```
GIF89a                                  
#GIF文件头
```  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/iauPABibqVzA7cQ7ly2vChLeiaribv3zJibDHTicDPgOyPUYHvpcYSh5WmLPibWtzEJWmWNibL5N6Y67c6Z5eoyluI9lCw/640?wx_fmt=png&from=appmsg "")  
  
5、使用客户端连接shell  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/iauPABibqVzA7cQ7ly2vChLeiaribv3zJibDH0O8JOTNkdjL7Go5r0e0dG6jSibWxGqIoSnibUc6WNO4Mq1icn0AY9YGtg/640?wx_fmt=png&from=appmsg "")  
  
### 0x04、修复建议  
  
1、限制文件上传类型。  
  
  
