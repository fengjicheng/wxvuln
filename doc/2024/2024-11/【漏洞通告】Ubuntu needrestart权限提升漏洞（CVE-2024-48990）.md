#  【漏洞通告】Ubuntu needrestart权限提升漏洞（CVE-2024-48990）   
 启明星辰安全简讯   2024-11-21 08:19  
  
**一、漏洞****概述**  
<table><tbody><tr style="mso-yfti-irow:0;mso-yfti-firstrow:yes;height:20.15pt;"><td width="80.33333333333333" style="border-width: 2.25pt 1.5pt 1.5pt 2.25pt;border-color: windowtext;border-style: solid;background: rgb(222, 234, 246);padding: 0cm 5.4pt;" height="20"><section style="text-align: center;line-height: 150%;margin-bottom: 0px;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;color: rgb(51, 51, 51);font-size: 14px;">漏洞名称<o:p></o:p></span></section></td><td width="352.3333333333333" colspan="3" style="border-top: 2.25pt solid windowtext;border-left: none;border-bottom: 1.5pt solid windowtext;border-right: 2.25pt solid windowtext;background: rgb(222, 234, 246);padding: 0cm 5.4pt;word-break: break-all;" height="20"><section style="text-align: center;line-height: 150%;margin-bottom: 0px;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;color: rgb(51, 51, 51);font-size: 14px;"> Ubuntu needrestart权限提升漏洞<o:p></o:p></span></section></td></tr><tr style="mso-yfti-irow:1;height:20.15pt;"><td width="100" style="border-top: none;border-left: 2.25pt solid windowtext;border-bottom: 1.5pt solid windowtext;border-right: 1.5pt solid windowtext;background: rgb(222, 234, 246);padding: 0cm 5.4pt;" height="20"><section style="text-align: center;line-height: 150%;margin-bottom: 0px;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;color: rgb(51, 51, 51);font-size: 14px;">CVE   ID<o:p></o:p></span></section></td><td width="352.3333333333333" colspan="3" style="border-top: none;border-left: none;border-bottom: 1.5pt solid windowtext;border-right: 2.25pt solid windowtext;background: rgb(222, 234, 246);padding: 0cm 5.4pt;" height="20"><section style="text-align: center;line-height: 150%;margin-bottom: 0px;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;color: rgb(51, 51, 51);font-size: 14px;">CVE-2024-48990<o:p></o:p></span></section></td></tr><tr style="mso-yfti-irow:2;height:20.15pt;"><td width="100" style="border-top: none;border-left: 2.25pt solid windowtext;border-bottom: 1.5pt solid windowtext;border-right: 1.5pt solid windowtext;background: rgb(222, 234, 246);padding: 0cm 5.4pt;" height="20"><section style="text-align: center;line-height: 150%;margin-bottom: 0px;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;color: rgb(51, 51, 51);font-size: 14px;">漏洞类型<o:p></o:p></span></section></td><td width="95.33333333333333" style="border-top: none;border-left: none;border-bottom: 1.5pt solid windowtext;border-right: 1.5pt solid windowtext;background: rgb(222, 234, 246);padding: 0cm 5.4pt;" height="20"><section style="text-align: center;line-height: 150%;margin-bottom: 0px;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;color: black;font-size: 14px;">LPE<o:p></o:p></span></section></td><td width="98.33333333333333" style="border-top: none;border-left: none;border-bottom: 1.5pt solid windowtext;border-right: 1.5pt solid windowtext;background: rgb(222, 234, 246);padding: 0cm 5.4pt;" height="20"><section style="text-align: center;line-height: 150%;margin-bottom: 0px;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;color: rgb(51, 51, 51);font-size: 14px;">发现时间<o:p></o:p></span></section></td><td width="109.33333333333333" style="border-top: none;border-left: none;border-bottom: 1.5pt solid windowtext;border-right: 2.25pt solid windowtext;background: rgb(222, 234, 246);padding: 0cm 5.4pt;" height="20"><section style="text-align: center;line-height: 150%;margin-bottom: 0px;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;color: rgb(51, 51, 51);font-size: 14px;">2024-11-21<o:p></o:p></span></section></td></tr><tr style="mso-yfti-irow:3;height:20.15pt;"><td width="100" style="border-top: none;border-left: 2.25pt solid windowtext;border-bottom: 1.5pt solid windowtext;border-right: 1.5pt solid windowtext;background: rgb(222, 234, 246);padding: 0cm 5.4pt;" height="20"><section style="text-align: center;line-height: 150%;margin-bottom: 0px;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;color: rgb(51, 51, 51);font-size: 14px;">漏洞评分<o:p></o:p></span></section></td><td width="95.33333333333333" style="border-top: none;border-left: none;border-bottom: 1.5pt solid windowtext;border-right: 1.5pt solid windowtext;background: rgb(222, 234, 246);padding: 0cm 5.4pt;" height="20"><section style="text-align: center;line-height: 150%;margin-bottom: 0px;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;color: rgb(51, 51, 51);font-size: 14px;">7.8<o:p></o:p></span></section></td><td width="98.33333333333333" style="border-top: none;border-left: none;border-bottom: 1.5pt solid windowtext;border-right: 1.5pt solid windowtext;background: rgb(222, 234, 246);padding: 0cm 5.4pt;" height="20"><section style="text-align: center;line-height: 150%;margin-bottom: 0px;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;color: rgb(51, 51, 51);font-size: 14px;">漏洞等级<o:p></o:p></span></section></td><td width="109.33333333333333" style="border-top: none;border-left: none;border-bottom: 1.5pt solid windowtext;border-right: 2.25pt solid windowtext;background: rgb(222, 234, 246);padding: 0cm 5.4pt;" height="20"><section style="text-align: center;line-height: 150%;margin-bottom: 0px;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;color: rgb(51, 51, 51);font-size: 14px;">高危<o:p></o:p></span></section></td></tr><tr style="mso-yfti-irow:4;"><td width="100" style="border-top: none;border-left: 2.25pt solid windowtext;border-bottom: 1.5pt solid windowtext;border-right: 1.5pt solid windowtext;background: rgb(222, 234, 246);padding: 0cm 5.4pt;"><section style="text-align: center;line-height: 150%;margin-bottom: 0px;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;color: rgb(51, 51, 51);font-size: 14px;">攻击向量<o:p></o:p></span></section></td><td width="95.33333333333333" style="border-top: none;border-left: none;border-bottom: 1.5pt solid windowtext;border-right: 1.5pt solid windowtext;background: rgb(222, 234, 246);padding: 0cm 5.4pt;"><section style="text-align: center;line-height: 150%;margin-bottom: 0px;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;color: rgb(51, 51, 51);font-size: 14px;">本地<o:p></o:p></span></section></td><td width="98.33333333333333" style="border-top: none;border-left: none;border-bottom: 1.5pt solid windowtext;border-right: 1.5pt solid windowtext;background: rgb(222, 234, 246);padding: 0cm 5.4pt;"><section style="text-align: center;line-height: 150%;margin-bottom: 0px;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;color: rgb(51, 51, 51);font-size: 14px;">所需权限<o:p></o:p></span></section></td><td width="109.33333333333333" style="border-top: none;border-left: none;border-bottom: 1.5pt solid windowtext;border-right: 2.25pt solid windowtext;background: rgb(222, 234, 246);padding: 0cm 5.4pt;"><section style="text-align: center;line-height: 150%;margin-bottom: 0px;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;color: rgb(51, 51, 51);font-size: 14px;">低<o:p></o:p></span></section></td></tr><tr style="mso-yfti-irow:5;"><td width="100" style="border-top: none;border-left: 2.25pt solid windowtext;border-bottom: 1.5pt solid windowtext;border-right: 1.5pt solid windowtext;background: rgb(222, 234, 246);padding: 0cm 5.4pt;"><section style="text-align: center;line-height: 150%;margin-bottom: 0px;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;color: rgb(51, 51, 51);font-size: 14px;">利用难度<o:p></o:p></span></section></td><td width="95.33333333333333" style="border-top: none;border-left: none;border-bottom: 1.5pt solid windowtext;border-right: 1.5pt solid windowtext;background: rgb(222, 234, 246);padding: 0cm 5.4pt;"><section style="text-align: center;line-height: 150%;margin-bottom: 0px;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;color: rgb(51, 51, 51);font-size: 14px;">低<o:p></o:p></span></section></td><td width="98.33333333333333" style="border-top: none;border-left: none;border-bottom: 1.5pt solid windowtext;border-right: 1.5pt solid windowtext;background: rgb(222, 234, 246);padding: 0cm 5.4pt;"><section style="text-align: center;line-height: 150%;margin-bottom: 0px;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;color: rgb(51, 51, 51);font-size: 14px;">用户交互<o:p></o:p></span></section></td><td width="109.33333333333333" style="border-top: none;border-left: none;border-bottom: 1.5pt solid windowtext;border-right: 2.25pt solid windowtext;background: rgb(222, 234, 246);padding: 0cm 5.4pt;"><section style="text-align: center;line-height: 150%;margin-bottom: 0px;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;color: rgb(51, 51, 51);font-size: 14px;">无<o:p></o:p></span></section></td></tr><tr style="mso-yfti-irow:6;mso-yfti-lastrow:yes;"><td width="100" style="border-top: none;border-left: 2.25pt solid windowtext;border-bottom: 2.25pt solid windowtext;border-right: 1.5pt solid windowtext;background: rgb(222, 234, 246);padding: 0cm 5.4pt;"><section style="text-align: center;line-height: 150%;margin-bottom: 0px;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;color: rgb(51, 51, 51);font-size: 14px;">PoC/EXP<o:p></o:p></span></section></td><td width="95.33333333333333" style="border-top: none;border-left: none;border-bottom: 2.25pt solid windowtext;border-right: 1.5pt solid windowtext;background: rgb(222, 234, 246);padding: 0cm 5.4pt;"><section style="text-align: center;line-height: 150%;margin-bottom: 0px;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;color: rgb(51, 51, 51);font-size: 14px;">未公开<o:p></o:p></span></section></td><td width="98.33333333333333" style="border-top: none;border-left: none;border-bottom: 2.25pt solid windowtext;border-right: 1.5pt solid windowtext;background: rgb(222, 234, 246);padding: 0cm 5.4pt;"><section style="text-align: center;line-height: 150%;margin-bottom: 0px;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;color: rgb(51, 51, 51);font-size: 14px;">在野利用<o:p></o:p></span></section></td><td width="109.33333333333333" style="border-top: none;border-left: none;border-bottom: 2.25pt solid windowtext;border-right: 2.25pt solid windowtext;background: rgb(222, 234, 246);padding: 0cm 5.4pt;"><section style="text-align: center;line-height: 150%;margin-bottom: 0px;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;color: rgb(51, 51, 51);font-size: 14px;">未发现<o:p></o:p></span></section></td></tr></tbody></table>  
needrestart 是Ubuntu 和其他基于 Debian 的 Linux 发行版中常用的一个工具，主要用于检测系统中是否有需要重启的服务或内核模块。它在软件包更新后运行，帮助管理员识别哪些服务或进程需要重新启动以使更新生效。  
  
2024年11月21日，启明星辰集团VSRC监测到Ubuntu needrestart包中存在多个本地权限提升漏洞，对目标系统具有本地访问权限的攻击者可利用这些漏洞在无需用户交互的情况下将权限提升到root，目前这些漏洞的技术细节已公开，详情如下：  
  
CVE-2024-48990：Needrestart 使用从正在运行的进程中提取的 PYTHONPATH 环境变量执行 Python 解释器，如果本地攻击者控制该变量，可以通过植入恶意共享库在 Python 初始化期间以 root 身份执行任意代码。  
  
CVE-2024-48992：needrestart 使用的 Ruby 解释器在处理攻击者控制的 RUBYLIB 环境变量时存在漏洞，允许本地攻击者通过向进程注入恶意库以 root 身份执行任意 Ruby 代码。  
  
CVE-2024-48991：needrestart 中的竞争条件漏洞允许本地攻击者用恶意可执行文件替换正在验证的 Python 解释器二进制文件，诱骗 needrestart运行其伪 Python 解释器，从而以 root 身份执行任意代码。  
  
CVE-2024-10224/ CVE-2024-11003：Module::ScanDeps Perl 模块用于分析依赖关系，它允许用户通过 open() 调用外部文件或执行命令，由于它对输入缺乏严格验证，攻击者可以提供恶意输入：使用管道符号（例如将“commands|”作为文件名传递），或将任意字符串传递给 eval() 来运行任意 shell 命令或Perl代码。在CVE-2024-11003 中，needrestart 使用Module::ScanDeps 来分析依赖文件，如果 needrestart 在以 root 权限运行时，错误地将用户可控的输入（例如文件名）传递给Module::ScanDeps，就会以 root 特权触发CVE-2024-10224漏洞。  
  
## 二、影响范围  
  
**受影响包版本******  
  
0.8 <= needrestart < 3.8  
  
**受影响Ubuntu发行版**  
****  
<table><tbody><tr style="mso-yfti-irow:0;mso-yfti-firstrow:yes;height:14.4pt;"><td width="119" nowrap="" style="border-width: 2.25pt 1.5pt 1.5pt 2.25pt;border-color: windowtext;border-style: solid;padding: 0cm 5.4pt;" height="14"><section style="text-align: center;margin-right: 5.25pt;margin-bottom: 0px;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;font-size: 14px;">受影响Ubuntu版本<o:p></o:p></span></section></td><td width="148" nowrap="" style="border-top: 2.25pt solid windowtext;border-left: none;border-bottom: 1.5pt solid windowtext;border-right: 1.5pt solid windowtext;padding: 0cm 5.4pt;" height="14"><section style="text-align: center;margin-right: 5.25pt;margin-bottom: 0px;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;font-size: 14px;">受影响包名<o:p></o:p></span></section></td><td width="99" nowrap="" style="border-top: 2.25pt solid windowtext;border-left: none;border-bottom: 1.5pt solid windowtext;border-right: 2.25pt solid windowtext;padding: 0cm 5.4pt;" height="14"><section style="text-align: center;margin-right: 5.25pt;margin-bottom: 0px;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;font-size: 14px;">受影响包版本<o:p></o:p></span></section></td></tr><tr style="mso-yfti-irow:1;height:14.4pt;"><td width="119" nowrap="" rowspan="2" style="border-top: none;border-left: 2.25pt solid windowtext;border-bottom: 1.5pt solid windowtext;border-right: 1.5pt solid windowtext;padding: 0cm 5.4pt;" height="14"><section style="text-align: center;margin-right: 5.25pt;margin-bottom: 0px;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;font-size: 14px;">Xenial (16.04)<o:p></o:p></span></section></td><td width="148" nowrap="" style="border-top: none;border-left: none;border-bottom: 1.5pt solid windowtext;border-right: 1.5pt solid windowtext;padding: 0cm 5.4pt;" height="14"><section style="text-align: center;margin-right: 5.25pt;margin-bottom: 0px;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;font-size: 14px;">needrestart<o:p></o:p></span></section></td><td width="99" nowrap="" style="border-top: none;border-left: none;border-bottom: 1.5pt solid windowtext;border-right: 2.25pt solid windowtext;padding: 0cm 5.4pt;" height="14"><section style="text-align: center;margin-right: 5.25pt;margin-bottom: 0px;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;font-size: 14px;">&lt;= 2.6-1<o:p></o:p></span></section></td></tr><tr style="mso-yfti-irow:2;height:14.4pt;"><td width="148" nowrap="" style="border-top: none;border-left: none;border-bottom: 1.5pt solid windowtext;border-right: 1.5pt solid windowtext;padding: 0cm 5.4pt;" height="14"><section style="text-align: center;margin-right: 5.25pt;margin-bottom: 0px;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;font-size: 14px;">libmodule-scandeps-perl<o:p></o:p></span></section></td><td width="99" nowrap="" style="border-top: none;border-left: none;border-bottom: 1.5pt solid windowtext;border-right: 2.25pt solid windowtext;padding: 0cm 5.4pt;" height="14"><section style="text-align: center;margin-right: 5.25pt;margin-bottom: 0px;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;font-size: 14px;">&lt;= 1.20-1<o:p></o:p></span></section></td></tr><tr style="mso-yfti-irow:3;height:14.4pt;"><td width="119" nowrap="" rowspan="2" style="border-top: none;border-left: 2.25pt solid windowtext;border-bottom: 1.5pt solid windowtext;border-right: 1.5pt solid windowtext;padding: 0cm 5.4pt;" height="14"><section style="text-align: center;margin-right: 5.25pt;margin-bottom: 0px;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;font-size: 14px;">Bionic (18.04)<o:p></o:p></span></section></td><td width="148" nowrap="" style="border-top: none;border-left: none;border-bottom: 1.5pt solid windowtext;border-right: 1.5pt solid windowtext;padding: 0cm 5.4pt;" height="14"><section style="text-align: center;margin-right: 5.25pt;margin-bottom: 0px;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;font-size: 14px;">needrestart<o:p></o:p></span></section></td><td width="99" nowrap="" style="border-top: none;border-left: none;border-bottom: 1.5pt solid windowtext;border-right: 2.25pt solid windowtext;padding: 0cm 5.4pt;" height="14"><section style="text-align: center;margin-right: 5.25pt;margin-bottom: 0px;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;font-size: 14px;">&lt;= 3.1-1ubuntu0.1<o:p></o:p></span></section></td></tr><tr style="mso-yfti-irow:4;height:14.4pt;"><td width="148" nowrap="" style="border-top: none;border-left: none;border-bottom: 1.5pt solid windowtext;border-right: 1.5pt solid windowtext;padding: 0cm 5.4pt;" height="14"><section style="text-align: center;margin-right: 5.25pt;margin-bottom: 0px;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;font-size: 14px;">libmodule-scandeps-perl<o:p></o:p></span></section></td><td width="99" nowrap="" style="border-top: none;border-left: none;border-bottom: 1.5pt solid windowtext;border-right: 2.25pt solid windowtext;padding: 0cm 5.4pt;" height="14"><section style="text-align: center;margin-right: 5.25pt;margin-bottom: 0px;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;font-size: 14px;">&lt;= 1.24-1<o:p></o:p></span></section></td></tr><tr style="mso-yfti-irow:5;height:14.4pt;"><td width="119" nowrap="" rowspan="2" style="border-top: none;border-left: 2.25pt solid windowtext;border-bottom: 1.5pt solid windowtext;border-right: 1.5pt solid windowtext;padding: 0cm 5.4pt;" height="14"><section style="text-align: center;margin-right: 5.25pt;margin-bottom: 0px;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;font-size: 14px;">Focal (20.04)<o:p></o:p></span></section></td><td width="148" nowrap="" style="border-top: none;border-left: none;border-bottom: 1.5pt solid windowtext;border-right: 1.5pt solid windowtext;padding: 0cm 5.4pt;" height="14"><section style="text-align: center;margin-right: 5.25pt;margin-bottom: 0px;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;font-size: 14px;">needrestart<o:p></o:p></span></section></td><td width="99" nowrap="" style="border-top: none;border-left: none;border-bottom: 1.5pt solid windowtext;border-right: 2.25pt solid windowtext;padding: 0cm 5.4pt;" height="14"><section style="text-align: center;margin-right: 5.25pt;margin-bottom: 0px;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;font-size: 14px;">&lt;= 3.4-6ubuntu0.1<o:p></o:p></span></section></td></tr><tr style="mso-yfti-irow:6;height:14.4pt;"><td width="148" nowrap="" style="border-top: none;border-left: none;border-bottom: 1.5pt solid windowtext;border-right: 1.5pt solid windowtext;padding: 0cm 5.4pt;" height="14"><section style="text-align: center;margin-right: 5.25pt;margin-bottom: 0px;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;font-size: 14px;">libmodule-scandeps-perl<o:p></o:p></span></section></td><td width="99" nowrap="" style="border-top: none;border-left: none;border-bottom: 1.5pt solid windowtext;border-right: 2.25pt solid windowtext;padding: 0cm 5.4pt;" height="14"><section style="text-align: center;margin-right: 5.25pt;margin-bottom: 0px;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;font-size: 14px;">&lt;= 1.27-1<o:p></o:p></span></section></td></tr><tr style="mso-yfti-irow:7;height:14.4pt;"><td width="119" nowrap="" rowspan="2" style="border-top: none;border-left: 2.25pt solid windowtext;border-bottom: 1.5pt solid windowtext;border-right: 1.5pt solid windowtext;padding: 0cm 5.4pt;" height="14"><section style="text-align: center;margin-right: 5.25pt;margin-bottom: 0px;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;font-size: 14px;">Jammy (22.04)<o:p></o:p></span></section></td><td width="148" nowrap="" style="border-top: none;border-left: none;border-bottom: 1.5pt solid windowtext;border-right: 1.5pt solid windowtext;padding: 0cm 5.4pt;" height="14"><section style="text-align: center;margin-right: 5.25pt;margin-bottom: 0px;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;font-size: 14px;">needrestart<o:p></o:p></span></section></td><td width="99" nowrap="" style="border-top: none;border-left: none;border-bottom: 1.5pt solid windowtext;border-right: 2.25pt solid windowtext;padding: 0cm 5.4pt;" height="14"><section style="text-align: center;margin-right: 5.25pt;margin-bottom: 0px;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;font-size: 14px;">&lt;= 3.5-5ubuntu2.1<o:p></o:p></span></section></td></tr><tr style="mso-yfti-irow:8;height:14.4pt;"><td width="148" nowrap="" style="border-top: none;border-left: none;border-bottom: 1.5pt solid windowtext;border-right: 1.5pt solid windowtext;padding: 0cm 5.4pt;" height="14"><section style="text-align: center;margin-right: 5.25pt;margin-bottom: 0px;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;font-size: 14px;">libmodule-scandeps-perl<o:p></o:p></span></section></td><td width="99" nowrap="" style="border-top: none;border-left: none;border-bottom: 1.5pt solid windowtext;border-right: 2.25pt solid windowtext;padding: 0cm 5.4pt;" height="14"><section style="text-align: center;margin-right: 5.25pt;margin-bottom: 0px;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;font-size: 14px;">&lt;= 1.31-1<o:p></o:p></span></section></td></tr><tr style="mso-yfti-irow:9;height:14.4pt;"><td width="119" nowrap="" rowspan="2" style="border-top: none;border-left: 2.25pt solid windowtext;border-bottom: 1.5pt solid windowtext;border-right: 1.5pt solid windowtext;padding: 0cm 5.4pt;" height="14"><section style="text-align: center;margin-right: 5.25pt;margin-bottom: 0px;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;font-size: 14px;">Noble (24.04)<o:p></o:p></span></section></td><td width="148" nowrap="" style="border-top: none;border-left: none;border-bottom: 1.5pt solid windowtext;border-right: 1.5pt solid windowtext;padding: 0cm 5.4pt;" height="14"><section style="text-align: center;margin-right: 5.25pt;margin-bottom: 0px;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;font-size: 14px;">needrestart<o:p></o:p></span></section></td><td width="99" nowrap="" style="border-top: none;border-left: none;border-bottom: 1.5pt solid windowtext;border-right: 2.25pt solid windowtext;padding: 0cm 5.4pt;" height="14"><section style="text-align: center;margin-right: 5.25pt;margin-bottom: 0px;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;font-size: 14px;">&lt;= 3.6-7ubuntu4.1<o:p></o:p></span></section></td></tr><tr style="mso-yfti-irow:10;height:14.4pt;"><td width="148" nowrap="" style="border-top: none;border-left: none;border-bottom: 1.5pt solid windowtext;border-right: 1.5pt solid windowtext;padding: 0cm 5.4pt;" height="14"><section style="text-align: center;margin-right: 5.25pt;margin-bottom: 0px;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;font-size: 14px;">libmodule-scandeps-perl<o:p></o:p></span></section></td><td width="99" nowrap="" style="border-top: none;border-left: none;border-bottom: 1.5pt solid windowtext;border-right: 2.25pt solid windowtext;padding: 0cm 5.4pt;" height="14"><section style="text-align: center;margin-right: 5.25pt;margin-bottom: 0px;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;font-size: 14px;">&lt;= 1.35-1<o:p></o:p></span></section></td></tr><tr style="mso-yfti-irow:11;height:14.4pt;"><td width="119" nowrap="" rowspan="2" style="border-top: none;border-left: 2.25pt solid windowtext;border-bottom: 2.25pt solid windowtext;border-right: 1.5pt solid windowtext;padding: 0cm 5.4pt;" height="14"><section style="text-align: center;margin-right: 5.25pt;margin-bottom: 0px;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;font-size: 14px;">Oracular (24.10)<o:p></o:p></span></section></td><td width="148" nowrap="" style="border-top: none;border-left: none;border-bottom: 1.5pt solid windowtext;border-right: 1.5pt solid windowtext;padding: 0cm 5.4pt;" height="14"><section style="text-align: center;margin-right: 5.25pt;margin-bottom: 0px;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;font-size: 14px;">needrestart<o:p></o:p></span></section></td><td width="99" nowrap="" style="border-top: none;border-left: none;border-bottom: 1.5pt solid windowtext;border-right: 2.25pt solid windowtext;padding: 0cm 5.4pt;" height="14"><section style="text-align: center;margin-right: 5.25pt;margin-bottom: 0px;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;font-size: 14px;">&lt;= 3.6-8ubuntu4<o:p></o:p></span></section></td></tr><tr style="mso-yfti-irow:12;mso-yfti-lastrow:yes;height:14.4pt;"><td width="148" nowrap="" style="border-top: none;border-left: none;border-bottom: 2.25pt solid windowtext;border-right: 1.5pt solid windowtext;padding: 0cm 5.4pt;" height="14"><section style="text-align: center;margin-right: 5.25pt;margin-bottom: 0px;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;font-size: 14px;">libmodule-scandeps-perl<o:p></o:p></span></section></td><td width="99" nowrap="" style="border-top: none;border-left: none;border-bottom: 2.25pt solid windowtext;border-right: 2.25pt solid windowtext;padding: 0cm 5.4pt;" height="14"><section style="text-align: center;margin-right: 5.25pt;margin-bottom: 0px;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;font-size: 14px;">&lt; 1.35-1<o:p></o:p></span></section></td></tr></tbody></table>  
注：Jammy、Noble和 Oracular 版本中needrestart 包是默认安装的，因此这些版本的服务器安装会受到影响。只有手动安装了 needrestart 后，Jammy 之前的桌面安装和默认 Ubuntu Server 安装才会受到影响。  
  
## 三、安全措施  
### 3.1 升级版本  
  
目前这些漏洞已经修复，受影响用户可将needrestart包更新到3.8或更高版本，Ubuntu用户可将受影响包升级到以下相应版本：  
<table><tbody><tr style="mso-yfti-irow:0;mso-yfti-firstrow:yes;"><td width="104.33333333333333" style="border-width: 2.25pt 1.5pt 1.5pt 2.25pt;border-color: windowtext;border-style: solid;padding: 0cm 5.4pt;"><section style="text-align: center;margin-bottom: 0px;"><span style="font-size: 14px;"><strong style="mso-bidi-font-weight:normal;"><span lang="EN-US" style="font-family: 微软雅黑, &#34;sans-serif&#34;;">Ubuntu</span></strong><strong style="mso-bidi-font-weight:normal;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;">发行版</span></strong><strong style="mso-bidi-font-weight:normal;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;"><o:p></o:p></span></strong></span></section></td><td width="265.3333333333333" style="border-top: 2.25pt solid windowtext;border-left: none;border-bottom: 1.5pt solid windowtext;border-right: 1.5pt solid windowtext;padding: 0cm 5.4pt;"><section style="text-align: center;margin-bottom: 0px;"><span style="font-size: 14px;"><strong style="mso-bidi-font-weight:normal;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;">修复包版本</span></strong><strong style="mso-bidi-font-weight:normal;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;"><o:p></o:p></span></strong></span></section></td><td width="54.33333333333333" style="border-top: 2.25pt solid windowtext;border-left: none;border-bottom: 1.5pt solid windowtext;border-right: 2.25pt solid windowtext;padding: 0cm 5.4pt;"><section style="text-align: center;margin-bottom: 0px;"><span style="font-size: 14px;"><strong style="mso-bidi-font-weight:normal;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;">说明</span></strong><strong style="mso-bidi-font-weight:normal;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;"><o:p></o:p></span></strong></span></section></td></tr><tr style="mso-yfti-irow:1;"><td width="124" style="border-top: none;border-left: 2.25pt solid windowtext;border-bottom: 1.5pt solid windowtext;border-right: 1.5pt solid windowtext;padding: 0cm 5.4pt;"><section style="text-align: center;margin-bottom: 0px;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;font-size: 14px;">Ubuntu 24.10<o:p></o:p></span></section></td><td width="265.3333333333333" style="border-top: none;border-left: none;border-bottom: 1.5pt solid windowtext;border-right: 1.5pt solid windowtext;padding: 0cm 5.4pt;"><section style="text-align: center;margin-bottom: 0px;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;font-size: 14px;">libmodule-scandeps-perl - 1.35-1ubuntu0.24.10.1<o:p></o:p></span></section><section style="text-align: center;margin-bottom: 0px;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;font-size: 14px;">needrestart - 3.6-8ubuntu4.2<o:p></o:p></span></section></td><td width="74.33333333333336" style="border-top: none;border-left: none;border-bottom: 1.5pt solid windowtext;border-right: 2.25pt solid windowtext;padding: 0cm 5.4pt;"><section style="text-align: center;margin-bottom: 0px;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;font-size: 14px;">/<o:p></o:p></span></section></td></tr><tr style="mso-yfti-irow:2;"><td width="124" style="border-top: none;border-left: 2.25pt solid windowtext;border-bottom: 1.5pt solid windowtext;border-right: 1.5pt solid windowtext;padding: 0cm 5.4pt;"><section style="text-align: center;margin-bottom: 0px;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;font-size: 14px;">Ubuntu 24.04<o:p></o:p></span></section></td><td width="285.3333333333333" style="border-top: none;border-left: none;border-bottom: 1.5pt solid windowtext;border-right: 1.5pt solid windowtext;padding: 0cm 5.4pt;"><section style="text-align: center;margin-bottom: 0px;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;font-size: 14px;">libmodule-scandeps-perl - 1.35-1ubuntu0.24.04.1<o:p></o:p></span></section><section style="text-align: center;margin-bottom: 0px;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;font-size: 14px;">needrestart - 3.6-7ubuntu4.3<o:p></o:p></span></section></td><td width="74.33333333333336" style="border-top: none;border-left: none;border-bottom: 1.5pt solid windowtext;border-right: 2.25pt solid windowtext;padding: 0cm 5.4pt;"><section style="text-align: center;margin-bottom: 0px;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;font-size: 14px;">/<o:p></o:p></span></section></td></tr><tr style="mso-yfti-irow:3;"><td width="124" style="border-top: none;border-left: 2.25pt solid windowtext;border-bottom: 1.5pt solid windowtext;border-right: 1.5pt solid windowtext;padding: 0cm 5.4pt;"><section style="text-align: center;margin-bottom: 0px;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;font-size: 14px;">Ubuntu 22.04<o:p></o:p></span></section></td><td width="285.3333333333333" style="border-top: none;border-left: none;border-bottom: 1.5pt solid windowtext;border-right: 1.5pt solid windowtext;padding: 0cm 5.4pt;"><section style="text-align: center;margin-bottom: 0px;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;font-size: 14px;">libmodule-scandeps-perl - 1.31-1ubuntu0.1<o:p></o:p></span></section><section style="text-align: center;margin-bottom: 0px;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;font-size: 14px;">needrestart - 3.5-5ubuntu2.2<o:p></o:p></span></section></td><td width="74.33333333333336" style="border-top: none;border-left: none;border-bottom: 1.5pt solid windowtext;border-right: 2.25pt solid windowtext;padding: 0cm 5.4pt;"><section style="text-align: center;margin-bottom: 0px;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;font-size: 14px;">/<o:p></o:p></span></section></td></tr><tr style="mso-yfti-irow:4;"><td width="124" style="border-top: none;border-left: 2.25pt solid windowtext;border-bottom: 1.5pt solid windowtext;border-right: 1.5pt solid windowtext;padding: 0cm 5.4pt;"><section style="text-align: center;margin-bottom: 0px;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;font-size: 14px;">Ubuntu 20.04<o:p></o:p></span></section></td><td width="285.3333333333333" style="border-top: none;border-left: none;border-bottom: 1.5pt solid windowtext;border-right: 1.5pt solid windowtext;padding: 0cm 5.4pt;"><section style="text-align: center;margin-bottom: 0px;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;font-size: 14px;">libmodule-scandeps-perl - 1.27-1ubuntu0.1~esm1<o:p></o:p></span></section><section style="text-align: center;margin-bottom: 0px;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;font-size: 14px;">needrestart - 3.4-6ubuntu0.1+esm1<o:p></o:p></span></section></td><td width="74.33333333333336" style="border-top: none;border-left: none;border-bottom: 1.5pt solid windowtext;border-right: 2.25pt solid windowtext;padding: 0cm 5.4pt;"><section style="text-align: center;margin-bottom: 0px;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;font-size: 14px;">适用于Ubuntu Pro<o:p></o:p></span></section></td></tr><tr style="mso-yfti-irow:5;"><td width="124" style="border-top: none;border-left: 2.25pt solid windowtext;border-bottom: 1.5pt solid windowtext;border-right: 1.5pt solid windowtext;padding: 0cm 5.4pt;"><section style="text-align: center;margin-bottom: 0px;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;font-size: 14px;">Ubuntu 18.04<o:p></o:p></span></section></td><td width="285.3333333333333" style="border-top: none;border-left: none;border-bottom: 1.5pt solid windowtext;border-right: 1.5pt solid windowtext;padding: 0cm 5.4pt;"><section style="text-align: center;margin-bottom: 0px;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;font-size: 14px;">libmodule-scandeps-perl - 1.24-1ubuntu0.1~esm1<o:p></o:p></span></section><section style="text-align: center;margin-bottom: 0px;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;font-size: 14px;">needrestart - 3.1-1ubuntu0.1+esm1<o:p></o:p></span></section></td><td width="74.33333333333336" style="border-top: none;border-left: none;border-bottom: 1.5pt solid windowtext;border-right: 2.25pt solid windowtext;padding: 0cm 5.4pt;"><section style="text-align: center;margin-bottom: 0px;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;font-size: 14px;">适用于Ubuntu Pro<o:p></o:p></span></section></td></tr><tr style="mso-yfti-irow:6;mso-yfti-lastrow:yes;"><td width="124" style="border-top: none;border-left: 2.25pt solid windowtext;border-bottom: 2.25pt solid windowtext;border-right: 1.5pt solid windowtext;padding: 0cm 5.4pt;"><section style="text-align: center;margin-bottom: 0px;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;font-size: 14px;">Ubuntu 16.04<o:p></o:p></span></section></td><td width="285.3333333333333" style="border-top: none;border-left: none;border-bottom: 2.25pt solid windowtext;border-right: 1.5pt solid windowtext;padding: 0cm 5.4pt;"><section style="text-align: center;margin-bottom: 0px;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;font-size: 14px;">libmodule-scandeps-perl - 1.20-1ubuntu0.1~esm1<o:p></o:p></span></section><section style="text-align: center;margin-bottom: 0px;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;font-size: 14px;">needrestart - 2.6-1ubuntu0.1~esm1<o:p></o:p></span></section></td><td width="74.33333333333336" style="border-top: none;border-left: none;border-bottom: 2.25pt solid windowtext;border-right: 2.25pt solid windowtext;padding: 0cm 5.4pt;"><section style="text-align: center;margin-bottom: 0px;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;font-size: 14px;">适用于Ubuntu Pro<o:p></o:p></span></section></td></tr></tbody></table>###   
### 3.2 临时措施  
  
1.Ubuntu系统上检查是否受到这些漏洞影响。  
  
在系统上运行以下命令并将列出的版本与上表进行比较：  
  
apt
list --installed | grep "^\(needrestart\|libmodule-scandeps-perl\)"  
  
2.修复措施。  
  
建议升级所有软件包：  
  
**sudo
apt update && sudo apt upgrade******  
  
如果不能执行此操作，可以针对受影响的组件进行以下操作：  
  
**sudo
apt update && sudo apt install --only-upgrade needrestart
libmodule-scandeps-perl******  
  
unattended-upgrades功能在Ubuntu 16.04 LTS 及更高版本中默认启用，如果启用此功能，上述补丁将在可用后 24 小时内自动应用。  
  
3.缓解措施。  
  
修改/etc/needrestart/needrestart.conf文件以禁用解释器扫描功能，从而防止漏洞被利用：  
  
#
Disable interpreter scanners.  
  
$nrconf{interpscan}
= 0;  
### 3.3 通用建议  
  
定期更新系统补丁，减少系统漏洞，提升服务器的安全性。  
  
加强系统和网络的访问控制，修改防火墙策略，关闭非必要的应用端口或服务，减少将危险服务（如SSH、RDP等）暴露到公网，减少攻击面。  
  
使用企业级安全产品，提升企业的网络安全性能。  
  
加强系统用户和权限管理，启用多因素认证机制和最小权限原则，用户和软件权限应保持在最低限度。  
  
启用强密码策略并设置为定期修改。  
### 3.4 参考链接  
  
https://ubuntu.com/blog/needrestart-local-privilege-escalation  
  
https://ubuntu.com/security/notices/USN-7117-1  
  
https://www.qualys.com/2024/11/19/needrestart/needrestart.txt  
  
  
  
