#  【漏洞通告】Apache OFBiz远程代码执行漏洞（CVE-2024-47208）   
 启明星辰安全简讯   2024-11-18 08:56  
  
**一、漏洞****概述**  
<table><tbody><tr style="mso-yfti-irow:0;mso-yfti-firstrow:yes;height:20.15pt;"><td width="82.33333333333333" style="border-width: 2.25pt 1.5pt 1.5pt 2.25pt;border-color: windowtext;border-style: solid;background: rgb(222, 234, 246);padding: 0cm 5.4pt;" height="20"><p style="text-align: center;line-height: 150%;margin-top: 0px;margin-bottom: 0px;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;color: rgb(51, 51, 51);font-size: 14px;">漏洞名称<o:p></o:p></span></p></td><td width="361.3333333333333" colspan="3" style="border-top: 2.25pt solid windowtext;border-left: none;border-bottom: 1.5pt solid windowtext;border-right: 2.25pt solid windowtext;background: rgb(222, 234, 246);padding: 0cm 5.4pt;" height="20"><p style="text-align: center;line-height: 150%;margin-top: 0px;margin-bottom: 0px;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;sans-serif&#34;;color: rgb(51, 51, 51);">Apache OFBiz远程代码执行漏洞<o:p></o:p></span></p></td></tr><tr style="mso-yfti-irow:1;height:20.15pt;"><td width="102" style="border-top: none;border-left: 2.25pt solid windowtext;border-bottom: 1.5pt solid windowtext;border-right: 1.5pt solid windowtext;background: rgb(222, 234, 246);padding: 0cm 5.4pt;" height="20"><p style="text-align: center;line-height: 150%;margin-top: 0px;margin-bottom: 0px;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;color: rgb(51, 51, 51);font-size: 14px;">CVE   ID<o:p></o:p></span></p></td><td width="381.3333333333333" colspan="3" style="border-top: none;border-left: none;border-bottom: 1.5pt solid windowtext;border-right: 2.25pt solid windowtext;background: rgb(222, 234, 246);padding: 0cm 5.4pt;" height="20"><p style="text-align: center;line-height: 150%;margin-top: 0px;margin-bottom: 0px;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;color: rgb(51, 51, 51);font-size: 14px;">CVE-2024-47208<o:p></o:p></span></p></td></tr><tr style="mso-yfti-irow:2;height:20.15pt;"><td width="102" style="border-top: none;border-left: 2.25pt solid windowtext;border-bottom: 1.5pt solid windowtext;border-right: 1.5pt solid windowtext;background: rgb(222, 234, 246);padding: 0cm 5.4pt;" height="20"><p style="text-align: center;line-height: 150%;margin-top: 0px;margin-bottom: 0px;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;color: rgb(51, 51, 51);font-size: 14px;">漏洞类型<o:p></o:p></span></p></td><td width="117.33333333333333" style="border-top: none;border-left: none;border-bottom: 1.5pt solid windowtext;border-right: 1.5pt solid windowtext;background: rgb(222, 234, 246);padding: 0cm 5.4pt;" height="20"><p style="text-align: center;line-height: 150%;margin-top: 0px;margin-bottom: 0px;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;color: black;font-size: 14px;">代码注入、SSRF<o:p></o:p></span></p></td><td width="94.33333333333333" style="border-top: none;border-left: none;border-bottom: 1.5pt solid windowtext;border-right: 1.5pt solid windowtext;background: rgb(222, 234, 246);padding: 0cm 5.4pt;" height="20"><p style="text-align: center;line-height: 150%;margin-top: 0px;margin-bottom: 0px;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;color: rgb(51, 51, 51);font-size: 14px;">发现时间<o:p></o:p></span></p></td><td width="110.33333333333333" style="border-top: none;border-left: none;border-bottom: 1.5pt solid windowtext;border-right: 2.25pt solid windowtext;background: rgb(222, 234, 246);padding: 0cm 5.4pt;" height="20"><p style="text-align: center;line-height: 150%;margin-top: 0px;margin-bottom: 0px;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;color: rgb(51, 51, 51);font-size: 14px;">2024-11-18<o:p></o:p></span></p></td></tr><tr style="mso-yfti-irow:3;height:20.15pt;"><td width="102" style="border-top: none;border-left: 2.25pt solid windowtext;border-bottom: 1.5pt solid windowtext;border-right: 1.5pt solid windowtext;background: rgb(222, 234, 246);padding: 0cm 5.4pt;" height="20"><p style="text-align: center;line-height: 150%;margin-top: 0px;margin-bottom: 0px;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;color: rgb(51, 51, 51);font-size: 14px;">漏洞评分<o:p></o:p></span></p></td><td width="118.33333333333333" style="border-top: none;border-left: none;border-bottom: 1.5pt solid windowtext;border-right: 1.5pt solid windowtext;background: rgb(222, 234, 246);padding: 0cm 5.4pt;" height="20"><p style="text-align: center;line-height: 150%;margin-top: 0px;margin-bottom: 0px;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;color: rgb(51, 51, 51);font-size: 14px;">暂无<o:p></o:p></span></p></td><td width="99.33333333333333" style="border-top: none;border-left: none;border-bottom: 1.5pt solid windowtext;border-right: 1.5pt solid windowtext;background: rgb(222, 234, 246);padding: 0cm 5.4pt;" height="20"><p style="text-align: center;line-height: 150%;margin-top: 0px;margin-bottom: 0px;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;color: rgb(51, 51, 51);font-size: 14px;">漏洞等级<o:p></o:p></span></p></td><td width="110.33333333333333" style="border-top: none;border-left: none;border-bottom: 1.5pt solid windowtext;border-right: 2.25pt solid windowtext;background: rgb(222, 234, 246);padding: 0cm 5.4pt;" height="20"><p style="text-align: center;line-height: 150%;margin-top: 0px;margin-bottom: 0px;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;color: rgb(51, 51, 51);font-size: 14px;">高危<o:p></o:p></span></p></td></tr><tr style="mso-yfti-irow:4;"><td width="102" style="border-top: none;border-left: 2.25pt solid windowtext;border-bottom: 1.5pt solid windowtext;border-right: 1.5pt solid windowtext;background: rgb(222, 234, 246);padding: 0cm 5.4pt;"><p style="text-align: center;line-height: 150%;margin-top: 0px;margin-bottom: 0px;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;color: rgb(51, 51, 51);font-size: 14px;">攻击向量<o:p></o:p></span></p></td><td width="118.33333333333333" style="border-top: none;border-left: none;border-bottom: 1.5pt solid windowtext;border-right: 1.5pt solid windowtext;background: rgb(222, 234, 246);padding: 0cm 5.4pt;"><p style="text-align: center;line-height: 150%;margin-top: 0px;margin-bottom: 0px;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;color: rgb(51, 51, 51);font-size: 14px;">网络<o:p></o:p></span></p></td><td width="99.33333333333333" style="border-top: none;border-left: none;border-bottom: 1.5pt solid windowtext;border-right: 1.5pt solid windowtext;background: rgb(222, 234, 246);padding: 0cm 5.4pt;"><p style="text-align: center;line-height: 150%;margin-top: 0px;margin-bottom: 0px;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;color: rgb(51, 51, 51);font-size: 14px;">所需权限<o:p></o:p></span></p></td><td width="110.33333333333333" style="border-top: none;border-left: none;border-bottom: 1.5pt solid windowtext;border-right: 2.25pt solid windowtext;background: rgb(222, 234, 246);padding: 0cm 5.4pt;"><p style="text-align: center;line-height: 150%;margin-top: 0px;margin-bottom: 0px;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;color: rgb(51, 51, 51);font-size: 14px;">无<o:p></o:p></span></p></td></tr><tr style="mso-yfti-irow:5;"><td width="102" style="border-top: none;border-left: 2.25pt solid windowtext;border-bottom: 1.5pt solid windowtext;border-right: 1.5pt solid windowtext;background: rgb(222, 234, 246);padding: 0cm 5.4pt;"><p style="text-align: center;line-height: 150%;margin-top: 0px;margin-bottom: 0px;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;color: rgb(51, 51, 51);font-size: 14px;">利用难度<o:p></o:p></span></p></td><td width="118.33333333333333" style="border-top: none;border-left: none;border-bottom: 1.5pt solid windowtext;border-right: 1.5pt solid windowtext;background: rgb(222, 234, 246);padding: 0cm 5.4pt;"><p style="text-align: center;line-height: 150%;margin-top: 0px;margin-bottom: 0px;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;color: rgb(51, 51, 51);font-size: 14px;">低<o:p></o:p></span></p></td><td width="99.33333333333333" style="border-top: none;border-left: none;border-bottom: 1.5pt solid windowtext;border-right: 1.5pt solid windowtext;background: rgb(222, 234, 246);padding: 0cm 5.4pt;"><p style="text-align: center;line-height: 150%;margin-top: 0px;margin-bottom: 0px;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;color: rgb(51, 51, 51);font-size: 14px;">用户交互<o:p></o:p></span></p></td><td width="110.33333333333333" style="border-top: none;border-left: none;border-bottom: 1.5pt solid windowtext;border-right: 2.25pt solid windowtext;background: rgb(222, 234, 246);padding: 0cm 5.4pt;"><p style="text-align: center;line-height: 150%;margin-top: 0px;margin-bottom: 0px;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;color: rgb(51, 51, 51);font-size: 14px;">无<o:p></o:p></span></p></td></tr><tr style="mso-yfti-irow:6;mso-yfti-lastrow:yes;"><td width="102" style="border-top: none;border-left: 2.25pt solid windowtext;border-bottom: 2.25pt solid windowtext;border-right: 1.5pt solid windowtext;background: rgb(222, 234, 246);padding: 0cm 5.4pt;"><p style="text-align: center;line-height: 150%;margin-top: 0px;margin-bottom: 0px;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;color: rgb(51, 51, 51);font-size: 14px;">PoC/EXP<o:p></o:p></span></p></td><td width="118.33333333333333" style="border-top: none;border-left: none;border-bottom: 2.25pt solid windowtext;border-right: 1.5pt solid windowtext;background: rgb(222, 234, 246);padding: 0cm 5.4pt;"><p style="text-align: center;line-height: 150%;margin-top: 0px;margin-bottom: 0px;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;color: rgb(51, 51, 51);font-size: 14px;">未公开<o:p></o:p></span></p></td><td width="99.33333333333333" style="border-top: none;border-left: none;border-bottom: 2.25pt solid windowtext;border-right: 1.5pt solid windowtext;background: rgb(222, 234, 246);padding: 0cm 5.4pt;"><p style="text-align: center;line-height: 150%;margin-top: 0px;margin-bottom: 0px;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;color: rgb(51, 51, 51);font-size: 14px;">在野利用<o:p></o:p></span></p></td><td width="110.33333333333333" style="border-top: none;border-left: none;border-bottom: 2.25pt solid windowtext;border-right: 2.25pt solid windowtext;background: rgb(222, 234, 246);padding: 0cm 5.4pt;"><p style="text-align: center;line-height: 150%;margin-top: 0px;margin-bottom: 0px;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;color: rgb(51, 51, 51);font-size: 14px;">未发现<o:p></o:p></span></p></td></tr></tbody></table>  
Apache OFBiz是一个著名的电子商务平台，提供了创建基于最新J2EE/ XML规范和技术标准，构建大中型企业级、跨平台、跨数据库、跨应用服务器的多层、分布式电子商务类WEB应用系统的框架。  
  
2024年11月18日，启明星辰集团VSRC监测到Apache OFBiz中修复了一个远程代码执行漏洞（CVE-2024-47208）。  
  
Apache OFBiz 18.12.17 之前版本中存在远程代码执行漏洞，由于对URL校验不严格，攻击者可通过构造恶意URL绕过校验逻辑并注入Groovy 表达式代码或触发服务器端请求伪造（SSRF）攻击，导致远程代码执行或访问未授权资源。  
  
此外，Apache OFBiz 18.12.17 之前版本中还存在另一个远程代码执行漏洞（CVE-2024-48962），由于在处理URL参数时未正确对特殊字符进行转义和编码，攻击者可以构造恶意URL参数绕过 SameSite cookie限制，通过目标重定向和服务器端模板注入（SSTI）实现跨站请求伪造（CSRF）攻击，进而触发远程代码执行。  
  
## 二、影响范围  
  
Apache OFBiz < 18.12.17  
  
## 三、安全措施  
### 3.1 升级版本  
  
目前这些漏洞已经修复，受影响用户可升级到以下版本：  
  
Apache OFBiz >= 18.12.17  
  
下载链接：  
  
https://ofbiz.apache.org/download.html  
### 3.2 临时措施  
  
暂无。  
### 3.3 通用建议  
  
l  
定期更新系统补丁，减少系统漏洞，提升服务器的安全性。  
  
l  
加强系统和网络的访问控制，修改防火墙策略，关闭非必要的应用端口或服务，减少将危险服务（如SSH、RDP等）暴露到公网，减少攻击面。  
  
l  
使用企业级安全产品，提升企业的网络安全性能。  
  
l  
加强系统用户和权限管理，启用多因素认证机制和最小权限原则，用户和软件权限应保持在最低限度。  
  
l  
启用强密码策略并设置为定期修改。  
### 3.4 参考链接  
  
https://lists.apache.org/thread/ls1w4ywdobn4hok1tpfm1x23n0q59o74  
  
https://issues.apache.org/jira/browse/OFBIZ-13158  
  
https://issues.apache.org/jira/browse/OFBIZ-13162  
  
https://www.openwall.com/lists/oss-security/2024/11/16/3  
  
  
  
