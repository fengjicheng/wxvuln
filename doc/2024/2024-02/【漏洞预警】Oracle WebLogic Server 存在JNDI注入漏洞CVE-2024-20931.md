#  【漏洞预警】Oracle WebLogic Server 存在JNDI注入漏洞CVE-2024-20931   
cexlife  飓风网络安全   2024-02-16 22:29  
  
![](https://mmbiz.qpic.cn/mmbiz_png/ibhQpAia4xu01FQVvqVSLcKwNZhtYfG0q5okiaHGFqG35t0JQkYZBTiaDJfcFuzpHMQiag6pXST4TW6x5oZDwDUibgOw/640?wx_fmt=png&from=appmsg "")  
  
**漏洞描述:**Oracle WebLogic Server是一个用于构建、部署和管理企业级Java应用程序。  
  
AQjmsInitialContextFactory 是一个允许应用程序使用JNDI查找方式访问Oracle AQ提供消息服务的工厂类。  
  
ForeignOpaqueReference是一个对象，lookup时会调用getReferent函数，进行远程对象查询,该漏洞是 CVE-2023-21839 漏洞绕过，在AQjmsInitialContextFactory初始化时会通过 JNDI获取远程的 DataSource，当通过反射修改 ForeignOpaqueReference 的 jndiEnvironment 和 remoteJNDIName 属性后，再次远程查询ForeignOpaqueReference对象会导致 JNDI 注入，从而直接接管 Oracle WebLogic Server 来执行未经授权的操作或访问系统敏感信息。  
  
poc:  
  
![](https://mmbiz.qpic.cn/mmbiz_png/ibhQpAia4xu01FQVvqVSLcKwNZhtYfG0q5s0pjZ4aZ2A0dEpsicPheLd2bvTVz3H7pKxW4kc6u4JdB7CeUea508vA/640?wx_fmt=png&from=appmsg "")  
  
**影响范围:**weblogic_server[12.2.1.4.0, 12.2.1.4.0]weblogic_server[14.1.1.0.0, 14.1.1.0.0]**修复方案:**安装官方1月补丁**参考链接:**https://www.oracle.com/security-alerts/cpujan2024verbose.htmlhttps://glassyamadeus.github.io/2024/01/31/CVE_2024_20931/  
  
