#  【复现】aiohttp 路径遍历漏洞（CVE-2024-23334）的风险通告   
原创 赛博昆仑CERT  赛博昆仑CERT   2024-02-27 18:58  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/iaZ7t7b9Dodvib7ddpGMC6vx4COAy4sBoGbGCkwVUIJSHBPI0z1Utrp1h5ys6ygT3albl3PgjejJcRRRiaDFFbMBA/640?wx_fmt=gif "")  
  
  
-  
赛博昆仑漏洞安全通告-  
  
aiohttp 路径遍历漏洞（CVE-2024-23334）的风险通告   
  
  
![](https://mmbiz.qpic.cn/mmbiz_svg/7j1UQofaR9fsNXgsOXHVKZMJ1PCicm8s4RHQVjCJEjX63AsNibMx3So4wSMAvubEOoU2vLqYY7hIibIJbkEaPIDs5A4ianh5jibxw/640?wx_fmt=svg "")  
  
  
  
****  
**漏洞描述**  
  
aiohttp是一个为Python提供异步HTTP 客户端/服务端编程，基于  
asyncio(Python用于支持异步编程的标准库)  
的异步库。  
  
近日，赛博昆仑CERT监测到aiohttp目录遍历漏洞的漏洞情报。当使用aiohttp启动Web  
  
服务并且静态资源解析使用了不安全的参数follow_symlinks=True时，不会检查读取的文件是否位于静态资源目录内，这将会导致目录遍历漏洞，攻击者利用该漏洞可读取服务器上任意文件。  
  
<table><colgroup><col width="176"/><col width="182"/><col width="182"/><col width="182"/></colgroup><tbody><tr style="height:39px;"><td colspan="1" rowspan="1" style="border-color: rgb(221, 221, 221);font-size: 10pt;padding: 8px;vertical-align: top;" width="127"><p><span style="color: rgb(0, 122, 170);"><strong>漏洞名称</strong></span></p></td><td colspan="3" rowspan="1" style="border-color: rgb(221, 221, 221);font-size: 10pt;padding: 8px;vertical-align: top;"><p><span style="color: rgb(0, 122, 170);">aiohttp 路径遍历漏洞</span></p></td></tr><tr style="height:39px;"><td colspan="1" rowspan="1" style="border-color: rgb(221, 221, 221);font-size: 10pt;padding: 8px;vertical-align: top;" width="127"><p><span style="color: rgb(0, 122, 170);"><strong>漏洞公开编号</strong></span></p></td><td colspan="3" rowspan="1" style="border-color: rgb(221, 221, 221);font-size: 10pt;padding: 8px;vertical-align: top;"><p><span style="color: rgb(0, 122, 170);">CVE-2024-23334</span></p></td></tr><tr style="height:39px;"><td colspan="1" rowspan="1" style="border-color: rgb(221, 221, 221);font-size: 10pt;padding: 8px;vertical-align: top;" width="127"><p><span style="color: rgb(0, 122, 170);"><strong>昆仑漏洞库编号</strong></span></p></td><td colspan="3" rowspan="1" style="border-color: rgb(221, 221, 221);font-size: 10pt;padding: 8px;vertical-align: top;"><p><span style="color: rgb(0, 122, 170);">CYKL-2024-001727</span></p></td></tr><tr style="height:39px;"><td colspan="1" rowspan="1" style="border-color: rgb(221, 221, 221);font-size: 10pt;padding: 8px;vertical-align: top;" width="127"><p><span style="color: rgb(0, 122, 170);"><strong>漏洞类型</strong></span></p></td><td colspan="1" rowspan="1" style="border-color: rgb(221, 221, 221);font-size: 10pt;padding: 8px;vertical-align: top;" width="127"><p><span style="color: rgb(0, 122, 170);">路径遍历</span></p></td><td colspan="1" rowspan="1" style="border-color: rgb(221, 221, 221);font-size: 10pt;padding: 8px;vertical-align: top;" width="127"><p><span style="color: rgb(0, 122, 170);"><strong>公开时间</strong></span></p></td><td colspan="1" rowspan="1" style="border-color: rgb(221, 221, 221);font-size: 10pt;padding: 8px;vertical-align: top;height: 39px;" width="127"><span style="color: rgb(0, 122, 170);">2024-01-29</span><br/></td></tr><tr style="height:39px;"><td colspan="1" rowspan="1" style="border-color: rgb(221, 221, 221);font-size: 10pt;padding: 8px;vertical-align: top;" width="127"><p><span style="color: rgb(0, 122, 170);"><strong>漏洞等级</strong></span></p></td><td colspan="1" rowspan="1" style="border-color: rgb(221, 221, 221);font-size: 10pt;padding: 8px;vertical-align: top;" width="127"><p><span style="color: rgb(0, 122, 170);">中危</span></p></td><td colspan="1" rowspan="1" style="border-color: rgb(221, 221, 221);font-size: 10pt;padding: 8px;vertical-align: top;" width="127"><p><span style="color: rgb(0, 122, 170);"><strong>评分</strong></span></p></td><td colspan="1" rowspan="1" style="border-color: rgb(221, 221, 221);font-size: 10pt;padding: 8px;vertical-align: top;" width="127"><p><span style="color: rgb(0, 122, 170);">7.5</span></p></td></tr><tr style="height:39px;"><td colspan="1" rowspan="1" style="border-color: rgb(221, 221, 221);font-size: 10pt;padding: 8px;vertical-align: top;" width="127"><p><span style="color: rgb(0, 122, 170);"><strong>漏洞所需权限</strong></span></p></td><td colspan="1" rowspan="1" style="border-color: rgb(221, 221, 221);font-size: 10pt;padding: 8px;vertical-align: top;" width="127"><p><span style="color: rgb(0, 122, 170);">无权限要求</span></p></td><td colspan="1" rowspan="1" style="border-color: rgb(221, 221, 221);font-size: 10pt;padding: 8px;vertical-align: top;" width="127"><p><span style="color: rgb(0, 122, 170);"><strong>漏洞利用难度</strong></span></p></td><td colspan="1" rowspan="1" style="border-color: rgb(221, 221, 221);font-size: 10pt;padding: 8px;vertical-align: top;" width="127"><p><span style="color: rgb(0, 122, 170);">低</span></p></td></tr><tr style="height:39px;"><td colspan="1" rowspan="1" style="border-color: rgb(221, 221, 221);font-size: 10pt;padding: 8px;vertical-align: top;" width="127" height="22"><p><span style="color: rgb(0, 122, 170);"><strong>PoC</strong><strong>状态</strong></span></p></td><td colspan="1" rowspan="1" style="border-color: rgb(221, 221, 221);font-size: 10pt;padding: 8px;vertical-align: top;" width="127" height="22"><p><span style="color: rgb(0, 122, 170);">未知</span></p></td><td colspan="1" rowspan="1" style="border-color: rgb(221, 221, 221);font-size: 10pt;padding: 8px;vertical-align: top;" width="127" height="22"><p><span style="color: rgb(0, 122, 170);"><strong>EXP</strong><strong>状态</strong></span></p></td><td colspan="1" rowspan="1" style="border-color: rgb(221, 221, 221);font-size: 10pt;padding: 8px;vertical-align: top;" width="127" height="22"><p><span style="color: rgb(0, 122, 170);">未知</span></p></td></tr><tr style="height:39px;"><td colspan="1" rowspan="1" style="border-color: rgb(221, 221, 221);font-size: 10pt;padding: 8px;vertical-align: top;" width="127"><p><span style="color: rgb(0, 122, 170);"><strong>漏洞细节</strong></span></p></td><td colspan="1" rowspan="1" style="border-color: rgb(221, 221, 221);font-size: 10pt;padding: 8px;vertical-align: top;" width="127"><p><span style="color: rgb(0, 122, 170);">未知</span></p></td><td colspan="1" rowspan="1" style="border-color: rgb(221, 221, 221);font-size: 10pt;padding: 8px;vertical-align: top;" width="127"><p><span style="color: rgb(0, 122, 170);"><strong>在野利用</strong></span></p></td><td colspan="1" rowspan="1" style="border-color: rgb(221, 221, 221);font-size: 10pt;padding: 8px;vertical-align: top;" width="127"><p><span style="color: rgb(0, 122, 170);">未知</span><span style="font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, &#34;Helvetica Neue&#34;, &#34;PingFang SC&#34;, &#34;Hiragino Sans GB&#34;, &#34;Microsoft YaHei UI&#34;, &#34;Microsoft YaHei&#34;, Arial, sans-serif;font-size: var(--articleFontsize);letter-spacing: 0.034em;"></span></p></td></tr></tbody></table>  
  
  
**影响版本**  
  
1.0.5 <aiohttp < 3.9.2  
  
  
  
  
**利用条件**  
1. 使用aiohttp启动web服务  
  
1. 配置aiohttp中的静态资源解析时 ，使用了参数follow_symlinks=True  
  
**漏洞复现**  
  
目前赛博昆仑CERT已确认漏洞原理，复现截图如下：  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/iaZ7t7b9Dodse2oX9DwZbYGztjeghEhZlNKu4GNr9GnDh11Vic9oVzhJdI8Lnn2OL9S1vgtFf8qBPsbQc87W2yeg/640?wx_fmt=png&from=appmsg "")  
  
**防护措施**  
  
  
  
目前，官方已发布修复建议，建议受影响的用户尽快升级至安全版本。  
  
下载地址：https://github.com/aio-libs/aiohttp/tags  
  
**技术咨询**  
  
赛博昆仑支持对用户提供轻量级的检测规则或热补方式，可提供定制化服务适  
配多种产品及规则，帮助用户进行漏洞检测和修复。  
  
赛博昆仑CERT已开启年订阅服务，付费客户(可申请试用)将获取更多技术详情，并支持适配客户的需求。  
  
联系邮箱：cert@cyberkl.com  
  
公众号：赛博昆仑CERT  
  
**参考链接**  
  
https://github.com/aio-libs/aiohttp/tags  
  
  
  
  
**时间线**  
  
2024年02  
月27  
日，赛博昆仑CERT公众号发布漏洞风险通告  
  
  
  
