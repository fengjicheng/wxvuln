#  漏洞通告 | Apache Solr 代码执行漏洞   
原创 微步情报局  微步在线研究响应中心   2024-02-20 10:48  
  
![](https://mmbiz.qpic.cn/mmbiz_png/fFyp1gWjicMKNkm4Pg1Ed6nv0proxQLEKJ2CUCIficfAwKfClJ84puialc9eER0oaibMn1FDUpibeK1t1YvgZcLYl3A/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1 "")  
  
01 漏洞概况****  
  
  
  
Apache Solr是一个基于Java开发的高性能全文搜索服务器，是Apache Lucene项目的开源企业搜索平台。它提供了丰富的查询语言、可配置、可扩展的特性，并对索引、搜索性能进行了优化。近日，微步漏洞团队监测到Apache Solr 发布安全通告披露数个安全漏洞，其中包括两个远程代码执行漏洞（CVE-2023-50386，CVE-2023-50292）。经过分析和研判，以上两个  
漏洞利用条件需要同时满足：  
1）未开启身份认证（默认不开启）2）以集群模式启动最终可导致远程代码执行，受影响的用户建议尽快修复。**CVE-2023-50386（XVE-2023-7001）**  
该漏洞详情于2024年2月公开（https://xz.aliyun.com/t/13637），该漏洞通过利用Solr Collections的Backup/Restore功能，上传恶意class文件，从而造成任意代码执行。  
**CVE-2023-50292（XVE-2023-37874）**  
该漏洞详情于2023年4月公开（https://blog.noah.360.net/apache-solr-rce/），也就是CNVD-2023-27598。该漏洞通过利用Solr的Schema Designer功能，新建Schema上传恶意配置文件，最终造成任意代码执行。  
微步漏洞团队2023年10月发布的XVE-2023-17224漏洞为CVE-2023-50292官方修复的绕过，相关信息可查看  
《[漏洞通告 | Apache Solr 远程代码执行漏洞](http://mp.weixin.qq.com/s?__biz=Mzg5MTc3ODY4Mw==&mid=2247503360&idx=1&sn=29f1738205f8ce6e4c05b868e6596691&chksm=cfcaad14f8bd2402958c119bffaf62c14bbba3b3aa56c2d313c90ba97b419062a27be5aad34d&scene=21#wechat_redirect)  
》  
。  
  
02 漏洞处置优先级（VPT）  
  
  
  
**综合处置优先级：**  
**中**  
  
<table><tbody style="visibility: visible;"><tr style="height: 23.3pt;visibility: visible;"><td width="128" valign="top" rowspan="1" style="padding: 0pt 5.4pt;border-width: 1pt;border-style: solid;border-color: rgb(191, 191, 191);word-break: break-all;visibility: visible;"><p style="visibility: visible;"><strong style="visibility: visible;"><span style="color: rgb(0, 0, 0);font-size: 14px;visibility: visible;">漏洞编号</span></strong></p></td><td width="127" valign="top" style="padding: 0pt 5.4pt;border-width: 1pt 1pt 1pt medium;border-style: solid solid solid none;border-color: rgb(191, 191, 191) rgb(191, 191, 191) rgb(191, 191, 191) currentcolor;visibility: visible;"><p style="visibility: visible;"><span style="font-size: 10.5pt;font-family: 微软雅黑;color: rgb(0, 0, 0);visibility: visible;">微步编号</span></p></td><td width="260" valign="top" style="padding: 0pt 5.4pt;border-width: 1pt 1pt 1pt medium;border-style: solid solid solid none;border-color: rgb(191, 191, 191) rgb(191, 191, 191) rgb(191, 191, 191) currentcolor;word-break: break-all;visibility: visible;"><p style="visibility: visible;"><span style="font-size: 10.5pt;font-family: 微软雅黑;color: rgb(0, 0, 0);visibility: visible;">XVE-2023-7001<br/>XVE-2023-37874<mpchecktext><br/></mpchecktext></span></p></td></tr><tr style="height:23.3000pt;"><td width="153" valign="top" rowspan="6" style="padding: 0pt 5.4pt;border-width: medium 1pt 1pt;border-style: none solid solid;border-color: currentcolor rgb(191, 191, 191) rgb(191, 191, 191);"><p><strong><span style="font-size: 10.5pt;color: rgb(0, 0, 0);font-family: 微软雅黑;">漏洞评估</span></strong></p></td><td width="127" valign="top" style="padding: 0pt 5.4pt;border-width: medium 1pt 1pt medium;border-style: none solid solid none;border-color: currentcolor rgb(191, 191, 191) rgb(191, 191, 191) currentcolor;"><p><span style="font-size: 10.5pt;font-family: 微软雅黑;color: rgb(0, 0, 0);">危害评级</span></p></td><td width="280" valign="top" style="padding: 0pt 5.4pt;border-width: medium 1pt 1pt medium;border-style: none solid solid none;border-color: currentcolor rgb(191, 191, 191) rgb(191, 191, 191) currentcolor;word-break: break-all;"><p><span style="font-size: 10.5pt;font-family: 微软雅黑;color: rgb(0, 0, 0);">中危</span></p></td></tr><tr style="height:23.3000pt;"><td width="194" valign="top" style="padding: 0pt 5.4pt;border-width: medium 1pt 1pt medium;border-style: none solid solid none;border-color: currentcolor rgb(191, 191, 191) rgb(191, 191, 191) currentcolor;"><p><span style="font-size: 10.5pt;color: rgb(0, 0, 0);font-family: 微软雅黑;">漏洞类型</span></p></td><td width="185" valign="top" style="padding: 0pt 5.4pt;border-width: medium 1pt 1pt medium;border-style: none solid solid none;border-color: currentcolor rgb(191, 191, 191) rgb(191, 191, 191) currentcolor;word-break: break-all;"><p><span style="font-size: 10.5pt;font-family: 微软雅黑;color: rgb(0, 0, 0);">RCE</span></p></td></tr><tr style="height:20.2500pt;"><td width="194" valign="top" style="padding: 0pt 5.4pt;border-width: medium 1pt 1pt medium;border-style: none solid solid none;border-color: currentcolor rgb(191, 191, 191) rgb(191, 191, 191) currentcolor;"><p><span style="font-size: 10.5pt;color: rgb(0, 0, 0);font-family: 微软雅黑;">公开程度</span></p></td><td width="185" valign="top" style="padding: 0pt 5.4pt;border-width: medium 1pt 1pt medium;border-style: none solid solid none;border-color: currentcolor rgb(191, 191, 191) rgb(191, 191, 191) currentcolor;word-break: break-all;"><p><span style="font-size: 10.5pt;font-family: 微软雅黑;color: rgb(0, 0, 0);">PoC已公开</span></p></td></tr><tr><td valign="top" colspan="1" rowspan="1" style="border-left-color: rgb(191, 191, 191);border-left-width: 1pt;border-top-color: rgb(191, 191, 191);border-top-width: 1pt;word-break: break-all;"><span style="font-size: 15px;">利用条件<br/></span></td><td valign="top" colspan="1" rowspan="1" style="border-left-color: rgb(191, 191, 191);border-left-width: 1pt;border-top-color: rgb(191, 191, 191);border-top-width: 1pt;word-break: break-all;"><span style="font-size: 15px;">未开启身份认证（默认不开启）<br/>以集群模式启动</span></td></tr><tr style="height:20.2500pt;"><td width="194" valign="top" style="padding: 0pt 5.4pt;border-width: medium 1pt 1pt medium;border-style: none solid solid none;border-color: currentcolor rgb(191, 191, 191) rgb(191, 191, 191) currentcolor;"><p><span style="font-size: 10.5pt;color: rgb(0, 0, 0);font-family: 微软雅黑;">交互要求</span></p></td><td width="185" valign="top" style="padding: 0pt 5.4pt;border-width: medium 1pt 1pt medium;border-style: none solid solid none;border-color: currentcolor rgb(191, 191, 191) rgb(191, 191, 191) currentcolor;"><p><span style="font-size: 10.5pt;font-family: 微软雅黑;color: rgb(0, 0, 0);">0-click</span></p></td></tr><tr style="height:20.2500pt;"><td width="194" valign="top" style="padding: 0pt 5.4pt;border-width: medium 1pt 1pt medium;border-style: none solid solid none;border-color: currentcolor rgb(191, 191, 191) rgb(191, 191, 191) currentcolor;"><p><span style="font-size: 10.5pt;color: rgb(0, 0, 0);font-family: 微软雅黑;">威胁类型</span></p></td><td width="185" valign="top" style="padding: 0pt 5.4pt;border-width: medium 1pt 1pt medium;border-style: none solid solid none;border-color: currentcolor rgb(191, 191, 191) rgb(191, 191, 191) currentcolor;"><p><span style="font-size: 10.5pt;font-family: 微软雅黑;color: rgb(0, 0, 0);">远程</span></p></td></tr><tr style="height:20.4000pt;"><td width="153" valign="top" style="padding: 0pt 5.4pt;border-width: medium 1pt 1pt;border-style: none solid solid;border-color: currentcolor rgb(191, 191, 191) rgb(191, 191, 191);"><p><strong><span style="font-size: 10.5pt;color: rgb(0, 0, 0);font-family: 微软雅黑;">利用情报</span></strong></p></td><td width="127" valign="top" style="padding: 0pt 5.4pt;border-width: medium 1pt 1pt medium;border-style: none solid solid none;border-color: currentcolor rgb(191, 191, 191) rgb(191, 191, 191) currentcolor;"><p><span style="font-size: 10.5pt;font-family: 微软雅黑;color: rgb(0, 0, 0);">微步已捕获攻击行为</span></p></td><td width="280" valign="top" style="padding: 0pt 5.4pt;border-width: medium 1pt 1pt medium;border-style: none solid solid none;border-color: currentcolor rgb(191, 191, 191) rgb(191, 191, 191) currentcolor;word-break: break-all;"><p><span style="font-size: 14px;">暂无</span></p></td></tr></tbody></table>  
  
### 03 漏洞影响范围 产品名称Apache Solr受影响版本XVE-2023-70018.10.0 <= version < 9.2.0XVE-2023-378746.0.0<= version < 8.11.39.0.0<= version < 9.4.1影响范围万级有无修复补丁有前往X情报社区资产测绘查看影响资产详情：https://x.threatbook.com/v5/survey?q=app%3D"Apache-Solr"  
  
### 04 漏洞复现 1) XVE-2023-70012）XVE-2023-3787405 修复方案1、官方修复方案：升级至9.4.1及以上版本，可修复以上漏洞：https://solr.apache.org/downloads.html2、临时修复方案：1.使用防护类设备对相关资产进行防护，重点关注/api/schema-designer/*；/solr/admin/configs/*有关路径2.Solr默认全局未授权，建议开启身份认证3.如非必要，避免将资产暴露在互联网06 微步产品侧支持情况1）微步在线威胁感知平台TDP已支持检测XVE-2023-37874 规则ID为 S3100028506，S3100028511XVE-2023-7001 规则ID为 S3100121063，S31000240852）微步在线安全情报网关OneSIG已支持防护，XVE-2023-37874 规则ID为 3100028506，3100028511XVE-2023-7001规则ID为 3100121063，310002408507 时间线 2024.02.08 微步漏洞团队获取相关情报2024.02.20 微步发布报告---End---微步漏洞情报订阅服务微步提供漏洞情报订阅服务，精准、高效助力企业漏洞运营提供高价值漏洞情报，具备及时、准确、全面和可操作性，帮助企业高效应对漏洞应急与日常运营难题；可实现对高威胁漏洞提前掌握，以最快的效率解决信息差问题，缩短漏洞运营MTTR；提供漏洞完整的技术细节，更贴近用户漏洞处置的落地；将漏洞与威胁事件库、APT组织和黑产团伙攻击大数据、网络空间测绘等结合，对漏洞的实际风险进行持续动态更新。扫码在线沟通↓↓↓点此电话咨询X 漏洞奖励计划“X漏洞奖励计划”是微步X情报社区推出的一款针对未公开漏洞的奖励计划，我们鼓励白帽子提交挖掘到的0day漏洞，并给予白帽子可观的奖励。我们期望通过该计划与白帽子共同努力，提升0day防御能力，守护数字世界安全。活动详情：https://x.threatbook.com/v5/vulReward  
  
  
