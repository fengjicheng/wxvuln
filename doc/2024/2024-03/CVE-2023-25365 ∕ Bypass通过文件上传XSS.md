#  CVE-2023-25365 / Bypass通过文件上传XSS   
 Ots安全   2024-03-09 13:55  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/bL2iaicTYdZn7gtxSFZlfuCW6AdQib8Q1onbR0U2h9icP1eRO6wH0AcyJmqZ7USD0uOYncCYIH7ZEE8IicAOPxyb9IA/640?wx_fmt=gif "")  
  
October CMS是一个基于Laravel PHP框架的自托管获奖平台。最初，我们试图上传，但这是不可能的，该应用程序有一个过滤器和分析源代码的源代码，我们意识到，它只允许以下扩展上传：  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/rWGOWg48tad6tnviamOxYucL9bibPUTibZPSw5ibpiax9brunAXYXFlcpicnLEeBL6QuaIT72Bb6pic7lJxpJCiaf5TvYw/640?wx_fmt=png&from=appmsg "")  
  
  
  
根据下面的gif，我们试图上传一个.html文件，但没有成功，消息如下：  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_gif/rWGOWg48tad6tnviamOxYucL9bibPUTibZPiaFP7hiaibPyJndBIduzg8cKTqaKMyPHGTiao2rsVP9xctKWNiaII8anib4w/640?wx_fmt=gif&from=appmsg "")  
  
**Bypass**  
  
我们发现可以不使用文件名上传，只需使用应用程序接受的扩展名。我尝试上传a.php上传文件失败  
  
但是通过拦截请求并将.html更改为系统接受的.mp3扩展名，我们能够成功。  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_gif/rWGOWg48tad6tnviamOxYucL9bibPUTibZP2Ql2ot1KMDYMOSndeibibeW5aVS9nfMgrHbHiaOYDnVkOvhicIA3yClxQw/640?wx_fmt=gif&from=appmsg "")  
  
我们插入一个简单的html文件，在访问页面时触发脚本。  
```
<!DOCTYPE html>
<html>
  <body>
    <script>
      alert('XSS');
</script>
  </body>
</html>
```  
  
在我们成功上传.mp3文件后，**它被隐藏在系统中**，所以我们**上传了一个“mask.jpg”**图片，并查看图片看到了文件路径。  
  
这样我们就可以将其**图片更改为隐藏的.mp3文件**，该文件不验证文件类型并运行我们的脚本）  
  
  
  
  
  
感谢您抽出  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWgdSBqOibtgiaYWjL4pkRXwycNnFvFYVgXoExRy0gqCkqvrAghf8KPXnwQaYq77HMsjcVka7kPcBDQw/640?wx_fmt=gif "")  
  
.  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWgdSBqOibtgiaYWjL4pkRXwycd5KMTutPwNWA97H5MPISWXLTXp0ibK5LXCBAXX388gY0ibXhWOxoEKBA/640?wx_fmt=gif "")  
  
.  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWgdSBqOibtgiaYWjL4pkRXwycU99fZEhvngeeAhFOvhTibttSplYbBpeeLZGgZt41El4icmrBibojkvLNw/640?wx_fmt=gif "")  
  
来阅读本文  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWge7Mibiad1tV0iaF8zSD5gzicbxDmfZCEL7vuOevN97CwUoUM5MLeKWibWlibSMwbpJ28lVg1yj1rQflyQ/640?wx_fmt=gif "")  
  
**点它，分享点赞在看都在这里**  
  
