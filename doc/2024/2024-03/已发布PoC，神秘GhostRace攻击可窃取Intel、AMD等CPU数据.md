#  已发布PoC，神秘GhostRace攻击可窃取Intel、AMD等CPU数据   
 网络安全应急技术国家工程中心   2024-03-15 15:25  
  
英特尔、AMD、Arm和IBM等CPU制造商以及软件供应商，受到一种名为GhostRace的新型推测性竞态条件（SRC）攻击的影响。  
  
来自IBM和荷兰阿姆斯特丹自由大学的研究团队在3月12日披露了一种新型数据泄漏攻击的细节，该攻击影响所有主要CPU制造商以及一些广泛使用的软件。  
  
![](https://mmbiz.qpic.cn/mmbiz_jpg/qq5rfBadR3ic973J1OQRoy0Cl94TGFrrK9IXlL8BQFskMyJHialZC6RHXduczzSTxSywzKbKbPLlkTE9hczg140Q/640?wx_fmt=jpeg&from=appmsg&tp=wxpic&wxfrom=5&wx_lazy=1&wx_co=1 "")  
  
这种新攻击被称为GhostRace，与研究人员所描述的推测性竞态条件（SRCs）有关，可能允许攻击者从内存中获取敏感信息，如密码和加密密钥。当多个线程同时尝试访问共享资源时，就会出现竞态条件，这可能会产生可以被用于各种目的的漏洞，包括任意代码执行、绕过安全防御和获取数据。值得一提的是，发起该攻击有一定的门槛，攻击者需预先获取一定的访问权限。  
  
操作系统使用同步原语可以避免竞态条件，但IBM和阿姆斯特丹自由大学研究人员对这些原语进行的安全分析表明，竞态条件可以与推测性执行结合起来，这是过去几年中经常在CPU攻击中利用的一种技术。  
  
研究人员在其研究论文的博客中解释：“我们的关键发现是，所有使用条件分支实现的常见同步原语，都可以在推测性路径上通过Spectre-v1攻击在微架构上绕过，将所有在架构上没有竞态条件的关键区域变成推测性竞态条件（SRCs），允许攻击者泄露目标软件中的信息。”  
  
为了发起攻击并赢得推测性竞态条件，受害过程的执行必须在正确的点上被中断，并保持在那里，以允许攻击者执行研究人员所描述的推测性并发使用后释放（SCUAF）攻击。为此他们使用了一种名为进程间中断（IPI）风暴的新技术实现该目标，该技术涉及淹没目标进程的CPU核心。  
  
在Linux内核中扫描SCUAF装置，发现了近1300个潜在的可利用装置。研究人员展示了对Linux内核的SCUAF信息泄露攻击，实现了每秒12Kb的内核内存泄漏。虽然研究主要集中在x86架构和Linux上，但专家表示，他们确认所有主要硬件供应商都受到影响。  
  
研究人员表示，通过条件分支实现同步原语，而没有在该路径上任何序列化指令，并运行在任何允许条件分支被推测性执行的微架构（例如x86、ARM、RISC-V等）上，都容易受到SRCs的攻击。  
  
英特尔、AMD、Arm和IBM在2023年底了解了GhostRace攻击，反馈操作系统和虚拟机监控器供应商，并且正在着手解决这些问题。3月13日，AMD发布公告称之前针对Spectre类型攻击的指导也有用于防止GhostRace攻击。  
  
Xen虚拟机监控器的开发者们也发布公告称，理论上来说所有版本的Xen都有被攻击的风险，但目前没有发现任何已知的易受到GhostRace攻击的装置，因此认为并不需要立即采取行动。  
  
此外，研究人员还提供了一个概念验证（PoC）漏洞利用程序、用于扫描Linux内核中SCUAF装置的脚本，以及他们已经识别出来的装置列表。  
  
  
  
原文来源  
：FreeBuf  
  
“投稿联系方式：010-82992251   sunzhonghao@cert.org.cn”  
  
![](https://mmbiz.qpic.cn/mmbiz_jpg/GoUrACT176n1NvL0JsVSB8lNDX2FCGZjW0HGfDVnFao65ic4fx6Rv4qylYEAbia4AU3V2Zz801UlicBcLeZ6gS6tg/640?wx_fmt=jpeg&wxfrom=5&wx_lazy=1&wx_co=1 "")  
  
  
