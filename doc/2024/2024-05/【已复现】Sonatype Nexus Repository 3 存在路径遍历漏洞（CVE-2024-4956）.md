#  【已复现】Sonatype Nexus Repository 3 存在路径遍历漏洞（CVE-2024-4956）   
安恒研究院  安恒信息CERT   2024-05-23 18:32  
  
![](https://mmbiz.qpic.cn/mmbiz_png/JAzzLj4nXesCfIew4xDgxHPaichzoa958OaWgTglXPf5mic3dq7TZc3np7PMDpLQPa4pL89cQvD6FAZaN71atsbA/640?wx_fmt=png&from=appmsg&wx_&wx_&wx_&wx_ "")  
  
<table><tbody><tr><td colspan="4" rowspan="1" width="100.0000%" data-style="border-width:1px;border-color:rgb(69, 119, 218);border-style:solid;background-color:rgb(69, 119, 218);box-sizing:border-box;" class="js_darkmode__0" style="word-break:break-all;hyphens:auto;border-color:rgb(69, 119, 218);background-color:rgb(69, 119, 218);"><section style="margin-top: 5px;margin-bottom: 5px;"><section style="margin-bottom: unset;padding-right: 5px;padding-left: 5px;font-size: 14px;color: rgb(255, 255, 255);"><p style="text-align:center;"><strong>漏洞概述</strong></p></section></section></td></tr><tr><td colspan="1" rowspan="1" width="25.0000%" style="word-break:break-all;hyphens:auto;border-color:rgb(69, 119, 218);"><section style="margin-top: 5px;margin-bottom: 5px;"><section style="margin-bottom: unset;padding-right: 5px;padding-left: 5px;font-size: 14px;"><p style="text-align:left;"><strong>漏洞名称</strong></p></section></section></td><td colspan="3" rowspan="1" width="75.0000%" style="word-break:break-all;hyphens:auto;border-color:rgb(69, 119, 218);"><section style="margin-top: 5px;margin-bottom: 5px;"><section style="margin-bottom: unset;padding-right: 5px;padding-left: 5px;font-size: 14px;"><p><span style="letter-spacing:0.544px;">Sonatype Nexus Repository 3 存在路径遍历漏洞（CVE-2024-4956）</span></p></section></section></td></tr><tr><td colspan="1" rowspan="1" width="25.0000%" style="word-break:break-all;hyphens:auto;border-color:rgb(69, 119, 218);"><section style="margin-top: 5px;margin-bottom: 5px;"><section style="margin-bottom: unset;padding-right: 5px;padding-left: 5px;font-size: 14px;"><p style="text-align:left;"><strong>安恒CERT评级</strong></p></section></section></td><td colspan="1" rowspan="1" width="25.0000%" style="word-break:break-all;hyphens:auto;border-color:rgb(69, 119, 218);"><section style="margin-top: 5px;margin-bottom: 5px;"><section style="margin-bottom: unset;padding-right: 5px;padding-left: 5px;font-size: 14px;"><p style="text-align:left;word-break:break-all;">2级</p></section></section></td><td colspan="1" rowspan="1" width="25.0000%" style="word-break:break-all;hyphens:auto;border-color:rgb(69, 119, 218);"><section style="margin-top: 5px;margin-bottom: 5px;"><section style="margin-bottom: unset;padding-right: 5px;padding-left: 5px;font-size: 14px;"><p style="text-align:left;"><strong>CVSS3.1评分</strong></p></section></section></td><td colspan="1" rowspan="1" width="25.0000%" style="word-break:break-all;hyphens:auto;border-color:rgb(69, 119, 218);"><section style="margin-top: 5px;margin-bottom: 5px;"><section style="margin-bottom: unset;padding-right: 5px;padding-left: 5px;font-size: 14px;"><p style="text-align:left;">7.5</p></section></section></td></tr><tr><td colspan="1" rowspan="1" width="25.0000%" style="word-break:break-all;hyphens:auto;border-color:rgb(69, 119, 218);"><section style="margin-top: 5px;margin-bottom: 5px;"><section style="margin-bottom: unset;padding-right: 5px;padding-left: 5px;font-size: 14px;"><p style="text-align:left;"><strong>CVE编号</strong></p></section></section></td><td colspan="1" rowspan="1" width="25.0000%" style="word-break:break-all;hyphens:auto;border-color:rgb(69, 119, 218);"><section style="margin-top: 5px;margin-bottom: 5px;"><section style="margin-bottom: unset;padding-right: 5px;padding-left: 5px;font-size: 14px;"><p>CVE-2024-4956</p></section></section></td><td colspan="1" rowspan="1" width="25.0000%" style="word-break:break-all;hyphens:auto;border-color:rgb(69, 119, 218);"><section style="margin-top: 5px;margin-bottom: 5px;"><section style="margin-bottom: unset;padding-right: 5px;padding-left: 5px;font-size: 14px;"><p style="text-align:left;"><strong>CNVD编号</strong></p></section></section></td><td colspan="1" rowspan="1" width="25.0000%" style="word-break:break-all;hyphens:auto;border-color:rgb(69, 119, 218);"><section style="margin-top: 5px;margin-bottom: 5px;"><section style="margin-bottom: unset;padding-right: 5px;padding-left: 5px;font-size: 14px;"><p style="text-align:left;">未分配</p></section></section></td></tr><tr><td colspan="1" rowspan="1" width="25.0000%" style="word-break:break-all;hyphens:auto;border-color:rgb(69, 119, 218);"><section style="margin-top: 5px;margin-bottom: 5px;"><section style="margin-bottom: unset;padding-right: 5px;padding-left: 5px;font-size: 14px;"><p style="text-align:left;"><strong>CNNVD编号</strong></p></section></section></td><td colspan="1" rowspan="1" width="25.0000%" style="word-break:break-all;hyphens:auto;border-color:rgb(69, 119, 218);"><section style="margin-top: 5px;margin-bottom: 5px;"><section style="margin-bottom: unset;padding-right: 5px;padding-left: 5px;font-size: 14px;"><p>CNNVD-202405-2896</p></section></section></td><td colspan="1" rowspan="1" width="25.0000%" style="word-break:break-all;hyphens:auto;border-color:rgb(69, 119, 218);"><section style="margin-top: 5px;margin-bottom: 5px;"><section style="margin-bottom: unset;padding-right: 5px;padding-left: 5px;font-size: 14px;"><p style="text-align:left;"><strong>安恒CERT编号</strong></p></section></section></td><td colspan="1" rowspan="1" width="25.0000%" style="word-break:break-all;hyphens:auto;border-color:rgb(69, 119, 218);"><section style="margin-top: 5px;margin-bottom: 5px;"><section style="margin-bottom: unset;padding-right: 5px;padding-left: 5px;font-size: 14px;"><p><span style="letter-spacing:0.544px;">DM-202405-002432</span></p></section></section></td></tr><tr><td colspan="1" rowspan="1" width="25.0000%" style="word-break:break-all;hyphens:auto;border-color:rgb(69, 119, 218);"><section style="margin-top: 5px;margin-bottom: 5px;"><section style="margin-bottom: unset;padding-right: 5px;padding-left: 5px;font-size: 14px;"><p style="text-align:left;"><strong>POC情况</strong></p></section></section></td><td colspan="1" rowspan="1" width="25.0000%" style="word-break:break-all;hyphens:auto;border-color:rgb(69, 119, 218);"><section style="margin-top: 5px;margin-bottom: 5px;"><section style="margin-bottom: unset;padding-right: 5px;padding-left: 5px;font-size: 14px;"><p style="text-align:left;">已发<span style="letter-spacing:0.57834px;line-height:22.4px;">现</span></p></section></section></td><td colspan="1" rowspan="1" width="25.0000%" style="word-break:break-all;hyphens:auto;border-color:rgb(69, 119, 218);"><section style="margin-top: 5px;margin-bottom: 5px;"><section style="margin-bottom: unset;padding-right: 5px;padding-left: 5px;font-size: 14px;"><p style="text-align:left;"><strong>EXP情况</strong></p></section></section></td><td colspan="1" rowspan="1" width="25.0000%" style="word-break:break-all;hyphens:auto;border-color:rgb(69, 119, 218);"><section style="margin-top: 5px;margin-bottom: 5px;"><section style="margin-bottom: unset;padding-right: 5px;padding-left: 5px;font-size: 14px;"><p style="text-align:left;">未发现</p></section></section></td></tr><tr><td colspan="1" rowspan="1" width="25.0000%" style="word-break:break-all;hyphens:auto;border-color:rgb(69, 119, 218);"><section style="margin-top: 5px;margin-bottom: 5px;"><section style="margin-bottom: unset;padding-right: 5px;padding-left: 5px;font-size: 14px;"><p style="text-align:left;"><strong>在野利用</strong></p></section></section></td><td colspan="1" rowspan="1" width="25.0000%" style="word-break:break-all;hyphens:auto;border-color:rgb(69, 119, 218);"><section style="margin-top: 5px;margin-bottom: 5px;"><section style="margin-bottom: unset;padding-right: 5px;padding-left: 5px;font-size: 14px;"><p style="text-align:left;">未发现</p></section></section></td><td colspan="1" rowspan="1" width="25.0000%" style="word-break:break-all;hyphens:auto;border-color:rgb(69, 119, 218);"><section style="margin-top: 5px;margin-bottom: 5px;"><section style="margin-bottom: unset;padding-right: 5px;padding-left: 5px;font-size: 14px;"><p style="text-align:left;"><strong>研究情况</strong></p></section></section></td><td colspan="1" rowspan="1" width="25.0000%" style="word-break:break-all;hyphens:auto;border-color:rgb(69, 119, 218);"><section style="margin-top: 5px;margin-bottom: 5px;"><section style="margin-bottom: unset;padding-right: 5px;padding-left: 5px;font-size: 14px;"><p style="text-align:left;">已复现</p></section></section></td></tr><tr><td colspan="1" rowspan="1" width="25.0000%" style="word-break:break-all;hyphens:auto;border-color:rgb(69, 119, 218);"><section style="margin-top: 5px;margin-bottom: 5px;"><section style="margin-bottom: unset;padding-right: 5px;padding-left: 5px;font-size: 14px;"><p style="text-align:left;"><strong>危害描述</strong></p></section></section></td><td colspan="3" rowspan="1" width="75.0000%" style="word-break:break-all;hyphens:auto;border-color:rgb(69, 119, 218);"><section style="margin-top: 5px;margin-bottom: 5px;"><section style="margin-bottom: unset;padding-right: 5px;padding-left: 5px;font-size: 14px;overflow: hidden;line-height: 0;"><br/></section><p><span style="font-size:14px;letter-spacing:0.57834px;">该漏洞允许未经过身份验证的攻击者读取系统文件。</span></p><section style="margin-bottom: unset;padding-right: 5px;padding-left: 5px;font-size: 14px;overflow: hidden;line-height: 0;"><br/></section></section></td></tr></tbody></table>  
  
该产品主要使用客户行业分布广泛，漏洞危害性高，建议客户尽快做好自查及防护。  
  
安恒研究院卫兵实验室已复现此漏洞。  
  
![](https://mmbiz.qpic.cn/mmbiz_png/JAzzLj4nXevRTn4aPBDlrGh1wFjoj60Q5ulT0oVWe6qxZaOseKZ0eJ2ICQhEog7GkgO1CoBqokNmFTWjeo8fqg/640?wx_fmt=png&from=appmsg "")  
  
Sonatype Nexus Repository 3路径遍历  
漏洞复现截图  
  
  
  
  
**漏洞信息**  
  
  
  
  
  
**产品描述**  
  
Sonatype Nexus Repository 3是一款功能强大的软件仓库管理器，旨在帮助组织有效地管理和维护其软件构件和依赖项。它提供了一个集中化的平台，让开发团队可以轻松地存储、共享和管理各种软件构建块。  
  
  
**漏洞危害等级：**  
高危  
  
**漏洞类型：**  
路径遍历  
  
  
**影响范围**  
  
**影响版本：**  
  
Sonatype Nexus < 3.68.1  
  
  
**CVSS向量**  
  
访问途径（AV）：网络  
  
攻击复杂度（AC）：低  
  
所需权限（PR）：无需任何权限  
  
用户交互（UI）：不需要用户交互  
  
影响范围 （S）：不变  
  
机密性影响 （C）：高  
  
完整性影响 （l）：无  
  
可用性影响 （A）：无  
  
  
  
**修复方案**  
  
  
  
  
**官方修复方案：**  
  
官方已发布修复方案，受影响的用户建议更新至安全版本。  
  
官方链接：  
  
```
https://help.sonatype.com/repomanager3/download
```  
  
  
**临时缓解方案：**  
  
编辑 Sonatype Nexus 存储库 jetty.xml:   
  
1、对于Sonatype Nexus Repository 的每个实例，编辑并从文件中删除这一行：  
  
```
(basedir)/etc/jetty/jetty.xml <Set name="resourceBase"><Property name="karaf.base"/>/public</Set> 
```  
  
  
2、重新启动 Nexus Repository 以使更改生效。  
  
  
  
**网空资产测绘**  
  
  
  
  
根据安恒Sumap全球网络空间资产测绘近三个月数据显示，受影响资产主要分布在中国、美国和德国等国家，其中国内资产为7908。  
  
![](https://mmbiz.qpic.cn/mmbiz_png/JAzzLj4nXevRTn4aPBDlrGh1wFjoj60QaxA7mISYNyLy9g0y49O9FkG9WZ7lRQTh75MAicR3eMbVxQicJboibImPw/640?wx_fmt=png&from=appmsg "")  
  
  
  
  
**参考资料**  
  
  
  
  
  
```
https://support.sonatype.com/hc/en-us/articles/29412417068819-Mitigations-for-CVE-2024-4956-Nexus-Repository-3-Vulnerability
https://support.sonatype.com/hc/en-us/articles/29416509323923-CVE-2024-4956-Nexus-Repository-3-Path-Traversal-2024-05-16
```  
  
**产品能力覆盖**  
  
  
  
<table><tbody><tr><td colspan="1" rowspan="1" width="33.0000%" data-style="border-width:1px;border-color:rgb(69, 119, 218);border-style:solid;background-color:rgb(69, 119, 218);box-sizing:border-box;" class="js_darkmode__38" style="word-break:break-all;hyphens:auto;border-color:#4577da;background-color:#4577da;"><section style="margin-top: 5px;margin-bottom: 5px;"><section style="margin-bottom: unset;padding-right: 5px;padding-left: 5px;text-align: left;font-size: 14px;color: rgb(255, 255, 255);"><p><strong>产品名称</strong></p></section></section></td><td colspan="1" rowspan="1" width="67.0000%" data-style="border-width:1px;border-color:rgb(69, 119, 218);border-style:solid;background-color:rgb(69, 119, 218);box-sizing:border-box;" class="js_darkmode__39" style="word-break:break-all;hyphens:auto;border-color:#4577da;background-color:#4577da;"><section style="margin-top: 5px;margin-bottom: 5px;"><section style="margin-bottom: unset;padding-right: 5px;padding-left: 5px;text-align: left;font-size: 14px;color: rgb(255, 255, 255);"><p><strong>覆盖补丁包</strong></p></section></section></td></tr><tr><td colspan="1" rowspan="1" width="33.0000%" style="word-break:break-all;hyphens:auto;border-color:#4577da;"><section style="margin-top: 5px;margin-bottom: 5px;"><section style="margin-bottom: unset;padding-right: 5px;padding-left: 5px;text-align: left;font-size: 14px;"><p>AiLPHA大数据平台</p></section></section></td><td colspan="1" rowspan="1" width="67.0000%" style="word-break:break-all;hyphens:auto;border-color:#4577da;"><section style="margin-top: 5px;margin-bottom: 5px;"><section style="margin-bottom: unset;padding-right: 5px;padding-left: 5px;text-align: left;font-size: 14px;"><p>已支持</p></section></section></td></tr><tr><td width="33.0000%" style="word-break:break-all;hyphens:auto;border-color:#4577da;"><section style="margin-top: 5px;margin-bottom: 5px;"><section style="margin-bottom: unset;padding-right: 5px;padding-left: 5px;text-align: left;font-size: 14px;"><p>APT攻击预警平台</p></section></section></td><td width="67.0000%" style="word-break:break-all;hyphens:auto;border-color:#4577da;"><section style="margin-top: 5px;margin-bottom: 5px;"><section style="margin-bottom: unset;padding-right: 5px;padding-left: 5px;text-align: left;font-size: 14px;"><p>已支持</p></section></section></td></tr><tr><td width="33.0000%" style="word-break:break-all;hyphens:auto;border-color:#4577da;"><section style="margin-top: 5px;margin-bottom: 5px;"><section style="margin-bottom: unset;padding-right: 5px;padding-left: 5px;text-align: left;font-size: 14px;"><p>明鉴漏洞扫描系统</p></section></section></td><td width="67.0000%" style="word-break:break-all;hyphens:auto;border-color:#4577da;"><section style="margin-top: 5px;margin-bottom: 5px;"><section style="margin-bottom: unset;padding-right: 5px;padding-left: 5px;text-align: left;font-size: 14px;"><p>V1.3.1659.1611及以上版本</p></section></section></td></tr><tr><td width="33.0000%" style="word-break:break-all;hyphens:auto;border-color:#4577da;"><section style="margin-top: 5px;margin-bottom: 5px;"><section style="margin-bottom: unset;padding-right: 5px;padding-left: 5px;text-align: left;font-size: 14px;"><p><span style="letter-spacing:0.544px;">WebScan7</span></p></section></section></td><td width="67.0000%" style="word-break:break-all;hyphens:auto;border-color:#4577da;"><section style="margin-top: 5px;margin-bottom: 5px;"><section style="margin-bottom: unset;padding-right: 5px;padding-left: 5px;text-align: left;font-size: 14px;"><p>v1.0.1.157及以上版本</p></section></section></td></tr><tr><td width="33.0000%" style="word-break:break-all;hyphens:auto;border-color:#4577da;"><section style="margin-top: 5px;margin-bottom: 5px;"><section style="margin-bottom: unset;padding-right: 5px;padding-left: 5px;text-align: left;font-size: 14px;"><p>WAF<br/></p></section></section></td><td width="67.0000%" style="word-break:break-all;hyphens:auto;border-color:#4577da;"><section style="margin-top: 5px;margin-bottom: 5px;"><section style="margin-bottom: unset;padding-right: 5px;padding-left: 5px;text-align: left;font-size: 14px;"><p>已支持<br/></p></section></section></td></tr><tr><td width="33.0000%" style="word-break:break-all;hyphens:auto;border-color:#4577da;"><section style="margin-top: 5px;margin-bottom: 5px;"><section style="margin-bottom: unset;padding-right: 5px;padding-left: 5px;text-align: left;font-size: 14px;"><p>玄武盾<br/></p></section></section></td><td width="67.0000%" style="word-break:break-all;hyphens:auto;border-color:#4577da;"><section style="margin-top: 5px;margin-bottom: 5px;"><section style="margin-bottom: unset;padding-right: 5px;padding-left: 5px;text-align: left;font-size: 14px;"><p>已支持<br/></p></section></section></td></tr></tbody></table>  
  
  
  
**技术支持**  
  
  
  
  
如有漏洞相关需求支持请联系400-6059-110获取相关能力支撑。  
  
