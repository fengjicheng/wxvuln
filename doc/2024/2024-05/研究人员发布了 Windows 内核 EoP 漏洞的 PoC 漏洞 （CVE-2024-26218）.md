#  研究人员发布了 Windows 内核 EoP 漏洞的 PoC 漏洞 （CVE-2024-26218）   
 Ots安全   2024-04-30 20:23  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/bL2iaicTYdZn7gtxSFZlfuCW6AdQib8Q1onbR0U2h9icP1eRO6wH0AcyJmqZ7USD0uOYncCYIH7ZEE8IicAOPxyb9IA/640?wx_fmt=gif "")  
  
网络安全研究员 Gabe Kirkpatrick 分享了影响Windows 内核的高严重性特权提升漏洞( CVE-2024-26218 ) 错误的技术细节和概念验证 (PoC) 漏洞代码。  
  
  
微软于 4 月 9 日（本月的补丁星期二）发布了安全更新，以在所有易受攻击的平台上解决该问题。  
  
  
**CVE-2024-26218 的详细信息**  
  
此特定漏洞源于 Windows 内核函数PspBuildCreateProcessContext中的堆栈缓冲区溢出情况，该函数涉及进程创建序列。该缺陷是由双重获取条件触发的，在这种情况下，内核多次错误地获取用户提供的数据，从而允许攻击者在两次获取之间更改数据。  
  
  
Microsoft 在 2024 年 4 月补丁星期二更新中修复了该漏洞。补丁发布后，Kirkpatrick 发布了详细的技术信息关于 CVE-2024-26218 漏洞以及GitHub上的 PoC，展示漏洞利用情况并教育网络安全社区有关风险和缓解策略的知识。  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/rWGOWg48tadpUjJ8DiaZopUcM0d6oS1G6rncxnw8elFuX0dqruKiaTHkZspZF5Mgl5LV0FUJIJqiaDmicOtkjP9Svw/640?wx_fmt=png&from=appmsg "")  
  
**怎么运行的：**  
- 双重获取漏洞：PspBuildCreateProcessContext函数负责处理通过NtCreateUserProcess系统调用传递的正在创建的进程的属性。这涉及处理PS_ATTRIBUTE_LIST ，即PS_ATTRIBUTE结构的数组 。  
  
- 操作和溢出：处理特定属性类型（PsAttributeMitigationOptions和PsAttributeMitigationAuditOptions）时，函数会两次获取PS_ATTRIBUTE结构的Size字段。如果攻击者更改这些提取之间的大小 值，则可能导致堆栈缓冲区溢出。  
  
**严重性和影响**  
  
该漏洞的严重程度为 7.8，因为它可能允许经过身份验证的用户以提升的权限执行任意代码，从而有效地让他们控制整个系统。  
  
  
微软指出：“成功利用此漏洞的攻击者可以获得系统权限。”。  
  
  
  
**项目地址：**  
  
https://github.com/exploits-forsale/CVE-2024-26218  
  
  
  
  
感谢您抽出  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWgdSBqOibtgiaYWjL4pkRXwycNnFvFYVgXoExRy0gqCkqvrAghf8KPXnwQaYq77HMsjcVka7kPcBDQw/640?wx_fmt=gif "")  
  
.  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWgdSBqOibtgiaYWjL4pkRXwycd5KMTutPwNWA97H5MPISWXLTXp0ibK5LXCBAXX388gY0ibXhWOxoEKBA/640?wx_fmt=gif "")  
  
.  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWgdSBqOibtgiaYWjL4pkRXwycU99fZEhvngeeAhFOvhTibttSplYbBpeeLZGgZt41El4icmrBibojkvLNw/640?wx_fmt=gif "")  
  
来阅读本文  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWge7Mibiad1tV0iaF8zSD5gzicbxDmfZCEL7vuOevN97CwUoUM5MLeKWibWlibSMwbpJ28lVg1yj1rQflyQ/640?wx_fmt=gif "")  
  
**点它，分享点赞在看都在这里**  
  
