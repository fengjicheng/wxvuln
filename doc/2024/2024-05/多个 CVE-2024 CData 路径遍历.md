#  多个 CVE-2024 CData 路径遍历   
 TtTeam   2024-05-08 00:13  
  
          
Tenable 的研究人员发现了一个路径遍历漏洞，在使用嵌入式 Jetty 服务器部署时，会影响多个 CData 产品的 Java 版本，每个产品的影响各不相同。该问题的存在是由于嵌入式 Jetty 服务器和 CData servlet 处理请求的方式相结合造成的。  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/0HlywncJbB39DnlCjshgEy92P4BAs5dMY2lU2IICxmds0oeObpgUH3UDOljIrM71CZLjiajibGy2hOcficT8rKftg/640?wx_fmt=png&from=appmsg "")  
  
技术细节  
  
由于以下条件，可以利用路径遍历：  
- 每个应用程序的 web.xml 配置文件中列出的 servlet 映射和安全约束似乎是由 Jetty 以 CData 意想不到的方式处理的，从而允许攻击者绕过预期的安全约束限制。   
  
- 此外，Jetty 不会像其他服务器那样拒绝URI 中的  
\  
字符（针对部署在 Tomcat 上的 CData 应用程序的相同请求会被拒绝，因为 Tomcat 不允许URI 中包含  
\  
字符），并且 CData servlet 仍然正确处理 URI。  
  
- CData 应用程序缺乏对许多端点的显式会话检查，从而允许攻击者利用路径遍历来执行敏感操作，否则这些操作将仅限于经过身份验证的用户。  
  
CVE-2024-31848 - CData API 服务器中的路径遍历   
基本分数：  
 9.8    
矢量  
：CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/啊  
  
使用嵌入式 Jetty 服务器运行时，CData API Server < 23.4.8844 的 Java 版本中存在路径遍历漏洞，这可能允许未经身份验证的远程攻击者获得对应用程序的完全管理访问权限。  
  
CVE-2024-31849 - CData Connect 中的路径遍历  
基本分数：  
 9.8    
矢量  
：CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A ：H  
  
使用嵌入式 Jetty 服务器运行时，Java 版本的 CData Connect < 23.4.8846 中存在路径遍历漏洞，该漏洞可能允许未经身份验证的远程攻击者获得对应用程序的完全管理访问权限。  
  
CVE-2024-31850 - CData Arc 中的路径遍历  
基本分数：  
 8.6    
矢量  
：CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:L/A ：L  
  
使用嵌入式 Jetty 服务器运行时，Java 版本的 CData Arc < 23.4.8839 中存在路径遍历漏洞，该漏洞可能允许未经身份验证的远程攻击者访问敏感信息并执行有限的操作。  
  
CVE-2024-31851 - CData Sync 中的路径遍历  
基本分数：  
 8.6    
矢量  
：CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:L/A ：L  
  
使用嵌入式 Jetty 服务器运行时，Java 版本的 CData Sync < 23.4.8843 中存在路径遍历漏洞，该漏洞可能允许未经身份验证的远程攻击者访问敏感信息并执行有限的操作。  
  
概念证明：  
  
适用于每个产品的最简单的概念证明是访问  
/src/getSettings.rsb  
，它可能会泄露敏感数据，具体取决于应用程序。   
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/0HlywncJbB39DnlCjshgEy92P4BAs5dMJRnJ3v32e8uMxBMdpoxEQiczRsjG56JAE2MjZpZblvvKpwME3zneEOA/640?wx_fmt=png&from=appmsg "")  
### 解决方案  
  
CData 已针对每个受影响的产品发布了更新，以缓解该问题。   
  
  
