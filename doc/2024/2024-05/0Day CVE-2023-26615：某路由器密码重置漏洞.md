#  0Day CVE-2023-26615：某路由器密码重置漏洞   
 船山信安   2024-05-08 00:00  
  
## Part1 漏洞状态  
<table><tbody style="border-width: 0px;border-style: initial;border-color: initial;font-style: inherit;font-variant: inherit;font-weight: inherit;font-stretch: inherit;font-size: inherit;line-height: 26px;font-optical-sizing: inherit;font-kerning: inherit;font-feature-settings: inherit;font-variation-settings: inherit;vertical-align: baseline;outline: none;display: table;width: 679.988px;table-layout: fixed;"><tr style="border-width: 0px;border-style: initial;border-color: initial;font-style: inherit;font-variant: inherit;font-weight: inherit;font-stretch: inherit;font-size: inherit;line-height: inherit;font-optical-sizing: inherit;font-kerning: inherit;font-feature-settings: inherit;font-variation-settings: inherit;vertical-align: baseline;outline: none;"><td align="center" valign="top" width="38" style="padding-right: 5px;padding-left: 5px;border-color: rgb(204, 204, 204);font-style: inherit;font-variant: inherit;font-weight: inherit;font-stretch: inherit;font-size: inherit;line-height: inherit;font-optical-sizing: inherit;font-kerning: inherit;font-feature-settings: inherit;font-variation-settings: inherit;vertical-align: baseline;outline: none;word-break: break-word;white-space-collapse: preserve;">漏洞细节</td><td align="center" valign="top" width="45" style="padding-right: 5px;padding-left: 5px;border-color: rgb(204, 204, 204);font-style: inherit;font-variant: inherit;font-weight: inherit;font-stretch: inherit;font-size: inherit;line-height: inherit;font-optical-sizing: inherit;font-kerning: inherit;font-feature-settings: inherit;font-variation-settings: inherit;vertical-align: baseline;outline: none;word-break: break-word;white-space-collapse: preserve;">漏洞POC</td><td align="center" valign="top" width="60" style="padding-right: 5px;padding-left: 5px;border-color: rgb(204, 204, 204);font-style: inherit;font-variant: inherit;font-weight: inherit;font-stretch: inherit;font-size: inherit;line-height: inherit;font-optical-sizing: inherit;font-kerning: inherit;font-feature-settings: inherit;font-variation-settings: inherit;vertical-align: baseline;outline: none;word-break: break-word;white-space-collapse: preserve;">漏洞EXP</td><td align="center" valign="top" width="38" style="padding-right: 5px;padding-left: 5px;border-color: rgb(204, 204, 204);font-style: inherit;font-variant: inherit;font-weight: inherit;font-stretch: inherit;font-size: inherit;line-height: inherit;font-optical-sizing: inherit;font-kerning: inherit;font-feature-settings: inherit;font-variation-settings: inherit;vertical-align: baseline;outline: none;word-break: break-word;white-space-collapse: preserve;">在野利用</td></tr><tr style="border-width: 0px;border-style: initial;border-color: initial;font-style: inherit;font-variant: inherit;font-weight: inherit;font-stretch: inherit;font-size: inherit;line-height: inherit;font-optical-sizing: inherit;font-kerning: inherit;font-feature-settings: inherit;font-variation-settings: inherit;vertical-align: baseline;outline: none;"><td align="center" valign="top" width="58" style="padding-right: 5px;padding-left: 5px;border-color: rgb(204, 204, 204);font-style: inherit;font-variant: inherit;font-weight: inherit;font-stretch: inherit;font-size: inherit;line-height: inherit;font-optical-sizing: inherit;font-kerning: inherit;font-feature-settings: inherit;font-variation-settings: inherit;vertical-align: baseline;outline: none;word-break: break-word;white-space-collapse: preserve;">有</td><td align="center" valign="top" width="65" style="padding-right: 5px;padding-left: 5px;border-color: rgb(204, 204, 204);font-style: inherit;font-variant: inherit;font-weight: inherit;font-stretch: inherit;font-size: inherit;line-height: inherit;font-optical-sizing: inherit;font-kerning: inherit;font-feature-settings: inherit;font-variation-settings: inherit;vertical-align: baseline;outline: none;word-break: break-word;white-space-collapse: preserve;">有</td><td align="center" valign="top" width="60" style="padding-right: 5px;padding-left: 5px;border-color: rgb(204, 204, 204);font-style: inherit;font-variant: inherit;font-weight: inherit;font-stretch: inherit;font-size: inherit;line-height: inherit;font-optical-sizing: inherit;font-kerning: inherit;font-feature-settings: inherit;font-variation-settings: inherit;vertical-align: baseline;outline: none;word-break: break-word;white-space-collapse: preserve;">无</td><td align="center" valign="top" width="58" style="padding-right: 5px;padding-left: 5px;border-color: rgb(204, 204, 204);font-style: inherit;font-variant: inherit;font-weight: inherit;font-stretch: inherit;font-size: inherit;line-height: inherit;font-optical-sizing: inherit;font-kerning: inherit;font-feature-settings: inherit;font-variation-settings: inherit;vertical-align: baseline;outline: none;word-break: break-word;white-space-collapse: preserve;">未知</td></tr></tbody></table>## Part2 漏洞描述  
<table><tbody style="border-width: 0px;border-style: initial;border-color: initial;font-style: inherit;font-variant: inherit;font-weight: inherit;font-stretch: inherit;font-size: inherit;line-height: 26px;font-optical-sizing: inherit;font-kerning: inherit;font-feature-settings: inherit;font-variation-settings: inherit;vertical-align: baseline;outline: none;display: table;width: 679.988px;table-layout: fixed;"><tr style="border-width: 0px;border-style: initial;border-color: initial;font-style: inherit;font-variant: inherit;font-weight: inherit;font-stretch: inherit;font-size: inherit;line-height: inherit;font-optical-sizing: inherit;font-kerning: inherit;font-feature-settings: inherit;font-variation-settings: inherit;vertical-align: baseline;outline: none;"><td align="center" valign="middle" width="111" style="padding-right: 5px;padding-left: 5px;border-color: rgb(204, 204, 204);font-style: inherit;font-variant: inherit;font-weight: inherit;font-stretch: inherit;font-size: inherit;line-height: inherit;font-optical-sizing: inherit;font-kerning: inherit;font-feature-settings: inherit;font-variation-settings: inherit;vertical-align: baseline;outline: none;word-break: break-word;white-space-collapse: preserve;">‍漏洞名称</td><td align="left" valign="middle" width="448" style="padding-right: 5px;padding-left: 5px;border-color: rgb(204, 204, 204);font-style: inherit;font-variant: inherit;font-weight: inherit;font-stretch: inherit;font-size: inherit;line-height: inherit;font-optical-sizing: inherit;font-kerning: inherit;font-feature-settings: inherit;font-variation-settings: inherit;vertical-align: baseline;outline: none;word-break: break-word;white-space-collapse: preserve;"><p style="margin-bottom: 10px;border-width: 0px;border-style: initial;border-color: initial;font-style: inherit;font-variant: inherit;font-weight: inherit;font-stretch: inherit;line-height: 26px;font-optical-sizing: inherit;font-kerning: inherit;font-feature-settings: inherit;font-variation-settings: inherit;vertical-align: baseline;outline: none;word-break: break-word;white-space-collapse: collapse;">某路由器密码重置漏洞</p></td></tr><tr style="border-width: 0px;border-style: initial;border-color: initial;font-style: inherit;font-variant: inherit;font-weight: inherit;font-stretch: inherit;font-size: inherit;line-height: inherit;font-optical-sizing: inherit;font-kerning: inherit;font-feature-settings: inherit;font-variation-settings: inherit;vertical-align: baseline;outline: none;"><td align="center" valign="middle" width="111" style="padding-right: 5px;padding-left: 5px;border-color: rgb(204, 204, 204);font-style: inherit;font-variant: inherit;font-weight: inherit;font-stretch: inherit;font-size: inherit;line-height: inherit;font-optical-sizing: inherit;font-kerning: inherit;font-feature-settings: inherit;font-variation-settings: inherit;vertical-align: baseline;outline: none;word-break: break-word;white-space-collapse: preserve;">CVE编号</td><td valign="top" width="448" style="padding-right: 5px;padding-left: 5px;border-color: rgb(204, 204, 204);font-style: inherit;font-variant: inherit;font-weight: inherit;font-stretch: inherit;font-size: inherit;line-height: inherit;font-optical-sizing: inherit;font-kerning: inherit;font-feature-settings: inherit;font-variation-settings: inherit;vertical-align: baseline;outline: none;word-break: break-word;white-space-collapse: preserve;">CVE-2023-26615</td></tr><tr style="border-width: 0px;border-style: initial;border-color: initial;font-style: inherit;font-variant: inherit;font-weight: inherit;font-stretch: inherit;font-size: inherit;line-height: inherit;font-optical-sizing: inherit;font-kerning: inherit;font-feature-settings: inherit;font-variation-settings: inherit;vertical-align: baseline;outline: none;"><td colspan="1" rowspan="1" align="center" valign="middle" width="18" style="padding-right: 5px;padding-left: 5px;border-color: rgb(204, 204, 204);font-style: inherit;font-variant: inherit;font-weight: inherit;font-stretch: inherit;font-size: inherit;line-height: inherit;font-optical-sizing: inherit;font-kerning: inherit;font-feature-settings: inherit;font-variation-settings: inherit;vertical-align: baseline;outline: none;word-break: break-word;white-space-collapse: preserve;">漏洞类型</td><td colspan="1" rowspan="1" align="left" valign="middle" width="448" style="padding-right: 5px;padding-left: 5px;border-color: rgb(204, 204, 204);font-style: inherit;font-variant: inherit;font-weight: inherit;font-stretch: inherit;font-size: inherit;line-height: inherit;font-optical-sizing: inherit;font-kerning: inherit;font-feature-settings: inherit;font-variation-settings: inherit;vertical-align: baseline;outline: none;word-break: break-word;white-space-collapse: preserve;">逻辑漏洞</td></tr><tr style="border-width: 0px;border-style: initial;border-color: initial;font-style: inherit;font-variant: inherit;font-weight: inherit;font-stretch: inherit;font-size: inherit;line-height: inherit;font-optical-sizing: inherit;font-kerning: inherit;font-feature-settings: inherit;font-variation-settings: inherit;vertical-align: baseline;outline: none;"><td colspan="1" rowspan="1" align="center" valign="middle" width="111" style="padding-right: 5px;padding-left: 5px;border-color: rgb(204, 204, 204);font-style: inherit;font-variant: inherit;font-weight: inherit;font-stretch: inherit;font-size: inherit;line-height: inherit;font-optical-sizing: inherit;font-kerning: inherit;font-feature-settings: inherit;font-variation-settings: inherit;vertical-align: baseline;outline: none;word-break: break-word;white-space-collapse: preserve;">漏洞等级</td><td colspan="1" rowspan="1" align="left" valign="middle" width="448" style="padding-right: 5px;padding-left: 5px;border-color: rgb(204, 204, 204);font-style: inherit;font-variant: inherit;font-weight: inherit;font-stretch: inherit;font-size: inherit;line-height: inherit;font-optical-sizing: inherit;font-kerning: inherit;font-feature-settings: inherit;font-variation-settings: inherit;vertical-align: baseline;outline: none;word-break: break-word;white-space-collapse: preserve;">未知</td></tr><tr style="border-width: 0px;border-style: initial;border-color: initial;font-style: inherit;font-variant: inherit;font-weight: inherit;font-stretch: inherit;font-size: inherit;line-height: inherit;font-optical-sizing: inherit;font-kerning: inherit;font-feature-settings: inherit;font-variation-settings: inherit;vertical-align: baseline;outline: none;"><td colspan="1" rowspan="1" align="center" valign="middle" width="111" style="padding-right: 5px;padding-left: 5px;border-color: rgb(204, 204, 204);font-style: inherit;font-variant: inherit;font-weight: inherit;font-stretch: inherit;font-size: inherit;line-height: inherit;font-optical-sizing: inherit;font-kerning: inherit;font-feature-settings: inherit;font-variation-settings: inherit;vertical-align: baseline;outline: none;word-break: break-word;white-space-collapse: preserve;">公开状态</td><td colspan="1" rowspan="1" align="left" valign="middle" width="448" style="padding-right: 5px;padding-left: 5px;border-color: rgb(204, 204, 204);font-style: inherit;font-variant: inherit;font-weight: inherit;font-stretch: inherit;font-size: inherit;line-height: inherit;font-optical-sizing: inherit;font-kerning: inherit;font-feature-settings: inherit;font-variation-settings: inherit;vertical-align: baseline;outline: none;word-break: break-word;white-space-collapse: preserve;">nvd发布日期2023-06-28</td></tr></tbody></table>## Part3 漏洞验证  
### 1.验证环境  
  
系统版本：Kali 2022.4  
### 2.验证过程  
  
修改WEB管理密码  
  
![](https://mmbiz.qpic.cn/mmbiz_jpg/7nIrJAgaibicPufibFyaGHxJqdfVRNSJicf7mt1oENbcd3SMEiaUozR8xUje7Xcd8h175050bace8RGnLYu1OMoicmeQ/640?wx_fmt=jpeg&from=appmsg "")  
  
使用BurpSuite发送PoC  
  
![](https://mmbiz.qpic.cn/mmbiz_jpg/7nIrJAgaibicPufibFyaGHxJqdfVRNSJicf7BU9VYiazBkMmNxTnghcIDZ7yd7LO0oXvxLibE0YkFIBWxuo9ES03GhXg/640?wx_fmt=jpeg&from=appmsg "")  
  
随后可以通过空密码登录  
  
![](https://mmbiz.qpic.cn/mmbiz_jpg/7nIrJAgaibicPufibFyaGHxJqdfVRNSJicf7DDUBrzYlVKeZBTjH8XQU7Kdia67D3dIyHQ9iaYibXQxGqUI8ktHwyTzHw/640?wx_fmt=jpeg&from=appmsg "")  
  
![](https://mmbiz.qpic.cn/mmbiz_jpg/7nIrJAgaibicPufibFyaGHxJqdfVRNSJicf7N9nYZaq1EH9dB2HBy8ibwO0fy1jPTiaY4HOlykASumOlwM1jE2S8axxA/640?wx_fmt=jpeg&from=appmsg "")  
  
Part4漏洞分析  
  
请求处理函数sub_4339E8使用for循环检测传入的XML数据，满足条件时调用dword_58AA80 + 4，其dword_58AA80初始值为地址off_589200。  
  
![](https://mmbiz.qpic.cn/mmbiz_jpg/7nIrJAgaibicPufibFyaGHxJqdfVRNSJicf7peoEQXKRQaOetaQwdy3qTns1ibE4DpUeLJTDdvibZYgaUOJnOTRFib7qw/640?wx_fmt=jpeg&from=appmsg "")  
  
查看off_589200处数据，发现了SetPasswdSettings字段，其后面跟着一个函数地址。  
  
![](https://mmbiz.qpic.cn/mmbiz_jpg/7nIrJAgaibicPufibFyaGHxJqdfVRNSJicf7h90WvVGKjY5GGHDkGDMTlBCeicKWwSV6y8cFtaAy6S5fiaU1eibA3uecw/640?wx_fmt=jpeg&from=appmsg "")  
  
分析sub_43D518函数函数，发现其32行获取了修改的密码，随后在38行调用sub_45B320函数进行解密。当sub_45B320执行成功，且原始密码长度小于0x40，则会在41行设置密码。当sub_45B320执行失败时，则在53行设置一个密码。  
  
![](https://mmbiz.qpic.cn/mmbiz_jpg/7nIrJAgaibicPufibFyaGHxJqdfVRNSJicf77x4m4mFFWSDuTB7ECUqdXbnT20TNhIbfJJhjIqfzMEr5iamAp0NcjNQ/640?wx_fmt=jpeg&from=appmsg "")  
  
查看dword_4A7540，发现其值是硬编码的00，这意味着当sub_45B320函数调用失败时，则会置为空密码。  
  
![](https://mmbiz.qpic.cn/mmbiz_jpg/7nIrJAgaibicPufibFyaGHxJqdfVRNSJicf7aK5AM6HpF7rBjbeOZoK8cvHOvyTvGtPktueMPrZ2tQb0OteQWqTiaNg/640?wx_fmt=jpeg&from=appmsg "")  
  
查看sub_45B320函数，其29行调用 sub_425ED0函数进行解密，并在30行检测byte_58ADEC是否为0，为0则继续循环。当循环20次后则通过16行代码跳出循环，返回结果0。  
  
![](https://mmbiz.qpic.cn/mmbiz_jpg/7nIrJAgaibicPufibFyaGHxJqdfVRNSJicf7icBQfKg1iaDiap8VM0d4icQbAjWKEvF0lw5p8oiaykKZ7EGMNK2oRic2iaYuQ/640?wx_fmt=jpeg&from=appmsg "")  
  
sub_425ED0函数第30行调用 sub_425CB0函数将密码写入到v11，然后在31和32行将密码写入sub_45B320函数提供的缓冲区内。但14行代码首先将v11数组初始化为了0，因此如果sub_425ED0函数没有操作v11数组，则写出的数据也将是0。  
  
![](https://mmbiz.qpic.cn/mmbiz_jpg/7nIrJAgaibicPufibFyaGHxJqdfVRNSJicf78TAia14LUrfK5dK8BVWFRBiadxyCm64JQloiaIIPlberTv3yRLqADGItw/640?wx_fmt=jpeg&from=appmsg "")  
  
sub_425CB0函数18行调用了sub_425830函数检测密码格式，当返回结果为0时，将不处理加密密码。  
  
![](https://mmbiz.qpic.cn/mmbiz_jpg/7nIrJAgaibicPufibFyaGHxJqdfVRNSJicf78zPmqd0ht6KDJ41Ozzu3Gqr1fV4xWJibhsvu9lykeXvzoTsT9LbfDgA/640?wx_fmt=jpeg&from=appmsg "")  
  
sub_425830函数第10行代码获取加密密码的长度，并在11行检测密码长度是否为奇数，如果为奇数则退出函数，并返回结果0。![](https://mmbiz.qpic.cn/mmbiz_jpg/7nIrJAgaibicPufibFyaGHxJqdfVRNSJicf7Mdhb2dVxoibqsDOwetUzooQT0xPdyoxHT1uXVXuFibx2kGOgZ3czibCBA/640?wx_fmt=jpeg&from=appmsg "")  
  
因此当加密密码的长度为奇数时，sub_425830函数返回0，从而导致sub_425CB0函数不会进行解密操作，此时sub_425ED0函数的v11数组将为0，并写入到sub_45B320函数提供的缓冲区内。sub_45B320函数判断byte_58ADEC缓冲区首字节为0，则继续执行循环，直至i为20，跳出循环，并返回结果0。当sub_43D518函数36行代码检测sub_45B320执行失败后，则使用空字符串设置登录密码。  
  
来源：https://www.freebuf.com/  
  
  
