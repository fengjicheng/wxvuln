#  CVE-2024-4367 & CVE-2024-34342：PDF.js 中的任意 JavaScript 执行   
LOURC0D3  Ots安全   2024-05-25 12:35  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/bL2iaicTYdZn7gtxSFZlfuCW6AdQib8Q1onbR0U2h9icP1eRO6wH0AcyJmqZ7USD0uOYncCYIH7ZEE8IicAOPxyb9IA/640?wx_fmt=gif "")  
  
处理 PDF.js 中的字体时缺少类型检查，这将允许在 PDF.js 上下文中执行任意 JavaScript。此漏洞会影响 Firefox < 126、Firefox ESR < 115.11 和 Thunderbird < 115.11。  
  
如果使用 pdf.js 加载恶意 PDF，并且 PDF.js 配置为将 isEvalSupported 设置为 true（这是默认值），则不受限制的攻击者控制的 JavaScript 将在托管域的上下文中执行。  
- JS 执行  
  
```
python3 CVE-2024-4367.py "alert(document.domain)"
```  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/rWGOWg48tacBibxicHopIClDb3fNj4AeZuhydWeWhM5gstcgPZH0uxR6BTqGBEMyMZ0Ca2fnldibUfTPibRSMDp7wA/640?wx_fmt=png&from=appmsg "")  
- 操作系统命令执行（仅基于 Electron）  
  
```
python3 CVE-2024-4367.py "require('child_process').exec('open -a /Applications/Calculator.app');"
```  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/rWGOWg48tacBibxicHopIClDb3fNj4AeZurJzM0D0shyEoNtl3frT4UNIDNvL6iaTZwGxgicQX89RLEv4qn420Yupg/640?wx_fmt=png&from=appmsg "")  
  
这不是我的错误，我只是为它做了一个 PoC。  
  
**参考**  
- https://github.com/advisories/GHSA-wgrm-67xf-hhpq  
  
- https://nvd.nist.gov/vuln/detail/CVE-2024-4367  
  
```
CVE-2024-4367 & CVE-2024-34342 Proof of Concept
https://github.com/LOURC0D3/CVE-2024-4367-PoC
```  
  
  
  
  
感谢您抽出  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWgdSBqOibtgiaYWjL4pkRXwycNnFvFYVgXoExRy0gqCkqvrAghf8KPXnwQaYq77HMsjcVka7kPcBDQw/640?wx_fmt=gif "")  
  
.  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWgdSBqOibtgiaYWjL4pkRXwycd5KMTutPwNWA97H5MPISWXLTXp0ibK5LXCBAXX388gY0ibXhWOxoEKBA/640?wx_fmt=gif "")  
  
.  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWgdSBqOibtgiaYWjL4pkRXwycU99fZEhvngeeAhFOvhTibttSplYbBpeeLZGgZt41El4icmrBibojkvLNw/640?wx_fmt=gif "")  
  
来阅读本文  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWge7Mibiad1tV0iaF8zSD5gzicbxDmfZCEL7vuOevN97CwUoUM5MLeKWibWlibSMwbpJ28lVg1yj1rQflyQ/640?wx_fmt=gif "")  
  
**点它，分享点赞在看都在这里**  
  
