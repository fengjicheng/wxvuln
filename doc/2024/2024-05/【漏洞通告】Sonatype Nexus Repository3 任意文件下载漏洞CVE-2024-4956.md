#  【漏洞通告】Sonatype Nexus Repository3 任意文件下载漏洞CVE-2024-4956   
深瞳漏洞实验室  深信服千里目安全技术中心   2024-05-20 18:27  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/w8NHw6tcQ5wUN98diciaS57Ticw9DEeArNdSiaPwgaCX664NY3QfcuXDlhRuY7kTff5hcnxGiaqJGDVW3hG2UHmkCGA/640?wx_fmt=gif&from=appmsg "")  
  
**漏洞名称：**  
  
Sonatype Nexus Repository3 任意文件下载漏洞(CVE-2024-4956)  
  
**组件名称：**  
  
Sonatype-Nexus  
  
**影响范围：**  
  
Sonatype Nexus < 3.68.1  
  
**漏洞类型：**  
  
任意文件下载  
  
**利用条件：**  
  
1、用户认证：否  
  
2、前置条件：默认配置  
  
3、触发方式：远程  
  
**综合评价：**  
  
<综合评定利用难度>：容易，无需授权即可下载任意文件。  
  
<综合评定威胁等级>：高危，能造成信息泄露。  
  
**官方解决方案：**  
  
已发布  
  
  
  
  
**漏洞分析**  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/w8NHw6tcQ5wUN98diciaS57Ticw9DEeArNd0Fusmd2fhbhWfM8n8ibaOslXd0wjkdnFMQRz54YdVc3b7aibOlNDhQZQ/640?wx_fmt=gif&from=appmsg "")  
  
**组件介绍**  
  
Nexus 是一个强大的 Maven 仓库管理器，它极大地简化了自己内部仓库的维护和外部仓库的访问。  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/w8NHw6tcQ5wUN98diciaS57Ticw9DEeArNd0Fusmd2fhbhWfM8n8ibaOslXd0wjkdnFMQRz54YdVc3b7aibOlNDhQZQ/640?wx_fmt=gif&from=appmsg "")  
  
**漏洞简介**  
  
  
2024年5月20日，深瞳漏洞实验室监测到一则Sonatype-Nexus组件存在任意文件下载漏洞的信息，漏洞编号：CVE-2024-4956，漏洞威胁等级：高危。  
  
受影响版本的Sonatype Nexus Repository3 存在路径遍历漏洞，**攻击者可以利用该漏洞下载任意文件，导致信息泄露。**  
  
  
**影响范围**  
  
目前受影响的Sonatype-Nexus版本：  
  
Sonatype Nexus < 3.68.1  
  
  
**解决方案**  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/w8NHw6tcQ5wUN98diciaS57Ticw9DEeArNd0Fusmd2fhbhWfM8n8ibaOslXd0wjkdnFMQRz54YdVc3b7aibOlNDhQZQ/640?wx_fmt=gif&from=appmsg "")  
  
**如何检测组件系统版本**  
  
  
在Nexus的web界面上依次点击右上角的问号和About，即可查看Nexus的当前版本。  
  
![](https://mmbiz.qpic.cn/mmbiz_png/w8NHw6tcQ5wUN98diciaS57Ticw9DEeArNdqJRghG3xO8DKw207k6HMDbg10ySyOlF8UZc8aSoefVdYYuX0myqKaw/640?wx_fmt=png&from=appmsg "")  
  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/w8NHw6tcQ5wUN98diciaS57Ticw9DEeArNd0Fusmd2fhbhWfM8n8ibaOslXd0wjkdnFMQRz54YdVc3b7aibOlNDhQZQ/640?wx_fmt=gif&from=appmsg "")  
  
**临时修复建议**  
  
  
编辑(basedir)/etc/jetty/jetty.xml 并从文件中删除这一行：  
```
<Set name="resourceBase"><Property name="karaf.base"/>/public</Set>
```  
  
重新启动 Nexus 存储库以使更改生效。  
  
  
注意：该修改会使(installdir)/public下的静态文件加载失效，导致轻微的UI渲染问题，但不影响Nexus的正常功能。  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/w8NHw6tcQ5wUN98diciaS57Ticw9DEeArNd0Fusmd2fhbhWfM8n8ibaOslXd0wjkdnFMQRz54YdVc3b7aibOlNDhQZQ/640?wx_fmt=gif&from=appmsg "")  
  
**官方修复建议**  
  
  
更新Nexus到最新版本以免受该漏洞的影响，链接：  
  
https://www.sonatype.com/products/sonatype-nexus-oss-download  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/w8NHw6tcQ5wUN98diciaS57Ticw9DEeArNd0Fusmd2fhbhWfM8n8ibaOslXd0wjkdnFMQRz54YdVc3b7aibOlNDhQZQ/640?wx_fmt=gif&from=appmsg "")  
  
**深信服解决方案**  
  
  
**风险资产发现**  
  
支持对Sonatype-Nexus的主动检测，可**批量检出**业务场景中该事件的**受影响资产**情况，相关产品如下：  
  
**【深信服云镜YJ】**预计2024年 5月 21 日发布资产检测方案。  
  
  
  
**参考链接**  
  
  
https://support.sonatype.com/hc/en-us/articles/29416509323923-CVE-2024-4956-Nexus-Repository-3-Path-Traversal-2024-05-16  
  
  
  
**时间轴**  
  
  
  
**2024/5/20**  
  
深瞳漏洞实验室监测到Sonatype Nexus Repository3 任意文件下载漏洞信息。  
  
  
**2024/5/20**  
  
深瞳漏洞实验室发布漏洞通告。  
  
  
点击**阅读原文**，及时关注并登录深信服**智安全平台**，可轻松查询漏洞相关解决方案。  
  
![](https://mmbiz.qpic.cn/mmbiz_png/w8NHw6tcQ5wUN98diciaS57Ticw9DEeArNdl1vp0eP0tycgkJ7rNqvfS21PpEch7SHtIcDM0be3pnB1evdugmKNuQ/640?wx_fmt=png&from=appmsg "")  
  
  
![](https://mmbiz.qpic.cn/mmbiz_jpg/w8NHw6tcQ5wUN98diciaS57Ticw9DEeArNdmRclSiaWPt32fJ4NSITjI6ia0vBSjSnEoZicxbjwr5P2447MhJ5lqVbsg/640?wx_fmt=jpeg&from=appmsg "")  
  
  
