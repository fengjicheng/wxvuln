#  【漏洞通告】libxml2 XML外部实体注入漏洞（CVE-2024-40896）   
 启明星辰安全简讯   2024-12-26 10:08  
  
## 一、漏洞概述  
<table><tbody style="visibility: visible;"><tr style="height: 20.15pt;visibility: visible;"><td width="100" style="border-width: 2.25pt 1.5pt 1.5pt 2.25pt;border-color: windowtext;border-style: solid;background: rgb(222, 234, 246);padding: 0cm 5.4pt;visibility: visible;" height="20"><p style="text-align: center;line-height: 150%;margin-top: 0px;margin-bottom: 0px;visibility: visible;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;color: rgb(51, 51, 51);font-size: 14px;visibility: visible;">漏洞名称<o:p style="visibility: visible;"></o:p></span></p></td><td width="338.3333333333333" colspan="3" valign="middle" style="width:91.0pt;background:#DEEAF6;border-top: 2.25pt solid windowtext;border-left: none;border-bottom: 1.5pt solid windowtext;border-right: 2.25pt solid windowtext;padding:0pt 5.4pt 0pt 5.4pt;height:20.15pt;"><p style="mso-margin-top-alt: auto;mso-margin-bottom-alt: auto;margin-left: 0.0pt;text-indent: 0.0pt;mso-pagination: widow-orphan;font-size: 12.0pt;font-family: 宋体;mso-fareast-font-family: 宋体;mso-bidi-font-family: 宋体;font-weight: normal;mso-bidi-font-weight: normal;text-align: center;line-height: 150%;"><span style="font-family: 微软雅黑;font-variant: normal;text-transform: none;color: rgb(51, 51, 51);font-size: 14px;">libxml2 XML外部实体注入漏洞</span></p></td></tr><tr style="height: 20.15pt;visibility: visible;"><td width="100" style="border-top: none;border-left: 2.25pt solid windowtext;border-bottom: 1.5pt solid windowtext;border-right: 1.5pt solid windowtext;background: rgb(222, 234, 246);padding: 0cm 5.4pt;visibility: visible;" height="20"><p style="text-align: center;line-height: 150%;margin-top: 0px;margin-bottom: 0px;visibility: visible;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;color: rgb(51, 51, 51);font-size: 14px;visibility: visible;">CVE   ID<o:p style="visibility: visible;"></o:p></span></p></td><td width="217" colspan="3" valign="middle" style="width:91.0pt;background:#DEEAF6;border-top:none;border-left:none;border-bottom: 1.5pt solid windowtext;border-right:2.25pt solid windowtext;padding:0pt 5.4pt 0pt 5.4pt;height:20.15pt;"><p style="mso-margin-top-alt: auto;mso-margin-bottom-alt: auto;margin-left: 0.0pt;text-indent: 0.0pt;mso-pagination: widow-orphan;font-size: 12.0pt;font-family: 宋体;mso-fareast-font-family: 宋体;mso-bidi-font-family: 宋体;font-weight: normal;mso-bidi-font-weight: normal;text-align: center;line-height: 150%;"><span style="font-family: 微软雅黑;font-variant: normal;text-transform: none;color: rgb(51, 51, 51);font-size: 14px;">CVE-2024-40896</span></p></td></tr><tr style="height: 20.15pt;visibility: visible;"><td width="100" style="border-top: none;border-left: 2.25pt solid windowtext;border-bottom: 1.5pt solid windowtext;border-right: 1.5pt solid windowtext;background: rgb(222, 234, 246);padding: 0cm 5.4pt;visibility: visible;" height="20"><p style="text-align: center;line-height: 150%;margin-top: 0px;margin-bottom: 0px;visibility: visible;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;color: rgb(51, 51, 51);font-size: 14px;visibility: visible;">漏洞类型<o:p style="visibility: visible;"></o:p></span></p></td><td width="87.33333333333333" style="border-top: none;border-left: none;border-bottom: 1.5pt solid windowtext;border-right: 1.5pt solid windowtext;background: rgb(222, 234, 246);padding: 0cm 5.4pt;visibility: visible;" height="20"><p style="text-align: center;line-height: 150%;margin-top: 0px;margin-bottom: 0px;visibility: visible;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;color: rgb(51, 51, 51);font-size: 14px;visibility: visible;">XXE<o:p style="visibility: visible;"></o:p></span></p></td><td width="99.33333333333333" style="border-top: none;border-left: none;border-bottom: 1.5pt solid windowtext;border-right: 1.5pt solid windowtext;background: rgb(222, 234, 246);padding: 0cm 5.4pt;visibility: visible;" height="20"><p style="text-align: center;line-height: 150%;margin-top: 0px;margin-bottom: 0px;visibility: visible;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;color: rgb(51, 51, 51);font-size: 14px;visibility: visible;">发现时间<o:p style="visibility: visible;"></o:p></span></p></td><td width="131.33333333333331" style="border-top: none;border-left: none;border-bottom: 1.5pt solid windowtext;border-right: 2.25pt solid windowtext;background: rgb(222, 234, 246);padding: 0cm 5.4pt;visibility: visible;" height="20"><p style="text-align: center;line-height: 150%;margin-top: 0px;margin-bottom: 0px;visibility: visible;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;color: rgb(51, 51, 51);font-size: 14px;visibility: visible;">2024-12-25<o:p style="visibility: visible;"></o:p></span></p></td></tr><tr style="height: 20.15pt;visibility: visible;"><td width="100" style="border-top: none;border-left: 2.25pt solid windowtext;border-bottom: 1.5pt solid windowtext;border-right: 1.5pt solid windowtext;background: rgb(222, 234, 246);padding: 0cm 5.4pt;visibility: visible;" height="20"><p style="text-align: center;line-height: 150%;margin-top: 0px;margin-bottom: 0px;visibility: visible;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;color: rgb(51, 51, 51);font-size: 14px;visibility: visible;">漏洞评分<o:p style="visibility: visible;"></o:p></span></p></td><td width="107" style="border-top: none;border-left: none;border-bottom: 1.5pt solid windowtext;border-right: 1.5pt solid windowtext;background: rgb(222, 234, 246);padding: 0cm 5.4pt;visibility: visible;" height="20"><p style="text-align: center;line-height: 150%;margin-top: 0px;margin-bottom: 0px;visibility: visible;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;color: rgb(51, 51, 51);font-size: 14px;visibility: visible;">9.1<o:p style="visibility: visible;"></o:p></span></p></td><td width="119.33333333333333" style="border-top: none;border-left: none;border-bottom: 1.5pt solid windowtext;border-right: 1.5pt solid windowtext;background: rgb(222, 234, 246);padding: 0cm 5.4pt;visibility: visible;" height="20"><p style="text-align: center;line-height: 150%;margin-top: 0px;margin-bottom: 0px;visibility: visible;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;color: rgb(51, 51, 51);font-size: 14px;visibility: visible;">漏洞等级<o:p style="visibility: visible;"></o:p></span></p></td><td width="131.33333333333331" style="border-top: none;border-left: none;border-bottom: 1.5pt solid windowtext;border-right: 2.25pt solid windowtext;background: rgb(222, 234, 246);padding: 0cm 5.4pt;visibility: visible;" height="20"><p style="text-align: center;line-height: 150%;margin-top: 0px;margin-bottom: 0px;visibility: visible;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;color: rgb(51, 51, 51);font-size: 14px;visibility: visible;">高危<o:p style="visibility: visible;"></o:p></span></p></td></tr><tr style="height: 20.15pt;visibility: visible;"><td width="100" style="border-top: none;border-left: 2.25pt solid windowtext;border-bottom: 1.5pt solid windowtext;border-right: 1.5pt solid windowtext;background: rgb(222, 234, 246);padding: 0cm 5.4pt;visibility: visible;" height="20"><p style="text-align: center;line-height: 150%;margin-top: 0px;margin-bottom: 0px;visibility: visible;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;color: rgb(51, 51, 51);font-size: 14px;visibility: visible;">攻击向量<o:p style="visibility: visible;"></o:p></span></p></td><td width="107" style="border-top: none;border-left: none;border-bottom: 1.5pt solid windowtext;border-right: 1.5pt solid windowtext;background: rgb(222, 234, 246);padding: 0cm 5.4pt;visibility: visible;" height="20"><p style="text-align: center;line-height: 150%;margin-top: 0px;margin-bottom: 0px;visibility: visible;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;color: rgb(51, 51, 51);font-size: 14px;visibility: visible;">网络<o:p style="visibility: visible;"></o:p></span></p></td><td width="119.33333333333333" style="border-top: none;border-left: none;border-bottom: 1.5pt solid windowtext;border-right: 1.5pt solid windowtext;background: rgb(222, 234, 246);padding: 0cm 5.4pt;visibility: visible;" height="20"><p style="text-align: center;line-height: 150%;margin-top: 0px;margin-bottom: 0px;visibility: visible;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;color: rgb(51, 51, 51);font-size: 14px;visibility: visible;">所需权限<o:p style="visibility: visible;"></o:p></span></p></td><td width="131.33333333333331" style="border-top: none;border-left: none;border-bottom: 1.5pt solid windowtext;border-right: 2.25pt solid windowtext;background: rgb(222, 234, 246);padding: 0cm 5.4pt;visibility: visible;" height="20"><p style="text-align: center;line-height: 150%;margin-top: 0px;margin-bottom: 0px;visibility: visible;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;color: rgb(51, 51, 51);font-size: 14px;visibility: visible;">无<o:p style="visibility: visible;"></o:p></span></p></td></tr><tr style="height: 20.15pt;visibility: visible;"><td width="100" style="border-top: none;border-left: 2.25pt solid windowtext;border-bottom: 1.5pt solid windowtext;border-right: 1.5pt solid windowtext;background: rgb(222, 234, 246);padding: 0cm 5.4pt;visibility: visible;" height="20"><p style="text-align: center;line-height: 150%;margin-top: 0px;margin-bottom: 0px;visibility: visible;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;color: rgb(51, 51, 51);font-size: 14px;visibility: visible;">利用难度<o:p style="visibility: visible;"></o:p></span></p></td><td width="107" style="border-top: none;border-left: none;border-bottom: 1.5pt solid windowtext;border-right: 1.5pt solid windowtext;background: rgb(222, 234, 246);padding: 0cm 5.4pt;visibility: visible;" height="20"><p style="text-align: center;line-height: 150%;margin-top: 0px;margin-bottom: 0px;visibility: visible;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;color: rgb(51, 51, 51);font-size: 14px;visibility: visible;">低<o:p style="visibility: visible;"></o:p></span></p></td><td width="119.33333333333333" style="border-top: none;border-left: none;border-bottom: 1.5pt solid windowtext;border-right: 1.5pt solid windowtext;background: rgb(222, 234, 246);padding: 0cm 5.4pt;visibility: visible;" height="20"><p style="text-align: center;line-height: 150%;margin-top: 0px;margin-bottom: 0px;visibility: visible;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;color: rgb(51, 51, 51);font-size: 14px;visibility: visible;">用户交互<o:p style="visibility: visible;"></o:p></span></p></td><td width="131.33333333333331" style="border-top: none;border-left: none;border-bottom: 1.5pt solid windowtext;border-right: 2.25pt solid windowtext;background: rgb(222, 234, 246);padding: 0cm 5.4pt;visibility: visible;" height="20"><p style="text-align: center;line-height: 150%;margin-top: 0px;margin-bottom: 0px;visibility: visible;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;color: rgb(51, 51, 51);font-size: 14px;visibility: visible;">无<o:p style="visibility: visible;"></o:p></span></p></td></tr><tr style="height: 20.15pt;visibility: visible;"><td width="100" style="border-top: none;border-left: 2.25pt solid windowtext;border-bottom: 2.25pt solid windowtext;border-right: 1.5pt solid windowtext;background: rgb(222, 234, 246);padding: 0cm 5.4pt;visibility: visible;" height="20"><p style="text-align: center;line-height: 150%;margin-top: 0px;margin-bottom: 0px;visibility: visible;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;color: rgb(51, 51, 51);font-size: 14px;visibility: visible;">PoC/EXP<o:p style="visibility: visible;"></o:p></span></p></td><td width="107" style="border-top: none;border-left: none;border-bottom: 2.25pt solid windowtext;border-right: 1.5pt solid windowtext;background: rgb(222, 234, 246);padding: 0cm 5.4pt;visibility: visible;" height="20"><p style="text-align: center;line-height: 150%;margin-top: 0px;margin-bottom: 0px;visibility: visible;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;color: rgb(51, 51, 51);font-size: 14px;visibility: visible;">未公开<o:p style="visibility: visible;"></o:p></span></p></td><td width="119.33333333333333" style="border-top: none;border-left: none;border-bottom: 2.25pt solid windowtext;border-right: 1.5pt solid windowtext;background: rgb(222, 234, 246);padding: 0cm 5.4pt;visibility: visible;" height="20"><p style="text-align: center;line-height: 150%;margin-top: 0px;margin-bottom: 0px;visibility: visible;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;color: rgb(51, 51, 51);font-size: 14px;visibility: visible;">在野利用<o:p style="visibility: visible;"></o:p></span></p></td><td width="131.33333333333331" style="border-top: none;border-left: none;border-bottom: 2.25pt solid windowtext;border-right: 2.25pt solid windowtext;background: rgb(222, 234, 246);padding: 0cm 5.4pt;visibility: visible;" height="20"><p style="text-align: center;line-height: 150%;margin-top: 0px;margin-bottom: 0px;visibility: visible;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;color: rgb(51, 51, 51);font-size: 14px;visibility: visible;">未发现<o:p style="visibility: visible;"></o:p></span></p></td></tr></tbody></table>  
libxml2是一个开源、高性能且应用广泛的XML解析库，它基于标准的ANSI C库完成，提供了丰富的API接口，支持XML文档的读取、创建、修改、验证和查询等功能，并兼容多种操作系统，包括 Linux、Windows、macOS 和其他类 UNIX 系统，可嵌入在多种编程语言中（如 C、Python、Ruby、Perl 等）。  
  
2024年12月26日，启明星辰集团VSRC监测到libxml2中存在一个XML外部实体注入漏洞（CVE-2024-40896），该漏洞的CVSS评分为9.1。  
  
由于libxml2受影响版本中的SAX 解析器在处理外部实体时，即使开发者在自定义的 SAX 处理器中尝试通过某种方式（例如设置“checked”）来控制或覆盖外部实体的加载，解析器仍会触发与外部实体相关的事件。攻击者可通过向目标 XML 解析器提供包含外部实体引用的恶意 XML 输入来利用该漏洞，成功利用可能导致信息泄露（如访问文件系统的敏感文件）、拒绝服务或执行其他未授权操作。  
  
## 二、影响范围  
  
2.11 <= libxml2 < 2.11.9  
  
2.12 <= libxml2 < 2.12.9  
  
2.13 <= libxml2 < 2.13.3  
  
## 三、安全措施  
### 3.1 升级版本  
  
目前该漏洞已经修复，受影响用户可升级到以下版本：  
  
libxml2 2.11.x >= 2.11.9  
  
libxml2 2.12.x >= 2.12.9  
  
libxml2 2.13.x >= 2.13.3  
  
下载链接：  
  
https://gitlab.gnome.org/GNOME/libxml2/-/releases  
### 3.2 临时措施  
  
暂无。  
### 3.3 通用建议  
  
定期更新系统补丁，减少系统漏洞，提升服务器的安全性。  
  
加强系统和网络的访问控制，修改防火墙策略，关闭非必要的应用端口或服务，减少将危险服务（如SSH、RDP等）暴露到公网，减少攻击面。  
  
使用企业级安全产品，提升企业的网络安全性能。  
  
加强系统用户和权限管理，启用多因素认证机制和最小权限原则，用户和软件权限应保持在最低限度。  
  
启用强密码策略并设置为定期修改。  
### 3.4 参考链接  
  
https://gitlab.gnome.org/GNOME/libxml2/-/issues/761  
  
https://nvd.nist.gov/vuln/detail/CVE-2024-40896  
  
