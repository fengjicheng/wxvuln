#  【复现】Tomcat DefaultServlet远程代码执行漏洞(CVE-2024-50379)风险通告   
原创 赛博昆仑CERT  赛博昆仑CERT   2024-12-18 12:02  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/iaZ7t7b9Dodvib7ddpGMC6vx4COAy4sBoGbGCkwVUIJSHBPI0z1Utrp1h5ys6ygT3albl3PgjejJcRRRiaDFFbMBA/640?wx_fmt=gif "")  
  
  
-  
赛博昆仑漏洞安全通告-  
  
Tomcat DefaultServlet远程代码执行漏洞（CVE-2024-50379）风险通告  
  
![](https://mmbiz.qpic.cn/mmbiz_svg/7j1UQofaR9fsNXgsOXHVKZMJ1PCicm8s4RHQVjCJEjX63AsNibMx3So4wSMAvubEOoU2vLqYY7hIibIJbkEaPIDs5A4ianh5jibxw/640?wx_fmt=svg "")  
  
  
  
****  
**漏洞描述**  
  
Tomcat是由Apache软件基金会属下Jakarta项目开发的Servlet容器，按照Sun Microsystems提供的技术规范，实现了对Servlet和JavaServer Page（JSP）的支持，并提供了作为Web服务器的一些特有功能。  
  
近日，赛博昆仑CERT监测到Tomcat DefaultServlet远程代码执行漏洞（CVE-2024-50379）的漏洞情报。当DefaultServlet 对大小写不敏感的文件系统启用了写入功能（只读初始化参数readonly设置为非默认值 false），攻击者可以通过条件竞争同时读取和上传同一文件，可能会绕过 Tomcat 的大小写敏感性检查，导致上传的文件被视为 JSP，从而导致远程代码执行。  
<table><tbody><tr><td valign="top" style="border-width: 1pt;border-color: rgb(221, 221, 221);padding: 3pt 6pt 1.5pt;" width="127"><section style="margin: 0px;font-size: 11pt;font-family: DengXian;line-height: 1.6em;text-align: left;text-indent: 0em;"><span style="color: rgb(0, 122, 170);"><strong><span style="font-size: 14px;letter-spacing: normal;text-decoration: none;">漏洞名称<o:p></o:p></span></strong></span></section></td><td colspan="3" valign="top" style="border-top-width: 1pt;border-color: rgb(221, 221, 221);border-right-width: 1pt;border-bottom-width: 1pt;border-left-width: initial;border-left-style: none;padding: 3pt 6pt 1.5pt;"><section style="margin: 0px;font-size: 11pt;font-family: DengXian;line-height: 1.6em;text-align: left;text-indent: 0em;"><span style="font-size: 14px;letter-spacing: normal;text-decoration: none;color: rgb(0, 122, 170);"><span lang="EN-US" style="color: rgb(0, 122, 170);text-decoration: none;letter-spacing: normal;font-size: 14px;font-family: Arial, sans-serif;">Tomcat DefaultServlet</span>远程代码执行漏洞<o:p></o:p></span></section></td></tr><tr><td valign="top" style="border-right-width: 1pt;border-color: rgb(221, 221, 221);border-bottom-width: 1pt;border-left-width: 1pt;border-top-width: initial;border-top-style: none;padding: 3pt 6pt 1.5pt;" width="127"><section style="margin: 0px;font-size: 11pt;font-family: DengXian;line-height: 1.6em;text-align: left;text-indent: 0em;"><span style="color: rgb(0, 122, 170);"><strong><span style="font-size: 14px;letter-spacing: normal;text-decoration: none;">漏洞公开编号<o:p></o:p></span></strong></span></section></td><td colspan="3" valign="top" style="border-top: none rgb(221, 221, 221);border-left: none rgb(221, 221, 221);border-bottom-width: 1pt;border-bottom-color: rgb(221, 221, 221);border-right-width: 1pt;border-right-color: rgb(221, 221, 221);padding: 3pt 6pt 1.5pt;"><section style="margin: 0px;font-size: 11pt;font-family: DengXian;line-height: 1.6em;text-align: left;text-indent: 0em;"><span style="font-size: 14px;letter-spacing: normal;text-decoration: none;color: rgb(0, 122, 170);"><span style="color: rgb(0, 122, 170);text-decoration: none;letter-spacing: normal;font-size: 14px;font-family: Arial, sans-serif;">CVE-2024-50379</span><o:p></o:p></span></section></td></tr><tr><td valign="top" style="border-right-width: 1pt;border-color: rgb(221, 221, 221);border-bottom-width: 1pt;border-left-width: 1pt;border-top-width: initial;border-top-style: none;padding: 3pt 6pt 1.5pt;" width="127"><section style="margin: 0px;font-size: 11pt;font-family: DengXian;line-height: 1.6em;text-align: left;text-indent: 0em;"><span style="color: rgb(0, 122, 170);"><strong><span style="color: rgb(0, 122, 170);font-size: 14px;letter-spacing: normal;text-decoration: none;">昆仑漏洞库编号<o:p></o:p></span></strong></span></section></td><td colspan="3" valign="top" style="margin: 0px;font-size: 11pt;font-family: DengXian;line-height: 1.6em;text-align: left;text-indent: 0em;border-top-width: 1pt;border-color: rgb(221, 221, 221);border-right-width: 1pt;border-bottom-width: 1pt;border-left-width: initial;border-left-style: none;padding: 3pt 6pt 1.5pt;"><span style="color: rgb(0, 122, 170);text-decoration: none;letter-spacing: normal;font-size: 14px;font-family: Arial, sans-serif;">CYKL-2024-030781 </span></td></tr><tr><td valign="top" style="border-right-width: 1pt;border-color: rgb(221, 221, 221);border-bottom-width: 1pt;border-left-width: 1pt;border-top-width: initial;border-top-style: none;padding: 3pt 6pt 1.5pt;" width="127"><section style="margin: 0px;font-size: 11pt;font-family: DengXian;line-height: 1.6em;text-align: left;text-indent: 0em;"><span style="color: rgb(0, 122, 170);"><strong><span style="font-size: 14px;letter-spacing: normal;text-decoration: none;">漏洞类型<o:p></o:p></span></strong></span></section></td><td valign="top" style="border-top: none rgb(221, 221, 221);border-left: none rgb(221, 221, 221);border-bottom-width: 1pt;border-bottom-color: rgb(221, 221, 221);border-right-width: 1pt;border-right-color: rgb(221, 221, 221);padding: 3pt 6pt 1.5pt;" width="127"><section style="margin: 0px;font-size: 11pt;font-family: DengXian;line-height: 1.6em;text-align: left;text-indent: 0em;"><span style="font-size: 14px;letter-spacing: normal;text-decoration: none;color: rgb(0, 122, 170);">代码执行<o:p></o:p></span></section></td><td valign="top" style="border-top: none rgb(221, 221, 221);border-left: none rgb(221, 221, 221);border-bottom-width: 1pt;border-bottom-color: rgb(221, 221, 221);border-right-width: 1pt;border-right-color: rgb(221, 221, 221);padding: 3pt 6pt 1.5pt;" width="127"><section style="margin: 0px;font-size: 11pt;font-family: DengXian;line-height: 1.6em;text-align: left;text-indent: 0em;"><span style="color: rgb(0, 122, 170);"><strong><span style="font-size: 14px;letter-spacing: normal;text-decoration: none;">公开时间</span></strong><strong><span style="font-size: 14px;letter-spacing: normal;text-decoration: none;"><o:p></o:p></span></strong></span></section></td><td valign="top" style="border-top: none rgb(221, 221, 221);border-left: none rgb(221, 221, 221);border-bottom-width: 1pt;border-bottom-color: rgb(221, 221, 221);border-right-width: 1pt;border-right-color: rgb(221, 221, 221);padding: 3pt 6pt 1.5pt;" width="127"><section style="margin: 0px;font-size: 11pt;font-family: DengXian;line-height: 1.6em;text-align: left;text-indent: 0em;"><span style="font-size: 14px;letter-spacing: normal;text-decoration: none;color: rgb(0, 122, 170);"><span style="color: rgb(0, 122, 170);text-decoration: none;letter-spacing: normal;font-size: 14px;font-family: Arial, sans-serif;">2024-12-17</span><o:p></o:p></span></section></td></tr><tr><td valign="top" style="border-right-width: 1pt;border-color: rgb(221, 221, 221);border-bottom-width: 1pt;border-left-width: 1pt;border-top-width: initial;border-top-style: none;padding: 3pt 6pt 1.5pt;" width="127"><section style="margin: 0px;font-size: 11pt;font-family: DengXian;line-height: 1.6em;text-align: left;text-indent: 0em;"><span style="color: rgb(0, 122, 170);"><strong><span style="font-size: 14px;letter-spacing: normal;text-decoration: none;">漏洞等级<o:p></o:p></span></strong></span></section></td><td valign="top" style="border-top: none rgb(221, 221, 221);border-left: none rgb(221, 221, 221);border-bottom-width: 1pt;border-bottom-color: rgb(221, 221, 221);border-right-width: 1pt;border-right-color: rgb(221, 221, 221);padding: 3pt 6pt 1.5pt;" width="127"><section style="margin: 0px;font-size: 11pt;font-family: DengXian;line-height: 1.6em;text-align: left;text-indent: 0em;"><span style="font-size: 14px;letter-spacing: normal;text-decoration: none;color: rgb(0, 122, 170);">中危<o:p></o:p></span></section></td><td valign="top" style="border-top: none rgb(221, 221, 221);border-left: none rgb(221, 221, 221);border-bottom-width: 1pt;border-bottom-color: rgb(221, 221, 221);border-right-width: 1pt;border-right-color: rgb(221, 221, 221);padding: 3pt 6pt 1.5pt;" width="127"><section style="margin: 0px;font-size: 11pt;font-family: DengXian;line-height: 1.6em;text-align: left;text-indent: 0em;"><span style="color: rgb(0, 122, 170);"><strong><span style="font-size: 14px;letter-spacing: normal;text-decoration: none;">评分</span></strong><strong><span style="font-size: 14px;letter-spacing: normal;text-decoration: none;"><o:p></o:p></span></strong></span></section></td><td valign="top" style="border-top: none rgb(221, 221, 221);border-left: none rgb(221, 221, 221);border-bottom-width: 1pt;border-bottom-color: rgb(221, 221, 221);border-right-width: 1pt;border-right-color: rgb(221, 221, 221);padding: 3pt 6pt 1.5pt;" width="127"><section style="margin: 0px;font-size: 11pt;font-family: DengXian;line-height: 1.6em;text-align: left;text-indent: 0em;"><span style="font-size: 14px;letter-spacing: normal;text-decoration: none;color: rgb(0, 122, 170);"><span style="color: rgb(0, 122, 170);text-decoration: none;letter-spacing: normal;font-size: 14px;font-family: Arial, sans-serif;">8.3</span><o:p></o:p></span></section></td></tr><tr><td valign="top" style="border-right-width: 1pt;border-color: rgb(221, 221, 221);border-bottom-width: 1pt;border-left-width: 1pt;border-top-width: initial;border-top-style: none;padding: 3pt 6pt 1.5pt;" width="127"><section style="margin: 0px;font-size: 11pt;font-family: DengXian;line-height: 1.6em;text-align: left;text-indent: 0em;"><span style="color: rgb(0, 122, 170);"><strong><span style="font-size: 14px;letter-spacing: normal;text-decoration: none;">漏洞所需权限<o:p></o:p></span></strong></span></section></td><td valign="top" style="border-top: none rgb(221, 221, 221);border-left: none rgb(221, 221, 221);border-bottom-width: 1pt;border-bottom-color: rgb(221, 221, 221);border-right-width: 1pt;border-right-color: rgb(221, 221, 221);padding: 3pt 6pt 1.5pt;" width="127"><section style="margin: 0px;font-size: 11pt;font-family: DengXian;line-height: 1.6em;text-align: left;text-indent: 0em;"><span style="font-size: 14px;letter-spacing: normal;text-decoration: none;color: rgb(0, 122, 170);">无<o:p></o:p></span></section></td><td valign="top" style="border-top: none rgb(221, 221, 221);border-left: none rgb(221, 221, 221);border-bottom-width: 1pt;border-bottom-color: rgb(221, 221, 221);border-right-width: 1pt;border-right-color: rgb(221, 221, 221);padding: 3pt 6pt 1.5pt;" width="127"><section style="margin: 0px;font-size: 11pt;font-family: DengXian;line-height: 1.6em;text-align: left;text-indent: 0em;"><span style="color: rgb(0, 122, 170);"><strong><span style="font-size: 14px;letter-spacing: normal;text-decoration: none;">漏洞利用难度</span></strong><strong><span style="font-size: 14px;letter-spacing: normal;text-decoration: none;"><o:p></o:p></span></strong></span></section></td><td valign="top" style="border-top: none rgb(221, 221, 221);border-left: none rgb(221, 221, 221);border-bottom-width: 1pt;border-bottom-color: rgb(221, 221, 221);border-right-width: 1pt;border-right-color: rgb(221, 221, 221);padding: 3pt 6pt 1.5pt;" width="127"><section style="margin: 0px;font-size: 11pt;font-family: DengXian;line-height: 1.6em;text-align: left;text-indent: 0em;"><span style="font-size: 14px;letter-spacing: normal;text-decoration: none;color: rgb(0, 122, 170);">中<o:p></o:p></span></section></td></tr><tr><td valign="top" style="border-right-width: 1pt;border-color: rgb(221, 221, 221);border-bottom-width: 1pt;border-left-width: 1pt;border-top-width: initial;border-top-style: none;padding: 3pt 6pt 1.5pt;" width="127"><section style="margin: 0px;font-size: 11pt;font-family: DengXian;line-height: 1.6em;text-align: left;text-indent: 0em;"><span style="color: rgb(0, 122, 170);"><strong><span style="font-size: 14px;letter-spacing: normal;text-decoration: none;"><span lang="EN-US" style="text-decoration: none;letter-spacing: normal;font-size: 14px;font-family: Arial, sans-serif;">PoC</span>状态<o:p></o:p></span></strong></span></section></td><td valign="top" style="border-top: none rgb(221, 221, 221);border-left: none rgb(221, 221, 221);border-bottom-width: 1pt;border-bottom-color: rgb(221, 221, 221);border-right-width: 1pt;border-right-color: rgb(221, 221, 221);padding: 3pt 6pt 1.5pt;" width="127"><section style="margin: 0px;font-size: 11pt;font-family: DengXian;line-height: 1.6em;text-align: left;text-indent: 0em;"><span style="font-size: 14px;letter-spacing: normal;text-decoration: none;color: rgb(0, 122, 170);">已公开<o:p></o:p></span></section></td><td valign="top" style="border-top: none rgb(221, 221, 221);border-left: none rgb(221, 221, 221);border-bottom-width: 1pt;border-bottom-color: rgb(221, 221, 221);border-right-width: 1pt;border-right-color: rgb(221, 221, 221);padding: 3pt 6pt 1.5pt;" width="127"><section style="margin: 0px;font-size: 11pt;font-family: DengXian;line-height: 1.6em;text-align: left;text-indent: 0em;"><span style="color: rgb(0, 122, 170);"><strong><span style="font-size: 14px;letter-spacing: normal;text-decoration: none;"><span lang="EN-US" style="text-decoration: none;letter-spacing: normal;font-size: 14px;font-family: Arial, sans-serif;">EXP</span>状态</span></strong><strong><span style="font-size: 14px;letter-spacing: normal;text-decoration: none;"><o:p></o:p></span></strong></span></section></td><td valign="top" style="border-top: none rgb(221, 221, 221);border-left: none rgb(221, 221, 221);border-bottom-width: 1pt;border-bottom-color: rgb(221, 221, 221);border-right-width: 1pt;border-right-color: rgb(221, 221, 221);padding: 3pt 6pt 1.5pt;" width="127"><section style="margin: 0px;font-size: 11pt;font-family: DengXian;line-height: 1.6em;text-align: left;text-indent: 0em;"><span style="font-size: 14px;letter-spacing: normal;text-decoration: none;color: rgb(0, 122, 170);">已公开<o:p></o:p></span></section></td></tr><tr><td valign="top" style="border-right-width: 1pt;border-color: rgb(221, 221, 221);border-bottom-width: 1pt;border-left-width: 1pt;border-top-width: initial;border-top-style: none;padding: 3pt 6pt 1.5pt;" width="127"><section style="margin: 0px;font-size: 11pt;font-family: DengXian;line-height: 1.6em;text-align: left;text-indent: 0em;"><span style="color: rgb(0, 122, 170);"><strong><span style="font-size: 14px;letter-spacing: normal;text-decoration: none;">漏洞细节<o:p></o:p></span></strong></span></section></td><td valign="top" style="border-top: none rgb(221, 221, 221);border-left: none rgb(221, 221, 221);border-bottom-width: 1pt;border-bottom-color: rgb(221, 221, 221);border-right-width: 1pt;border-right-color: rgb(221, 221, 221);padding: 3pt 6pt 1.5pt;" width="127"><section style="margin: 0px;font-size: 11pt;font-family: DengXian;line-height: 1.6em;text-align: left;text-indent: 0em;"><span style="font-size: 14px;letter-spacing: normal;text-decoration: none;color: rgb(0, 122, 170);">未知<o:p></o:p></span></section></td><td valign="top" style="border-top: none rgb(221, 221, 221);border-left: none rgb(221, 221, 221);border-bottom-width: 1pt;border-bottom-color: rgb(221, 221, 221);border-right-width: 1pt;border-right-color: rgb(221, 221, 221);padding: 3pt 6pt 1.5pt;" width="127"><section style="margin: 0px;font-size: 11pt;font-family: DengXian;line-height: 1.6em;text-align: left;text-indent: 0em;"><span style="color: rgb(0, 122, 170);"><strong><span style="font-size: 14px;letter-spacing: normal;text-decoration: none;">在野利用</span></strong><strong><span style="font-size: 14px;letter-spacing: normal;text-decoration: none;"><o:p></o:p></span></strong></span></section></td><td valign="top" style="border-top: none rgb(221, 221, 221);border-left: none rgb(221, 221, 221);border-bottom-width: 1pt;border-bottom-color: rgb(221, 221, 221);border-right-width: 1pt;border-right-color: rgb(221, 221, 221);padding: 3pt 6pt 1.5pt;word-break: break-all;" width="127"><section style="margin: 0px;font-size: 11pt;font-family: DengXian;line-height: 1.6em;text-align: left;text-indent: 0em;"><span style="font-size: 14px;letter-spacing: normal;text-decoration: none;color: rgb(0, 122, 170);">未知</span></section></td></tr></tbody></table>  
  
**影响版本**  
  
9.0.0.M1 <= Apache Tomcat <= 9.0.97  
  
10.1.0-M1 <= Apache Tomcat <= 10.1.33  
  
11.0.0-M1 <= Apache Tomcat <= 11.0.1  
  
**漏洞利用条件**  
1. 需要tomcat配置中DefaultServlet的初始参数readonly为false（默认不为false）  
  
1. 需要文件系统对大小写不敏感  
  
**漏洞复现**  
  
目前赛博昆仑CERT已确认漏洞原理，复现截图如下：  
  
复现版本为9.0.96  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/iaZ7t7b9Dodt2qibibEV8vJDicZeK0U88wfFKCodtzawTVThpdr5iaibBXSTwq9DDOf3BtcN6mZ9AKSdWstn63VIuic4Q/640?wx_fmt=png&from=appmsg "")  
  
**防护措施**  
- **修复建议**  
  
目前，  
官  
方已发布修复建议，建议受影响的用户尽快升级至安全版本。  
  
下载地址：https://tomcat.apache.org/download-90.cgi  
  
- **技术业务咨询**  
  
  
  
赛博昆仑支持对用户提供轻量级的检测规则或热补方式，可提供定制化服务适配多种产品及规则，帮助用户进行漏洞检测和修复。  
  
赛博昆仑CERT已开启年订阅服务，付费客户(可申请试用)将获取更多技术详情，并支持适配客户的需求。  
  
联系邮箱：  
cert@cyberkl.com  
  
公众号：赛博昆仑CERT  
  
**参考链接**  
  
  
https://lists.apache.org/thread/y6lj6q1xnp822g6ro70tn19sgtjmr80r  
  
**时间线**  
  
2024年12月17日，Apache Tomcat官方公开漏洞  
  
2024  
年  
12  
月  
18  
日，赛博昆仑  
CERT  
公众号发布漏洞风险通告  
  
  
  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/iaZ7t7b9Dodvib7ddpGMC6vx4COAy4sBoGLJ1DKwHPSc2JX7FQat3De8XiaajuAHkJzOY9ic9bnaHiaLJqVHIe0E2wg/640?wx_fmt=gif "")  
  
