#  实战渗透-某金融众测价值3k的漏洞（附SRC报告合集免费下载）   
原创 sspsec  SSP安全研究   2024-12-16 00:57  
  
在本次金融系统安全测试中，我们从一个日志泄露问题入手，逐步挖掘并利用了系统弱口令和越权访问漏洞，最终实现了对后台系统的高权限接管。本次分享将带您全程回顾漏洞挖掘过程及系统安全的防护建议。  
## 🔍 1. 日志泄露 - 敏感信息曝光  
### 漏洞描述  
  
我们使用自研的**Spring专扫工具SSP**  
 进行系统扫描，发现了一个未授权保护的日志接口： 🔗**接口地址**  
：https://example.com/prod-api/actuator/logfile  
  
通过访问该接口，系统直接返回了大量运行日志，**日志中包含明文账号、密码、身份证号、手机号等敏感信息**  
。  
### 日志内容（部分脱敏示例）：  
```
[2024-12-15 10:20:00] User: 189****8888, ID: 110**********0012, Password: 123456  [2024-12-15 10:22:00] User: 138****6666, ID: 330**********5678, Password: 654321  

```  
### 数据统计 📊  
  
✅ 共泄露敏感信息：**200余条**  
✅ 包含信息：手机号、身份证号、登录账号及明文密码  
### 截图展示 📸  
> **风险分析**  
：明文密码被直接暴露，攻击者可以利用这些数据进行撞库攻击，甚至登录系统后台进一步挖掘更多漏洞。  
  
## 🔑 2. 利用泄露的账号密码登录后台  
  
通过日志中泄露的账号密码，我们尝试登录后台管理系统，结果发现系统存在**大量弱口令账户**  
。  
  
🔗**后台登录地址**  
：https://example.com/login?redirect=/index  
### 成功登录账号：  
- 账号： 80xxxx5  
- 密码： 80xxxx5  
### 测试结果：  
  
🔹**弱口令账户总数：**  
 80个  
### 高权限功能 ✨  
1. **查看员工信息**  
：姓名、手机号、登录IP、所属部门等。  
1. **重置/删除账户**  
：对其他用户进行重置密码或删除操作。  
1. **导出签署记录**  
：涉及签署记录 **3000多条**  
。  
1. **文件管理操作**  
：访问和修改签署合同、员工签名，共计 **5000+ 文件**  
。  
> **风险分析**  
：弱口令问题导致系统极易被攻击者接管，造成严重的数据泄露风险。  
  
## 🚪 3. 越权访问签署记录  
  
登录后台后，我们进一步测试了系统接口的权限校验，发现存在越权访问漏洞。通过修改接口参数，能够访问其他用户的签署记录。  
### 测试过程 🔧  
1. 正常访问签署记录接口： https://example.com/prod-api/sign/record/1234567890  
 返回当前用户的签署记录。  
1. 修改参数中的记录ID： https://example.com/prod-api/sign/record/1234567891  
 成功访问到其他用户的签署记录和文件。  
> **风险分析**  
：攻击者可批量获取签署记录，泄露企业和用户的合同信息，带来严重的隐私与法律风险。  
  
## 🛠️ 修复建议  
1. **日志泄露问题**  
：  
- 禁用未使用的日志接口，尤其是 /actuator/logfile  
。  
- 对日志内容进行脱敏处理，隐藏账号、密码、身份证号等敏感信息。  
1. **弱口令问题**  
：  
- 强制用户修改默认密码，并设置密码复杂性要求。  
- 定期检查弱口令账户，进行强制更新。  
1. **越权访问问题**  
：  
- 增加接口权限验证，确保用户只能访问自身数据。  
- 对敏感操作接口引入身份校验和日志审计功能。  
## 🎁 案例总结  
  
本次测试中，从日志泄露入手，结合弱口令和越权漏洞，形成了一条完整的攻击链。攻击者通过简单的接口访问和参数修改，便能获取系统内的敏感数据及高权限操作权，风险极高。希望开发者能够引以为鉴，完善系统的安全防护策略。  
  
📌**漏洞收益：3000元**  
通过此次挖掘，我们收获了平台方的认可和奖励，同时也为系统提供了修复建议，提升了整体安全性。  
## 🎉 获取更多案例下载  
  
**点击下方名片进入公众号**  
  
**回复关键字【**  
**241216****】获取下载链接**  
  
  
![](https://mmbiz.qpic.cn/mmbiz_png/Oum0kexPoVoEJVR68CibcxYsicpawwF5MPyvJ0lXn1fFke9wpicyKEVLicdic3Ofkr6IYibS9kickj97eqMAcUicab9ahw/640?wx_fmt=png&from=appmsg "")  
  
![](https://mmbiz.qpic.cn/mmbiz_png/Oum0kexPoVoEJVR68CibcxYsicpawwF5MPyEHJW8BvibS8Exkibniaib4gpZlGbAE4XcsUUlQbhGQXz6PgcQTSaXf53Q/640?wx_fmt=png&from=appmsg "")  
  
  
