#  CVE-2024-49112 Windows 轻量级目录访问协议（LDAP）的远程代码执行漏洞   
云梦DC  云梦安全   2024-12-26 01:00  
  
### 漏洞背景  
  
Windows LDAP 是一个重要的目录访问协议，广泛用于身份验证、目录管理和资源访问控制。该协议是许多企业网络的核心部分，因此其安全性对于保障整个网络的稳定和安全至关重要。  
  
![](https://mmbiz.qpic.cn/mmbiz_png/ndxZsFvkmpyvb4bS02NIe9uF1ztjhTNBicx1ghGfOty2JuNoPQ9TibTkA9YVxBexLiaADIibAgMVmbkcokp8YBQsRw/640?wx_fmt=png&from=appmsg "")  
  
### 漏洞描述  
  
CVE-2024-49112 是由于 LDAP 服务在处理特定类型的请求时缺乏有效的输入验证而引发的漏洞。攻击者可以通过发送特制的恶意 LDAP 请求来触发缓冲区溢出或绕过安全检查，从而在目标系统上执行任意代码。  
### 受影响的版本  
  
以下是可能受影响的 Windows 版本：  
- Windows Server 2016  
  
- Windows Server 2019  
  
- Windows Server 2022  
  
- Windows 10（某些特定版本）  
  
- Windows 11（某些特定版本）  
  
（具体受影响版本需以官方公告为准。）  
### 攻击向量  
  
攻击者可通过以下方式利用该漏洞：  
1. 在开放 LDAP 服务的端口（默认端口为 389 或 636）上发送特制请求。  
  
1. 恶意请求触发 LDAP 服务中的漏洞点，导致代码执行。  
  
### 危害  
  
成功利用该漏洞后，攻击者可能：  
- 执行任意代码，完全控制目标系统。  
  
- 访问或篡改目录服务中的敏感数据。  
  
- 进一步渗透企业网络，扩大攻击范围。  
  
### 漏洞利用条件  
- 攻击者需要能够直接访问目标系统的 LDAP 服务端口。  
  
- 目标系统未启用强制认证或存在不安全的配置。  
  
### 缓解措施  
  
在官方补丁发布之前，以下措施可帮助缓解漏洞风险：  
1. **限制网络访问**  
：通过防火墙限制对 LDAP 服务端口（389/636）的外部访问。  
  
1. **启用 LDAPS**  
：强制使用安全的 LDAP over SSL（LDAPS）协议。  
  
1. **最小化权限**  
：确保 LDAP 服务仅具有最低必要权限。  
  
1. **监控日志**  
：定期审计 LDAP 请求日志，检测异常活动。  
  
1. **虚拟补丁**  
：在网络设备上部署入侵防御系统（IPS）规则，过滤恶意 LDAP 请求。  
  
### 官方补丁  
  
Microsoft 通常会在月度安全更新中发布补丁，修复此类高危漏洞。建议管理员及时应用相关更新，并参考   
Microsoft 官方公告  
 了解最新详情。  
### PoC 分析（假设部分信息已公开）  
  
以下为一个示例性的恶意 LDAP 请求构造：  
```
import socket
# 构造恶意的 LDAP 请求payload = b"malicious payload"
# 连接到目标 LDAP 服务
with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:    
  s.connect(("target_ip", 389))  
# 替换为目标 IP 地址    
  s.sendall(payload)    
  response = s.recv(1024)    
  print(response.decode())

```  
  
⚠️ **注意**  
：仅供研究和学习使用，切勿非法利用。  
  
  
