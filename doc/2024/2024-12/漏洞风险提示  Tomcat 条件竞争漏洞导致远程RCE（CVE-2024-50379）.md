#  漏洞风险提示 | Tomcat 条件竞争漏洞导致远程RCE（CVE-2024-50379）   
原创 chunn1  边界无限   2024-12-18 09:17  
  
![](https://mmbiz.qpic.cn/mmbiz_jpg/eCphtEDOn1t6RWDlVgpSdz4HxTrrCAGgsIsqHI2VX0SYFhRuutNBglibB23k6wcUb4PTLUhRUdXbGHMLQCJXxuA/640?wx_fmt=jpeg&from=appmsg "")  
  
**漏洞简介**  
  
  
  
  
  
  
在Apache Tomcat 9.X、Apache Tomcat 10.X、Apache Tomcat 11.X系列的某些版本中，如果默认 servlet 对大小写不敏感的文件系统(如windows、macos)启用了写入功能（readonly=False），则在负载情况下同时读取和上传同一文件时，可能会绕过 Tomcat 的大小写敏感性检查，导致上传的文件被视为 JSP，从而导致远程代码执行。  
  
  
![](https://mmbiz.qpic.cn/mmbiz_png/eCphtEDOn1t6RWDlVgpSdz4HxTrrCAGggTtUZoHsiaq82frfumbypYibMk7dlzPpTn2Onibc4yodtIdia65SCWfc8w/640?wx_fmt=png&from=appmsg "")  
  
  
**漏洞信息**  
  
  
  
  
  
  
通过编写脚本模拟高并发场景进行条件竞争，成功复现结果如下：  
  
  
![](https://mmbiz.qpic.cn/mmbiz_png/eCphtEDOn1t6RWDlVgpSdz4HxTrrCAGgibe7vSiaYwlUBRcibfj27laviaDsay2f001ico8TibpAMG5AXSCTfDJE26JQ/640?wx_fmt=png&from=appmsg "")  
  
  
**漏洞影响范围**  
  
  
  
  
  
  
Apache Tomcat 11.0.0-M1-11.0.1  
  
Apache Tomcat 10.1.0-M1-10.1.33  
  
Apache Tomcat 9.0.0.M1-9.0.97  
  
  
**修复方案**  
  
  
  
  
  
  
1.建议用户升级到版本 11.0.2、10.1.34 或 9.0.08  
  
  
2.  
**安装基于RASP技术的靖云甲ADR，可天然免疫该漏洞攻击**  
  
****  
![](https://mmbiz.qpic.cn/mmbiz_jpg/eCphtEDOn1t6RWDlVgpSdz4HxTrrCAGgNb3xU7KOAicbgYMPep3qdicNspQf35p9ZaUsjlUicAxaXu0icFnGu9lChw/640?wx_fmt=jpeg&from=appmsg "")  
  
  
**参考信息**  
  
  
  
  
  
  
https://www.openwall.com/lists/oss-security/2024/12/17/4  
  
  
https://securityonline.info/rce-and-dos-vulnerabilities-addressed-in-apache-tomcat-cve-2024-50379-and-cve-2024-54677/  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/eCphtEDOn1u1WI9zQMKQc5HMAnyLHMM8f6HPnGeicZQTpjGqN1xS9eOibTTAXq008zzkvmMJoljLuGVQ0tuH0Vhg/640?wx_fmt=gif "")  
  
  
