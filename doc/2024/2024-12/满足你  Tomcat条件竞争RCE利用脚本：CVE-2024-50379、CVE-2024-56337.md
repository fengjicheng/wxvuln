#  满足你 | Tomcat条件竞争RCE利用脚本：CVE-2024-50379、CVE-2024-56337   
原创 犀利猪  犀利猪安全   2024-12-24 01:23  
  
![](https://mmbiz.qpic.cn/mmbiz_png/PVHs7dHw163nH6MUINlAAdNibz6iaI4IzyrdKvVSZibcTh4HYuZdYIfb8qc2V0Ij92eaVBlDUY5H7rtIfgnYZzh6A/640?wx_fmt=png "")  
  
![](https://mmbiz.qpic.cn/mmbiz_png/7QRTvkK2qC6CankDUFDurKHNPv6c9ko5AqkwHqWpfosEJZolyMm7jQJgETLL5c3liagnTI6wSibQyRKJs5uBBgFw/640?wx_fmt=png "")  
  
**免责声明**  
****    
  
    文章内容**仅限授权测试**或  
**学习使用**请**勿进行非法的测试**或攻击，  
利用本账号所发文章进行直接或间接的非法行为，均由**操作者本人负全责**，犀利猪安全及文章对应作者将不为此承担任何责任。  
  
    文章来自互联网或原创，  
如有侵权可联系我方进行删除，深感抱歉  
。  
  
![](https://mmbiz.qpic.cn/mmbiz_png/7QRTvkK2qC6CankDUFDurKHNPv6c9ko501vNgyKf1ImmVAia8gkDje5L6Q8CyuBwNuB2ic5r5ql7ZgBROPgD37Aw/640?wx_fmt=png "")  
  
  
  
![](https://mmbiz.qpic.cn/mmbiz_png/PVHs7dHw163l3X1DTic0xNUMlqqNWbyjzMCSQBL5TSYMicqiaebusTIMaEibNDp0S0ST543taeeM9Blvydoa0pk0uA/640?wx_fmt=png "")  
  
**0x00 文章背景**  
  
    本来Tomcat这个洞到昨天也就结束了，但是有师傅说出个脚本，好吧。满足，必须满足，而且出两个脚本。  
  
![](https://mmbiz.qpic.cn/mmbiz_png/PVHs7dHw160sKTllbdHibe6OmJCO6Efgv7j4qNF5zpjgFzXiaCviarpb9tWwGfmgHmUWjsjpa7pwnQLUQpt3HeUeg/640?wx_fmt=png&from=appmsg "")  
  
![](https://mmbiz.qpic.cn/mmbiz_png/PVHs7dHw163l3X1DTic0xNUMlqqNWbyjzMCSQBL5TSYMicqiaebusTIMaEibNDp0S0ST543taeeM9Blvydoa0pk0uA/640?wx_fmt=png "")  
  
**0x01 探测脚本**  
  
    这个脚本用于初步探测目标是否支持PUT请求，开启PUT不一定存在漏洞，但是没有开启肯定是不存在的。  
  
    读取同目录下的url.txt，进行批量探测：  
```
python tomcat.py
```  
  
![](https://mmbiz.qpic.cn/mmbiz_png/PVHs7dHw160sKTllbdHibe6OmJCO6EfgvS7AKQIBJuAn40Vxnk0TSKg3HCnibKRUSIibccPAkUQpPQoSC0Hib3G9QA/640?wx_fmt=png&from=appmsg "")  
  
![](https://mmbiz.qpic.cn/mmbiz_png/PVHs7dHw163l3X1DTic0xNUMlqqNWbyjzMCSQBL5TSYMicqiaebusTIMaEibNDp0S0ST543taeeM9Blvydoa0pk0uA/640?wx_fmt=png "")  
  
**0x02 利用脚本**  
  
    初步实现批量发包还是比较快就完成了，但是后续在测试过程中，由于漏洞本身的限制，加上仔细探索之后发现的问题，一直微调，调了好几个小时，完成了最终版本：  
  
![](https://mmbiz.qpic.cn/mmbiz_png/PVHs7dHw160sKTllbdHibe6OmJCO6EfgvpuLQGpTDbDbzbroLwIsHmrzgibsPt5GZSicRxrarM0cXewePWWqlIvLQ/640?wx_fmt=png&from=appmsg "")  
  
     执行完成后，脚本会访问最后生成的文件地址做判断，并返回结果：  
  
![](https://mmbiz.qpic.cn/mmbiz_png/PVHs7dHw160sKTllbdHibe6OmJCO6EfgvyQr2KfJ6kEribTVdtvk1Q7uQHucnTibbYwAD3LTtN8v89BHr9tGuB4zg/640?wx_fmt=png&from=appmsg "")  
  
****  
**请看VCR******  
```
测试环境：
  Win7虚拟机（4H4G）
  Apache Tomcat 9.0.98（基于java8启动）
```  
  
  
    不过还有个问题哈，忘记加设置代理了，懒得加了。不过也无所谓，手机开热点就行了，浏览器要访问的话再用个隐私模式：  
```
set http_proxy=httP://127.0.0.1:8080
set https_proxy=httP://127.0.0.1:8080
```  
  
      
如果你实在要用代理，可以在CMD中临时设置，只要这个CMD窗口不关，它就会一直生效。也就意味着，你在这个CMD中执行的命令所发出的流量，都会走代理：  
  
![](https://mmbiz.qpic.cn/mmbiz_png/PVHs7dHw160sKTllbdHibe6OmJCO6EfgveMIKaicHF6WVOn4t4cJMLvNk5eytPa6437kPE4CwIMUajEkwZ1c6qqw/640?wx_fmt=png&from=appmsg "")  
  
![](https://mmbiz.qpic.cn/mmbiz_png/PVHs7dHw163l3X1DTic0xNUMlqqNWbyjzMCSQBL5TSYMicqiaebusTIMaEibNDp0S0ST543taeeM9Blvydoa0pk0uA/640?wx_fmt=png "")  
  
**0x03 脚本获取**  
  
**公众号回复：241224****，获取下载链接**  
  
**公众号回复：解压，获取解压密码**  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/PVHs7dHw163nH6MUINlAAdNibz6iaI4Izy4LuoZ7bquVOTMR71nU9KdboYQl4xoGMXguo4X7ojBz8EgZn7RuRYMw/640?wx_fmt=gif "")  
  
(  
  
**END**  
  
)  
  
  
  
  
**！扫码添加哦！**  
  
**联系进群即可，群内可交流技术**  
  
![](https://mmbiz.qpic.cn/mmbiz_png/PVHs7dHw160sKTllbdHibe6OmJCO6EfgvVzXWXWAZf1ZKDwutM7fHDXauJWzfGW6wOXwVQqCenGxSKOkYYGByuQ/640?wx_fmt=png&from=appmsg "")  
  
**没钱吃饭了，大哥给点吧**  
  
