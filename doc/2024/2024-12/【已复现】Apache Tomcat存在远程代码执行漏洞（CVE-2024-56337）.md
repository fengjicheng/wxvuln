#  【已复现】Apache Tomcat存在远程代码执行漏洞（CVE-2024-56337）   
安恒研究院  安恒信息CERT   2024-12-23 09:57  
  
![](https://mmbiz.qpic.cn/mmbiz_jpg/JAzzLj4nXevmL5H6C1I6nWLYOHeic25ZZq3Sju5Xs1LnOckux8PBqG1qYrBly0Nicx4verjADnLorl5g1ImeuTeg/640?wx_fmt=jpeg&from=appmsg&wx_ "")  
  
<table><tbody><tr><td colspan="4" rowspan="1" width="100.0000%" data-style="border-width:1px;border-color:rgb(69, 119, 218);border-style:solid;background-color:rgb(69, 119, 218);box-sizing:border-box;" class="js_darkmode__0" style="word-break:break-all;hyphens:auto;border-color:#4577da;background-color:#4577da;"><section style="margin-top:5px;margin-bottom:5px;"><section style="margin-bottom:unset;padding-right:5px;padding-left:5px;font-size:14px;color:#ffffff;box-sizing:border-box;"><p style="text-align:center;"><strong>漏洞概述</strong></p></section></section></td></tr><tr><td colspan="1" rowspan="1" width="25.0000%" style="word-break:break-all;hyphens:auto;border-color:#4577da;"><section style="margin-top:5px;margin-bottom:5px;"><section style="margin-bottom:unset;padding-right:5px;padding-left:5px;font-size:14px;box-sizing:border-box;"><p style="text-align:left;"><strong>漏洞名称</strong></p></section></section></td><td colspan="3" rowspan="1" width="75.0000%" style="word-break:break-all;hyphens:auto;border-color:#4577da;"><section style="margin-top:5px;margin-bottom:5px;"><section style="margin-bottom:unset;padding-right:5px;padding-left:5px;font-size:14px;box-sizing:border-box;"><p>Apache Tomcat存在远程代码执行漏洞（CVE-2024-56377）</p></section></section></td></tr><tr><td colspan="1" rowspan="1" width="25.0000%" style="word-break:break-all;hyphens:auto;border-color:#4577da;"><section style="margin-top:5px;margin-bottom:5px;"><section style="margin-bottom:unset;padding-right:5px;padding-left:5px;font-size:14px;box-sizing:border-box;"><p style="text-align:left;"><strong>安恒CERT评级</strong></p></section></section></td><td colspan="1" rowspan="1" width="25.0000%" style="word-break:break-all;hyphens:auto;border-color:#4577da;"><section style="margin-top:5px;margin-bottom:5px;"><section style="margin-bottom:unset;padding-right:5px;padding-left:5px;font-size:14px;box-sizing:border-box;"><p style="text-align:left;word-break:break-all;">2级</p></section></section></td><td colspan="1" rowspan="1" width="25.0000%" style="word-break:break-all;hyphens:auto;border-color:#4577da;"><section style="margin-top:5px;margin-bottom:5px;"><section style="margin-bottom:unset;padding-right:5px;padding-left:5px;font-size:14px;box-sizing:border-box;"><p style="text-align:left;"><strong>CVSS3.1评分</strong></p></section></section></td><td colspan="1" rowspan="1" width="25.0000%" style="word-break:break-all;hyphens:auto;border-color:#4577da;"><section style="margin-top:5px;margin-bottom:5px;"><section style="margin-bottom:unset;padding-right:5px;padding-left:5px;font-size:14px;box-sizing:border-box;"><p style="text-align:left;">8.1（安恒自评）<br/></p></section></section></td></tr><tr><td colspan="1" rowspan="1" width="25.0000%" style="word-break:break-all;hyphens:auto;border-color:#4577da;"><section style="margin-top:5px;margin-bottom:5px;"><section style="margin-bottom:unset;padding-right:5px;padding-left:5px;font-size:14px;box-sizing:border-box;"><p style="text-align:left;"><strong>CVE编号</strong></p></section></section></td><td colspan="1" rowspan="1" width="25.0000%" style="word-break:break-all;hyphens:auto;border-color:#4577da;"><section style="margin-top:5px;margin-bottom:5px;"><p><span style="font-size:14px;letter-spacing:0.544px;line-height:22.4px;">CVE-2024-56377</span></p><section style="margin-bottom:unset;padding-right:5px;padding-left:5px;font-size:14px;box-sizing:border-box;overflow:hidden;line-height:0;"><br/></section></section></td><td colspan="1" rowspan="1" width="25.0000%" style="word-break:break-all;hyphens:auto;border-color:#4577da;"><section style="margin-top:5px;margin-bottom:5px;"><section style="margin-bottom:unset;padding-right:5px;padding-left:5px;font-size:14px;box-sizing:border-box;"><p style="text-align:left;"><strong>CNVD编号</strong></p></section></section></td><td colspan="1" rowspan="1" width="25.0000%" style="word-break:break-all;hyphens:auto;border-color:#4577da;"><section style="margin-top:5px;margin-bottom:5px;"><section style="margin-bottom:unset;padding-right:5px;padding-left:5px;font-size:14px;box-sizing:border-box;"><p style="text-align:left;">未分配</p></section></section></td></tr><tr><td colspan="1" rowspan="1" width="25.0000%" style="word-break:break-all;hyphens:auto;border-color:#4577da;"><section style="margin-top:5px;margin-bottom:5px;"><section style="margin-bottom:unset;padding-right:5px;padding-left:5px;font-size:14px;box-sizing:border-box;"><p style="text-align:left;"><strong>CNNVD编号</strong></p></section></section></td><td colspan="1" rowspan="1" width="25.0000%" style="word-break:break-all;hyphens:auto;border-color:#4577da;"><section style="margin-top:5px;margin-bottom:5px;"><section style="margin-bottom:unset;padding-right:5px;padding-left:5px;font-size:14px;box-sizing:border-box;"><p> 未分配</p></section></section></td><td colspan="1" rowspan="1" width="25.0000%" style="word-break:break-all;hyphens:auto;border-color:#4577da;"><section style="margin-top:5px;margin-bottom:5px;"><section style="margin-bottom:unset;padding-right:5px;padding-left:5px;font-size:14px;box-sizing:border-box;"><p style="text-align:left;"><strong>安恒CERT编号</strong></p></section></section></td><td colspan="1" rowspan="1" width="25.0000%" style="word-break:break-all;hyphens:auto;border-color:#4577da;"><section style="margin-top:5px;margin-bottom:5px;"><section style="margin-bottom:unset;padding-right:5px;padding-left:5px;font-size:14px;box-sizing:border-box;"><p>DM-202412-003532</p></section></section></td></tr><tr><td colspan="1" rowspan="1" width="25.0000%" style="word-break:break-all;hyphens:auto;border-color:#4577da;"><section style="margin-top:5px;margin-bottom:5px;"><section style="margin-bottom:unset;padding-right:5px;padding-left:5px;font-size:14px;box-sizing:border-box;"><p style="text-align:left;"><strong>POC情况</strong></p></section></section></td><td colspan="1" rowspan="1" width="25.0000%" style="word-break:break-all;hyphens:auto;border-color:#4577da;"><section style="margin-top:5px;margin-bottom:5px;"><section style="margin-bottom:unset;padding-right:5px;padding-left:5px;font-size:14px;box-sizing:border-box;"><p>已发现</p></section></section></td><td colspan="1" rowspan="1" width="25.0000%" style="word-break:break-all;hyphens:auto;border-color:#4577da;"><section style="margin-top:5px;margin-bottom:5px;"><section style="margin-bottom:unset;padding-right:5px;padding-left:5px;font-size:14px;box-sizing:border-box;"><p style="text-align:left;"><strong>EXP情况</strong></p></section></section></td><td colspan="1" rowspan="1" width="25.0000%" style="word-break:break-all;hyphens:auto;border-color:#4577da;"><section style="margin-top:5px;margin-bottom:5px;"><section style="margin-bottom:unset;padding-right:5px;padding-left:5px;font-size:14px;box-sizing:border-box;"><p>未发现</p></section></section></td></tr><tr><td colspan="1" rowspan="1" width="25.0000%" style="word-break:break-all;hyphens:auto;border-color:#4577da;"><section style="margin-top:5px;margin-bottom:5px;"><section style="margin-bottom:unset;padding-right:5px;padding-left:5px;font-size:14px;box-sizing:border-box;"><p style="text-align:left;"><strong>在野利用</strong></p></section></section></td><td colspan="1" rowspan="1" width="25.0000%" style="word-break:break-all;hyphens:auto;border-color:#4577da;"><section style="margin-top:5px;margin-bottom:5px;"><section style="margin-bottom:unset;padding-right:5px;padding-left:5px;font-size:14px;box-sizing:border-box;"><p>未发现</p></section></section></td><td colspan="1" rowspan="1" width="25.0000%" style="word-break:break-all;hyphens:auto;border-color:#4577da;"><section style="margin-top:5px;margin-bottom:5px;"><section style="margin-bottom:unset;padding-right:5px;padding-left:5px;font-size:14px;box-sizing:border-box;"><p style="text-align:left;"><strong>研究情况</strong></p></section></section></td><td colspan="1" rowspan="1" width="25.0000%" style="word-break:break-all;hyphens:auto;border-color:#4577da;"><section style="margin-top:5px;margin-bottom:5px;"><section style="margin-bottom:unset;padding-right:5px;padding-left:5px;font-size:14px;box-sizing:border-box;"><p>已复现<br/></p></section></section></td></tr><tr><td colspan="1" rowspan="1" width="25.0000%" style="word-break:break-all;hyphens:auto;border-color:#4577da;"><section style="margin-top:5px;margin-bottom:5px;"><section style="margin-bottom:unset;padding-right:5px;padding-left:5px;font-size:14px;box-sizing:border-box;"><p style="text-align:left;"><strong>危害描述</strong></p></section></section></td><td colspan="3" rowspan="1" width="75.0000%" style="word-break:break-all;hyphens:auto;border-color:#4577da;"><section style="margin-top:5px;margin-bottom:5px;"><section style="margin-bottom:unset;padding-right:5px;padding-left:5px;font-size:14px;overflow:hidden;line-height:0;box-sizing:border-box;"><span style="font-size:14px;letter-spacing:0.544px;line-height:22.4px;">CVE-2024-56337是一个存在于Apache Tomcat中的TOCTOU（Time-of-Check Time-of-Use）竞争条件漏洞。此漏洞源于对先前漏洞（CVE-2024-50379）的不完整修复。若默认servlet是可写的（参数readonly设置值为false，该设置为非默认设置）表示不区分大小写文件系统，在负载下并发读取和上传同一文件可以绕过Tomcat的大小写检查。攻击者可以通过构造恶意请求上传含恶意JSP代码的文件，使其触发解析并执行这些文件，从而导致远程代码执行。</span></section></section></td></tr></tbody></table>  
  
该产  
品主要使用客户行业分布广泛，漏洞危害性高，  
建议客户尽快做好自查及防护。  
  
**安恒研究院卫兵实验室已复现此漏洞。**  
  
![](https://mmbiz.qpic.cn/mmbiz_png/JAzzLj4nXesrJuibwGjsrILqVW1NSGxM8Cia5BhA8aYibghpGcO96UcH3TA2FXyqiatqaNtsT9YNEdyNIrEw3vNeBQ/640?wx_fmt=png&from=appmsg "")  
  
  
  
**漏洞信息**  
  
  
  
  
  
**漏洞描述**  
  
**漏洞危害等级：**  
高危  
  
**漏洞类型：**  
远程代码执行  
  
  
**影响范围**  
  
**影响版本：**  
9.0.0.M1 <= Apache Tomcat < 9.0.98  
10.1.0-M1 <= Apache Tomcat < 10.1.34  
  
11.0.0-M1 <= Apache Tomcat < 11.0.2  
  
**安全版本：**  
  
Apache Tomcat >= 9.0.98  
Apache Tomcat >= 10.1.34  
  
Apache Tomcat >= 11.0.2  
  
  
**CVSS向量**  
  
访问途径（AV）：网络  
  
攻击复杂度（AC）：高  
  
所需权限（PR）：无需任何权限  
  
用户交互（UI）：不需要用户交互  
  
影响范围 （S）：不  
变  
  
机密性影响 （C）：高  
  
完整性影响 （l）：高  
  
可用性影响 （A）：高  
  
  
  
**修复方案**  
  
  
  
  
**官方修复方案：**  
官方已发布修复方案，受影响的用户建议更新至安全版本。  
下载链接：  
  
https://tomcat.apache.org/download-90.cgi  
  
https://tomcat.apache.org/download-10.cgi  
  
https://tomcat.apache.org/download-11.cgi  
  
如果用户在不区分大小写的文件系统上运行Tomcat，并且默认启用了servlet写入功能（参数readonly设置值为false），则可能需要进行额外配置才能完全缓解CVE-2024-50379，Tomcat与各版本Java对应的缓解措施如下：  
  
在Java 8或Java 11上运行：系统属性sun.io.useCanonCaches必须明确设置为false（默认值为true）  
  
在Java 17上运行：系统属性sun.io.useCanonCaches（如果设置）必须设置为false（默认值为false）  
  
在Java 21及更高版本上运行：无需进一步配置（系统属性和有问题的缓存已被删除）  
  
**临时缓解方案：**  
  
若配置了readonly参数，则可以在Tomcat程序根目录/conf/web.xml中将readonly参数设置为true或将配置代码注释或移除。  
  
![](https://mmbiz.qpic.cn/mmbiz_png/JAzzLj4nXetuqzn5QZqHBTLiaNJqPcjdibkINGZKU7E6l67hH4y2kOZcXicZMWarkibibiaRib4j8hIVTwNRiaD8NZm67A/640?wx_fmt=png&from=appmsg "")  
  
**产品能力覆盖**  
  
  
  
<table><tbody style="max-width:100% !important;box-sizing:border-box;overflow-wrap:break-word !important;"><tr style="max-width:100% !important;box-sizing:border-box;overflow-wrap:break-word !important;"><td colspan="1" rowspan="1" width="33.0000%" data-style="border-width:1px;border-color:rgb(69, 119, 218);border-style:solid;background-color:rgb(69, 119, 218);box-sizing:border-box;" class="js_darkmode__38" style="padding:5px 10px;overflow-wrap:break-word !important;word-break:break-all;hyphens:auto;border-width:1px;border-style:solid;border-color:#4577da;max-width:100% !important;box-sizing:border-box;background-color:#4577da;"><section style="margin:5px 0px;max-width:100% !important;box-sizing:border-box;overflow-wrap:break-word !important;"><section style="margin-top:0px;margin-right:0px;margin-bottom:unset;margin-left:0px;padding:0px 5px;max-width:100% !important;box-sizing:border-box;overflow-wrap:break-word !important;text-align:left;font-size:14px;color:#ffffff;"><p><strong style="max-width:100% !important;box-sizing:border-box;overflow-wrap:break-word !important;">产品名称</strong></p></section></section></td><td colspan="1" rowspan="1" width="67.0000%" data-style="border-width:1px;border-color:rgb(69, 119, 218);border-style:solid;background-color:rgb(69, 119, 218);box-sizing:border-box;" class="js_darkmode__39" style="padding:5px 10px;overflow-wrap:break-word !important;word-break:break-all;hyphens:auto;border-width:1px;border-style:solid;border-color:#4577da;max-width:100% !important;box-sizing:border-box;background-color:#4577da;"><section style="margin:5px 0px;max-width:100% !important;box-sizing:border-box;overflow-wrap:break-word !important;"><section style="margin-top:0px;margin-right:0px;margin-bottom:unset;margin-left:0px;padding:0px 5px;max-width:100% !important;box-sizing:border-box;overflow-wrap:break-word !important;text-align:left;font-size:14px;color:#ffffff;"><p><strong style="max-width:100% !important;box-sizing:border-box;overflow-wrap:break-word !important;">覆盖补丁包</strong></p></section></section></td></tr><tr style="max-width:100% !important;box-sizing:border-box;overflow-wrap:break-word !important;"><td colspan="1" rowspan="1" width="33.0000%" style="padding:5px 10px;overflow-wrap:break-word !important;word-break:break-all;hyphens:auto;border-width:1px;border-style:solid;border-color:#4577da;max-width:100% !important;box-sizing:border-box;"><section style="margin:5px 0px;max-width:100% !important;box-sizing:border-box;overflow-wrap:break-word !important;"><section style="margin-top:0px;margin-right:0px;margin-bottom:unset;margin-left:0px;padding:0px 5px;max-width:100% !important;box-sizing:border-box;overflow-wrap:break-word !important;text-align:left;font-size:14px;"><p>AiLPHA大数据平台</p></section></section></td><td colspan="1" rowspan="1" width="67.0000%" style="padding:5px 10px;overflow-wrap:break-word !important;word-break:break-all;hyphens:auto;border-width:1px;border-style:solid;border-color:#4577da;max-width:100% !important;box-sizing:border-box;"><section style="margin:5px 0px;max-width:100% !important;box-sizing:border-box;overflow-wrap:break-word !important;"><section style="margin-top:0px;margin-right:0px;margin-bottom:unset;margin-left:0px;padding:0px 5px;max-width:100% !important;box-sizing:border-box;overflow-wrap:break-word !important;text-align:left;font-size:14px;"><p>已支持</p></section></section></td></tr><tr style="max-width:100% !important;box-sizing:border-box !important;overflow-wrap:break-word !important;"><td width="33.0000%" style="padding:5px 10px;overflow-wrap:break-word !important;word-break:break-all;hyphens:auto;border-width:1px;border-style:solid;border-color:#4577da;max-width:100% !important;box-sizing:border-box;"><section style="margin:5px 0px;max-width:100% !important;box-sizing:border-box;overflow-wrap:break-word !important;"><section style="margin-top:0px;margin-right:0px;margin-bottom:unset;margin-left:0px;padding:0px 5px;max-width:100% !important;box-sizing:border-box;overflow-wrap:break-word !important;text-align:left;font-size:14px;"><p>APT攻击预警平台</p></section></section></td><td width="67.0000%" style="padding:5px 10px;overflow-wrap:break-word !important;word-break:break-all;hyphens:auto;border-width:1px;border-style:solid;border-color:#4577da;max-width:100% !important;box-sizing:border-box;"><section style="margin:5px 0px;max-width:100% !important;box-sizing:border-box;overflow-wrap:break-word !important;"><section style="margin-top:0px;margin-right:0px;margin-bottom:unset;margin-left:0px;padding:0px 5px;max-width:100% !important;box-sizing:border-box;overflow-wrap:break-word !important;text-align:left;font-size:14px;"><p>已支持</p></section></section></td></tr><tr><td width="33.0000%" style="padding:5px 10px;overflow-wrap:break-word !important;word-break:break-all;hyphens:auto;border-width:1px;border-right-style:solid;border-bottom-style:solid;border-color:#4577da;max-width:100% !important;box-sizing:border-box;"><section style="margin:5px 0px;max-width:100% !important;box-sizing:border-box;overflow-wrap:break-word !important;"><section style="margin-top:0px;margin-right:0px;margin-bottom:unset;margin-left:0px;padding:0px 5px;max-width:100% !important;box-sizing:border-box;overflow-wrap:break-word !important;text-align:left;font-size:14px;"><p>明鉴漏洞扫描系统</p></section></section></td><td width="67.0000%" style="padding:5px 10px;overflow-wrap:break-word !important;word-break:break-all;hyphens:auto;border-width:1px;border-right-style:solid;border-bottom-style:solid;border-color:#4577da;max-width:100% !important;box-sizing:border-box;"><section style="margin:5px 0px;max-width:100% !important;box-sizing:border-box;overflow-wrap:break-word !important;"><section style="margin-top:0px;margin-right:0px;margin-bottom:unset;margin-left:0px;padding:0px 5px;max-width:100% !important;box-sizing:border-box;overflow-wrap:break-word !important;text-align:left;font-size:14px;"><p>已支持<br style="max-width:100% !important;box-sizing:border-box !important;overflow-wrap:break-word !important;"/></p></section></section></td></tr><tr style="max-width:100% !important;box-sizing:border-box !important;overflow-wrap:break-word !important;"><td width="33.0000%" style="padding:5px 10px;overflow-wrap:break-word !important;word-break:break-all;hyphens:auto;border-width:1px;border-style:solid;border-color:#4577da;max-width:100% !important;box-sizing:border-box;"><section style="margin:5px 0px;max-width:100% !important;box-sizing:border-box;overflow-wrap:break-word !important;"><section style="margin-top:0px;margin-right:0px;margin-bottom:unset;margin-left:0px;padding:0px 5px;max-width:100% !important;box-sizing:border-box;overflow-wrap:break-word !important;text-align:left;font-size:14px;"><p>WAF<br style="max-width:100% !important;box-sizing:border-box !important;overflow-wrap:break-word !important;"/></p></section></section></td><td width="67.0000%" style="padding:5px 10px;overflow-wrap:break-word !important;word-break:break-all;hyphens:auto;border-width:1px;border-style:solid;border-color:#4577da;max-width:100% !important;box-sizing:border-box;"><section style="margin:5px 0px;max-width:100% !important;box-sizing:border-box;overflow-wrap:break-word !important;"><section style="margin-top:0px;margin-right:0px;margin-bottom:unset;margin-left:0px;padding:0px 5px;max-width:100% !important;box-sizing:border-box;overflow-wrap:break-word !important;text-align:left;font-size:14px;"><p>已支持<br style="max-width:100% !important;box-sizing:border-box !important;overflow-wrap:break-word !important;"/></p></section></section></td></tr><tr style="max-width:100% !important;box-sizing:border-box !important;overflow-wrap:break-word !important;"><td width="33.0000%" style="padding:5px 10px;overflow-wrap:break-word !important;word-break:break-all;hyphens:auto;border-width:1px;border-style:solid;border-color:#4577da;max-width:100% !important;box-sizing:border-box;"><section style="margin:5px 0px;max-width:100% !important;box-sizing:border-box;overflow-wrap:break-word !important;"><section style="margin-top:0px;margin-right:0px;margin-bottom:unset;margin-left:0px;padding:0px 5px;max-width:100% !important;box-sizing:border-box;overflow-wrap:break-word !important;text-align:left;font-size:14px;"><p>玄武盾<br style="max-width:100% !important;box-sizing:border-box !important;overflow-wrap:break-word !important;"/></p></section></section></td><td width="67.0000%" style="padding:5px 10px;overflow-wrap:break-word !important;word-break:break-all;hyphens:auto;border-width:1px;border-style:solid;border-color:#4577da;max-width:100% !important;box-sizing:border-box;"><section style="margin:5px 0px;max-width:100% !important;box-sizing:border-box;overflow-wrap:break-word !important;"><section style="margin-top:0px;margin-right:0px;margin-bottom:unset;margin-left:0px;padding:0px 5px;max-width:100% !important;box-sizing:border-box;overflow-wrap:break-word !important;text-align:left;font-size:14px;"><p>已支持</p></section></section></td></tr></tbody></table>  
  
**参考资料**  
  
  
  
  
https://www.openwall.com/lists/oss-security/2024/12/17/4https://nvd.nist.gov/vuln/detail/CVE-2024-56337  
  
  
  
**技术支持**  
  
  
  
  
如有漏洞相关需求支持请联系400-6059-110获取相关能力支撑。  
  
