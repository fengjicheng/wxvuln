#  DMC Airin Blog Plugin 反序列化 CVE-2024-52413分析   
原创 韭菜  fraud安全   2024-12-12 00:30  
  
# 漏洞文件定位  
  
根据漏洞通告提示问题点在反序列化  
  
![](https://mmbiz.qpic.cn/mmbiz_png/Eqn4A05JY6uBDHIGSIZVYxsHv1mdV1mgrRa0QeM65u3kVc7YT8JR9r9GicVzcic4uEoIN6DsIMP0yQ97WhYQYboA/640?wx_fmt=png&from=appmsg "")  
  
全局查找反序列化关键字  
  
![](https://mmbiz.qpic.cn/mmbiz_png/Eqn4A05JY6uBDHIGSIZVYxsHv1mdV1mg9hWGnu0bNIWNGHpAZqia14OtLAbXC3EbOb0sJfibtm2zVQcbnZvlF7Yw/640?wx_fmt=png&from=appmsg "")  
# 漏洞分析  
  
构造反序列化payload通过POST  
请求query  
参数直接获取  
  
反向追踪，发现airinblog_fun_loadmore_post_cat  
和airinblog_fun_loadmore_cat_home  
方法都可以进入airinblog_fun_loadmore_post_grid  
  
![](https://mmbiz.qpic.cn/mmbiz_png/Eqn4A05JY6uBDHIGSIZVYxsHv1mdV1mgKpRImHAI9ZcD4zbFP46EiaKmHnhYA7QzL0S2eM9E2QqX4CSKoVoOn3Q/640?wx_fmt=png&from=appmsg "")  
  
那么思路就比较简单了，post请求携带query参数，即可触发反序列化。  
  
但是在调试的过程中get_theme_mod( 'airinblog_cus_pagination_variant', 'v1' )  
值为v1  
  
![](https://mmbiz.qpic.cn/mmbiz_png/Eqn4A05JY6uBDHIGSIZVYxsHv1mdV1mgg9dngibv1Iibd0kUiaLttMYBoWc45EGeoicoiafRurB6I1sSIjG8ibzqbF2A/640?wx_fmt=png&from=appmsg "")  
  
推测可能是需要购买Premium  
版才能出发漏洞  
  
ps：个人也不是很熟悉这个模块，如果推测错误，请各位大佬吾喷，谢谢  
  
![](https://mmbiz.qpic.cn/mmbiz_png/Eqn4A05JY6uBDHIGSIZVYxsHv1mdV1mgTBgDsRWx4LibCAkgZo7mtWiagUfzBJNicEeu00uRHL8W5NGSgZuy4KNKw/640?wx_fmt=png&from=appmsg "")  
  
那么修改代码将v2  
修改为v1  
测试反序列漏洞  
  
![](https://mmbiz.qpic.cn/mmbiz_png/Eqn4A05JY6uBDHIGSIZVYxsHv1mdV1mgn6hBcsMsIsqQGAlgW8Mldh9be7Y74Fia6Vnu55tibDHiacOXLYTnAWibdA/640?wx_fmt=png&from=appmsg "")  
  
要想触发airinblog_fun_loadmore_post_cat  
或airinblog_fun_loadmore_cat_home  
方法需要使用使用ajax请求  
  
![](https://mmbiz.qpic.cn/mmbiz_png/Eqn4A05JY6uBDHIGSIZVYxsHv1mdV1mgkFsUxiaDmb8iaibb9zos72ibZ5gfCLFWbUVwfQduZaSRNDJAHs09g0nOgw/640?wx_fmt=png&from=appmsg "")  
  
在if里进行标记，查看是否进入if结构体里  
  
![](https://mmbiz.qpic.cn/mmbiz_png/Eqn4A05JY6uBDHIGSIZVYxsHv1mdV1mgmWcyQ04s4m4X2yFelCRZRrzmIhIvnibibyC91mzE6d6JJiaLMuC6SI1wg/640?wx_fmt=png&from=appmsg "")  
  
成功进入if结构体  
  
![](https://mmbiz.qpic.cn/mmbiz_png/Eqn4A05JY6uBDHIGSIZVYxsHv1mdV1mgBYUsJugERyib138b6FobicCqWr9nTuJtIibruErhsP7OMaV6EdickUcMqA/640?wx_fmt=png&from=appmsg "")  
  
进入airinblog_fun_loadmore_post_cat_home函数  
  
![](https://mmbiz.qpic.cn/mmbiz_png/Eqn4A05JY6uBDHIGSIZVYxsHv1mdV1mguxgTTauXFIqNEicZwhftV2Vuc2VTpPZAA23HUiaAc3iczSvpbZDmerhXg/640?wx_fmt=png&from=appmsg "")  
```
```  
  
![](https://mmbiz.qpic.cn/mmbiz_png/Eqn4A05JY6uBDHIGSIZVYxsHv1mdV1mgxRSaAfnyHWNsK1jWcO2BuaUObH2mmf5h5nw73XicWFc4bINem81pSZA/640?wx_fmt=png&from=appmsg "")  
  
确认是否进入airinblog_fun_loadmore_post_grid  
  
![](https://mmbiz.qpic.cn/mmbiz_png/Eqn4A05JY6uBDHIGSIZVYxsHv1mdV1mgwnF8wqnU7alnTJZKicuhk1sNQT6892KNlwiaMYUbqtPxib0Ah1FiaapFCA/640?wx_fmt=png&from=appmsg "")  
  
成功进入反序列化入口。  
  
![](https://mmbiz.qpic.cn/mmbiz_png/Eqn4A05JY6uBDHIGSIZVYxsHv1mdV1mgiaoogKTsveUqoPaAVXY1UH2ian9lBJrRicckvSL4fe13fkB3AWPqx8gPQ/640?wx_fmt=png&from=appmsg "")  
  
  
