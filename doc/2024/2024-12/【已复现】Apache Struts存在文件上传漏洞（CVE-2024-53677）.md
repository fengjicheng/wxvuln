#  【已复现】Apache Struts存在文件上传漏洞（CVE-2024-53677）   
安恒研究院  安恒信息CERT   2024-12-16 09:27  
  
![](https://mmbiz.qpic.cn/mmbiz_jpg/JAzzLj4nXevmL5H6C1I6nWLYOHeic25ZZq3Sju5Xs1LnOckux8PBqG1qYrBly0Nicx4verjADnLorl5g1ImeuTeg/640?wx_fmt=jpeg&from=appmsg&wx_ "")  
  
<table><tbody><tr><td colspan="4" rowspan="1" width="100.0000%" data-style="border-width:1px;border-color:rgb(69, 119, 218);border-style:solid;background-color:rgb(69, 119, 218);box-sizing:border-box;" class="js_darkmode__0" style="word-break:break-all;hyphens:auto;border-color:#4577da;background-color:#4577da;"><section style="margin-top:5px;margin-bottom:5px;"><section style="margin-bottom:unset;padding-right:5px;padding-left:5px;font-size:14px;color:#ffffff;box-sizing:border-box;"><p style="text-align:center;"><strong>漏洞概述</strong></p></section></section></td></tr><tr><td colspan="1" rowspan="1" width="25.0000%" style="word-break:break-all;hyphens:auto;border-color:#4577da;"><section style="margin-top:5px;margin-bottom:5px;"><section style="margin-bottom:unset;padding-right:5px;padding-left:5px;font-size:14px;box-sizing:border-box;"><p style="text-align:left;"><strong>漏洞名称</strong></p></section></section></td><td colspan="3" rowspan="1" width="75.0000%" style="word-break:break-all;hyphens:auto;border-color:#4577da;"><section style="margin-top:5px;margin-bottom:5px;"><section style="margin-bottom:unset;padding-right:5px;padding-left:5px;font-size:14px;box-sizing:border-box;"><p>Apache Struts存在文件上传漏洞（CVE-2024-53677）</p></section></section></td></tr><tr><td colspan="1" rowspan="1" width="25.0000%" style="word-break:break-all;hyphens:auto;border-color:#4577da;"><section style="margin-top:5px;margin-bottom:5px;"><section style="margin-bottom:unset;padding-right:5px;padding-left:5px;font-size:14px;box-sizing:border-box;"><p style="text-align:left;"><strong>安恒CERT评级</strong></p></section></section></td><td colspan="1" rowspan="1" width="25.0000%" style="word-break:break-all;hyphens:auto;border-color:#4577da;"><section style="margin-top:5px;margin-bottom:5px;"><section style="margin-bottom:unset;padding-right:5px;padding-left:5px;font-size:14px;box-sizing:border-box;"><p style="text-align:left;word-break:break-all;">2级</p></section></section></td><td colspan="1" rowspan="1" width="25.0000%" style="word-break:break-all;hyphens:auto;border-color:#4577da;"><section style="margin-top:5px;margin-bottom:5px;"><section style="margin-bottom:unset;padding-right:5px;padding-left:5px;font-size:14px;box-sizing:border-box;"><p style="text-align:left;"><strong>CVSS3.1评分</strong></p></section></section></td><td colspan="1" rowspan="1" width="25.0000%" style="word-break:break-all;hyphens:auto;border-color:#4577da;"><section style="margin-top:5px;margin-bottom:5px;"><section style="margin-bottom:unset;padding-right:5px;padding-left:5px;font-size:14px;box-sizing:border-box;"><p style="text-align:left;">8.1<br/></p></section></section></td></tr><tr><td colspan="1" rowspan="1" width="25.0000%" style="word-break:break-all;hyphens:auto;border-color:#4577da;"><section style="margin-top:5px;margin-bottom:5px;"><section style="margin-bottom:unset;padding-right:5px;padding-left:5px;font-size:14px;box-sizing:border-box;"><p style="text-align:left;"><strong>CVE编号</strong></p></section></section></td><td colspan="1" rowspan="1" width="25.0000%" style="word-break:break-all;hyphens:auto;border-color:#4577da;"><section style="margin-top:5px;margin-bottom:5px;"><p><span style="font-size:14px;letter-spacing:0.544px;line-height:22.4px;">CVE-2024-53677</span></p><section style="margin-bottom:unset;padding-right:5px;padding-left:5px;font-size:14px;box-sizing:border-box;overflow:hidden;line-height:0;"><br/></section></section></td><td colspan="1" rowspan="1" width="25.0000%" style="word-break:break-all;hyphens:auto;border-color:#4577da;"><section style="margin-top:5px;margin-bottom:5px;"><section style="margin-bottom:unset;padding-right:5px;padding-left:5px;font-size:14px;box-sizing:border-box;"><p style="text-align:left;"><strong>CNVD编号</strong></p></section></section></td><td colspan="1" rowspan="1" width="25.0000%" style="word-break:break-all;hyphens:auto;border-color:#4577da;"><section style="margin-top:5px;margin-bottom:5px;"><section style="margin-bottom:unset;padding-right:5px;padding-left:5px;font-size:14px;box-sizing:border-box;"><p style="text-align:left;">未分配</p></section></section></td></tr><tr><td colspan="1" rowspan="1" width="25.0000%" style="word-break:break-all;hyphens:auto;border-color:#4577da;"><section style="margin-top:5px;margin-bottom:5px;"><section style="margin-bottom:unset;padding-right:5px;padding-left:5px;font-size:14px;box-sizing:border-box;"><p style="text-align:left;"><strong>CNNVD编号</strong></p></section></section></td><td colspan="1" rowspan="1" width="25.0000%" style="word-break:break-all;hyphens:auto;border-color:#4577da;"><section style="margin-top:5px;margin-bottom:5px;"><section style="margin-bottom:unset;padding-right:5px;padding-left:5px;font-size:14px;box-sizing:border-box;"><p>CNNVD-202412-1393</p></section></section></td><td colspan="1" rowspan="1" width="25.0000%" style="word-break:break-all;hyphens:auto;border-color:#4577da;"><section style="margin-top:5px;margin-bottom:5px;"><section style="margin-bottom:unset;padding-right:5px;padding-left:5px;font-size:14px;box-sizing:border-box;"><p style="text-align:left;"><strong>安恒CERT编号</strong></p></section></section></td><td colspan="1" rowspan="1" width="25.0000%" style="word-break:break-all;hyphens:auto;border-color:#4577da;"><section style="margin-top:5px;margin-bottom:5px;"><section style="margin-bottom:unset;padding-right:5px;padding-left:5px;font-size:14px;box-sizing:border-box;"><p>DM-202411-003426</p></section></section></td></tr><tr><td colspan="1" rowspan="1" width="25.0000%" style="word-break:break-all;hyphens:auto;border-color:#4577da;"><section style="margin-top:5px;margin-bottom:5px;"><section style="margin-bottom:unset;padding-right:5px;padding-left:5px;font-size:14px;box-sizing:border-box;"><p style="text-align:left;"><strong>POC情况</strong></p></section></section></td><td colspan="1" rowspan="1" width="25.0000%" style="word-break:break-all;hyphens:auto;border-color:#4577da;"><section style="margin-top:5px;margin-bottom:5px;"><section style="margin-bottom:unset;padding-right:5px;padding-left:5px;font-size:14px;box-sizing:border-box;"><p>已发现</p></section></section></td><td colspan="1" rowspan="1" width="25.0000%" style="word-break:break-all;hyphens:auto;border-color:#4577da;"><section style="margin-top:5px;margin-bottom:5px;"><section style="margin-bottom:unset;padding-right:5px;padding-left:5px;font-size:14px;box-sizing:border-box;"><p style="text-align:left;"><strong>EXP情况</strong></p></section></section></td><td colspan="1" rowspan="1" width="25.0000%" style="word-break:break-all;hyphens:auto;border-color:#4577da;"><section style="margin-top:5px;margin-bottom:5px;"><section style="margin-bottom:unset;padding-right:5px;padding-left:5px;font-size:14px;box-sizing:border-box;"><p>未发现</p></section></section></td></tr><tr><td colspan="1" rowspan="1" width="25.0000%" style="word-break:break-all;hyphens:auto;border-color:#4577da;"><section style="margin-top:5px;margin-bottom:5px;"><section style="margin-bottom:unset;padding-right:5px;padding-left:5px;font-size:14px;box-sizing:border-box;"><p style="text-align:left;"><strong>在野利用</strong></p></section></section></td><td colspan="1" rowspan="1" width="25.0000%" style="word-break:break-all;hyphens:auto;border-color:#4577da;"><section style="margin-top:5px;margin-bottom:5px;"><section style="margin-bottom:unset;padding-right:5px;padding-left:5px;font-size:14px;box-sizing:border-box;"><p>未发现</p></section></section></td><td colspan="1" rowspan="1" width="25.0000%" style="word-break:break-all;hyphens:auto;border-color:#4577da;"><section style="margin-top:5px;margin-bottom:5px;"><section style="margin-bottom:unset;padding-right:5px;padding-left:5px;font-size:14px;box-sizing:border-box;"><p style="text-align:left;"><strong>研究情况</strong></p></section></section></td><td colspan="1" rowspan="1" width="25.0000%" style="word-break:break-all;hyphens:auto;border-color:#4577da;"><section style="margin-top:5px;margin-bottom:5px;"><section style="margin-bottom:unset;padding-right:5px;padding-left:5px;font-size:14px;box-sizing:border-box;"><p>已复现<br/></p></section></section></td></tr><tr><td colspan="1" rowspan="1" width="25.0000%" style="word-break:break-all;hyphens:auto;border-color:#4577da;"><section style="margin-top:5px;margin-bottom:5px;"><section style="margin-bottom:unset;padding-right:5px;padding-left:5px;font-size:14px;box-sizing:border-box;"><p style="text-align:left;"><strong>危害描述</strong></p></section></section></td><td colspan="3" rowspan="1" width="75.0000%" style="word-break:break-all;hyphens:auto;border-color:#4577da;"><section style="margin-top:5px;margin-bottom:5px;"><section style="margin-bottom:unset;padding-right:5px;padding-left:5px;font-size:14px;overflow:hidden;line-height:0;box-sizing:border-box;"><br/></section><p><span style="font-size:14px;letter-spacing:0.544px;line-height:22.4px;">若用户未正确配置验证和过滤机制，攻击者可以操纵文件上传参数来启用路径遍历，利用未授权的上传功能执行恶意代码。未使用FileUploadInterceptor的情况下将不受该漏洞影响。</span></p></section></td></tr></tbody></table>  
  
该产  
品主要使用客户行业分布广泛，漏洞危害性高，  
建议客户尽快做好自查及防护。  
  
**安恒研究院卫兵实验室已复现此漏洞。**  
  
![](https://mmbiz.qpic.cn/mmbiz_png/JAzzLj4nXesuicNccibMKOsiaugnUO1rLGdFUXkxziaZUd4Y8Etia2wFx6EXlESOGREibKntZEq214gufhnb5biaR8HhQ/640?wx_fmt=png&from=appmsg "")  
  
  
  
**漏洞信息**  
  
  
  
  
  
**漏洞描述**  
  
**漏洞危害等级：**  
高危  
  
**漏洞类型：**  
文件上传  
  
  
**影响范围**  
  
**影响版本：**  
Struts 2.0.0 - Struts 2.3.37（EOL）  
Struts 2.5.0 - Struts 2.5.33  
  
Struts 6.0.0 - Struts 6.3.0.2  
  
**安全版本：**  
  
Struts >= 6.4.0  
  
  
**CVSS向量**  
  
访问途径（AV）：网络  
  
攻击复杂度（AC）：高  
  
所需权限（PR）：无需任何权限  
  
用户交互（UI）：不需要用户交互  
  
影响范围 （S）：不  
变  
  
机密性影响 （C）：高  
  
完整性影响 （l）：高  
  
可用性影响 （A）：高  
  
  
  
**修复方案**  
  
  
  
  
**官方修复方案：**  
官方已发布修复方案，受影响的用户建议更新至安全版本。  
官方链接：  
  
https://struts.apache.org/download.html  
  
**临时缓解方案：**  
禁用FileUploadInterceptor，或仅允许白名单中的文件类型进行上传。  
配置严格的权限验证，确保上传功能仅对授权用户开放。  
  
**产品能力覆盖**  
  
  
  
<table><tbody style="max-width:100% !important;box-sizing:border-box;overflow-wrap:break-word !important;"><tr style="max-width:100% !important;box-sizing:border-box;overflow-wrap:break-word !important;"><td colspan="1" rowspan="1" width="33.0000%" data-style="border-width:1px;border-color:rgb(69, 119, 218);border-style:solid;background-color:rgb(69, 119, 218);box-sizing:border-box;" class="js_darkmode__38" style="padding:5px 10px;overflow-wrap:break-word !important;word-break:break-all;hyphens:auto;border-width:1px;border-style:solid;border-color:#4577da;max-width:100% !important;box-sizing:border-box;background-color:#4577da;"><section style="margin:5px 0px;max-width:100% !important;box-sizing:border-box;overflow-wrap:break-word !important;"><section style="margin-top:0px;margin-right:0px;margin-bottom:unset;margin-left:0px;padding:0px 5px;max-width:100% !important;box-sizing:border-box;overflow-wrap:break-word !important;text-align:left;font-size:14px;color:#ffffff;"><p><strong style="max-width:100% !important;box-sizing:border-box;overflow-wrap:break-word !important;">产品名称</strong></p></section></section></td><td colspan="1" rowspan="1" width="67.0000%" data-style="border-width:1px;border-color:rgb(69, 119, 218);border-style:solid;background-color:rgb(69, 119, 218);box-sizing:border-box;" class="js_darkmode__39" style="padding:5px 10px;overflow-wrap:break-word !important;word-break:break-all;hyphens:auto;border-width:1px;border-style:solid;border-color:#4577da;max-width:100% !important;box-sizing:border-box;background-color:#4577da;"><section style="margin:5px 0px;max-width:100% !important;box-sizing:border-box;overflow-wrap:break-word !important;"><section style="margin-top:0px;margin-right:0px;margin-bottom:unset;margin-left:0px;padding:0px 5px;max-width:100% !important;box-sizing:border-box;overflow-wrap:break-word !important;text-align:left;font-size:14px;color:#ffffff;"><p><strong style="max-width:100% !important;box-sizing:border-box;overflow-wrap:break-word !important;">覆盖补丁包</strong></p></section></section></td></tr><tr style="max-width:100% !important;box-sizing:border-box;overflow-wrap:break-word !important;"><td colspan="1" rowspan="1" width="33.0000%" style="padding:5px 10px;overflow-wrap:break-word !important;word-break:break-all;hyphens:auto;border-width:1px;border-style:solid;border-color:#4577da;max-width:100% !important;box-sizing:border-box;"><section style="margin:5px 0px;max-width:100% !important;box-sizing:border-box;overflow-wrap:break-word !important;"><section style="margin-top:0px;margin-right:0px;margin-bottom:unset;margin-left:0px;padding:0px 5px;max-width:100% !important;box-sizing:border-box;overflow-wrap:break-word !important;text-align:left;font-size:14px;"><p>AiLPHA大数据平台</p></section></section></td><td colspan="1" rowspan="1" width="67.0000%" style="padding:5px 10px;overflow-wrap:break-word !important;word-break:break-all;hyphens:auto;border-width:1px;border-style:solid;border-color:#4577da;max-width:100% !important;box-sizing:border-box;"><section style="margin:5px 0px;max-width:100% !important;box-sizing:border-box;overflow-wrap:break-word !important;"><section style="margin-top:0px;margin-right:0px;margin-bottom:unset;margin-left:0px;padding:0px 5px;max-width:100% !important;box-sizing:border-box;overflow-wrap:break-word !important;text-align:left;font-size:14px;"><p>GoldenEyeIPv6_XXXXX_strategy2.0.XXXXX.241216.1及以上版本</p></section></section></td></tr><tr style="max-width:100% !important;box-sizing:border-box !important;overflow-wrap:break-word !important;"><td width="33.0000%" style="padding:5px 10px;overflow-wrap:break-word !important;word-break:break-all;hyphens:auto;border-width:1px;border-style:solid;border-color:#4577da;max-width:100% !important;box-sizing:border-box;"><section style="margin:5px 0px;max-width:100% !important;box-sizing:border-box;overflow-wrap:break-word !important;"><section style="margin-top:0px;margin-right:0px;margin-bottom:unset;margin-left:0px;padding:0px 5px;max-width:100% !important;box-sizing:border-box;overflow-wrap:break-word !important;text-align:left;font-size:14px;"><p>APT攻击预警平台</p></section></section></td><td width="67.0000%" style="padding:5px 10px;overflow-wrap:break-word !important;word-break:break-all;hyphens:auto;border-width:1px;border-style:solid;border-color:#4577da;max-width:100% !important;box-sizing:border-box;"><section style="margin:5px 0px;max-width:100% !important;box-sizing:border-box;overflow-wrap:break-word !important;"><section style="margin-top:0px;margin-right:0px;margin-bottom:unset;margin-left:0px;padding:0px 5px;max-width:100% !important;box-sizing:border-box;overflow-wrap:break-word !important;text-align:left;font-size:14px;"><p>GoldenEyeIPv6_XXXXX_strategy2.0.XXXXX.241216.1及以上版本</p></section></section></td></tr><tr style="max-width:100% !important;box-sizing:border-box !important;overflow-wrap:break-word !important;"><td width="33.0000%" style="padding:5px 10px;overflow-wrap:break-word !important;word-break:break-all;hyphens:auto;border-width:1px;border-style:solid;border-color:#4577da;max-width:100% !important;box-sizing:border-box;"><section style="margin:5px 0px;max-width:100% !important;box-sizing:border-box;overflow-wrap:break-word !important;"><section style="margin-top:0px;margin-right:0px;margin-bottom:unset;margin-left:0px;padding:0px 5px;max-width:100% !important;box-sizing:border-box;overflow-wrap:break-word !important;text-align:left;font-size:14px;"><p>WAF<br style="max-width:100% !important;box-sizing:border-box !important;overflow-wrap:break-word !important;"/></p></section></section></td><td width="67.0000%" style="padding:5px 10px;overflow-wrap:break-word !important;word-break:break-all;hyphens:auto;border-width:1px;border-style:solid;border-color:#4577da;max-width:100% !important;box-sizing:border-box;"><section style="margin:5px 0px;max-width:100% !important;box-sizing:border-box;overflow-wrap:break-word !important;"><section style="margin-top:0px;margin-right:0px;margin-bottom:unset;margin-left:0px;padding:0px 5px;max-width:100% !important;box-sizing:border-box;overflow-wrap:break-word !important;text-align:left;font-size:14px;"><p>已支持<br style="max-width:100% !important;box-sizing:border-box !important;overflow-wrap:break-word !important;"/></p></section></section></td></tr><tr style="max-width:100% !important;box-sizing:border-box !important;overflow-wrap:break-word !important;"><td width="33.0000%" style="padding:5px 10px;overflow-wrap:break-word !important;word-break:break-all;hyphens:auto;border-width:1px;border-style:solid;border-color:#4577da;max-width:100% !important;box-sizing:border-box;"><section style="margin:5px 0px;max-width:100% !important;box-sizing:border-box;overflow-wrap:break-word !important;"><section style="margin-top:0px;margin-right:0px;margin-bottom:unset;margin-left:0px;padding:0px 5px;max-width:100% !important;box-sizing:border-box;overflow-wrap:break-word !important;text-align:left;font-size:14px;"><p>玄武盾<br style="max-width:100% !important;box-sizing:border-box !important;overflow-wrap:break-word !important;"/></p></section></section></td><td width="67.0000%" style="padding:5px 10px;overflow-wrap:break-word !important;word-break:break-all;hyphens:auto;border-width:1px;border-style:solid;border-color:#4577da;max-width:100% !important;box-sizing:border-box;"><section style="margin:5px 0px;max-width:100% !important;box-sizing:border-box;overflow-wrap:break-word !important;"><section style="margin-top:0px;margin-right:0px;margin-bottom:unset;margin-left:0px;padding:0px 5px;max-width:100% !important;box-sizing:border-box;overflow-wrap:break-word !important;text-align:left;font-size:14px;"><p>已支持</p></section></section></td></tr></tbody></table>  
  
**参考资料**  
  
  
  
  
https://cwiki.apache.org/confluence/display/WW/S2-067  
  
  
  
**技术支持**  
  
  
  
  
如有漏洞相关需求支持请联系400-6059-110获取相关能力支撑。  
  
