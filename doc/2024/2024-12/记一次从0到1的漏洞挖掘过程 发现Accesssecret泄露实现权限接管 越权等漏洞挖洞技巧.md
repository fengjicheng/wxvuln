#  记一次从0到1的漏洞挖掘过程 发现Accesssecret泄露实现权限接管 越权等漏洞|挖洞技巧   
漏洞挖掘  渗透安全HackTwo   2024-12-01 16:00  
  
0x01 前言   
       通过分析目标系统的前端JS代码，发现了泄露的 heapdump 文件，从中提取云服务的 accesskey 和 accesssecret 实现权限接管。在某通用系统中，利用水平越权删除他人API和垂直越权接管服务器的逻辑漏洞。****  
  
**末尾可领取挖洞资料文件**  
  
0x02 漏洞发现开局一个经典的登录框。一般遇到带验证码的，口令爆破的可能都比较小。一般可尝试绕过验证码的操作：置空、复用、captcha爆破等，这里尝试后无果。随便试了几个弱口令果断放弃。扫目录也没有扫出东西…没办法了，最后尝试审记JS看有没有未授权接口什么的。F12，启动！通过js发现一个可疑的目录。访问是springboot的报错白页：针对springboot框架的站一般先看两个东西：env泄露、和heapdump文件。这里发现存在heapdump文件和env泄露，这里主要看heapdump文件。拖进工具里面分析，拿到云的accesskey和accesssecret 。然后利用CF接管到云服务器：无聊挖掘某Src挖到的，该平台存在多个严重逻辑缺陷问题漏洞1：水平越权删除他人API 影响正常业务漏洞2：垂直越权可以越权接管服务器先来看垂直越权：发现平台注册无限制，使用个人邮箱注册个账号１登录抓包：发现其中一个接口返回包里有一个鉴权参数roles尝试更改 /rest/user/isLogin 返回包参数roles为 0越权成功，测试发现可以直接对API服务器进行操作管理进一步测试发现该系统直接把登录鉴权逻辑写到前端了。为开发点赞！！再来看水平越权：查看该平台相关功能后，发现有一个新加和删除API操作：抓个包看看该功能的逻辑：是通过appid来控制的测试发现更改"appId"的值 可以越权查看其他人服务器API信息　再注册一个测试账号２，新加一个api服务，记住id，使用账号１进行删除测试然后抓包，把id更改成账号二新加的api：删除成功登录账号２看看：删除成功0x03 总结        最后总结，主要通过JS分析发现敏感文件泄露（如heapdump），利用其获取云服务密钥，另外的案例通过抓包修改鉴权参数或ID实现水平和垂直越权操作。喜欢的师傅可以点赞转发支持一下谢谢！0x04 内部星球VIP介绍-V1.3（福利）        如果你想学习更多渗透挖洞技术/技巧欢迎加入我们内部星球可获得内部工具字典和享受内部资源，每周一至五周更新1day/0day漏洞，报包含网上一些付费工具BurpSuite漏洞检测插件xray企业版等，Fofa高级会员，Ctfshow各种账号会员共享。详情直接点击下方链接进入了解，需要加入的直接点击下方链接了解即可，觉得价格高的师傅可后台回复" 星球 "有优惠券名额有限先到先得！内部包含了网上需付费的0day/1day漏洞库，后续资源会更丰富在加入还是低价！（最近即将再次涨价早加入早享受！）👉点击了解加入-->>内部VIP知识星球福利介绍V1.3版本-星球介绍-HW漏洞威胁情报  
  
结尾  
  
# 免责声明  
  
  
# 获取方法  
  
  
回复“**app**  
" 获取  app渗透和app抓包教程  
  
回复“**渗透字典**" 获取 一些字典已重新划分处理**（需要内部专属字典可加入星球获取，好字典不对外公开，持续整理中！）**  
  
  
回复“**书籍**" 获取 网络安全相关经典书籍电子版pdf  
  
# 最后必看  
  
  
      
文章中的案例或工具仅面向合法授权的企业安全建设行为，如您需要测试内容的可用性，请自行搭建靶机环境，勿用于非法行为。如  
用于其他用途，由使用者承担全部法律及连带责任，与作者和本公众号无关。  
本项目所有收录的poc均为漏洞的理论判断，不存在漏洞利用过程，不会对目标发起真实攻击和漏洞利用。文中所涉及的技术、思路和工具仅供以安全为目的的学习交流使用。  
如您在使用本工具或阅读文章的过程中存在任何非法行为，您需自行承担相应后果，我们将不承担任何法律及连带责任。本工具或文章或来源于网络，若有侵权请联系作者删除，请在24小时内删除，请勿用于商业行为，自行查验是否具有后门，切勿相信软件内的广告！  
  
  
  
  
  
# 往期推荐  
  
  
**1. 内部VIP知识星球福利介绍V1.2版本-元旦优惠**  
  
**2. 最新BurpSuite2023.12.1专业版中英文版下载**  
  
[3. 最新Nessus2023下载Windows/Linux](http://mp.weixin.qq.com/s?__biz=Mzg3ODE2MjkxMQ==&mid=2247484713&idx=1&sn=0fdab59445d9e0849843077365607b18&chksm=cf16a399f8612a8f6feb8362b1d946ea15ce4ff8a4a4cf0ce2c21f433185c622136b3c5725f3&scene=21#wechat_redirect)  
  
  
[4. 最新xray1.9.11高级版下载Windows/Linux](http://mp.weixin.qq.com/s?__biz=Mzg3ODE2MjkxMQ==&mid=2247483882&idx=1&sn=e1bf597eb73ee7881ae132cc99ac0c8e&chksm=cf16a75af8612e4c73eda9f52218ccfc6de72725eb37aff59e181435de095b71e653b446c521&scene=21#wechat_redirect)  
  
  
[5. 最新HCL AppScan Standard 10.2.128273破解版下载](http://mp.weixin.qq.com/s?__biz=Mzg3ODE2MjkxMQ==&mid=2247483850&idx=1&sn=8fad4ed1e05443dce28f6ee6d89ab920&chksm=cf16a77af8612e6c688c55f7a899fe123b0f71735eb15988321d0bd4d14363690c96537bc1fb&scene=21#wechat_redirect)  
  
  
  
###### 渗透安全HackTwo  
  
  
微信号：关注公众号获取  
  
后台回复星球加入：  
知识星球  
  
扫码关注 了解更多  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/RjOvISzUFq6qFFAxdkV2tgPPqL76yNTw38UJ9vr5QJQE48ff1I4Gichw7adAcHQx8ePBPmwvouAhs4ArJFVdKkw/640?wx_fmt=png "二维码")  
  
  
  
喜欢的朋友可以点赞转发支持一下  
  
  
