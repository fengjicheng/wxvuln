#  Fortinet 无线管理器惊现严重漏洞，黑客可轻松获取管理员权限！   
原创 Hankzheng  技术修道场   2024-12-22 01:19  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/wWBwsDOJT4ibte8BWXfVoibbFkjAWRiaBxMZC2TQ2efLA25qgfKgsK9BY8KibUYMOyhEMjfOwcKzE5vIp03iaHicWm0w/640?wx_fmt=png&from=appmsg "")  
  
**Fortinet  近日披露了 Fortinet 无线管理器 (FortiWLM) 中的一个严重漏洞 (CVE-2023-34990)，该漏洞允许远程攻击者通过精心构造的 Web 请求执行未经授权的代码或命令，从而接管设备。**  
  
FortiWLM 是一款用于监控、管理和优化无线网络的集中管理工具，广泛应用于政府机构、医疗机构、教育机构和大型企业。  
  
**该漏洞是一个相对路径遍历漏洞，CVSS 评分高达 9.8。**  
 Horizon3 的研究员 Zach Hanley 于 2023 年 5 月发现并向 Fortinet 披露了该漏洞。然而，十个月后，该漏洞仍未修复，Hanley  于 2024 年 3 月 14 日决定在一篇关于他发现的其他 Fortinet 漏洞的技术文章中披露相关信息和 POC。  
  
**攻击者如何利用该漏洞？**  
  
该漏洞允许未经身份验证的攻击者利用“/ems/cgi-bin/ezrf_lighttpd.cgi”端点中输入验证不当的问题。通过在“op_type”设置为“upgradelogs”时，在“imagename”参数中使用目录遍历技术，攻击者可以从系统中读取敏感的日志文件。这些日志通常包含管理员会话 ID，攻击者可以利用这些 ID 劫持管理员会话并获得特权访问权限，从而接管设备。  
  
**Hanley 解释说：“攻击者可以构造一个请求，其中 imagename 参数包含路径遍历，从而允许攻击者读取系统上的任何日志文件。 幸运的是，对于攻击者来说，FortiWLM 拥有非常详细的日志——并记录所有经过身份验证的用户的会话 ID。滥用上述任意日志文件读取，攻击者现在可以获取用户的会话 ID 并登录，还可以滥用经过身份验证的端点。”**  
  
**受影响版本及修复情况：**  
  
该漏洞影响 FortiWLM 8.6.0 到 8.6.5 以及 8.5.0 到 8.5.4 版本。尽管研究人员发出了公开警告，但由于当时缺乏 CVE ID 和安全公告，用户并不知道风险，也无法升级到安全版本。  
  
根据 Fortinet 于 2024 年 12 月 18 日发布的安全公告，CVE-2023-34990 已在 2023 年 9 月底发布的 FortiWLM 8.6.6 和 8.5.5 版本中修复。  
  
**这意味着 CVE-2023-34990  曾是一个零日漏洞长达约四个月，FortiWLM 用户在 Hanley  的文章发表后，也就是漏洞被发现 10 个月后才首次了解到它。而 Fortinet  又花了 9 个月的时间才发布公开安全公告。**  
  
**鉴于 FortiWLM 部署在关键环境中，它可能成为攻击者的重要目标，因为远程 compromised  它可能导致全网范围的中断和敏感数据泄露。因此，强烈建议 FortiWLM 管理员在所有可用更新发布后立即应用。**  
  
