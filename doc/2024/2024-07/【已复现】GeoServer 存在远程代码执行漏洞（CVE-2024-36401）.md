#  【已复现】GeoServer 存在远程代码执行漏洞（CVE-2024-36401）   
安恒研究院  安恒信息CERT   2024-07-04 17:44  
  
![](https://mmbiz.qpic.cn/mmbiz_png/JAzzLj4nXetttZbicQFaVwfHdNzXFOUIojlribmnn4Yd7NQNLp5UaYrpstMTHia07wiapQUkyo2gHEXQ4sbf8Yt4vw/640?wx_fmt=png&from=appmsg "")  
  
<table><tbody style="box-sizing:border-box;"><tr style="box-sizing:border-box;"><td colspan="4" rowspan="1" style="border-width:1px;border-color:#4577da;border-style:solid;background-color:#4577da;box-sizing:border-box;" width="100.0000%"><section style="margin:5px 0%;box-sizing:border-box;"><section style="padding:0px 5px;font-size:14px;color:rgb(255, 255, 255);box-sizing:border-box;margin-bottom:unset;"><p style="text-align:center;"><strong style="box-sizing:border-box;">漏洞概述</strong></p></section></section></td></tr><tr style="box-sizing:border-box;"><td colspan="1" rowspan="1" style="border-width:1px;border-color:#4577da;border-style:solid;box-sizing:border-box;" width="25.0000%"><section style="margin:5px 0%;box-sizing:border-box;"><section style="padding:0px 5px;font-size:14px;box-sizing:border-box;margin-bottom:unset;"><p style="text-align:left;"><strong style="box-sizing:border-box;">漏洞名称</strong></p></section></section></td><td colspan="3" rowspan="1" style="border-width:1px;border-color:#4577da;border-style:solid;box-sizing:border-box;" width="75.0000%"><section style="margin:5px 0%;box-sizing:border-box;"><section style="padding:0px 5px;font-size:14px;box-sizing:border-box;margin-bottom:unset;"><p>GeoServer 存在远程代码执行漏洞（CVE-2024-36401）</p></section></section></td></tr><tr style="box-sizing:border-box;"><td colspan="1" rowspan="1" style="border-width:1px;border-color:#4577da;border-style:solid;box-sizing:border-box;" width="25.0000%"><section style="margin:5px 0%;box-sizing:border-box;"><section style="padding:0px 5px;font-size:14px;box-sizing:border-box;margin-bottom:unset;"><p style="text-align:left;"><strong style="box-sizing:border-box;">安恒CERT评级</strong></p></section></section></td><td colspan="1" rowspan="1" style="border-width:1px;border-color:#4577da;border-style:solid;box-sizing:border-box;" width="25.0000%"><section style="margin:5px 0%;box-sizing:border-box;"><section style="padding:0px 5px;font-size:14px;box-sizing:border-box;margin-bottom:unset;"><p style="text-align:left;word-break:break-all;">严重<br/></p></section></section></td><td colspan="1" rowspan="1" style="border-width:1px;border-color:#4577da;border-style:solid;box-sizing:border-box;" width="25.0000%"><section style="margin:5px 0%;box-sizing:border-box;"><section style="padding:0px 5px;font-size:14px;box-sizing:border-box;margin-bottom:unset;"><p style="text-align:left;"><strong style="box-sizing:border-box;">CVSS3.1评分</strong></p></section></section></td><td colspan="1" rowspan="1" style="border-width:1px;border-color:#4577da;border-style:solid;box-sizing:border-box;" width="25.0000%"><section style="margin:5px 0%;box-sizing:border-box;"><section style="padding:0px 5px;font-size:14px;box-sizing:border-box;margin-bottom:unset;"><p style="text-align:left;">9.8<br/></p></section></section></td></tr><tr style="box-sizing:border-box;"><td colspan="1" rowspan="1" style="border-width:1px;border-color:#4577da;border-style:solid;box-sizing:border-box;" width="25.0000%"><section style="margin:5px 0%;box-sizing:border-box;"><section style="padding:0px 5px;font-size:14px;box-sizing:border-box;margin-bottom:unset;"><p style="text-align:left;"><strong style="box-sizing:border-box;">CVE编号</strong></p></section></section></td><td colspan="1" rowspan="1" style="border-width:1px;border-color:#4577da;border-style:solid;box-sizing:border-box;" width="25.0000%"><section style="margin:5px 0%;box-sizing:border-box;"><section style="padding:0px 5px;font-size:14px;box-sizing:border-box;margin-bottom:unset;"><p>CVE-2024-36401</p></section></section></td><td colspan="1" rowspan="1" style="border-width:1px;border-color:#4577da;border-style:solid;box-sizing:border-box;" width="25.0000%"><section style="margin:5px 0%;box-sizing:border-box;"><section style="padding:0px 5px;font-size:14px;box-sizing:border-box;margin-bottom:unset;"><p style="text-align:left;"><strong style="box-sizing:border-box;">CNVD编号</strong></p></section></section></td><td colspan="1" rowspan="1" style="border-width:1px;border-color:#4577da;border-style:solid;box-sizing:border-box;" width="25.0000%"><section style="margin:5px 0%;box-sizing:border-box;"><section style="padding:0px 5px;font-size:14px;box-sizing:border-box;margin-bottom:unset;"><p style="text-align:left;">未分配</p></section></section></td></tr><tr style="box-sizing:border-box;"><td colspan="1" rowspan="1" style="border-width:1px;border-color:#4577da;border-style:solid;box-sizing:border-box;" width="25.0000%"><section style="margin:5px 0%;box-sizing:border-box;"><section style="padding:0px 5px;font-size:14px;box-sizing:border-box;margin-bottom:unset;"><p style="text-align:left;"><strong style="box-sizing:border-box;">CNNVD编号</strong></p></section></section></td><td colspan="1" rowspan="1" style="border-width:1px;border-color:#4577da;border-style:solid;box-sizing:border-box;" width="25.0000%"><section style="margin:5px 0%;box-sizing:border-box;"><section style="padding:0px 5px;font-size:14px;box-sizing:border-box;margin-bottom:unset;"><p>CNNVD-202407-085</p></section></section></td><td colspan="1" rowspan="1" style="border-width:1px;border-color:#4577da;border-style:solid;box-sizing:border-box;" width="25.0000%"><section style="margin:5px 0%;box-sizing:border-box;"><section style="padding:0px 5px;font-size:14px;box-sizing:border-box;margin-bottom:unset;"><p style="text-align:left;"><strong style="box-sizing:border-box;">安恒CERT编号</strong></p></section></section></td><td colspan="1" rowspan="1" style="border-width:1px;border-color:#4577da;border-style:solid;box-sizing:border-box;" width="25.0000%"><section style="margin:5px 0%;box-sizing:border-box;"><section style="padding:0px 5px;font-size:14px;box-sizing:border-box;margin-bottom:unset;"><p>DM-202405-004663</p></section></section></td></tr><tr style="box-sizing:border-box;"><td colspan="1" rowspan="1" style="border-width:1px;border-color:#4577da;border-style:solid;box-sizing:border-box;" width="25.0000%"><section style="margin:5px 0%;box-sizing:border-box;"><section style="padding:0px 5px;font-size:14px;box-sizing:border-box;margin-bottom:unset;"><p style="text-align:left;"><strong style="box-sizing:border-box;">POC情况</strong></p></section></section></td><td colspan="1" rowspan="1" style="border-width:1px;border-color:#4577da;border-style:solid;box-sizing:border-box;" width="25.0000%"><section style="margin:5px 0%;box-sizing:border-box;"><section style="padding:0px 5px;font-size:14px;box-sizing:border-box;margin-bottom:unset;"><p style="text-align:left;">已发现</p></section></section></td><td colspan="1" rowspan="1" style="border-width:1px;border-color:#4577da;border-style:solid;box-sizing:border-box;" width="25.0000%"><section style="margin:5px 0%;box-sizing:border-box;"><section style="padding:0px 5px;font-size:14px;box-sizing:border-box;margin-bottom:unset;"><p style="text-align:left;"><strong style="box-sizing:border-box;">EXP情况</strong></p></section></section></td><td colspan="1" rowspan="1" style="border-width:1px;border-color:#4577da;border-style:solid;box-sizing:border-box;" width="25.0000%"><section style="margin:5px 0%;box-sizing:border-box;"><section style="padding:0px 5px;font-size:14px;box-sizing:border-box;margin-bottom:unset;"><p>已发现</p></section></section></td></tr><tr style="box-sizing:border-box;"><td colspan="1" rowspan="1" style="border-width:1px;border-color:#4577da;border-style:solid;box-sizing:border-box;" width="25.0000%"><section style="margin:5px 0%;box-sizing:border-box;"><section style="padding:0px 5px;font-size:14px;box-sizing:border-box;margin-bottom:unset;"><p style="text-align:left;"><strong style="box-sizing:border-box;">在野利用</strong></p></section></section></td><td colspan="1" rowspan="1" style="border-width:1px;border-color:#4577da;border-style:solid;box-sizing:border-box;" width="25.0000%"><section style="margin:5px 0%;box-sizing:border-box;"><section style="padding:0px 5px;font-size:14px;box-sizing:border-box;margin-bottom:unset;"><p style="text-align:left;">未发现</p></section></section></td><td colspan="1" rowspan="1" style="border-width:1px;border-color:#4577da;border-style:solid;box-sizing:border-box;" width="25.0000%"><section style="margin:5px 0%;box-sizing:border-box;"><section style="padding:0px 5px;font-size:14px;box-sizing:border-box;margin-bottom:unset;"><p style="text-align:left;"><strong style="box-sizing:border-box;">研究情况</strong></p></section></section></td><td colspan="1" rowspan="1" style="border-width:1px;border-color:#4577da;border-style:solid;box-sizing:border-box;" width="25.0000%"><section style="margin:5px 0%;box-sizing:border-box;"><section style="padding:0px 5px;font-size:14px;box-sizing:border-box;margin-bottom:unset;"><p style="text-align:left;">已复现<br/></p></section></section></td></tr><tr style="box-sizing:border-box;"><td colspan="1" rowspan="1" style="border-width:1px;border-color:#4577da;border-style:solid;box-sizing:border-box;" width="25.0000%"><section style="margin:5px 0%;box-sizing:border-box;"><section style="padding:0px 5px;font-size:14px;box-sizing:border-box;margin-bottom:unset;"><p style="text-align:left;"><strong style="box-sizing:border-box;">危害描述</strong></p></section></section></td><td colspan="3" rowspan="1" style="border-width:1px;border-color:#4577da;border-style:solid;box-sizing:border-box;" width="75.0000%"><section style="margin:5px 0%;box-sizing:border-box;"><section style="padding:0px 5px;font-size:14px;box-sizing:border-box;margin-bottom:unset;"><p>由于不安全地将属性名称评估为 XPath 表达式，多个 OGC 请求参数允许未经身份验证的用户通过针对默认 GeoServer 安装的特制输入执行任意代码。</p></section></section></td></tr></tbody></table>  
  
安恒研究院卫兵实验室已复现此漏洞。  
  
该产品主要使用客户行业分布广泛，漏洞危害性高，建议客户尽快做好自查及防护。  
  
![](https://mmbiz.qpic.cn/mmbiz_png/JAzzLj4nXeuIe4BbCKVI9EyMu8Udol2q3zgSAuBIlYCzCbPbT2IpBfuBuktjibHrLF82QcFicmSibeFd4D3RTtT8g/640?wx_fmt=png&from=appmsg "")  
  
GeoServer 远程代码执行漏洞（CVE-2024-36401）复现截图  
  
  
  
**漏洞信息**  
  
  
  
  
  
**产品描述**  
  
GeoServer 是一个开源的服务器端软件，用于共享和编辑地理空间数据。它允许用户将地理数据（如矢量数据、栅格数据）发布为标准的 Web 服务。  
  
**应急响应等级：**  
1级  
  
**漏洞类型：**远程代码执行  
  
  
**影响范围**  
  
影响版本：  
  
GeoServer < 2.23.6  
  
2.24.0 <= GeoServer < 2.24.4  
  
2.25.0 <= GeoServer < 2.25.2  
  
安全版本：  
  
GeoServer 2.23.* >= 2.23.6  
  
GeoServer 2.24.* >= 2.24.4  
  
GeoServer 2.25.* >= 2.25.2  
  
  
**CVSS向量**  
  
访问途径（AV）：网络  
  
攻击复杂度（AC）：低  
  
所需权限（PR）：无需任何权限  
  
用户交互（UI）：不需要用户交互  
  
影响范围 （S）：不变  
  
机密性影响 （C）：高  
  
完整性影响 （l）：高  
  
可用性影响 （A）：高  
  
  
  
**修复方案**  
  
  
  
  
**官方修复方案：**  
  
官方已发布新版本修复漏洞，受影响的用户建议更新至安全版本。  
  
下载链接：  
  
```
https://github.com/geoserver/geoserver/releases
```  
  
  
  
**临时缓解方案:**  
  
```
删除 gt-complex-x.y.jar 文件，其中x.y是GeoTools版本。这将从GeoServer中删除易受攻击的代码，但可能会破坏某些GeoServer功能，如果您正在使用的扩展需要gt-complex模块，则GeoServer无法部署。

geoserver.war 部署的缓解措施：

1.停止应用程序服务器

2.解压geoserver.war 添加到目录

3.找到文件 WEB-INF/lib/gt-complex-x.y.jar 并删除

4.将目录压缩到新的 geoserver.war

5.重新启动应用程序服务器

GeoServer二进制文件的缓解措施：

1.停止Jetty

2.找到文件 webapps/geoserver/WEB-INF/lib/gt-complex-x.y.jar 并删除

3.重新启动 Jetty
```  
  
  
  
  
**产品能力覆盖**  
  
  
  
  
<table><tbody style="box-sizing:border-box;"><tr style="box-sizing:border-box;"><td colspan="1" rowspan="1" style="border-width:1px;border-color:#4577da;border-style:solid;background-color:#4577da;box-sizing:border-box;" width="33.0000%"><section style="margin:5px 0%;box-sizing:border-box;"><section style="text-align:left;padding:0px 5px;font-size:14px;color:rgb(255, 255, 255);box-sizing:border-box;margin-bottom:unset;"><p><strong style="box-sizing:border-box;">产品名称</strong></p></section></section></td><td colspan="1" rowspan="1" style="border-width:1px;border-color:#4577da;border-style:solid;background-color:#4577da;box-sizing:border-box;" width="67.0000%"><section style="margin:5px 0%;box-sizing:border-box;"><section style="text-align:left;padding:0px 5px;font-size:14px;color:rgb(255, 255, 255);box-sizing:border-box;margin-bottom:unset;"><p><strong style="box-sizing:border-box;">覆盖补丁包</strong></p></section></section></td></tr><tr style="box-sizing:border-box;"><td colspan="1" rowspan="1" style="border-width:1px;border-color:#4577da;border-style:solid;box-sizing:border-box;" width="33.0000%"><section style="margin:5px 0%;box-sizing:border-box;"><section style="text-align:left;padding:0px 5px;font-size:14px;box-sizing:border-box;margin-bottom:unset;"><p>AiLPHA大数据平台</p></section></section></td><td colspan="1" rowspan="1" style="border-width:1px;border-color:#4577da;border-style:solid;box-sizing:border-box;" width="67.0000%"><section style="margin:5px 0%;box-sizing:border-box;"><section style="text-align:left;padding:0px 5px;font-size:14px;box-sizing:border-box;margin-bottom:unset;"><p>GoldenEyeIPv6_XXXXX_strategy2.0.XXXXX.240703.1及以上版本</p></section></section></td></tr><tr><td width="33.0000%" style="border-width:1px;border-color:#4577da;border-right-style:solid;border-bottom-style:solid;box-sizing:border-box;"><section style="margin:5px 0%;box-sizing:border-box;"><section style="text-align:left;padding:0px 5px;font-size:14px;box-sizing:border-box;margin-bottom:unset;"><p>APT攻击预警平台</p></section></section></td><td width="67.0000%" style="border-width:1px;border-color:#4577da;border-right-style:solid;border-bottom-style:solid;box-sizing:border-box;"><section style="margin:5px 0%;box-sizing:border-box;"><section style="text-align:left;padding:0px 5px;font-size:14px;box-sizing:border-box;margin-bottom:unset;"><p>GoldenEyeIPv6_XXXXX_strategy2.0.XXXXX.240703.1及以上版本</p></section></section></td></tr><tr><td width="33.0000%" style="border-width:1px;border-color:#4577da;border-right-style:solid;border-bottom-style:solid;box-sizing:border-box;"><section style="margin:5px 0%;box-sizing:border-box;"><section style="text-align:left;padding:0px 5px;font-size:14px;box-sizing:border-box;margin-bottom:unset;"><p>WAF</p></section></section></td><td width="67.0000%" style="border-width:1px;border-color:#4577da;border-right-style:solid;border-bottom-style:solid;box-sizing:border-box;"><section style="margin:5px 0%;box-sizing:border-box;"><section style="text-align:left;padding:0px 5px;font-size:14px;box-sizing:border-box;margin-bottom:unset;"><p>已支持</p></section></section></td></tr><tr style="box-sizing:border-box;"><td colspan="1" rowspan="1" style="border-width:1px;border-color:#4577da;border-style:solid;box-sizing:border-box;" width="33.0000%"><section style="margin:5px 0%;box-sizing:border-box;"><section style="text-align:left;padding:0px 5px;font-size:14px;box-sizing:border-box;margin-bottom:unset;"><p>玄武盾</p></section></section></td><td colspan="1" rowspan="1" style="border-width:1px;border-color:#4577da;border-style:solid;box-sizing:border-box;" width="67.0000%"><section style="margin:5px 0%;box-sizing:border-box;"><section style="text-align:left;padding:0px 5px;font-size:14px;box-sizing:border-box;margin-bottom:unset;"><p>已支持</p></section></section></td></tr></tbody></table>  
  
  
  
**参考资料**  
  
  
  
  
```
https://github.com/advisories/GHSA-6jj6-gm7p-fcvv
https://nvd.nist.gov/vuln/detail/CVE-2024-36401
```  
  
  
  
  
**技术支持**  
  
  
  
  
如有漏洞相关需求支持请联系400-6059-110获取相关能力支撑。  
  
