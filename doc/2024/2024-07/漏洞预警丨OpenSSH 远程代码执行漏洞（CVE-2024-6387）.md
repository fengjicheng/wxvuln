#  漏洞预警丨OpenSSH 远程代码执行漏洞（CVE-2024-6387）   
原创 烽火台实验室  Beacon Tower Lab   2024-07-02 11:57  
  
**漏洞概述**  
  
  
<table><tbody><tr opera-tn-ra-comp="_$.pages:0.layers:0.comps:2.classicTable1:0"><td colspan="1" rowspan="1" opera-tn-ra-cell="_$.pages:0.layers:0.comps:2.classicTable1:0.td@@0" style="border-color: rgb(62, 62, 62);padding: 0px;" width="25.0000%"><section style="margin: 5px 0%;"><section style="padding-right: 5px;padding-left: 5px;font-size: 14px;"><p style="text-align: left;text-wrap: wrap;"><strong>漏洞类型</strong></p></section></section></td><td colspan="1" rowspan="1" opera-tn-ra-cell="_$.pages:0.layers:0.comps:2.classicTable1:0.td@@1" style="border-color: rgb(62, 62, 62);padding: 0px;" width="75.0000%"><section style="margin: 5px 0%;"><section style="text-align: center;padding-right: 5px;padding-left: 5px;font-size: 14px;"><p style="text-align: left;">远程代码执行</p></section></section></td></tr><tr opera-tn-ra-comp="_$.pages:0.layers:0.comps:2.classicTable1:1"><td colspan="1" rowspan="1" opera-tn-ra-cell="_$.pages:0.layers:0.comps:2.classicTable1:1.td@@0" style="border-color: rgb(62, 62, 62);padding: 0px;" width="25.0000%"><section style="margin: 5px 0%;"><section style="padding-right: 5px;padding-left: 5px;font-size: 14px;"><p style="text-align: left;text-wrap: wrap;"><strong>漏洞等级</strong></p></section></section></td><td colspan="1" rowspan="1" opera-tn-ra-cell="_$.pages:0.layers:0.comps:2.classicTable1:1.td@@1" style="border-color: rgb(62, 62, 62);padding: 0px;" width="75.0000%"><section style="margin: 5px 0%;"><section style="text-align: left;padding-right: 5px;padding-left: 5px;font-size: 14px;"><p>高</p></section></section></td></tr><tr opera-tn-ra-comp="_$.pages:0.layers:0.comps:2.classicTable1:2"><td colspan="1" rowspan="1" opera-tn-ra-cell="_$.pages:0.layers:0.comps:2.classicTable1:2.td@@0" style="border-color: rgb(62, 62, 62);padding: 0px;" width="25.0000%"><section style="margin: 5px 0%;"><section style="padding-right: 5px;padding-left: 5px;font-size: 14px;"><p style="text-align: left;text-wrap: wrap;"><strong>漏洞编号</strong></p></section></section></td><td colspan="1" rowspan="1" opera-tn-ra-cell="_$.pages:0.layers:0.comps:2.classicTable1:2.td@@1" style="border-color: rgb(62, 62, 62);padding: 0px;" width="75.0000%"><section style="margin: 5px 0%;"><section style="text-align: center;padding-right: 5px;padding-left: 5px;font-size: 14px;"><p style="text-align: left;">CVE-2024-6387</p></section></section></td></tr><tr opera-tn-ra-comp="_$.pages:0.layers:0.comps:2.classicTable1:3"><td colspan="1" rowspan="1" opera-tn-ra-cell="_$.pages:0.layers:0.comps:2.classicTable1:3.td@@0" style="border-color: rgb(62, 62, 62);padding: 0px;" width="25.0000%"><section style="margin: 5px 0%;"><section style="padding-right: 5px;padding-left: 5px;font-size: 14px;"><p style="text-align: left;text-wrap: wrap;"><strong>漏洞评分</strong></p></section></section></td><td colspan="1" rowspan="1" opera-tn-ra-cell="_$.pages:0.layers:0.comps:2.classicTable1:3.td@@1" style="border-color: rgb(62, 62, 62);padding: 0px;" width="75.0000%"><section style="margin: 5px 0%;"><section style="text-align: center;padding-right: 5px;padding-left: 5px;font-size: 14px;"><p style="text-align: left;">8.1</p></section></section></td></tr><tr opera-tn-ra-comp="_$.pages:0.layers:0.comps:2.classicTable1:4"><td colspan="1" rowspan="1" opera-tn-ra-cell="_$.pages:0.layers:0.comps:2.classicTable1:4.td@@0" style="border-color: rgb(62, 62, 62);padding: 0px;" width="25.0000%"><section style="margin: 5px 0%;"><section style="padding-right: 5px;padding-left: 5px;font-size: 14px;"><p style="text-align: left;text-wrap: wrap;"><strong>利用复杂度</strong></p></section></section></td><td colspan="1" rowspan="1" opera-tn-ra-cell="_$.pages:0.layers:0.comps:2.classicTable1:4.td@@1" style="border-color: rgb(62, 62, 62);padding: 0px;" width="75.0000%"><section style="margin: 5px 0%;"><section style="text-align: center;padding-right: 5px;padding-left: 5px;font-size: 14px;"><p style="text-align: left;">高</p></section></section></td></tr><tr opera-tn-ra-comp="_$.pages:0.layers:0.comps:2.classicTable1:5"><td colspan="1" rowspan="1" opera-tn-ra-cell="_$.pages:0.layers:0.comps:2.classicTable1:5.td@@0" style="border-color: rgb(62, 62, 62);padding: 0px;" width="25.0000%"><section style="margin: 5px 0%;"><section style="padding-right: 5px;padding-left: 5px;font-size: 14px;"><p style="text-align: left;text-wrap: wrap;"><strong>影响版本</strong></p></section></section></td><td colspan="1" rowspan="1" opera-tn-ra-cell="_$.pages:0.layers:0.comps:2.classicTable1:5.td@@1" style="border-color: rgb(62, 62, 62);padding: 0px;" width="75.0000%"><section style="margin: 5px 0%;"><section style="text-align: center;padding-right: 5px;padding-left: 5px;font-size: 14px;"><p style="text-align: left;">OpenSSH &lt; 4.4p1 且未安装CVE-2006-5051/CVE-2008-4109补丁</p><p style="text-align: left;">8.5p1 &lt;= OpenSSH &lt; 9.8p1</p></section></section></td></tr><tr opera-tn-ra-comp="_$.pages:0.layers:0.comps:2.classicTable1:6"><td colspan="1" rowspan="1" opera-tn-ra-cell="_$.pages:0.layers:0.comps:2.classicTable1:6.td@@0" style="border-color: rgb(62, 62, 62);padding: 0px;" width="25.0000%"><section style="margin: 5px 0%;"><section style="padding-right: 5px;padding-left: 5px;font-size: 14px;"><p style="text-align: left;text-wrap: wrap;"><strong>利用方式</strong></p></section></section></td><td colspan="1" rowspan="1" opera-tn-ra-cell="_$.pages:0.layers:0.comps:2.classicTable1:6.td@@1" style="border-color: rgb(62, 62, 62);padding: 0px;" width="75.0000%"><section style="margin: 5px 0%;"><section style="text-align: center;padding-right: 5px;padding-left: 5px;font-size: 14px;"><p style="text-align: left;">远程</p></section></section></td></tr><tr opera-tn-ra-comp="_$.pages:0.layers:0.comps:2.classicTable1:7"><td colspan="1" rowspan="1" opera-tn-ra-cell="_$.pages:0.layers:0.comps:2.classicTable1:7.td@@0" style="border-color: rgb(62, 62, 62);padding: 0px;" width="25.0000%"><section style="margin: 5px 0%;"><section style="padding-right: 5px;padding-left: 5px;font-size: 14px;"><p style="text-align: left;text-wrap: wrap;"><strong>POC/EXP</strong></p></section></section></td><td colspan="1" rowspan="1" opera-tn-ra-cell="_$.pages:0.layers:0.comps:2.classicTable1:7.td@@1" style="border-color: rgb(62, 62, 62);padding: 0px;" width="75.0000%"><section style="margin: 5px 0%;"><section style="text-align: center;padding-right: 5px;padding-left: 5px;font-size: 14px;"><p style="text-align: left;">已公开</p></section></section></td></tr></tbody></table>  
  
  
OpenSSH是一个开源实现的SSH协议，用于加密网络通信。OpenSSH提供了一个安全的通道来访问远程计算机或服务器，并包含了一组客户端和服务器工具，以提供包括远程登录、远程执行命令、文件传输等功能。  
  
  
CVE-2024-6387影响使用glibc的Linux系统，该漏洞被称为”RegreSSHion”。这个漏洞允许未经身份验证的用户在默认配置的情况下，通过LoginGraceTime参数进行远程代码执行，从而以root权限控制受影响的系统。  
  
  
这个漏洞一旦被利用，可能会导致系统全面崩溃，攻击者可以使用最高权限执行任意代码，从而导致系统全面接管、安装恶意软件、篡改数据和创建后门进行持久访问。它可能会促进网络传播，使攻击者可以利用被入侵的系统作为立足点，穿越并利用组织内其他易受攻击的系统。  
  
  
  
**漏洞详情**  
  
  
目前该漏洞利用详情已公开，DayDayPoc平台收录了该漏洞poc，访问如下链接可查看漏洞poc  
  
https://www.ddpoc.com/DVB-2024-7376.html  
  
![](https://mmbiz.qpic.cn/mmbiz_png/8E5sfrfkeAPaveTP6eeLauLYp5GJdEl7fR8xaA25CcWB8M4UibYbibLrcl71Rb7kNu8QEaibrk7ZcJkmeOkw4X6Hg/640?wx_fmt=png&from=appmsg "")  
  
  
  
**漏洞影响范围**  
  
  
根据DayDayMap(www.daydaymap.com)全球网络空间资产测绘平台的数据显示，全球有上亿条资产可能遭受该漏洞的影响。国内风险资产主要分布在香港和北京。  
  
DayDayMap查询语法：  
  
protocol.service="ssh"  
  
![](https://mmbiz.qpic.cn/mmbiz_png/8E5sfrfkeAPaveTP6eeLauLYp5GJdEl7ibzT4fB11IszQqcOq3eCKwMULWC0ia0Qf5AwmKoQjicDrNxuam35JQumw/640?wx_fmt=png&from=appmsg "")  
  
![](https://mmbiz.qpic.cn/mmbiz_png/8E5sfrfkeAPaveTP6eeLauLYp5GJdEl7yeYhiaKGicvBor5pMAZNlE7Yc9ibYtjgM4HqSE6bt4Ek1j9vzXRVyQbOA/640?wx_fmt=png&from=appmsg "")  
  
  
  
**解决方案**  
  
  
目前官方已有可更新版本，建议受影响用户升级至最新版本：OpenSSH > 9.8p1  
  
  
官方补丁下载地址：  
  
https://www.openssh.com/releasenotes.html  
  
Ubuntu 的软件源已更新：   
  
https://ubuntu.com/security/notices/USN-6859-1Debian 11 12已更新：  
  
https://security-tracker.debian.org/tracker/CVE-2024-6387  
  
  
  
**参考链接**  
  
```
https://www.qualys.com/2024/07/01/cve-2024-6387/regresshion.txt
https://ubuntu.com/security/CVE-2024-6387
https://www.openssh.com/txt/release-9.8
```  
  
  
  
  
