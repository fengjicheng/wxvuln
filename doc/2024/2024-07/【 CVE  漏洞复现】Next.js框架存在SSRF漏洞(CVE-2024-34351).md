#  【 CVE | 漏洞复现】Next.js框架存在SSRF漏洞(CVE-2024-34351)   
小明同学  小明信安   2024-07-20 12:49  
  
**0x01 免责声明**  
  
disclaimer  
  
请勿利用文章内的相关技术从事非法测试，由于传播、利用此文所提供的信息而造成的任何直接或者间接的后果及损失，均由使用者本人负责，作者不为此承担任何责任。信息及工具收集于互联网，真实性及安全性自测，如有侵权请联系删除。本次测试仅供学习使用，如若非法他用，与平台和本文作者无关，需自行负责！！！  
  
**0x02 漏洞介绍**  
  
Vulnerability introduction  
  
      
  
Next.js 框架是一个用于 生产环境的 React 框架，Next.js 为您提供生产环境所需的所有功能以及最佳的开发体验：包括静态及服务器端融合渲染、 支持 TypeScript、智能化打包、 路由预取等功能 无需任何配置。   
  
    Next.js 框架存在SSRF漏洞，攻击者可以通过漏洞构造对内部 URL 的请求来利用此漏洞，从而可能获得对敏感信息的未经授权的访问。  
  
**0x03 搜索语法**  
  
Search for syntax  
  
- Fofa：  
  
  
```
body="/_next/static"
```  
  
- Hunter：  
  
  
```
body="/_next/static"
```  
  
- Quake：  
  
  
```
body="/_next/static"
```  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/WfB6o4vicwSITulzZrH77dNcibL5X0D6Lwn8icIiaGBEmJiawSlTyiaiavtonq7gBbQd2lhW6HicO0f4sjZclw1WRgwcLg/640?wx_fmt=png&from=appmsg "")  
  
**0x04 漏洞复现**  
  
Request packets  
  
- 请求DNSLog地址记录  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/WfB6o4vicwSITulzZrH77dNcibL5X0D6LwXqweX4L0ltB9EBANhcN81YnicmnGg5XSbET3gV9yOftoaIN1a9Cn9Ig/640?wx_fmt=png&from=appmsg "")  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/WfB6o4vicwSITulzZrH77dNcibL5X0D6LwoOiabn5fTOGeSV2y5TYRVq2ibZEWy8rgqCfPrRDiajBWTYE5MMC1RFJicQ/640?wx_fmt=png&from=appmsg "")  
  
  
  
  
**0x05 nuclei POC**  
  
nuclei POC  
  
- Nuclei批量漏洞检测POC脚本已发布知识星球：  
**小明信安POC库**  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/WfB6o4vicwSITulzZrH77dNcibL5X0D6LwsJQV72M0gZ7ibcxNWicqvbHa4ME3rmskMDR9D3lq9OHFRBnzzeib0vpWQ/640?wx_fmt=png&from=appmsg "")  
  
  
**0x06 修复建议**  
  
Remediation recommendations  
  
- 在Web应用防火墙中添加接口临时黑名单规则  
  
- 联系厂商打补丁或升级版本。  
  
  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/WfB6o4vicwSKPg3iaOJwc8bpPHXxAI4Asyv1AiaL5MrLSodbBtGObiccGu5Vp3E0O5hg6ibaquk6IbfPlwXjJ7A5vBg/640?wx_fmt=other&from=appmsg&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1 "")  
  
  
**欢迎加入星球一起交流，券后价仅39元！！！**  
  
**长期每天更新，更多的0day/1day漏洞POC/EXP**  
  
