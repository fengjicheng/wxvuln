#  【知道创宇404实验室】建议关注Glibc-based Linux OpenSSH 最新RCE漏洞(CVE-2024-6387)   
404实验室  知道创宇   2024-07-01 20:28  
  
![](https://mmbiz.qpic.cn/mmbiz_png/Oan15mBs7fMmcianApXU1yKru07OicNRqboCeLK6ic224rwcThIanaZZiauPv94bYOicVS7rIBiaQKrw4VjJVvibUfkEA/640?wx_fmt=png&from=appmsg "")  
  
2024年7月1日，国外安全研究机构发布了最新的一个关于“regreSSHion: RCE in OpenSSH's server, on glibc-based Linux systems(CVE-2024-6387)” 的漏洞公告。  
该公告称漏洞（CVE-2024-6387）是Qualys研究团队在对OpenSSH进行常规安全审查时发现的。  
  
他们注意到，在OpenSSH 8.5p1版本引入的一次代码变更中，恢复了一个旧的漏洞（CVE-2006-5051）。研究人员通过静态代码分析和实际测试，确定该漏洞可以在特定条件下被利用，实现远程代码执行。他们详细审查了信号处理器的竞态条件，确认了漏洞的存在，并向OpenSSH团队报告了这一问题。  
  
尽管通过Qualys测试这个漏洞利用的效果看起来非常麻烦：在本地虚拟机环境“平均需要尝试约10,000次才能成功，约需3-4小时，而由于ASLR，每次实验成功率只有一半，因此平均需要6-8小时才能获得远程root shell”。但是我们认为对于OpenSSH的使用非常广泛，并且有大量的核心主机仅暴露了SSH服务，那么这个漏洞很可能成为攻击者攻击目标的突破口。对于攻击者来说即使成功率再低、时间再长，可能都是值得一试的。所以在这里我们提醒所有相关用户关注这个漏洞信息，及时升级OpenSSH，如果无法更新或重新编译sshd，可以通过在配置文件中将LoginGraceTime设置为0来修复这个信号处理器竞态条件漏洞。  
  
**参考资料：**  
  
[1]https://www.qualys.com/2024/07/01/cve-2024-6387/regresshion.txt  
  
[2] https://www.openssh.com/security.html  
  
