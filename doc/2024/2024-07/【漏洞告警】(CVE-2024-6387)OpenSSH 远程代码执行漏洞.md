#  【漏洞告警】(CVE-2024-6387)OpenSSH 远程代码执行漏洞   
YGnight  night安全   2024-07-01 23:05  
  
公众号新规  
只对常读  
和  
星标的公众号才能展示大图推送，  
建议大家把公众号“  
n  
i  
g  
h  
t  
安  
全”设为  
星  
标，  
否  
则  
可  
能  
就  
看  
不  
到  
啦  
！  
  
![](https://mmbiz.qpic.cn/mmbiz_png/SaibaRNhOjqhia1cXxs2MiaTdgf2bBwXka6sHg0pvRw6MpQSvVF3CeJ83RS0Ys1YBXC1vM6icvsxKialdwur2lAFAsQ/640?wx_fmt=png&from=appmsg "")  
  
![](https://mmbiz.qpic.cn/mmbiz_jpg/SaibaRNhOjqhia1cXxs2MiaTdgf2bBwXka6kXG7JA6Rbic2FFaqy9dPWrQlwfRNCPfyicibm6Evv39Z6VttiagBARRQgw/640?wx_fmt=jpeg&from=appmsg "")  
  
  
免责声明  
  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/SaibaRNhOjqg4CicjYhkyn7j8xeutLIIGlA3Pam1Oxz5ujOUsmPibr5J9NCiagtp8nGEEXPeJiaUeWkN3v1XXSS9Vfw/640?wx_fmt=gif "")  
  
  
  
night安全致力于分享技术学习和工具掌握。然而请注意不得将此用于任何未经授权的非法行为，请您严格遵守国家信息安全法律法规。任何违反法律、法规的行为，均与本人无关。如有侵权烦请告知，我们会立即删除并致歉。谢谢！  
  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/oMlX8Lll9JhtrlOVpAFwbbnTXyrqweQO0kKLSPTRtSL4MEXjM3TdHU1GMhb3ysoFV3ic9hKDLibzic6T7ADMnfNnA/640?wx_fmt=gif "")  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWgmBny4eMeJJOramdTQiciaDu5LeMykBibiaorwCvYEX2sxq5lVYw4iaddx0qYlbQ6fAyXd22dcFOiads8w/640?wx_fmt=gif "")  
  
漏洞描述  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWgmBny4eMeJJOramdTQiciaDuYRDXO8rZ2DX4p68v8aWfzp0XSlDyFJvENtj4DwOjoB5CaZVMPnfFYQ/640?wx_fmt=gif "")  
  
  
![](https://mmbiz.qpic.cn/mmbiz_png/SaibaRNhOjqhYErnypGG8icibiagia3YvqBRDAcDMQ1O7iaZTaRadCaRVkrz1XKicgodtWn0Y7hQvmJrz0smUBG5HpBqA/640?wx_fmt=png&from=appmsg "")  
  
    在OpenSSH的服务器（sshd）中发现了一个信号处理程序竞争条件，其中客户端没有在LoginGraceTime秒（默认为120秒，旧版OpenSSH为600秒）内进行身份验证，然后sshd的SIGALRM处理程序被异步调用。但是，这个信号处理程序调用了各种不安全的函数，例如syslog（）。  
  
    未经身份验证的攻击者可以利用此漏洞在Linux系统上以root身份执行任意代码。  
  
    该漏洞的根源在于OpenSSH服务器的SIGALRM信号处理程序中的异步信号不安全函数调用。攻击者通过精确的时间控制和多次尝试，触发了竞态条件，从而在系统中执行了恶意代码。  
  
     在某些特定版本的 32 位操作系统上，攻击者最短需 6-8 小时即可获得最高权限的 root shell。而在 64 位机器上，目前没有在可接受时间内的利用方案。  
  
  
网传POC已公开（安全性未查证）  
  
![](https://mmbiz.qpic.cn/mmbiz_png/SaibaRNhOjqhYErnypGG8icibiagia3YvqBRDriaxn6GhoG1b4PNxQjzrwvx7OSSibvt1IbibjGYic8TXNqibTZDjziaPI6Kg/640?wx_fmt=png&from=appmsg "")  
  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWgmBny4eMeJJOramdTQiciaDu5LeMykBibiaorwCvYEX2sxq5lVYw4iaddx0qYlbQ6fAyXd22dcFOiads8w/640?wx_fmt=gif "")  
  
影响版本  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWgmBny4eMeJJOramdTQiciaDuYRDXO8rZ2DX4p68v8aWfzp0XSlDyFJvENtj4DwOjoB5CaZVMPnfFYQ/640?wx_fmt=gif "")  
  
  
  
8.5p1 <= OpenSSH < 9.8p1  
![](https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWgmBny4eMeJJOramdTQiciaDu5LeMykBibiaorwCvYEX2sxq5lVYw4iaddx0qYlbQ6fAyXd22dcFOiads8w/640?wx_fmt=gif "")  
  
修复建议  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWgmBny4eMeJJOramdTQiciaDuYRDXO8rZ2DX4p68v8aWfzp0XSlDyFJvENtj4DwOjoB5CaZVMPnfFYQ/640?wx_fmt=gif "")  
  
  
  
官方已推送更新版本，受影响用户可以升级至最新版本：  
  
OpenSSH > 9.8p1  
  
官方补丁下载地址：  
  
https://www.openssh.com/releasenotes.html  
  
  
临时修复方案：  
  
1. 可以在配置文件中将 LoginGraceTime 设置为 0（永不超时）。这样虽然会使 sshd 暴露于拒绝服务攻击（占满所有 Startups 连接），但可以避免远程代码执行风险。  
  
2. 启用 fail2ban 等防护机制，封禁发生过多次失败登录 ssh 尝试的来源 IP。  
  
  
参考资料：https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-6387https://mp.weixin.qq.com/s/OckdXKdvRxBNhXC3Y1ZH_w  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/oMlX8Lll9JhtrlOVpAFwbbnTXyrqweQO0kKLSPTRtSL4MEXjM3TdHU1GMhb3ysoFV3ic9hKDLibzic6T7ADMnfNnA/640?wx_fmt=gif "")  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/SaibaRNhOjqhXmCUxdZR0bITTD3G86qXKpciaqHNr4Y60SPF1XeS358wiceQDUm8K5zh7RZsnknYxKJ37kkkcpWZg/640?wx_fmt=gif "")  
  
![](https://mmbiz.qpic.cn/mmbiz_png/SaibaRNhOjqhia1cXxs2MiaTdgf2bBwXka6DCLEF53OGJWH7A9YU8LA95g10yEzvZgFYhwhV3OQX3qdtk7vIsWncw/640?wx_fmt=png&from=appmsg "")  
  
****  
扫  
码  
关  
注  
  
获  
得  
更  
多  
资  
讯  
  
****  
  
