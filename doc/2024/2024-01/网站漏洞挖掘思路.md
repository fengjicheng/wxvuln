#  网站漏洞挖掘思路   
点击关注→_→  黑客白帽子   2024-01-08 06:00  
  
![](https://mmbiz.qpic.cn/mmbiz_png/PJG3jJlPv0w6V8YUTyNSuV2udfyY3rWyR6V1UeHWuiab6T80I5ldZicZswCnrbicD4ibpaDMqCZ6UvFmhWLyTzptSA/640?wx_fmt=png&random=0.6636094571400317&random=0.6219011309810436&random=0.21191420540585404 "")  
  
**感谢师傅 · 关注我们**  
  
![](https://mmbiz.qpic.cn/mmbiz_png/PJG3jJlPv0w6V8YUTyNSuV2udfyY3rWyR6V1UeHWuiab6T80I5ldZicZswCnrbicD4ibpaDMqCZ6UvFmhWLyTzptSA/640?wx_fmt=png&random=0.9829534454876507&random=0.2787622380037358&random=0.29583791053286834 "")  
  
  
由于，微信公众号推送机制改变，现在需要设置为星标才能收到推送消息。大家就动动发财小手设置一下呗！啾咪~~~  
  
![](https://mmbiz.qpic.cn/mmbiz_png/PJG3jJlPv0y50hQk1TiaBIAnSjzqkmZcPS4TWvohHfHPTVUBWM2mFxcqwhiaZKaQM6S7t11fuiajZ2zZqXD5hJJmA/640?wx_fmt=png "")  
  
  
本篇主要分享网站各漏洞思路，希望你看完有所收获。  
  
  
**一」登录框常见漏洞**  
  
  
**常规漏洞**  
  
  
  
**sql注入、万能密码**  
  
  
我们在用户名中输入 ‘or 1=1#，密码随意。  
  
  
就变成了：  
  
select name.passwd from users where username= ‘’ or 1=1#’ and password=???。  
  
  
在SQL语法中 # 是注释符，所以后面的语句都会杯注释掉，那么上面的语句就等价于select name.passwd from users where username=’’ or 1=1。  
  
  
在or 连接中， username=’’ 和 1=1 中有一个为真就为真。所以1=1肯定为真。  
  
  
如果存在sql注入的漏洞，则可以直接登录进去。  
  
  
**url重定向**  
  
  
网站接受用户输入的链接，跳转到一个攻击者控制的网站，可能导致跳转过去的用户被黑客设置的钓鱼页面骗走自己的个人信息和登录口令。  
  
  
**未授权访问**  
  
  
未授权访问漏洞，是在攻击者没有获取到登录权限或未授权的情况下，不需要输入密码，即可通过输入网站控制台主页面地址或者不允许查看的连接便可进行访问，同时进行操作。  
  
  
**修改返回包**  
  
  
由于对登录的账号及口令校验存在逻辑缺陷，以再次使用服务器端返回的相关参数作为最终登录凭证，导致可绕过登录限制，如服务器返回一个参数作为登录是否成功的标准，由于代码最后登录是否成功是通过获取这个参数来作为最终的验证，所以。攻击者通过修改参数即可绕过登录的限制！  
  
  
**越权**  
  
****  
登录框处同样存在越权：  
  
  
·平行越权：获得相同等级的其它用户的权限；  
  
·垂直越权：低权限用户获取高权限用户的权限，例如:用户权限获得管理员权限，或者超级管理员权限。  
  
  
**目录遍历、信息泄露**  
  
  
目录遍历漏洞是由于web中间件目录访问相关的配置错误造成的，该漏洞会泄露web应用程序的敏感路径、敏感的文件信息、网站的编辑器路径或测试接口、系统敏感目录等信息。  
  
  
**造成漏洞原因**  
  
  
程序在实现上没有充分过滤用户输入的…/之类的目录跳转符，导致恶意用户可以通过提交目录跳转来遍历服务器上的任意文件。  
  
  
**跨站脚本攻击**  
  
  
分三类：反射型、存储型、DOM型  
  
利用：获取cookie，钓鱼  
  
这里就不细说了  
  
  
**用户相关**  
  
  
  
**明文传输、用户名遍历**  
  
  
在登录框BP抓包，发现用户名、密码是明文传输的，即客户端与服务器的数据传输未加密。  
  
  
危害：攻击者可能通过劫持ARP欺骗、嗅探Sniffer、等手段截获敏感数据，若获取用户名和密码信息，可以进入到系统当中。  
  
  
**漏洞挖掘：**  
  
- 查看是否使用HTTPS协议  
  
- 用户名、密码是否加密  
  
**任意用户注册**  
  
  
利用：在登录框处输入手机号，密码，验证码随便填，BP抓包，尝试验证码爆破  
  
  
下图作用是可以抓到返回包并可修改返回值：  
  
  
**任意密码重置**  
  
  
任意账号密码重置的6种方法，这里深入讲一下：  
  
  
**1. 短信验证码回传：**通过手机找回密码，响应包中包含短信验证码。  
  
  
**修复建议：**响应包中去掉短信验证码。  
  
  
**2. 修改用户名、用户ID或手机号重置任意账号密码:**  
  
  
通过手机找回密码一般需要短信验证码验证。当我们输入正确的手机号和正确的短信验证码，然后进入重置密码的最后一步，也就是输入新的密码输入密码后提交到服务端的post数据包需要包含当前用户的身份信息。  
  
  
而一般网站是通过用户名或用户ID来标识用户身份的，如果这个用户名或用户ID没有和当前手机号、短信验证码进行绑定；也就是说服务端只验证用户名、ID是否存在，而不去验证用户和当前手机号是否匹配，那么我们就可以通过修改用户名、ID去修改其他用户的密码了。  
  
  
也可以修改的地方不限于找回密码的数据包，比如修改资料的地方也可能存在这样的漏洞。  
  
  
**修复建议：**  
  
****- 用户操作个人信息时，服务端要对当前用户身份进行验证，防止越权操作；  
  
- 用来标识用户身份的名称或ID可以使用自定义加密，也可以隐藏这些参数，直接从cookie中获取用户信息；  
  
- 用户修改密码时应该先对旧密码进行验证，或者使用手机短信验证；  
  
- 用  
户修改手机号时需要先对原手机号进行验证。  
  
  
  
  
**3. 修改响应包重置任意账号密码：**  
  
  
通过手机找回密码一般需要短信验证码验证，服务端需要告诉客户端，输入的验证码是否正确。  
  
  
如果客户端收到true的信息，那么就会向带着true的信息向服务端请求进入下一步，而服务端收到true的信息，就会允许客户端进入下一步。  
  
  
反之，如果是false的信息，服务端就不会允许客户端进入下一步。  
  
  
所以我们进入下一步的关键是让服务端收到客户端的true信息。而通过Burpsuite，我们可以修改服务端返回到客户端的信息，这样一来，我们就可以输入任意短信验证码，然后将服务端返回的false信息改为true就可以绕过短信验证码的验证了。  
  
  
**修复建议：**  
  
- 服务端对验证码进行验证，结果为true时直接跳到下一步，无需向客户端单独返回验证结果；  
  
- 输入新的密码，然后提交到服务端，服务端应对当前用户名、手机号、短信验证码进行二次匹配验证，都为true时，才可以修改成功。  
  
  
  
  
**4. 跳过验证步骤重置任意账号密码：**  
  
  
找回密码流程一般需要四个步骤：  
  
- 验证用户名；  
  
- 验证短信验证码；  
  
- 输入新密码；  
  
- 重置成功。  
  
利用思路：第一步正常输入用户名，第二部输入任意验证码，直接访问输入新密码，重置密码。  
  
  
原因：当我们输入新的密码后，提交到服务端，服务端并没有对当前用户身份进行二次验证，只是简单的获取到用户名或ID以及新密码，从而导致跳过短信验证码验证重置任意账号密码。  
  
  
**修复建议：**  
  
- 每一个步骤都要对前一个步骤进行验证；  
  
- 最后提交新密码时应对当前用户名或ID、手机号、短信验证码进行二次匹配验证。  
  
  
  
  
**5. 重置密码链接中token值未验证或不失效导致任意账号密码重置：**  
  
  
使用邮箱重置密码时，服务端向邮箱发送一个重置密码的链接，链接中包含当前用户的身份信息和一个随机生成的token信息，如果未对token值进行验证或是验证后不失效，我们就可以通过修改用户名或用户ID来重置任意账号密码。  
  
  
**修复建议：**  
  
- 服务端对客户端提交的token值进行验证；  
  
- 保证token值使用一次后即失效，防止重复使用；  
  
- 对  
用户ID进行自定义加密；  
  
- 使用根据用户ID生成的token值来标识用户，链接中不携带用户ID。  
  
  
  
  
**6. 找回密码的短信验证码可被爆破导致任意账号密码重置：**  
  
  
找回密码时使用位数较少的短信验证码，或者验证码没有设置有效时间限制，导致攻击者借助自动化工具（例如BP）进行爆破获得短信验证码，从而导致重置任意账号密码。  
  
  
**修复建议：**  
  
- 验证码满足一定复杂度，且限制验证码生效时间；  
  
- 验证短信验证码的数据包使用token值并验证，防止自动化工具爆破  
  
  
  
  
**弱口令**  
  
  
  
**短信相关漏洞**  
  
  
**1. 短信轰炸**  
  
  
短信炸弹是利用互联网第三方接口发送垃圾短信轰炸，只需输入手机号码就可以利用网络短信无限轰炸对方手机，具有恶意骚扰功能的软件。  
  
  
**2. 短信验证码爆破**  
  
  
上面讲到过了，例如：用BurpSuite爆破。  
  
  
**3. 验证码回显**  
  
  
思路：登录接收验证码时，BP抓包，可以看到验证码回显在返回包中。  
  
  
**4. 万能验证码**  
  
  
类似于弱口令，程序员开发为了方便，设置比较简单，例如8888、0000等。  
  
  
**5. 验证码失效、未与用户绑定**  
  
****  
  
**二」搜索框存在什么漏洞？**  
  
- SQL注入:SQL注入漏洞主要形成的原因是在数据交互中，前端的数据传入到后台处理时，没有做严格的判断，导致其传入的"数据"拼接到SQL语句中后，被当作SQL语句的一部分执行，从而导致数据库被增、删、改、查的危害。  
  
- xss漏洞  
  
  
  
**三」新增主题、添加用户处存在什么漏洞**  
  
- 越权  
  
- sql注入  
  
- 文件上传  
  
- 未授权登录  
  
- csrf  
  
  
  
**四」导入、导出excel处存在什么漏洞**  
  
  
任意文件读取、下载任意文件上传漏洞xxe  
  
  
**五」内容编辑处存在什么漏洞**  
  
- xss  
  
- sql注入  
  
- 越权  
  
- 文件上传  
  
- 编辑器：fckeditor、ueditor  
  
  
  
**六」修改头像处**  
  
- 文件上传：getshell、xss  
  
- 越权  
  
  
  
**七」页面内容浏览处一般存在漏洞**  
  
- 越权  
  
- sql注入  
  
  
  
  
  

								  

									  

										  

											  
往期推荐  

										  

									  

									  

								[ 从零开始学习CTF——CTF基本概念 ](http://mp.weixin.qq.com/s?__biz=MzA5MzYzMzkzNg==&mid=2650938861&idx=1&sn=ee950096888dc41cfae365ed1976c467&chksm=8bac5112bcdbd8042dfeb6c3e38e2c149cc32432095cc3fd35f255034aff44908690faebd8ae&scene=21#wechat_redirect)  

							  
  

								[ 【逻辑漏洞】任意账号密码重置 ](http://mp.weixin.qq.com/s?__biz=MzA5MzYzMzkzNg==&mid=2650938763&idx=1&sn=21bb56fca5f878bb55136dc57c8c39f6&chksm=8bac5174bcdbd862e7ddd67f3d19acf4054ed54662e5e8aedb1efbd71084b7d9a3218af7de89&scene=21#wechat_redirect)  

							  
  

								[ 红蓝对抗｜备战大型攻防演练 ](http://mp.weixin.qq.com/s?__biz=MzA5MzYzMzkzNg==&mid=2650938651&idx=1&sn=450d8f3bcf0e4b851e911c17b946e2d9&chksm=8bac51e4bcdbd8f2a358724af994dfa4ab4365f72d3c9e146a5f7ce98fcb5562aa85c54d41c7&scene=21#wechat_redirect)  

							  
  

								[ 【应急响应】黑客入侵应急响应分析手工排查 ](http://mp.weixin.qq.com/s?__biz=MzA5MzYzMzkzNg==&mid=2650938560&idx=1&sn=be476da838703bd1d646ac7894dffa3c&chksm=8bac503fbcdbd9298f0503f888767cffdb49fb0c69dc1c54c10e6ffd8808b8d9dddd4a0735d6&scene=21#wechat_redirect)  

							  
  

								[ 常见的WAF绕过、进程及识别工具 ](http://mp.weixin.qq.com/s?__biz=MzA5MzYzMzkzNg==&mid=2650938465&idx=1&sn=62a741c4540c46a18fca9fa9ea4ba79b&chksm=8bac509ebcdbd9885e38b59ff54e3b10012586178b3255f5a26ee829bda4f468a32c26a80f62&scene=21#wechat_redirect)  

							  
  

								[ WAF的功能、检测、指纹及绕过 ](http://mp.weixin.qq.com/s?__biz=MzA5MzYzMzkzNg==&mid=2650938399&idx=1&sn=5a7106855070506f2ae949a8b21eba98&chksm=8bac50e0bcdbd9f681efc559646f7d6b6e5769adf51c5742f7414aa72f700e8695afbc220110&scene=21#wechat_redirect)  

							  
  

								[ 关于站库分离渗透思路总结 ](http://mp.weixin.qq.com/s?__biz=MzA5MzYzMzkzNg==&mid=2650938295&idx=1&sn=d4b25b9b3793316a53c4ee5512cfcc24&chksm=8bac5748bcdbde5ee24552c75090901699a134a2c7899e9b796f090d5c826b00a8181a3132e0&scene=21#wechat_redirect)  

							  
  

								[ 护网红队必备工具列表总结 ](http://mp.weixin.qq.com/s?__biz=MzA5MzYzMzkzNg==&mid=2650938233&idx=1&sn=5111af28f5db934faa9127a87263199a&chksm=8bac5786bcdbde90a7a3d4cb1420e8f8be2214972139cb59483378522731ef45cd31fd339f06&scene=21#wechat_redirect)  

							  
  

								[ 什么是反弹shell，反弹shell的方法 ](http://mp.weixin.qq.com/s?__biz=MzA5MzYzMzkzNg==&mid=2650938134&idx=1&sn=a72afd48e5d5186e7303fa78057e76c8&chksm=8bac57e9bcdbdeffb0f0be66a030e3c819cced36443046729bd9052b0a83df403efee0947162&scene=21#wechat_redirect)  

							  
  

								[ php后门隐藏技巧大全 ](http://mp.weixin.qq.com/s?__biz=MzA5MzYzMzkzNg==&mid=2650938045&idx=1&sn=064ec68a16ec5db3473ef50f0a78b214&chksm=8bac5642bcdbdf5405b4f28265ed24c0614bc96217c2b3f8d15cbf6c90e3c78c9523c2bdb6a4&scene=21#wechat_redirect)  

							  
  
  
  
声明：本公众号所分享内容仅用于网安爱好者之间的技术讨论，禁止用于违法途径，**所有渗透都需获取授权**  
！否则需自行承担，本公众号及原作者不承担相应的后果  
```
```  
  
  
