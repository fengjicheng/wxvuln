#  漏洞复现 | CVE-2023-7028 GitLab 任意用户密码重置   
evilc0de  白帽子左一   2024-01-13 12:01  
  
扫码领资料  
  
获网安教程  
  
![](https://mmbiz.qpic.cn/mmbiz_png/CBJYPapLzSFJNibV2baHRo8G34MZhFD1sjTz4LHLiaKG9208VTU6pdTIEpC9jlW6UVfhIb9rHorCvvMsdiaya4T6Q/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1 "")  
  
  
![](https://mmbiz.qpic.cn/mmbiz_png/b96CibCt70iaaJcib7FH02wTKvoHALAMw4fchVnBLMw4kTQ7B9oUy0RGfiacu34QEZgDpfia0sVmWrHcDZCV1Na5wDQ/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1 "")  
  
  
  
GitLab 任意用户密码重置漏洞（CVE-2023-7028）  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/CBJYPapLzSGHFk1RSofNibFRyIUIj52nRM8d0hR5eiaHRAbHkkSdJ9mdjsfaY4jGO1vf9LVXLRb5icZMRQvyAPrtg/640?wx_fmt=jpeg "")  
  
漏洞概述  
<table><tbody style="outline: 0px;"><tr style="outline: 0px;"><td valign="middle" align="center" rowspan="1" colspan="4" style="outline: 0px;word-break: break-all;hyphens: auto;border-color: rgb(70, 118, 217);background-color: rgb(70, 118, 217);"><p style="outline: 0px;line-height: 1.5em;"><span style="outline: 0px;color: rgb(255, 255, 255);letter-spacing: 0px;"><strong style="outline: 0px;"><span style="outline: 0px;font-size: 13px;letter-spacing: 0px;">漏洞概述</span></strong><br style="outline: 0px;"/></span></p></td></tr><tr style="outline: 0px;"><td valign="middle" align="left" style="outline: 0px;word-break: break-all;hyphens: auto;border-color: rgb(70, 118, 217);"><p style="outline: 0px;line-height: 1em;"><span style="outline: 0px;font-size: 13px;letter-spacing: 0px;"><strong style="outline: 0px;"><span style="outline: 0px;letter-spacing: 0px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">漏洞名称</span></strong></span></p></td><td valign="middle" align="left" rowspan="1" colspan="3" style="outline: 0px;word-break: break-all;hyphens: auto;border-color: rgb(70, 118, 217);"><p style="outline: 0px;line-height: 1em;"><span style="outline: 0px;font-size: 13px;caret-color: red;letter-spacing: 0px;">GitLab 密码重置漏洞</span></p></td></tr><tr style="outline: 0px;"><td valign="middle" align="left" rowspan="1" colspan="1" style="outline: 0px;word-break: break-all;hyphens: auto;border-color: rgb(70, 118, 217);"><p style="outline: 0px;line-height: 1em;"><span style="outline: 0px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><span style="outline: 0px;font-size: 13px;"><strong style="outline: 0px;">漏洞编号</strong></span></span></p></td><td valign="middle" align="left" rowspan="1" colspan="3" style="outline: 0px;word-break: break-all;hyphens: auto;border-color: rgb(70, 118, 217);"><p style="outline: 0px;line-height: 1em;"><span style="outline: 0px;color: rgb(0, 0, 0);font-size: 13px;caret-color: rgb(255, 0, 0);font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">CVE-2023-7028</span></p></td></tr><tr style="outline: 0px;"><td valign="middle" align="left" colspan="1" rowspan="1" style="outline: 0px;word-break: break-all;hyphens: auto;border-color: rgb(70, 118, 217);"><p style="outline: 0px;line-height: 1em;"><strong style="outline: 0px;"><span style="outline: 0px;font-size: 13px;"><strong style="max-inline-size: 100%;cursor: text;color: rgb(0, 0, 0);caret-color: rgb(255, 0, 0);font-family: 微软雅黑, &#34;Microsoft YaHei&#34;, sans-serif;outline: none 0px !important;"><span style="max-inline-size: 100%;cursor: text;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;outline: none 0px !important;">公开时间</span></strong></span></strong></p></td><td valign="middle" align="left" colspan="1" rowspan="1" style="outline: 0px;word-break: break-all;hyphens: auto;border-color: rgb(70, 118, 217);"><p style="outline: 0px;line-height: 1em;"><span style="outline: 0px;color: rgb(0, 0, 0);font-size: 13px;caret-color: rgb(255, 0, 0);font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">2024-01-12</span></p></td><td valign="middle" align="left" colspan="1" rowspan="1" style="outline: 0px;word-break: break-all;hyphens: auto;border-color: rgb(70, 118, 217);"><p style="outline: 0px;line-height: 1em;"><strong style="outline: 0px;"><span style="outline: 0px;font-size: 13px;"><strong style="max-inline-size: 100%;cursor: text;color: rgb(0, 0, 0);caret-color: rgb(255, 0, 0);font-family: 微软雅黑, &#34;Microsoft YaHei&#34;, sans-serif;outline: none 0px !important;"><span style="max-inline-size: 100%;cursor: text;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;outline: none 0px !important;">影响量级</span></strong></span></strong></p></td><td valign="middle" align="left" colspan="1" rowspan="1" style="outline: 0px;word-break: break-all;hyphens: auto;border-color: rgb(70, 118, 217);"><p style="outline: 0px;line-height: 1em;"><span style="outline: 0px;color: rgb(0, 0, 0);font-size: 13px;caret-color: rgb(255, 0, 0);font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">十万级</span></p></td></tr><tr style="outline: 0px;"><td valign="middle" align="left" style="outline: 0px;word-break: break-all;hyphens: auto;border-color: rgb(70, 118, 217);"><p style="outline: 0px;line-height: 1em;"><span style="outline: 0px;font-size: 13px;letter-spacing: 0px;"><strong style="max-inline-size: 100%;cursor: text;color: rgb(0, 0, 0);font-size: 17px;caret-color: rgb(255, 0, 0);font-family: 微软雅黑, &#34;Microsoft YaHei&#34;, sans-serif;outline: none 0px !important;"><span style="max-inline-size: 100%;cursor: text;font-size: 13px;letter-spacing: 0px;outline: none 0px !important;">评级</span></strong></span></p></td><td valign="middle" align="left" style="outline: 0px;word-break: break-all;hyphens: auto;border-color: rgb(70, 118, 217);"><p style="outline: 0px;line-height: 1em;"><span style="outline: 0px;letter-spacing: 0px;"><strong style="max-inline-size: 100%;cursor: text;color: rgb(255, 0, 0);caret-color: rgb(255, 0, 0);font-family: 微软雅黑, &#34;Microsoft YaHei&#34;, sans-serif;outline: none 0px !important;"><span style="max-inline-size: 100%;cursor: text;font-size: 13px;letter-spacing: 0px;outline: none 0px !important;">高危</span></strong></span></p></td><td valign="middle" align="left" style="outline: 0px;word-break: break-all;hyphens: auto;border-color: rgb(70, 118, 217);"><p style="outline: 0px;line-height: 1em;"><strong style="outline: 0px;"><span style="outline: 0px;font-size: 13px;letter-spacing: 0px;">CVSS 3.1分数</span></strong></p></td><td valign="middle" align="left" style="outline: 0px;word-break: break-all;hyphens: auto;border-color: rgb(70, 118, 217);"><p style="outline: 0px;line-height: 1em;"><span style="outline: 0px;color: rgb(255, 0, 0);font-size: 13px;letter-spacing: 0px;"><strong style="outline: 0px;">10.0</strong></span></p></td></tr><tr style="outline: 0px;"><td valign="middle" align="left" colspan="1" rowspan="1" style="outline: 0px;word-break: break-all;hyphens: auto;border-color: rgb(70, 118, 217);"><p style="outline: 0px;line-height: 1em;"><span style="outline: 0px;font-size: 13px;"><strong style="outline: 0px;">威胁类型</strong></span></p></td><td valign="middle" align="left" colspan="1" rowspan="1" style="outline: 0px;word-break: break-all;hyphens: auto;border-color: rgb(70, 118, 217);"><p style="outline: 0px;line-height: 1em;"><span style="outline: 0px;font-size: 13px;">身份认证绕过</span></p></td><td valign="middle" align="left" colspan="1" rowspan="1" style="outline: 0px;word-break: break-all;hyphens: auto;border-color: rgb(70, 118, 217);"><p style="outline: 0px;line-height: 1em;"><strong style="max-inline-size: 100%;cursor: text;color: rgb(0, 0, 0);caret-color: rgb(255, 0, 0);font-family: 微软雅黑, &#34;Microsoft YaHei&#34;, sans-serif;outline: none 0px !important;"><span style="max-inline-size: 100%;cursor: text;font-size: 13px;outline: none 0px !important;">利用可能性</span></strong></p></td><td valign="middle" align="left" colspan="1" rowspan="1" style="outline: 0px;word-break: break-all;hyphens: auto;border-color: rgb(70, 118, 217);"><p style="outline: 0px;line-height: 1em;"><strong style="max-inline-size: 100%;cursor: text;caret-color: rgb(255, 0, 0);color: rgb(255, 0, 0);font-family: 微软雅黑, &#34;Microsoft YaHei&#34;, sans-serif;outline: none 0px !important;"><span style="max-inline-size: 100%;cursor: text;font-size: 13px;outline: none 0px !important;">高</span></strong></p></td></tr><tr style="outline: 0px;"><td valign="middle" colspan="1" rowspan="1" align="left" style="outline: 0px;word-break: break-all;hyphens: auto;border-color: rgb(70, 118, 217);"><p style="outline: 0px;line-height: 1em;"><span style="outline: 0px;font-size: 13px;"><strong style="outline: 0px;"><span style="outline: 0px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">POC状态</span></strong></span></p></td><td valign="middle" colspan="1" rowspan="1" align="left" style="outline: 0px;word-break: break-all;hyphens: auto;border-color: rgb(70, 118, 217);"><p style="outline: 0px;line-height: 1em;"><span style="outline: 0px;font-size: 13px;color: rgb(0, 0, 0);font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">未公开</span></p></td><td valign="middle" colspan="1" rowspan="1" align="left" style="outline: 0px;word-break: break-all;hyphens: auto;border-color: rgb(70, 118, 217);"><p style="outline: 0px;line-height: 1em;"><span style="outline: 0px;font-size: 13px;"><strong style="outline: 0px;"><span style="outline: 0px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">在野利用状态</span></strong></span></p></td><td valign="middle" colspan="1" rowspan="1" align="left" style="outline: 0px;word-break: break-all;hyphens: auto;border-color: rgb(70, 118, 217);"><p style="outline: 0px;line-height: 1em;"><span style="outline: 0px;font-size: 13px;color: rgb(0, 0, 0);font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">未发现</span></p></td></tr><tr style="outline: 0px;"><td valign="middle" colspan="1" rowspan="1" align="left" style="outline: 0px;word-break: break-all;hyphens: auto;border-color: rgb(70, 118, 217);"><p style="outline: 0px;line-height: 1em;"><span style="outline: 0px;font-size: 13px;"><strong style="outline: 0px;"><span style="outline: 0px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">EXP状态</span></strong></span></p></td><td valign="middle" colspan="1" rowspan="1" align="left" style="outline: 0px;word-break: break-all;hyphens: auto;border-color: rgb(70, 118, 217);"><p style="outline: 0px;line-height: 1em;"><span style="outline: 0px;font-size: 13px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">未公开</span></p></td><td valign="middle" colspan="1" rowspan="1" align="left" style="outline: 0px;word-break: break-all;hyphens: auto;border-color: rgb(70, 118, 217);"><p style="outline: 0px;line-height: 1em;"><span style="outline: 0px;font-size: 13px;"><strong style="outline: 0px;"><span style="outline: 0px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">技术细节状态</span></strong></span></p></td><td valign="middle" colspan="1" rowspan="1" align="left" style="outline: 0px;word-break: break-all;hyphens: auto;border-color: rgb(70, 118, 217);"><p style="outline: 0px;line-height: 1em;"><span style="outline: 0px;font-size: 13px;color: rgb(0, 0, 0);font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">未公开</span></p></td></tr><tr style="outline: 0px;"><td valign="middle" colspan="4" rowspan="1" align="left" style="outline: 0px;word-break: break-all;hyphens: auto;border-color: rgb(70, 118, 217);"><p style="outline: 0px;line-height: 1em;"><strong style="outline: 0px;"><span style="outline: 0px;font-size: 13px;">危害描述：</span></strong><span style="outline: 0px;font-size: 13px;letter-spacing: 0.544px;">成功利用该漏洞可修改任意用户密码。</span></p></td></tr></tbody></table>  
漏洞描述：  
  
2024年1月11日，Gitlab官方披露CVE-2023-7028 GitLab 任意用户密码重置漏洞，官方评级严重。攻击者可利用忘记密码功能，构造恶意请求获取密码重置链接从而重置密码。官方已发布安全更新，建议升级至最新版本，若无法升级，建议利用安全组功能设置Gitlab仅对可信地址开放。  
  
漏洞利用条件：  
1、需获取系统已有用户注  
册  
邮箱地址  
2、满足影响版本  
```
16.1 <=GitLab CE<16.1.6
16.2 <=GitLab CE<16.2.8
16.3 <=GitLab CE<16.3.6
16.4 <=GitLab CE<16.4.4
16.5 <=GitLab CE<16.5.6
16.6 <=GitLab CE<16.6.4
16.7 <=GitLab CE<16.7.2
16.1 <=GitLab EE<16.1.6
16.2 <=GitLab EE<16.2.8
16.3 <=GitLab EE<16.3.6
16.4 <=GitLab EE<16.4.4
16.5 <=GitLab EE<16.5.6
16.6 <=GitLab EE<16.6.4
16.7 <=GitLab EE<16.7.2

```  
## 受影响资产情况：奇安信鹰图资产测绘平台数据显示，GitLab 密码重置漏洞(CVE-2023-7028)关联的国内风险资产总数为1406090个，关联IP总数为147705个复现过程  
> 这里被找回邮箱为个人注册邮箱地址，真实环境中需先获取目标邮箱地址  
  
  
访问找回密码页面：/users/password/new  
  
![](https://mmbiz.qpic.cn/mmbiz_png/vqGv1p3HpTloNO6p17lgRCPNIT7fQbdxFianXElAwFJAeavfcibJFvySh708KXrN6MjveO9V7pEf9GddycebD8iaQ/640?wx_fmt=png&from=appmsg&tp=wxpic&wxfrom=5&wx_lazy=1&wx_co=1 "")  
  
填写被找回邮箱地址，然后点击抓包  
  
![](https://mmbiz.qpic.cn/mmbiz_png/vqGv1p3HpTloNO6p17lgRCPNIT7fQbdx728snBjWMo7ZzuB89HMMQwrbeq6pVQzerdM9vlIOrxL8HEhSnJrGQw/640?wx_fmt=png&from=appmsg&tp=wxpic&wxfrom=5&wx_lazy=1&wx_co=1 "")  
  
修改请求包为：user[email][]=目标邮箱地址&user[email][]=攻击者邮箱地址![](https://mmbiz.qpic.cn/mmbiz_png/vqGv1p3HpTloNO6p17lgRCPNIT7fQbdxIj6yT26g8qW0Gu9nEU7ulJjFNySp7Bg1pM7Hm9V9Y5w6icHPicOdK6QA/640?wx_fmt=png&from=appmsg&tp=wxpic&wxfrom=5&wx_lazy=1&wx_co=1 "")  
  
  
成功复现![](https://mmbiz.qpic.cn/mmbiz_png/vqGv1p3HpTloNO6p17lgRCPNIT7fQbdxNEmPLoGKtaSQJk9ZA9AWekLU8ogJ3uEpJJicScTMohUlvrwvPVnWBYg/640?wx_fmt=png&from=appmsg&tp=wxpic&wxfrom=5&wx_lazy=1&wx_co=1 "")  
  
  
文章作者：Evilc0de 安全团队  
  
声明：⽂中所涉及的技术、思路和⼯具仅供以安全为⽬的的学习交流使⽤，任何⼈不得将其⽤于⾮法⽤途以及盈利等⽬的，否则后果⾃⾏承担。**所有渗透都需获取授权**  
！  
  
@  
**学习更多渗透技能！体验靶场实战练习**  
```
```  
  
  
