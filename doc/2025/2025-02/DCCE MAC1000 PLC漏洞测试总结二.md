#  DCCE MAC1000 PLC漏洞测试总结二   
NEURON  SAINTSEC   2025-02-06 02:02  
  
**1. PLC指令可被利用发起蠕虫传播**  
  
****<table><tbody><tr style="height: 72px;"><td width="89" style="border-width: 1px;border-color: windowtext;padding: 0px 7px;" height="72"><section style="text-align: center;margin-left: 8px;margin-right: 8px;"><span style="font-family: 黑体;font-size: 15px;">问题名称</span></section></td><td width="453" style="border-top-width: 1px;border-right-width: 1px;border-bottom-width: 1px;border-left-style: none;border-top-color: windowtext;border-right-color: windowtext;border-bottom-color: windowtext;padding: 0px 7px;" height="72"><section style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;font-family: 楷体;">PLC“自由通讯指令”可被利用发起蠕虫传播</span></section></td></tr><tr><td width="89" style="border-right-width: 1px;border-bottom-width: 1px;border-left-width: 1px;border-top-style: none;border-right-color: windowtext;border-bottom-color: windowtext;border-left-color: windowtext;padding: 0px 7px;"><section style="text-align: center;margin-left: 8px;margin-right: 8px;"><span style="font-family: 黑体;font-size: 15px;">检测工具</span></section></td><td width="453" style="border-top-style: none;border-left-style: none;border-bottom-width: 1px;border-bottom-color: windowtext;border-right-width: 1px;border-right-color: windowtext;padding: 0px 7px;"><section style="margin-left: 8px;margin-right: 8px;"><span style="font-family: 仿宋_GB2312;font-size: 15px;">Arpspoof  Python PLC_Config</span></section></td></tr><tr style="height: 74px;"><td width="89" style="border-right-width: 1px;border-bottom-width: 1px;border-left-width: 1px;border-top-style: none;border-right-color: windowtext;border-bottom-color: windowtext;border-left-color: windowtext;padding: 0px 7px;" height="74"><section style="text-align: center;margin-left: 8px;margin-right: 8px;"><span style="font-family: 黑体;font-size: 15px;">问题描述</span></section></td><td width="453" style="border-top-style: none;border-left-style: none;border-bottom-width: 1px;border-bottom-color: windowtext;border-right-width: 1px;border-right-color: windowtext;padding: 0px 7px;" height="74"><section style="margin-left: 8px;margin-right: 8px;"><span style="font-family: 仿宋_GB2312;font-size: 15px;">通过劫持PLC_Config下载程序流程，篡改PLC下载程序内容，导致PLC向局域网设备发送任一带功能报文（例:发送停止指令），从而导致其他局域网内PLC设备停机，实现类似PLC感染病毒功能</span></section></td></tr><tr><td width="83" style="border-right-width: 1px;border-bottom-width: 1px;border-left-width: 1px;border-top-style: none;border-right-color: windowtext;border-bottom-color: windowtext;border-left-color: windowtext;padding: 0px 7px;"><section style="text-align: center;margin-left: 8px;margin-right: 8px;"><span style="font-family: 黑体;font-size: 15px;">测试步骤描述</span></section></td><td width="453" style="border-top-style: none;border-left-style: none;border-bottom-width: 1px;border-bottom-color: windowtext;border-right-width: 1px;border-right-color: windowtext;padding: 0px 7px;"><section style="text-align: left;margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;"><span style="font-family: 仿宋_GB2312;">1、<span style="font-stretch: normal;line-height: normal;">    </span></span><span style="font-family: 仿宋;">“</span><span style="font-family: 仿宋_GB2312;">自由通讯</span><span style="font-family: 仿宋;">”</span><span style="font-family: 仿宋_GB2312;">指令中的</span><span style="font-family: 仿宋;">“</span><span style="font-family: 仿宋_GB2312;">UDP_AFC</span><span style="font-family: 仿宋;">”</span><span style="font-family: 仿宋_GB2312;">,可以向其他PLC发送任意UDP数据，若构造恶意控制指令（如启停），将造成网络内其他设备宕机。可通过编程，实现plc自动向内网发送udp报文。</span></span></section><section style="margin-left: 8px;margin-right: 8px;"><span style="font-family: 仿宋_GB2312;font-size: 15px;"><img class="rich_pages wxw-img" data-ratio="0.6666666666666666" data-src="https://mmbiz.qpic.cn/mmbiz_png/Gw8FuwXLJnQ9EwDdUHMdnGvT23W1QMbQEM4iaS23TKlWnZYZyDbJVfTMk7uGZ9PQWYfI4OG7gZSAAyFjiaibgxFBQ/640?wx_fmt=png" data-type="png" data-w="990" height="216" width="324"/></span></section><section style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;font-family: 仿宋_GB2312;">2．<span style="font-stretch: normal;line-height: normal;">    </span>UDP报文内容可使局域网内其他plc设备停止的命令，可以使其他内网中plc设备停止。</span></section><section style="text-indent: 0px;margin-left: 8px;margin-right: 8px;"><img class="rich_pages wxw-img" data-ratio="0.6666666666666666" data-src="https://mmbiz.qpic.cn/mmbiz_png/Gw8FuwXLJnQ9EwDdUHMdnGvT23W1QMbQbYs4zlbCreoBuBuq2XMMpZx9oK4K6IrUUjZJt3MOG0h1ic2yPPpG07w/640?wx_fmt=png" data-type="png" data-w="888" height="194" width="290"/></section></td></tr><tr><td width="89" style="border-right-width: 1px;border-bottom-width: 1px;border-left-width: 1px;border-top-style: none;border-right-color: windowtext;border-bottom-color: windowtext;border-left-color: windowtext;padding: 0px 7px;"><section style="text-align: center;margin-left: 8px;margin-right: 8px;"><span style="font-family: 黑体;font-size: 15px;">其他说明</span></section></td><td width="453" style="border-top-style: none;border-left-style: none;border-bottom-width: 1px;border-bottom-color: windowtext;border-right-width: 1px;border-right-color: windowtext;padding: 0px 7px;"><section style="margin-left: 8px;margin-right: 8px;"><span style="font-family: 仿宋_GB2312;font-size: 15px;">此方法也可结合其他攻击方法，实现更多功能，例如重写其他plc设备中某些内存值或者IO输出值</span></section></td></tr><tr><td width="89" style="border-right-width: 1px;border-bottom-width: 1px;border-left-width: 1px;border-top-style: none;border-right-color: windowtext;border-bottom-color: windowtext;border-left-color: windowtext;padding: 0px 7px;"><section style="text-align: center;margin-left: 8px;margin-right: 8px;"><span style="font-family: 黑体;font-size: 15px;">其他说明</span></section></td><td width="453" style="border-top-style: none;border-left-style: none;border-bottom-width: 1px;border-bottom-color: windowtext;border-right-width: 1px;border-right-color: windowtext;padding: 0px 7px;"><br/></td></tr></tbody></table>  
  
**2.    PLC远程控制任意I/O读写**  
  
****<table><tbody><tr style="height: 72px;"><td width="86" style="border-width: 1px;border-color: windowtext;padding: 0px 7px;" height="72"><section style="text-align: center;margin-left: 8px;margin-right: 8px;"><span style="font-family: 黑体;font-size: 15px;">问题名称</span></section></td><td width="444" style="border-top-width: 1px;border-right-width: 1px;border-bottom-width: 1px;border-left-style: none;border-top-color: windowtext;border-right-color: windowtext;border-bottom-color: windowtext;padding: 0px 7px;" height="72"><section style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;font-family: 仿宋_GB2312;">PLC远程控制任意I/O读写</span></section></td></tr><tr><td width="92" style="border-right-width: 1px;border-bottom-width: 1px;border-left-width: 1px;border-top-style: none;border-right-color: windowtext;border-bottom-color: windowtext;border-left-color: windowtext;padding: 0px 7px;"><section style="text-align: center;margin-left: 8px;margin-right: 8px;"><span style="font-family: 黑体;font-size: 15px;">检测工具</span></section></td><td width="444" style="border-top-style: none;border-left-style: none;border-bottom-width: 1px;border-bottom-color: windowtext;border-right-width: 1px;border-right-color: windowtext;padding: 0px 7px;"><section style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;font-family: 仿宋_GB2312;">Python发包脚本 wireshark</span></section></td></tr><tr style="height: 74px;"><td width="92" style="border-right-width: 1px;border-bottom-width: 1px;border-left-width: 1px;border-top-style: none;border-right-color: windowtext;border-bottom-color: windowtext;border-left-color: windowtext;padding: 0px 7px;" height="74"><section style="text-align: center;margin-left: 8px;margin-right: 8px;"><span style="font-family: 黑体;font-size: 15px;">问题描述</span></section></td><td width="444" style="border-top-style: none;border-left-style: none;border-bottom-width: 1px;border-bottom-color: windowtext;border-right-width: 1px;border-right-color: windowtext;padding: 0px 7px;" height="74"><section style="text-align: left;margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;font-family: 仿宋_GB2312;">EPA协议可以实现PLC内部参数配置、程序上下载和变量监控，由于没有认证，攻击者可远程向PLC发送特殊构造的数据包实现这些操作的远程操纵。</span></section></td></tr><tr><td width="92" style="border-right-width: 1px;border-bottom-width: 1px;border-left-width: 1px;border-top-style: none;border-right-color: windowtext;border-bottom-color: windowtext;border-left-color: windowtext;padding: 0px 7px;"><section style="text-align: center;margin-left: 8px;margin-right: 8px;"><span style="font-family: 黑体;font-size: 15px;">测试步骤描述</span></section></td><td width="444" style="border-top-style: none;border-left-style: none;border-bottom-width: 1px;border-bottom-color: windowtext;border-right-width: 1px;border-right-color: windowtext;padding: 0px 7px;"><section style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;font-family: 仿宋_GB2312;">1、可利用EPA变量读写报文访问各变量区，通过0c读操作码实现对控制器的监控。通过0d写操作码可以对各种位变量、单字双字多字变量修改</span></section><section style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;font-family: 仿宋_GB2312;">2、</span></section><section style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;font-family: 仿宋_GB2312;">3、</span></section></td></tr><tr><td width="92" style="border-right-width: 1px;border-bottom-width: 1px;border-left-width: 1px;border-top-style: none;border-right-color: windowtext;border-bottom-color: windowtext;border-left-color: windowtext;padding: 0px 7px;"><section style="text-align: center;margin-left: 8px;margin-right: 8px;"><span style="font-family: 黑体;font-size: 15px;">其他说明</span></section></td><td width="444" style="border-top-style: none;border-left-style: none;border-bottom-width: 1px;border-bottom-color: windowtext;border-right-width: 1px;border-right-color: windowtext;padding: 0px 7px;"><br/></td></tr></tbody></table>  
  
**3.    PLC软件多种配置文件易篡改**  
  
****<table><tbody><tr style="height: 72px;"><td width="78" style="border-width: 1px;border-color: windowtext;padding: 0px 7px;" height="72"><section style="text-align: center;margin-left: 8px;margin-right: 8px;"><span style="font-family: 黑体;font-size: 15px;">问题名称</span></section></td><td width="456" style="border-top-width: 1px;border-right-width: 1px;border-bottom-width: 1px;border-left-style: none;border-top-color: windowtext;border-right-color: windowtext;border-bottom-color: windowtext;padding: 0px 7px;" height="72"><section style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;font-family: 仿宋_GB2312;">PLC编程软件多种配置文件易被篡改</span></section></td></tr><tr><td width="85" style="border-right-width: 1px;border-bottom-width: 1px;border-left-width: 1px;border-top-style: none;border-right-color: windowtext;border-bottom-color: windowtext;border-left-color: windowtext;padding: 0px 7px;"><section style="text-align: center;margin-left: 8px;margin-right: 8px;"><span style="font-family: 黑体;font-size: 15px;">检测工具</span></section></td><td width="456" style="border-top-style: none;border-left-style: none;border-bottom-width: 1px;border-bottom-color: windowtext;border-right-width: 1px;border-right-color: windowtext;padding: 0px 7px;"><section style="margin-left: 8px;margin-right: 8px;"><span style="font-family: 仿宋_GB2312;font-size: 15px;">Notepad</span></section></td></tr><tr style="height: 74px;"><td width="85" style="border-right-width: 1px;border-bottom-width: 1px;border-left-width: 1px;border-top-style: none;border-right-color: windowtext;border-bottom-color: windowtext;border-left-color: windowtext;padding: 0px 7px;" height="74"><section style="text-align: center;margin-left: 8px;margin-right: 8px;"><span style="font-family: 黑体;font-size: 15px;">问题描述</span></section></td><td width="456" style="border-top-style: none;border-left-style: none;border-bottom-width: 1px;border-bottom-color: windowtext;border-right-width: 1px;border-right-color: windowtext;padding: 0px 7px;" height="74"><section style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;"><span style="font-family: 仿宋_GB2312;">软件安装目录</span><span style="font-family: 仿宋;">“</span><span style="font-family: 仿宋_GB2312;">C:\Program Files\DCCE\PLC_Config</span><span style="font-family: 仿宋;">”</span><span style="font-family: 仿宋_GB2312;">下存在7个扩展名为.cfg的配置文件，明文存储，虽然文件中提示了</span><span style="font-family: 仿宋;">“</span><span style="font-family: 仿宋_GB2312;">请勿手工编辑此文档</span><span style="font-family: 仿宋;">”</span><span style="font-family: 仿宋_GB2312;">，但恶意篡改此类配置文件中的参数，将导致软件使用异常，逻辑功能错误，编写PLC程序时会产生安全风险，具体文件列表请见截图中打开的TXT窗口标题：</span></span></section></td></tr><tr><td width="85" style="border-right-width: 1px;border-bottom-width: 1px;border-left-width: 1px;border-top-style: none;border-right-color: windowtext;border-bottom-color: windowtext;border-left-color: windowtext;padding: 0px 7px;"><section style="text-align: center;margin-left: 8px;margin-right: 8px;"><span style="font-family: 黑体;font-size: 15px;">测试步骤描述</span></section></td><td width="456" style="border-top-style: none;border-left-style: none;border-bottom-width: 1px;border-bottom-color: windowtext;border-right-width: 1px;border-right-color: windowtext;padding: 0px 7px;"><section style="margin-left: 8px;margin-right: 8px;"><span style="font-family: 仿宋_GB2312;font-size: 15px;"><img data-ratio="0.625" data-src="https://mmbiz.qpic.cn/mmbiz_png/Gw8FuwXLJnQ9EwDdUHMdnGvT23W1QMbQjiczSw4RWUpq99DX32Y4DcrTfyOk39nVpBh5yl72lF47jiak7wo2tdKA/640?wx_fmt=png" data-type="png" data-w="1080" height="221" width="354"/></span></section><section style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;"><span style="font-family: 仿宋_GB2312;">1、打开软件安装目录</span><span style="font-family: 仿宋;">“</span><span style="font-family: 仿宋_GB2312;">C:\Program Files\DCCE\PLC_Config</span><span style="font-family: 仿宋;">”</span></span></section><section style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;font-family: 仿宋_GB2312;">2、可见目录下存在7个扩展名为.cfg的配置文件</span></section><section style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;"><span style="font-family: 仿宋_GB2312;">3、以打开编辑nc.cfg文件为例，包含了</span><span style="font-family: 仿宋;">‘</span><span style="font-family: 仿宋_GB2312;">opcode</span><span style="font-family: 仿宋;">’</span><span style="font-family: 仿宋_GB2312;">操作码明文，如果随意更改操作码，将导致编写出的组态程序无法实现正确操作，在生产环境中可能造成高速运转的刀具碰撞等严重问题。</span></span></section><section style="margin-left: 8px;margin-right: 8px;"><span style="font-family: 仿宋_GB2312;font-size: 15px;"><img class="rich_pages wxw-img" data-ratio="0.1801566579634465" data-src="https://mmbiz.qpic.cn/mmbiz_png/Gw8FuwXLJnQ9EwDdUHMdnGvT23W1QMbQQd7ia7BGAMW1z575twNMFt7oy2IkQZuuF7oDhduvrGonBUTXkJPfCPw/640?wx_fmt=png" data-type="png" data-w="766" height="69" width="383"/></span></section></td></tr><tr><td width="85" style="border-right-width: 1px;border-bottom-width: 1px;border-left-width: 1px;border-top-style: none;border-right-color: windowtext;border-bottom-color: windowtext;border-left-color: windowtext;padding: 0px 7px;"><section style="text-align: center;margin-left: 8px;margin-right: 8px;"><span style="font-family: 黑体;font-size: 15px;">其他说明</span></section></td><td width="456" style="border-top-style: none;border-left-style: none;border-bottom-width: 1px;border-bottom-color: windowtext;border-right-width: 1px;border-right-color: windowtext;padding: 0px 7px;"><br/></td></tr></tbody></table>  
   
  
**4.    PLC软件卸载不全导致敏感信息泄露**  
  
****<table><tbody><tr style="height: 72px;"><td width="80" style="border-width: 1px;border-color: windowtext;padding: 0px 7px;" height="72"><section style="text-align: center;margin-left: 8px;margin-right: 8px;"><span style="font-family: 黑体;font-size: 15px;">问题名称</span></section></td><td width="450" style="border-top-width: 1px;border-right-width: 1px;border-bottom-width: 1px;border-left-style: none;border-top-color: windowtext;border-right-color: windowtext;border-bottom-color: windowtext;padding: 0px 7px;" height="72"><section style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;font-family: 仿宋_GB2312;">PLC软件卸载不全导致敏感信息泄露 </span></section></td></tr><tr><td width="86" style="border-right-width: 1px;border-bottom-width: 1px;border-left-width: 1px;border-top-style: none;border-right-color: windowtext;border-bottom-color: windowtext;border-left-color: windowtext;padding: 0px 7px;"><section style="text-align: center;margin-left: 8px;margin-right: 8px;"><span style="font-family: 黑体;font-size: 15px;">检测工具</span></section></td><td width="450" style="border-top-style: none;border-left-style: none;border-bottom-width: 1px;border-bottom-color: windowtext;border-right-width: 1px;border-right-color: windowtext;padding: 0px 7px;"><section style="margin-left: 8px;margin-right: 8px;"><span style="font-family: 仿宋_GB2312;font-size: 15px;">软件目录下uninst.exe</span></section></td></tr><tr style="height: 74px;"><td width="86" style="border-right-width: 1px;border-bottom-width: 1px;border-left-width: 1px;border-top-style: none;border-right-color: windowtext;border-bottom-color: windowtext;border-left-color: windowtext;padding: 0px 7px;" height="74"><section style="text-align: center;margin-left: 8px;margin-right: 8px;"><span style="font-family: 黑体;font-size: 15px;">问题描述</span></section></td><td width="450" style="border-top-style: none;border-left-style: none;border-bottom-width: 1px;border-bottom-color: windowtext;border-right-width: 1px;border-right-color: windowtext;padding: 0px 7px;" height="74"><section style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;"><span style="font-family: 宋体;background-color: white;">软</span><span style="background-color: white;">件</span><span style="font-family: 宋体;background-color: white;">卸载时处理不完全，残留的文件中记录了工程文件打开列表，若包含敏感信息，存在泄密风险；</span></span></section></td></tr><tr><td width="86" style="border-right-width: 1px;border-bottom-width: 1px;border-left-width: 1px;border-top-style: none;border-right-color: windowtext;border-bottom-color: windowtext;border-left-color: windowtext;padding: 0px 7px;"><section style="text-align: center;margin-left: 8px;margin-right: 8px;"><span style="font-family: 黑体;font-size: 15px;">测试步骤描述</span></section></td><td width="450" style="border-top-style: none;border-left-style: none;border-bottom-width: 1px;border-bottom-color: windowtext;border-right-width: 1px;border-right-color: windowtext;padding: 0px 7px;"><section style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;font-family: 仿宋_GB2312;">1、运行软件目录下uninst.exe卸载</span></section><section style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;"><span style="font-family: 仿宋_GB2312;">2、在询问</span><span style="font-family: 仿宋;">“</span><span style="font-family: 仿宋_GB2312;">保留工程文件夹</span><span style="font-family: 仿宋;">”</span><span style="font-family: 仿宋_GB2312;">时选择否（</span><span style="background-color: white;">无</span><span style="font-family: 宋体;background-color: white;">论选</span><span style="background-color: white;">是</span><span style="font-family: 宋体;background-color: white;">还</span><span style="background-color: white;">是否</span><span style="font-family: 宋体;background-color: white;">，原软件安装目录下都会有残留，且重启也不会消失）</span></span></section><section style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;font-family: 仿宋_GB2312;">3、卸载完成后，原软件安装目录下仍有残留文件，包括最近使用工程列表，最近打开文件，软件配置等文件。</span></section><section style="text-align: center;margin-left: 8px;margin-right: 8px;"><span style="font-family: 仿宋_GB2312;font-size: 15px;"><img class="rich_pages wxw-img" data-ratio="0.6966292134831461" data-src="https://mmbiz.qpic.cn/mmbiz_png/Gw8FuwXLJnQ9EwDdUHMdnGvT23W1QMbQWDjw8iaBdAJcFUtheO8IHQDaEQ24x1oGa8tqVNlfDd92eMqTlDnHkWQ/640?wx_fmt=png" data-type="png" data-w="1068" height="167" width="240"/></span></section><section style="text-align: left;margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;"><span style="font-family: 仿宋_GB2312;">4、打开残留的ProjSave.txt后，可以看到之前使用过的工程文件名称，若包含涉密信息，则存在敏感信息泄露安全风险。如图该文件，可见</span><span style="font-family: 仿宋;">“</span><span style="font-family: 仿宋_GB2312;">绝密-核电反应堆冷却塔项目</span><span style="font-family: 仿宋;">”</span><span style="font-family: 仿宋_GB2312;">、</span><span style="font-family: 仿宋;">“</span><span style="font-family: 仿宋_GB2312;">绝密-歼10航空发动机零件生产项目</span><span style="font-family: 仿宋;">”</span><span style="font-family: 仿宋_GB2312;">等记录，存在情报安全隐患。<img class="rich_pages wxw-img" data-ratio="0.2351851851851852" data-src="https://mmbiz.qpic.cn/mmbiz_png/Gw8FuwXLJnQ9EwDdUHMdnGvT23W1QMbQARBge3dia4iatwXMN9Tg2mqsvoxJTdvfORTbXAfm9rNmZbk8NBUF3uhQ/640?wx_fmt=png" data-type="png" data-w="1080" height="88" width="374"/></span></span></section></td></tr><tr><td width="86" style="border-right-width: 1px;border-bottom-width: 1px;border-left-width: 1px;border-top-style: none;border-right-color: windowtext;border-bottom-color: windowtext;border-left-color: windowtext;padding: 0px 7px;"><section style="text-align: center;margin-left: 8px;margin-right: 8px;"><span style="font-family: 黑体;font-size: 15px;">其他说明</span></section></td><td width="450" style="border-top-style: none;border-left-style: none;border-bottom-width: 1px;border-bottom-color: windowtext;border-right-width: 1px;border-right-color: windowtext;padding: 0px 7px;"><br/></td></tr></tbody></table>  
   
  
**5.    PLC软件存在未加固等安全问题**  
  
****<table><tbody><tr style="height: 72px;"><td width="75" style="border-width: 1px;border-color: windowtext;padding: 0px 7px;" height="72"><section style="text-align: center;margin-left: 8px;margin-right: 8px;"><span style="font-family: 黑体;font-size: 15px;">问题名称</span></section></td><td width="461" style="border-top-width: 1px;border-right-width: 1px;border-bottom-width: 1px;border-left-style: none;border-top-color: windowtext;border-right-color: windowtext;border-bottom-color: windowtext;padding: 0px 7px;" height="72"><section style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;font-family: 仿宋_GB2312;">PLC软件存在未加固和DLL劫持风险</span></section></td></tr><tr><td width="81" style="border-right-width: 1px;border-bottom-width: 1px;border-left-width: 1px;border-top-style: none;border-right-color: windowtext;border-bottom-color: windowtext;border-left-color: windowtext;padding: 0px 7px;"><section style="text-align: center;margin-left: 8px;margin-right: 8px;"><span style="font-family: 黑体;font-size: 15px;">检测工具</span></section></td><td width="461" style="border-top-style: none;border-left-style: none;border-bottom-width: 1px;border-bottom-color: windowtext;border-right-width: 1px;border-right-color: windowtext;padding: 0px 7px;"><section style="margin-left: 8px;margin-right: 8px;"><span style="font-family: 仿宋_GB2312;font-size: 15px;">IDA Pro</span></section></td></tr><tr style="height: 74px;"><td width="81" style="border-right-width: 1px;border-bottom-width: 1px;border-left-width: 1px;border-top-style: none;border-right-color: windowtext;border-bottom-color: windowtext;border-left-color: windowtext;padding: 0px 7px;" height="74"><section style="text-align: center;margin-left: 8px;margin-right: 8px;"><span style="font-family: 黑体;font-size: 15px;">问题描述</span></section></td><td width="461" style="border-top-style: none;border-left-style: none;border-bottom-width: 1px;border-bottom-color: windowtext;border-right-width: 1px;border-right-color: windowtext;padding: 0px 7px;" height="74"><section style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;font-family: 仿宋_GB2312;">PLC没有对PLC编程软件做加固，可轻易逆向其软件结构，甚至可以通过逆向PLC编程软件DLL库，可以发现关键加密函数、编译函数等敏感函数、明文保存密码、口令。</span></section></td></tr><tr><td width="81" style="border-right-width: 1px;border-bottom-width: 1px;border-left-width: 1px;border-top-style: none;border-right-color: windowtext;border-bottom-color: windowtext;border-left-color: windowtext;padding: 0px 7px;"><section style="text-align: center;margin-left: 8px;margin-right: 8px;"><span style="font-family: 黑体;font-size: 15px;">测试步骤描述</span></section></td><td width="461" style="border-top-style: none;border-left-style: none;border-bottom-width: 1px;border-bottom-color: windowtext;border-right-width: 1px;border-right-color: windowtext;padding: 0px 7px;"><section style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;font-family: 仿宋_GB2312;">1、<span style="font-stretch: normal;line-height: normal;">      </span>逆向分析plc_config.exe可以找到明文保存的用户名密码：admin/123456 user1/123456 user2/123456，疑为内置账户。如图：</span></section><section style="text-align: center;text-indent: 0px;margin-left: 8px;margin-right: 8px;"><img class="rich_pages wxw-img" data-ratio="0.9368131868131868" data-src="https://mmbiz.qpic.cn/mmbiz_png/Gw8FuwXLJnQ9EwDdUHMdnGvT23W1QMbQ8OcsShViaWGiaicGicibqPQxQdTsy2uicVliajjeia9TJTbvueMZ5mYGvOt1iaw/640?wx_fmt=png" data-type="png" data-w="364" height="141" width="150"/></section><section style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;"><span style="font-family: DengXian;">2、<span style="font-stretch: normal;line-height: normal;">           </span></span><span style="font-family: 仿宋_GB2312;">逆向plc_config.exe还可发现其大量调用ShellExecuteA函数执行外部命令，存在高危风险。</span></span></section><section style="text-align: center;text-indent: 0px;margin-left: 8px;margin-right: 8px;"><img class="rich_pages wxw-img" data-ratio="0.7818181818181819" data-src="https://mmbiz.qpic.cn/mmbiz_png/Gw8FuwXLJnQ9EwDdUHMdnGvT23W1QMbQMOc41Q3iaMJ3Ef3nFNNHRXpA4rJT6Ip27vgk05NL6bOhiblJT9keH0MA/640?wx_fmt=png" data-type="png" data-w="605" height="164" width="216"/></section><section style="text-align: left;margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;font-family: 仿宋_GB2312;">3、<span style="font-stretch: normal;line-height: normal;">      </span>软件目录下面的dll中，core.dll,ReadWriteDll.dll等为系统设置相关：</span></section><section style="text-align: center;margin-left: 8px;margin-right: 8px;"><img data-ratio="0.548885077186964" data-src="https://mmbiz.qpic.cn/mmbiz_png/Gw8FuwXLJnQ9EwDdUHMdnGvT23W1QMbQUERJYXNrCnSEBXCc2PJgpeEnXtPgwxy6LLSwt3jvFhqoqh2qCC7LvQ/640?wx_fmt=png" data-type="png" data-w="583" height="150" width="275"/></section><section style="text-indent: 0px;margin-left: 8px;margin-right: 8px;"><span style="font-family: 仿宋_GB2312;font-size: 15px;">逆向其core.dll核心dll，可以看到核心系统参数，可以修改这些参数达到修改plc_config系统的目的。</span></section><section style="text-align: center;margin-left: 8px;margin-right: 8px;"><img class="rich_pages wxw-img" data-ratio="0.735593220338983" data-src="https://mmbiz.qpic.cn/mmbiz_png/Gw8FuwXLJnQ9EwDdUHMdnGvT23W1QMbQfI8agsBiaYVexDI0CG1pp5527O30nPnMBGAbVuw5bgGmjkia7TBW0z9g/640?wx_fmt=png" data-type="png" data-w="590" height="150" width="209"/></section><section style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;">4、<span style="font-stretch: normal;line-height: normal;">           </span><span style="font-family: 仿宋_GB2312;">逆向readWrite.dll可以发现其读写函数，可以通过劫持dll达到执行任意代码目的。</span></span></section><section style="text-align: center;margin-left: 8px;margin-right: 8px;"><img class="rich_pages wxw-img" data-ratio="0.3526490066225166" data-src="https://mmbiz.qpic.cn/mmbiz_png/Gw8FuwXLJnQ9EwDdUHMdnGvT23W1QMbQAO3d1NKT0Gxp5DXq7ksxPfSqE96GHClfUe6BKEvuy9iauzROL6eSU1w/640?wx_fmt=png" data-type="png" data-w="604" height="105" width="301"/></section><section style="text-align: center;margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;"> </span></section></td></tr><tr><td width="81" style="border-right-width: 1px;border-bottom-width: 1px;border-left-width: 1px;border-top-style: none;border-right-color: windowtext;border-bottom-color: windowtext;border-left-color: windowtext;padding: 0px 7px;"><section style="text-align: center;margin-left: 8px;margin-right: 8px;"><span style="font-family: 黑体;font-size: 15px;">其他说明</span></section></td><td width="461" style="border-top-style: none;border-left-style: none;border-bottom-width: 1px;border-bottom-color: windowtext;border-right-width: 1px;border-right-color: windowtext;padding: 0px 7px;"><section style="margin-left: 8px;margin-right: 8px;"><span style="font-family: 仿宋_GB2312;font-size: 15px;">本身plc_config 程序没有加壳保护，很容易被逆向</span></section></td></tr></tbody></table>  
   
  
**6.    PLC存在未知变量区**  
  
****<table><tbody><tr style="height: 90px;"><td width="75" style="border-width: 1px;border-color: windowtext;padding: 0px 7px;word-break: break-all;" height="90"><section style="margin-left: 8px;margin-right: 8px;text-indent: 0em;"><span style="font-family: 黑体;font-size: 15px;">问题名称</span></section></td><td width="401" style="border-top-width: 1px;border-right-width: 1px;border-bottom-width: 1px;border-left-style: none;border-top-color: windowtext;border-right-color: windowtext;border-bottom-color: windowtext;padding: 0px 7px;" height="90"><section style="margin-left: 8px;margin-right: 8px;text-indent: 0em;"><span style="font-family: 仿宋_GB2312;font-size: 15px;">扫描变量区，发现未知的变量区</span></section></td></tr><tr><td width="81" style="border-right-width: 1px;border-bottom-width: 1px;border-left-width: 1px;border-top-style: none;border-right-color: windowtext;border-bottom-color: windowtext;border-left-color: windowtext;padding: 0px 7px;"><section style="text-align: center;margin-left: 8px;margin-right: 8px;text-indent: 0em;"><span style="font-family: 黑体;font-size: 15px;">检测工具</span></section></td><td width="401" style="border-top-style: none;border-left-style: none;border-bottom-width: 1px;border-bottom-color: windowtext;border-right-width: 1px;border-right-color: windowtext;padding: 0px 7px;"><section style="margin-left: 8px;margin-right: 8px;text-indent: 0em;"><span style="font-size: 15px;font-family: 仿宋_GB2312;">Python 脚本</span></section></td></tr><tr style="height: 74px;"><td width="81" style="border-right-width: 1px;border-bottom-width: 1px;border-left-width: 1px;border-top-style: none;border-right-color: windowtext;border-bottom-color: windowtext;border-left-color: windowtext;padding: 0px 7px;" height="74"><section style="text-align: left;margin-left: 8px;margin-right: 8px;text-indent: 0em;"><span style="font-family: 黑体;font-size: 15px;">问题描述</span></section></td><td width="401" style="border-top-style: none;border-left-style: none;border-bottom-width: 1px;border-bottom-color: windowtext;border-right-width: 1px;border-right-color: windowtext;padding: 0px 7px;" height="74"><section style="margin-left: 8px;margin-right: 8px;text-indent: 0em;"><span style="font-family: 仿宋_GB2312;font-size: 15px;">发现使用特殊的读变量区指令，指定变量区号，可以发现10022，11001，11003，11005，11007，11008，11014。这些变量区未在文档中说明。</span></section></td></tr><tr><td width="81" style="border-right-width: 1px;border-bottom-width: 1px;border-left-width: 1px;border-top-style: none;border-right-color: windowtext;border-bottom-color: windowtext;border-left-color: windowtext;padding: 0px 7px;word-break: break-all;"><section style="text-align: center;margin-left: 8px;margin-right: 8px;text-indent: 0em;"><span style="font-family: 黑体;font-size: 15px;">测试步骤描述</span></section></td><td width="401" style="border-top-style: none;border-left-style: none;border-bottom-width: 1px;border-bottom-color: windowtext;border-right-width: 1px;border-right-color: windowtext;padding: 0px 7px;"><section style="margin-left: 8px;margin-right: 8px;text-indent: 0em;"><span style="font-size: 15px;font-family: 仿宋_GB2312;">1、<span style="font-stretch: normal;line-height: normal;">    </span>编写Python脚本直接发送‘区读取’命令，逐一测试变量区。</span></section><section style="text-indent: 0px;margin-left: 8px;margin-right: 8px;"><span style="font-family: 仿宋_GB2312;font-size: 15px;"><img class="rich_pages wxw-img" data-ratio="0.7222222222222222" data-src="https://mmbiz.qpic.cn/mmbiz_png/Gw8FuwXLJnQ9EwDdUHMdnGvT23W1QMbQqQAO4tibM15qGpJictT3Txzm1LxSgDibBLVdl9EgXX6xCBFVfVpibgIzqA/640?wx_fmt=png" data-type="png" data-w="1080" height="204" width="282"/></span></section><section style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;font-family: 仿宋_GB2312;">2、<span style="font-stretch: normal;line-height: normal;">    </span>发现了以下变量区，以及读取的结果</span></section><section style="text-indent: 0px;margin-left: 8px;margin-right: 8px;"><span style="font-family: 仿宋_GB2312;font-size: 15px;"><img class="rich_pages wxw-img" data-ratio="0.9351851851851852" data-src="https://mmbiz.qpic.cn/mmbiz_png/Gw8FuwXLJnQ9EwDdUHMdnGvT23W1QMbQMyeziabINYEIu9OricH5SGcpYvTJDWEFHX71d3vB5ibZRgryNb41FibrYw/640?wx_fmt=png" data-type="png" data-w="1080" height="276" width="296"/></span></section><p style="text-indent: 0;"><br/></p></td></tr><tr><td width="81" style="border-right-width: 1px;border-bottom-width: 1px;border-left-width: 1px;border-top-style: none;border-right-color: windowtext;border-bottom-color: windowtext;border-left-color: windowtext;padding: 0px 7px;"><section style="text-align: center;margin-left: 8px;margin-right: 8px;text-indent: 0em;"><span style="font-family: 黑体;font-size: 15px;">其他说明</span></section></td><td width="401" style="border-top-style: none;border-left-style: none;border-bottom-width: 1px;border-bottom-color: windowtext;border-right-width: 1px;border-right-color: windowtext;padding: 0px 7px;"><br/></td></tr></tbody></table>  
  
**7.    PLC软件上载程序报错内存不足**  
  
****<table><tbody><tr style="height: 72px;"><td width="73" style="border-width: 1px;border-color: windowtext;padding: 0px 7px;" height="72"><section style="text-align: center;margin-left: 8px;margin-right: 8px;"><span style="font-family: 黑体;font-size: 15px;">问题名称</span></section></td><td width="457" style="border-top-width: 1px;border-right-width: 1px;border-bottom-width: 1px;border-left-style: none;border-top-color: windowtext;border-right-color: windowtext;border-bottom-color: windowtext;padding: 0px 7px;" height="72"><section style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;font-family: 仿宋_GB2312;">PLC远程控制任意I/O读写</span></section></td></tr><tr><td width="79" style="border-right-width: 1px;border-bottom-width: 1px;border-left-width: 1px;border-top-style: none;border-right-color: windowtext;border-bottom-color: windowtext;border-left-color: windowtext;padding: 0px 7px;"><section style="text-align: center;margin-left: 8px;margin-right: 8px;"><span style="font-family: 黑体;font-size: 15px;">检测工具</span></section></td><td width="457" style="border-top-style: none;border-left-style: none;border-bottom-width: 1px;border-bottom-color: windowtext;border-right-width: 1px;border-right-color: windowtext;padding: 0px 7px;"><section style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;font-family: 仿宋_GB2312;">Python发包脚本 wireshark</span></section></td></tr><tr style="height: 74px;"><td width="79" style="border-right-width: 1px;border-bottom-width: 1px;border-left-width: 1px;border-top-style: none;border-right-color: windowtext;border-bottom-color: windowtext;border-left-color: windowtext;padding: 0px 7px;" height="74"><section style="text-align: center;margin-left: 8px;margin-right: 8px;"><span style="font-family: 黑体;font-size: 15px;">问题描述</span></section></td><td width="457" style="border-top-style: none;border-left-style: none;border-bottom-width: 1px;border-bottom-color: windowtext;border-right-width: 1px;border-right-color: windowtext;padding: 0px 7px;" height="74"><section style="text-align: left;margin-left: 8px;margin-right: 8px;"><span style="font-family: 仿宋_GB2312;font-size: 15px;">当需要上载PLC程序时，经常提示内存不足，无法进行。</span></section></td></tr><tr><td width="79" style="border-right-width: 1px;border-bottom-width: 1px;border-left-width: 1px;border-top-style: none;border-right-color: windowtext;border-bottom-color: windowtext;border-left-color: windowtext;padding: 0px 7px;"><section style="text-align: center;margin-left: 8px;margin-right: 8px;"><span style="font-family: 黑体;font-size: 15px;">测试步骤描述</span></section></td><td width="457" style="border-top-style: none;border-left-style: none;border-bottom-width: 1px;border-bottom-color: windowtext;border-right-width: 1px;border-right-color: windowtext;padding: 0px 7px;"><section style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;font-family: 仿宋_GB2312;">1、将组态软件目录下的PLC_Config\Sample\灯板管理下载到PLC上，运行后取消监控，再上载，这时软件会发生内存不足异常，程序长时间无响应。如图：</span></section><section style="margin-left: 8px;margin-right: 8px;"><span style="font-family: 仿宋_GB2312;font-size: 15px;"><img class="rich_pages wxw-img" data-ratio="0.4966442953020134" data-src="https://mmbiz.qpic.cn/mmbiz_png/Gw8FuwXLJnQ9EwDdUHMdnGvT23W1QMbQSpxicfgLxxBtooIBkWHUXEuID7NIH5NcyKWgjRa5l947KictickyOYc0w/640?wx_fmt=png" data-type="png" data-w="894" height="206" width="415"/></span></section><section style="margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;font-family: 仿宋_GB2312;">2、此时无法获取PLC上运行程序。</span></section></td></tr><tr><td width="79" style="border-right-width: 1px;border-bottom-width: 1px;border-left-width: 1px;border-top-style: none;border-right-color: windowtext;border-bottom-color: windowtext;border-left-color: windowtext;padding: 0px 7px;"><section style="text-align: center;margin-left: 8px;margin-right: 8px;"><span style="font-family: 黑体;font-size: 15px;">其他说明</span></section></td><td width="457" style="border-top-style: none;border-left-style: none;border-bottom-width: 1px;border-bottom-color: windowtext;border-right-width: 1px;border-right-color: windowtext;padding: 0px 7px;word-break: break-all;"><br/></td></tr></tbody></table>  
   
  
