#  修复 Rsync 漏洞 CVE-2024-12084   
原创 ralap  网络个人修炼   2025-02-10 02:00  
  
Rsync 最近爆出一个重大漏洞（CVE-2024-12084），CVSS 评分为 9.8。该漏洞仅存在于 Rsync 3.2.7 和 3.3.0 版本中。为了解决这一安全问题，建议将 Rsync 升级到 3.4.0 或更高版本。当前最新版本为 3.4.1（官网链接https://rsync.samba.org/）。  
  
![](https://mmbiz.qpic.cn/mmbiz_png/5y2fUaoQPfLkpYMwibILLKUaauPRZdeYBWjfp5yTtgEF4d9VXQC45XfqfHhfJsViagbMlzBtvhfWT5RXXnzoMeXg/640?wx_fmt=png&from=appmsg "")  
  
![](https://mmbiz.qpic.cn/mmbiz_png/5y2fUaoQPfLkpYMwibILLKUaauPRZdeYBdnyNI7oTpcCUFNJlg4ibJvtVMFyHgke0HCrllGZwHHS3j7ibibhgdWoYg/640?wx_fmt=png&from=appmsg "")  
  
  
  
  
### 具体安装步骤  
#### 步骤一：下载并解压 Rsync 源码  
  
下载 Rsync 3.4.1 源代码：  
  
```
wget https://download.samba.org/pub/rsync/src/rsync-3.4.1.tar.gz
```  
  
```

```  
  
解压源代码：  
```
tar -zxvf rsync-3.4.1.tar.gz
```  
```
进入解压后的目录：
```  
```
cd rsync-3.4.1
```  
```

```  
#### 步骤二：配置、编译并安装  
  
创建安装目录：  
```
mkdir /usr/local/rsync
```  
```

```  
  
配置 Rsync：  
```
./configure --prefix=/usr/local/rsync
```  
```

```  
  
中间报错提示缺少xxhash-devel、libzstd-devel、lz4、lz4-devel、C编译器,阿里云源缺少相关组件，因此启用**启用 EPEL 仓库，安装依赖库**  
```
yum install epel-release -y
yum install xxhash-devel libzstd-devel lz4-devel gcc -y
```  
  
![](https://mmbiz.qpic.cn/mmbiz_png/5y2fUaoQPfLkpYMwibILLKUaauPRZdeYBZibbvpljHO3QmE3l7NVCwjBAOpH9ibHDQ3LvGZcNtBMTnAXPqoLUa6bA/640?wx_fmt=png&from=appmsg "")  
  
![](https://mmbiz.qpic.cn/mmbiz_png/5y2fUaoQPfKY2a9qQLv4TXmlbL71XibuRWcnicw891etWs4apAlqR5lxXxEDpAgdtiavicwXVQHm54jxuOwn11X9sw/640?wx_fmt=png&from=appmsg "")  
  
![](https://mmbiz.qpic.cn/mmbiz_png/5y2fUaoQPfKY2a9qQLv4TXmlbL71XibuRbYAwIWKIjFFOpClFkGVcW1k4r1eTh98xET02MIfWEA87WqvotBJu8Q/640?wx_fmt=png&from=appmsg "")  
  
  
安装完成后重新执行步骤2  
  
```
make && make install
```  
  
![](https://mmbiz.qpic.cn/mmbiz_png/5y2fUaoQPfLkpYMwibILLKUaauPRZdeYBqRKM6yB5WlPRgqZiaHyCD25evHkbhmribmRdECBXPxnC1HBQ3XoB1VAA/640?wx_fmt=png&from=appmsg "")  
```

```  
  
#### 步骤三：替换旧版本的 Rsync  
  
备份旧版本的 Rsync  
  
在替换旧版本之前，建议先备份现有的 Rsync 可执行文件：  
```
mv /usr/bin/rsync /usr/bin/rsync.old
```  
```

```  
  
创建符号链接指向新版本  
  
创建一个符号链接，使新的 Rsync 版本成为默认版本：  
```
ln -s /usr/local/rsync/bin/rsync /usr/bin/rsync
```  
```

```  
#### 步骤四：验证安装  
  
检查 Rsync 版本  
  
验证新版本是否已正确安装：  
```
rsync --version
```  
  
![](https://mmbiz.qpic.cn/mmbiz_png/5y2fUaoQPfKY2a9qQLv4TXmlbL71XibuRaiacm1A9brhNFZoDAners4ljGsVfsvWcaPiafOC0XC73GxGN8tkQiatcQ/640?wx_fmt=png&from=appmsg "")  
```

```  
  
参考链接：  
  
https://avd.aliyun.com/detail?id=AVD-2024-12084&timestamp__1384=WqjOY5YKiIeIxCqGNDQRenx0rXnEe%3DD8BUeD  
  
https://access.redhat.com/security/cve/CVE-2024-12084  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
