#  Linux 内核越界写入漏洞（CVE-2024-53104）   
 网安百色   2025-03-09 19:24  
  
 ![图片](https://mmbiz.qpic.cn/mmbiz_png/1QIbxKfhZo5lNbibXUkeIxDGJmD2Md5vK9ZGS15PBzhF8gRBMk6V7TXMVsSxyqn3vpLuXTg82nHzLRYicg7QtVJQ/640?wx_fmt=other&from=appmsg&wxfrom=5&wx_lazy=1&wx_co=1&tp=webp "")  
  
点击上方  
蓝字  
关注我们吧~  
  
![](https://mmbiz.qpic.cn/mmbiz_jpg/1QIbxKfhZo4QGclHDRibqicA75flEYLibAnaA270LwXRB5NUYxcuM0WkK6slzmY82ITEe6VLDzFeIRia2jWU7Q3nrA/640?wx_fmt=jpeg&from=appmsg "")  
  
  
近日，一个针对 Linux 内核的高危 越界写入（out-of-bounds write） 漏洞（CVE-2024-53104）的概念验证（PoC）漏洞利用代码已被公开。该漏洞存在于 USB 视频类（UVC）驱动程序 中，可能导致 权限提升（Privilege Escalation）。  
### 漏洞详情  
  
该漏洞源于 函数 uvc_parse_format 在解析 UVC_VS_UNDEFINED 帧时处理不当。由于计算缓冲区大小时出现错误，可能导致 越界写入（out-of-bounds write），进而影响系统安全。  
  
攻击者可通过插入恶意 USB 设备或操控视频流来触发缓冲区溢出，进而覆盖相邻的内存区域。  
  
一旦成功利用该漏洞，攻击者可修改内核内存，可能导致系统不稳定、权限提升，甚至执行任意代码。  
### PoC 漏洞利用代码已发布  
  
该漏洞位于 UVC 驱动程序文件 uvc_driver.c 的 uvc_parse_format 函数中。漏洞的成因是驱动程序未能正确跳过格式错误的 UVC_VS_UNDEFINED 帧，导致 uvc_parse_streaming 中的缓冲区分配错误，最终可能引发 内存损坏（Memory Corruption）。  
  
补丁发布前，while 循环解析帧描述符时未正确验证 ftype 值，导致即使 ftype 为 0（即 UVC_VS_UNDEFINED 类型），循环仍会执行，从而计算出错误的帧缓冲区大小，并引发越界写入问题。  
  
修复措施：补丁添加了一个检查条件，确保 while 循环只有在 ftype 非零 时才会继续解析帧描述符。这样可以防止解析未定义的帧格式，从而避免越界写入问题。  
### 缓解措施  
  
该漏洞的 CVSS 评分为 7.8（高危）。目前，Google 已发布补丁 修复该漏洞，并在 Android 系统中应用了相关安全更新。  
  
此外，美国网络安全和基础设施安全局（CISA） 已将该漏洞添加到已知被利用的漏洞（KEV）列表，并要求联邦机构在三周内完成补丁更新。  
  
建议所有用户尽快更新 Linux 发行版提供的最新安全补丁，以降低漏洞被利用的风险，确保系统安全。  
  
受影响的 Linux 内核版本从 2.6.26 及更高版本。应用补丁可有效降低漏洞利用风险。  
  
为提升长期安全性，建议采取多层防御措施，例如审查 USB 设备使用策略，并部署监控工具，防范潜在攻击。  
  
**免责声明**  
：  
  
本公众号所载文章为本公众号原创或根据网络搜索下载编辑整理，文章版权归原作者所有，仅供读者学习、参考，禁止用于商业用途。因转载众多，无法找到真正来源，如标错来源，或对于文中所使用的图片、文字、链接中所包含的软件/资料等，如有侵权，请跟我们联系删除，谢谢！  
  
![图片](https://mmbiz.qpic.cn/mmbiz_jpg/1QIbxKfhZo5lNbibXUkeIxDGJmD2Md5vKicbNtIkdNvibicL87FjAOqGicuxcgBuRjjolLcGDOnfhMdykXibWuH6DV1g/640?wx_fmt=other&from=appmsg&wxfrom=5&wx_lazy=1&wx_co=1&tp=webp "")  
  
