#  【漏洞通告】Next.js中间件权限绕过漏洞（CVE-2025-29927）   
原创 NS-CERT  绿盟科技CERT   2025-03-24 18:17  
  
**通告编号:NS-2025-0015**  
  
2025-03-24  
  
<table><tbody><tr><td style="margin: 5px 10px;border-color: rgb(216, 216, 216);word-break: break-all;" valign="top"><strong><span style="font-size: 14px;">TA</span></strong><strong><span style="font-size: 14px;">G：</span></strong></td><td style="margin: 5px 10px;border-color: rgb(216, 216, 216);word-break: break-all;" valign="top"><p style="vertical-align: inherit;line-height: 1.75em;font-size: 14px;color: rgb(0, 0, 0);font-family: 微软雅黑;"><strong style="caret-color: red;line-height: 1.57em;font-family:微软雅黑, &#34;Microsoft YaHei&#34;;">Next.js、权限绕过、CVE-2025-29927</strong></p></td></tr><tr><td style="margin: 5px 10px;border-color: rgb(216, 216, 216);word-break: break-all;" valign="top"><span style="color: rgb(0, 0, 0);"><strong><span style="font-size: 14px;">漏洞危害：</span></strong></span><span style="color: rgb(255, 0, 0);"><strong><span style="font-size: 14px;"></span></strong></span></td><td style="margin: 5px 10px;border-color: rgb(216, 216, 216);word-break: break-all;" valign="top"><p><strong style="caret-color: red;font-size: 14px;line-height: 1.57em;font-family:微软雅黑, &#34;Microsoft YaHei&#34;;">攻击者利用此漏洞，可实现权限绕过。 </strong></p></td></tr><tr><td style="margin: 5px 10px;border-color: rgb(216, 216, 216);word-break: break-all;" valign="top"><strong><span style="font-size: 14px;">版本：</span></strong></td><td style="margin: 5px 10px;border-color: rgb(216, 216, 216);word-break: break-all;" valign="top"><strong><span style="font-size: 14px;">1.0<br/></span></strong></td></tr></tbody></table>  
  
**1**  
  
  
**漏洞概述**  
  
  
近日，绿盟科技CERT监测到Next.js发布安全公告，修复了Next.js中间件权限绕过漏洞（CVE-2025-29927）；由于Next.js对x-middleware-subrequest标头的来源缺乏有效校验，当配置使用中间件进行身份验证和授权时，未经身份验证的攻击者可通过操作x-middleware-subrequest请求头绕过系统权限控制，从而访问目标的受保护资源。目前漏洞细节与PoC已公开，请相关用户尽快采取措施进行防护。  
  
Next.js是Node.js生态中基于React的开源Web框架，其通过Server Actions功能提供了后端开发能力。  
  
绿盟科技已成功复现此漏洞：  
  
![image.png](https://mmbiz.qpic.cn/mmbiz_png/VvfsuOanecpUMlDQg7nicNuiavnZmfvL4bfbxpnaoZwK96P1qMNSJBFam4LmwfoqBJCZVUTeswpQAwwZlNxbLJhQ/640?wx_fmt=png&from=appmsg "")  
  
![image.png](https://mmbiz.qpic.cn/mmbiz_png/VvfsuOanecpUMlDQg7nicNuiavnZmfvL4bhXibrI5z2pzloSKibQiayxOia6IJvogXUYr95FbMoup8FTLicUYxWoKJ5xA/640?wx_fmt=png&from=appmsg "")  
  
参考链接：  
  
https://github.com/vercel/next.js/security/advisories/GHSA-f82v-jwr5-mffw  
  
  
**SEE MORE →******  
  
**2****影响范围**  
  
**受影响版本：**  
  
- 11.1.4 <= Next.js <= 13.5.6    
  
- 14.0.0 <= Next.js <= 14.2.24    
  
- 15.0.0 <= Next.js <= 15.2.2  
  
  
  
  
**不受影响版本：**  
  
- Next.js = 12.3.5  
  
- Next.js >= 13.5.9  
  
- Next.js >= 14.2.25  
  
- Next.js >= 15.2.3  
  
  
  
  
**3****暴露面风险排查**  
  
**3.1 云端检测**  
  
绿盟科技外部攻击面管理服务（EASM）支持CVE-2025-29927漏洞风险的互联网资产排查，目前已帮助服务客户群体完成了暴露面排查，在威胁发生前及时进行漏洞预警与闭环处置。  
  
![image.png](https://mmbiz.qpic.cn/mmbiz_png/VvfsuOanecpUMlDQg7nicNuiavnZmfvL4bzp9icp0enx0gictPDq9rh9ulBem2MJO6cunDO4ciaVcfZ9qlgQakvD0Xw/640?wx_fmt=png&from=appmsg "")  
  
感兴趣的客户可通过联系绿盟当地区域同事或发送邮件至rs@nsfocus.com安排详细的咨询交流。  
  
![image.png](https://mmbiz.qpic.cn/mmbiz_png/VvfsuOanecpUMlDQg7nicNuiavnZmfvL4bLdIvTician1VMBfvegrbiaA473nRtaJJSb4qTialSKia6tWCkKqxFZqLoCw/640?wx_fmt=png&from=appmsg "")  
  
**3.2 本地排查**  
  
绿盟科技自动化渗透测试工具（EZ）支持Next.js应用的指纹识别，可直接使用web模块进行扫描检测。  
  
工具下载链接：https://github.com/m-sec-org/EZ/releases  
  
 新用户请注册M-SEC社区（https://msec.nsfocus.com）申请证书进行使用：  
  
![image.png](https://mmbiz.qpic.cn/mmbiz_png/VvfsuOanecpUMlDQg7nicNuiavnZmfvL4bruux1ZiaiaAwg5MnEPo3v2qIaaicvCNc3JHI20BibI2002CIGcTegGePJA/640?wx_fmt=png&from=appmsg "")  
  
**4****漏洞防护**  
  
**4.1 官方升级**  
  
目前官方已发布新版本修复此漏洞，请受影响的用户尽快升级防护，下载链接：https://github.com/vercel/next.js/releases  
  
**4.2 临时防护措施**  
  
若相关用户暂时无法进行升级操作，也可通过拦截包含x-middleware-subrequest标头的请求进行临时缓解。  
  
  
**END**  
  
![](https://mmbiz.qpic.cn/mmbiz_png/qR4ORTNELImFwJM2rh6GKbnrurdFA28jJ8chUPyC1U6aW3jhenqEiaXkmeGVmfOnvAJy8j3My901JQ7emHaicYzA/640?wx_fmt=png "")  
           
  
![](https://mmbiz.qpic.cn/mmbiz_jpg/qR4ORTNELImFwJM2rh6GKbnrurdFA28jib7icfic0lJJHh3eLRpIXiaia08KqOSEibBsz64vlOH9aqicu3lmjccEeAFWQ/640?wx_fmt=jpeg "")  
          
  
**声明**  
  
本安全公告仅用来描述可能存在的安全问题，绿盟科技不为此安全公告提供任何保证或承诺。由于传播、利用此安全公告所提供的信息而造成的任何直接或者间接的后果及损失，均由使用者本人负责，绿盟科技以及安全公告作者不为此承担任何责任。              
  
绿盟科技拥有对此安全公告的修改和解释权。如欲转载或传播此安全公告，必须保证此安全公告的完整性，包括版权声明等全部内容。未经绿盟科技允许，不得任意修改或者增减此安全公告内容，不得以任何方式将其用于商业目的。              
  
![](https://mmbiz.qpic.cn/mmbiz_jpg/qR4ORTNELImFwJM2rh6GKbnrurdFA28jib7icfic0lJJHh3eLRpIXiaia08KqOSEibBsz64vlOH9aqicu3lmjccEeAFWQ/640?wx_fmt=jpeg "")  
  
  
**绿盟科技CERT**  
****  
∣  
微信公众号  
  
![绿盟科技CERT公众号.jpg](https://mmbiz.qpic.cn/mmbiz_jpg/VvfsuOanecpUMlDQg7nicNuiavnZmfvL4bIWedicI9BYFXIY3fwPmeicX1yItWMibGiacf0KTDdhWWcgcvibgy5SLJAEA/640?wx_fmt=jpeg&from=appmsg "绿盟科技CERT公众号.jpg")  
  
![](https://mmbiz.qpic.cn/mmbiz/Hu8hctxHqSW0nSJn8p8OHVEQwHicSwTibFJMBE650AxdzfISoeY8woe2QsgCINIBrccBOOUft2HuU0GsNQWibSG7g/640?wx_fmt=png "")  
  
长按识别二维码，关注网络安全威胁信息  
  
