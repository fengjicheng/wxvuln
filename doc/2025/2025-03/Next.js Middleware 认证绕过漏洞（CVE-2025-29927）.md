#  Next.js Middleware 认证绕过漏洞（CVE-2025-29927）   
深瞳漏洞实验室  深信服千里目安全技术中心   2025-03-24 17:06  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/w8NHw6tcQ5zOlv8XzVDz8dztubOL9KBjAskX2e0uWFGE3icrguDZttFAq6636vvVsSPOp7R9RjU1GIicKswca5qA/640?wx_fmt=gif&from=appmsg "")  
  
**漏洞名称：**  
  
Next.js Middleware 认证绕过漏洞（CVE-2025-29927）  
  
**组件名称：**  
  
Next.js  
  
**影响范围：**  
  
11.1.4 < Next.js ≤ 13.5.614.0 < Next.js < 14.2.2515.0 < Next.js < 15.2.3  
  
**漏洞类型：**  
  
绕过认证  
  
**利用条件：**  
  
1、用户认证：不需要用户认证  
  
2、前置条件：默认配置  
  
3、触发方式：远程  
  
**综合评价：**  
  
<综合评定利用难度>：容易，能造成认证绕过。  
  
<综合评定威胁等级>：高危，能导致未授权操作。  
  
**官方解决方案：**  
  
已发布  
  
  
  
  
**漏洞分析**  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/w8NHw6tcQ5zOlv8XzVDz8dztubOL9KBjibrrPXjoDvH4fadRlicnHibiaFjJtOPfHGlCVuM1cR15qRZJ8bbe3chwpQ/640?wx_fmt=gif&from=appmsg "")  
  
**组件介绍**  
  
Next.js 是一个基于 React 的开源框架，旨在为开发者提供构建高性能、可扩展的 Web 应用程序的工具。  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/w8NHw6tcQ5zOlv8XzVDz8dztubOL9KBjibrrPXjoDvH4fadRlicnHibiaFjJtOPfHGlCVuM1cR15qRZJ8bbe3chwpQ/640?wx_fmt=gif&from=appmsg "")  
  
**漏洞简介**  
  
2025年3月24日，深瞳漏洞实验室监测到一则NextJS组件存在绕过认证漏洞的信息，漏洞编号：CVE-2025-29927，漏洞威胁等级：高危。  
  
  
Next.js 的middleware存在一个认证绕过漏洞，**如果授权检查发生在middleware中，则可以在Next.js应用程序中绕过授权检查，导致数据泄露、未经授权的操作和服务中断。**  
  
  
**影响范围**  
  
目前受影响的NextJS版本：  
  
11.1.4 < Next.js ≤ 13.5.614.0 < Next.js < 14.2.2515.0 < Next.js < 15.2.3  
  
  
**解决方案**  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/w8NHw6tcQ5zOlv8XzVDz8dztubOL9KBjibrrPXjoDvH4fadRlicnHibiaFjJtOPfHGlCVuM1cR15qRZJ8bbe3chwpQ/640?wx_fmt=gif&from=appmsg "")  
  
**漏洞验证**  
  
深瞳漏洞实验室已复现该漏洞，效果如下：  
  
![](https://mmbiz.qpic.cn/mmbiz_png/w8NHw6tcQ5zOlv8XzVDz8dztubOL9KBjf93TMYOfvPAJ6FYtPfWr2tbSxwod3f2LtOd2MvUsjicP2hTtynamnNA/640?wx_fmt=png&from=appmsg "")  
  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/w8NHw6tcQ5zOlv8XzVDz8dztubOL9KBjibrrPXjoDvH4fadRlicnHibiaFjJtOPfHGlCVuM1cR15qRZJ8bbe3chwpQ/640?wx_fmt=gif&from=appmsg "")  
  
**如何检测组件系统版本**  
  
在项目根目录的终端或命令提示符中，运行以下命令查看版本：  
  
npx next -v  
  
![](https://mmbiz.qpic.cn/mmbiz_png/w8NHw6tcQ5zOlv8XzVDz8dztubOL9KBjRNna4qAWjteeZr6XyUhPfhMv6jxVeNwtWFbPe9bP6ysfs4wDzaibhGw/640?wx_fmt=png&from=appmsg "")  
  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/w8NHw6tcQ5zOlv8XzVDz8dztubOL9KBjibrrPXjoDvH4fadRlicnHibiaFjJtOPfHGlCVuM1cR15qRZJ8bbe3chwpQ/640?wx_fmt=gif&from=appmsg "")  
  
**临时修复建议**  
  
阻止包含 x-middleware-subrequest 标头的外部用户请求到达 Next.js 应用程序。  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/w8NHw6tcQ5zOlv8XzVDz8dztubOL9KBjibrrPXjoDvH4fadRlicnHibiaFjJtOPfHGlCVuM1cR15qRZJ8bbe3chwpQ/640?wx_fmt=gif&from=appmsg "")  
  
**官方修复建议**  
  
官方已发布最新版本修复该漏洞，建议受影响用户将NextJs更新到以下版本：Next.js 14.2.25Next.js 15.2.3下载链接：https://github.com/vercel/next.js/releases  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/w8NHw6tcQ5zOlv8XzVDz8dztubOL9KBjibrrPXjoDvH4fadRlicnHibiaFjJtOPfHGlCVuM1cR15qRZJ8bbe3chwpQ/640?wx_fmt=gif&from=appmsg "")  
  
**深信服解决方案**  
  
**1、风险资产发现**  
  
支持对NextJS的主动检测，可批量检出业务场景中该事件的  
**受影响资产**情况，相关产品如下：  
  
**【深信服云镜YJ】** 已发布资产检测方案，指纹ID:0031703。  
  
**【深信服漏洞评估工具TSS】**已发布资产检测方案，指纹ID:0031703。  
  
**2、漏洞主动检测**  
  
支持对Next.js Middleware 认证绕过漏洞(CVE-2025-29927)的主动检测，可批量快速检出业务场景中是否存在  
**漏洞风险**，相关产品如下：  
  
**【深信服云镜YJ】**预计2025年03月31日发布检测方案，规则ID:SF-2025-00242。  
  
**【深信服漏洞评估工具TSS】**预计2025年03月30日发布检测方案，规则ID:SF-2025-00241。  
  
**【深信服安全托管服务MSS】**预计2025年03月30日发布检测方案（需要具备TSS组件能力），规则ID:SF-2025-00241。  
  
**【深信服安全检测与响应平台XDR】**预计2025年03月31日发布检测方案（需要具备云镜组件能力），规则ID:SF-2025-00242。  
  
**3、漏洞安全监测**  
  
支持对Next.js Middleware 认证绕过漏洞(CVE-2025-29927)的监测，可依据流量收集实时监控业务场景中的  
**受影响资产情况，快速检查受影响范围，**相关产品及服务如下：  
  
**【深信服安全感知管理平台SIP】**预计2025年04月03日发布监测方案，规则ID:11027468。  
  
**【深信服安全托管服务MSS】**预计2025年04月03日发布监测方案（需要具备SIP组件能力），规则ID:11027468。  
  
**【深信服安全检测与响应平台XDR】**预计2025年04月03日发布监测方案，规则ID:11027468。  
  
**4、漏洞安全防护**  
  
支持对Next.js Middleware 认证绕过漏洞(CVE-2025-29927)的防御，  
**可阻断攻击者针对该事件的入侵行为**，相关产品及服务如下：  
  
**【深信服下一代防火墙AF】**预计2025年04月03日发布防护方案，规则ID:11027468。  
  
**【深信服Web应用防火墙WAF】**预计2025年04月03日发布防护方案，规则ID:11027468。  
  
**【深信服安全托管服务MSS】**预计2025年04月03日发布防护方案（需要具备AF组件能力），规则ID:11027468。  
  
**【深信服安全检测与响应平台XDR】**预计2025年04月03日发布防护方案（需要具备AF组件能力），规则ID:11027468。  
  
  
  
**参考链接**  
  
https://github.com/vercel/next.js/security/advisories/GHSA-f82v-jwr5-mffw  
  
https://github.com/vercel/next.js/pull/77201  
  
  
**时间轴**  
  
  
  
**2025/3/24**  
  
深瞳漏洞实验室监测到Next.js Middleware 认证绕过漏洞信息。  
  
  
**2025/3/24**  
  
深瞳漏洞实验室发布漏洞通告。  
  
  
点击**阅读原文**，及时关注并登录深信服**智安全平台**，可轻松查询漏洞相关解决方案。  
  
![](https://mmbiz.qpic.cn/mmbiz_png/w8NHw6tcQ5zOlv8XzVDz8dztubOL9KBj0a90GGaJ3LbPdD25F79r9UJjk8hZMiaKSZsHibSfFHCDl2uuicM6lllzw/640?wx_fmt=png&from=appmsg "")  
  
![](https://mmbiz.qpic.cn/mmbiz_jpg/w8NHw6tcQ5zvcIHbwGGYKbqDVYsVKzNNia1jYtHf49C7133AlDXAgex2W4lFvpia56tjQQDkiauNBrl08YbxqG01A/640?wx_fmt=jpeg&from=appmsg "")  
  
  
