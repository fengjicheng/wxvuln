#  当风云卫拥抱DeepSeek发生了哪些？ --从漏洞验证到自动修复的优化之路   
原创 创新研究院  绿盟科技研究通讯   2025-03-07 19:28  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/hiayDdhDbxUYMAwo0X2e7jSicRpJz5TUV5MSAwj2vPqfNdRrEHzDGhp6gNKFxEv4a36mic2Mam45UlpR4eibiaa9icyg/640?wx_fmt=gif&from=appmsg "")  
  
  
  
一.  前言  
  
  
  
  
  
  
  
  
  
  
近期，Deepseek-R1[1]凭借在多项核心评测基准中的优异表现，尤其是在代码层面，展现出了强大的推理能力和高效的性能，能够有效支持开发者完成复杂的编程任务。那么，Deepseek-R1是否会给代码审计带来智能化变革呢？  
  
本文将聚焦于静态代码审计的安全场景，通过对DeepSeek-R1能力实测，分析背后技术内核，探索Deepseek-R1在代码审计中的潜力。本文将探讨如何将其推理能力内化，帮助识别复杂的代码审计问题，从而提升代码审计的准确性。  
  
  
二.  代码审计能力实测  
  
  
  
  
  
  
  
  
  
  
本次对比实测风云卫大模型和DeepSeek-R1满血版。风云卫大模型为绿盟发布的安全行业大模型。  
  
2.1  
  
测试方法  
  
为了确保对两款模型在代码审计方面表现的公平且精确对比，本文进行了三次独立实验。在每次实验中，我们使用了125条精选的测试代码片段（这些代码片段经过人工构造并进行审查）。其中，约60%的代码片段包含了常见的TOP25 CWE（Common Weakness Enumeration）漏洞。为了避免网络请求波动对DeepSeek-R1分析结果的干扰，三次独立实验的设计最大限度地消除了潜在的干扰因素，从而确保了分析结果的稳定性和可靠性。  
  
  
2.2  
  
测试指标  
  
在实际的源代码安全审计场景中，静态代码安全测试工具（SAST）常用于对源代码进行安全扫描，识别代码中可能存在的安全问题或漏洞。图1展示了静态扫描工具的漏报。  
  
![](https://mmbiz.qpic.cn/mmbiz_png/hiayDdhDbxUYMAwo0X2e7jSicRpJz5TUV5Xdduuu1dyp6qqJoRSTWLBZhWWFfibOxrIKxq5LuY44QxKCMS1f1rWYg/640?wx_fmt=png&from=appmsg "")  
  
图1 静态扫描工具漏洞报告  
  
为精确评估模型在源代码漏洞识别方面的能力，我们定义了四个关键度量标准[2]：  
  
可解析的GPT输出计数：检查模型是否能提取并解析JSON结构，至少包含“findings”键，即使内容为空或存在错误结构。如果JSON格式不正确，则需要进行人工校验。  
  
CWE字段标记为“Present”但源代码错误：若模型列出正确的CWE编号，但未识别出漏洞代码行，视为错误。  
  
CWE标记为“Present”且包含部分漏洞代码：若CWE正确，且部分漏洞代码被识别，但仍包含无关代码，视为部分正确。  
  
完全正确的实例计数：CWE正确且漏洞代码行被准确识别，视为理想结果。  
  
模型响应质量分类如下：  
  
有效 (I)：准确识别漏洞类型，且漏洞代码仅包含有效漏洞片段。  
  
有帮助 (H)：识别了正确漏洞类型，但漏洞代码包含无关代码。  
  
误导 (M)：识别了正确漏洞类型，但漏洞代码识别错误。  
  
不确定 (U)：未识别漏洞或错误识别为其他类型。  
  
![](https://mmbiz.qpic.cn/mmbiz_png/hiayDdhDbxUYMAwo0X2e7jSicRpJz5TUV52NNF9xs5kqRlWRAZ3FVJyiaN5I4gv59KtBch69MNSvU9sIHSreWyKBw/640?wx_fmt=png&from=appmsg "")  
  
因此，我们可以根据以下CWE判别指标来进一步评估模型的效果：  
  
较高的I-Score和IH-Score表明模型在检测安全缺陷能力更强。因IH-Score的值大于I-Score，本文主要以IH-Score进行指标对比。  
  
此外，使用准确率来表示模型对某类CWE漏洞的识别能力。  
  
  
2.3  
  
测试结果  
  
本次实验共包含125个测试样本，每个样本测试三次，理论上应产生375个扫描结果。实验结果图2所示，微调后的风云卫表现出色，其最优的IH-Score达到了49.87%，且对提示词的变化表现出最高的稳定性。这一优势主要归功于风云卫在专业漏洞分析数据上的精细化微调。而作为推理型大模型的DeepSeek-R1，在少样本增强提示词的帮助下，也取得了42.75%的识别率，展现了其强大的深度推理能力。这个结果证明，尽管DeepSeek-R1没有经过专门的漏洞代码数据微调，它依然能够在多种任务中保持较高的性能。  
  
![](https://mmbiz.qpic.cn/mmbiz_png/hiayDdhDbxUYMAwo0X2e7jSicRpJz5TUV5MPYuyLrVtdAlvXolJ2CK0qF8CNkClLn8ic9EzDzeKnqGo4EKSSZJR8g/640?wx_fmt=png&from=appmsg "")  
  
图2 风云卫与DeepSeeK-R1 IH-score测试结果  
  
图3展示了在最优提示词条件下，风云卫与DeepSeek-R1在微调前后对各种CWE漏洞识别表现的对比。风云卫在漏洞分析微调前，能够识别的CWE漏洞不到50%。这可能是因为基座模型在安全预训练过程中使用的数据存在偏向性和噪音问题。为了弥补这一不足，公司利用自有安全产品积累和海量安全数据构建了高质量的漏洞代码分析数据。在进行专业漏洞分析数据训练后，风云卫大模型在漏洞识别方面表现卓越，几乎能够识别所有CWE漏洞，并显著提高了识别的准确率。例如，经过微调后的风云卫模型，成功识别了之前无法检测的CWE-276（不正确的默认权限）和CWE-269（权限管理不当）等漏洞，并且在常见的语义漏洞CWE-89（SQL注入）上达到了100%的识别率。微调后的风云卫在各项漏洞识别任务中的整体表现大幅优于微调前，进一步验证了通过安全领域指令微调数据提升大模型性能的有效性。  
  
  
![](https://mmbiz.qpic.cn/mmbiz_png/hiayDdhDbxUYMAwo0X2e7jSicRpJz5TUV5K5HqHHmJBpVxoFiawbxicgvNMx18CrcFictcARgfoLu2ss2zNYMpEpouQ/640?wx_fmt=png&from=appmsg "")  
  
图3 风云卫与DeepSeek-R1各CWE识别准确率  
  
另一方面，DeepSeek-R1在一些高级漏洞识别任务中展现出了更强的优势，特别是在CWE-22（路径遍历）、CWE-918（服务器端请求伪造）和CWE-362（竞态条件）的识别上，表现优于微调后的风云卫模型。例如，CWE-362，竞态条件漏洞，是一种复杂的安全漏洞，通常发生在多线程或多进程环境中，当多个线程或进程竞争访问共享资源时，可能导致系统行为不稳定或不可预测。此类漏洞的识别要求对程序的整体结构进行深度推理，分析并发操作对资源的影响。DeepSeek-R1凭借其强大的推理能力，在处理此类问题时展现出明显优势，能够精准地识别和预测多线程操作中潜在的竞态条件。然而，风云卫大模型在处理这类高级漏洞时仍有提升空间，未来需要加强对并发程序和复杂交互的分析能力，以更好地应对竞态条件等挑战。  
  
尽管风云卫在整体漏洞识别率上优于DeepSeek-R1，但后者凭借其强大的推理能力，在高级漏洞检测方面表现突出。总体而言，DeepSeek-R1展现了作为推理型大模型的强大潜力，能够在多种漏洞检测任务中保持较高的识别准确度。  
  
传统的静态代码分析主要依赖于抽象语法树（AST）或构建函数调用图，通过规则匹配进行漏洞识别。而当前主流的大语言模型则通过CWE漏洞定义的语义进行漏洞识别。总体来看，相比传统的静态扫描工具，大语言模型在代码审计中提供了更高的覆盖率，但也带来了更高的误报率。尤其在识别漏洞类型和CWE编号时，容易出现幻觉问题（hallucination）。此外，大模型还受到上下文长度的限制，这使得如何实现项目级别的全面代码审计成为了业界亟待解决的重要研究方向。  
  
  
  
三.  代码审计智能体  
  
  
  
  
  
  
  
  
  
  
3.1  
  
AST优化代码审计  
  
风云卫的代码审计能力源自双重技术路径：在预训练阶段，模型通过海量企业级安全数据构建漏洞模式认知；在微调阶段，则深度融合抽象语法树（AST）的节点追踪与上下文敏感分析，将程序化审计逻辑编码至检测框架中。这种从原始安全语料到结构化语法特征的递进式训练策略，使得模型既能理解代码的语义意图，又能通过AST路径解析精准定位潜在漏洞的触发边界，为自动化审计提供双重验证机制。  
  
![](https://mmbiz.qpic.cn/mmbiz_png/hiayDdhDbxUYMAwo0X2e7jSicRpJz5TUV5aDKJ76b80Mae6H8plZtEU3SBmvlrZjqmhB7NT9AgjibibibMNVQ9GHXhw/640?wx_fmt=png&from=appmsg "")  
  
图4 风云卫安全智能体平台  
  
  
图4展示了由天枢实验室建立的智能体平台，根据各种安全场景需求，快速构建了多种适配安全业务的智能体，其风云卫代码审计能力已被集成到代码审计智能体2.0应用中。在该智能体平台上，除了代码审计外，还支持对流量监控、敏感信息检测、网页挂马检测、代码泄露发现等其他安全智能体。绿盟致力于打造全球领先的安全智能体平台，推动安全技术的持续创新和应用。接下来，将重点介绍代码审计智能体，其他智能体的详细介绍请关注绿盟的企业公众号，以获取更多更新和相关信息。  
  
代码审计智能体2.0中，主要包含了代码审计、代码漏洞修复、与源码静态工具融合判断三个子功能。  
  
**代码审计:**  
图5展示了在智能体中，风云卫如何融合抽象语法树（AST）分析。风云卫通过AST和语义分析，给出了更加符合代码语义场景的CWE-95（eval函数执行，CWE-95典型例子）。  
  
![](https://mmbiz.qpic.cn/mmbiz_png/hiayDdhDbxUYMAwo0X2e7jSicRpJz5TUV5CxSIZA0Bl3dicicpTTXgcvT8ic9X3o9mJT0jQAiayMRraQYelCeY6ZaE8w/640?wx_fmt=png&from=appmsg "")  
  
图5 代码审计智能体2.0-代码审计子功能  
  
**代码漏洞修复：**  
在进行代码审计时，如果发现漏洞，系统将自动进行修复。图6 展示了一个漏洞修复后的代码示例。  
  
![](https://mmbiz.qpic.cn/mmbiz_png/hiayDdhDbxUYMAwo0X2e7jSicRpJz5TUV5B1mUmGbH8g40d2RRgk674x0UKUUbgK2NgdPm1TKM82aCdndrlpECgg/640?wx_fmt=png&from=appmsg "")  
  
图6 代码审计智能体2.0-代码修复子功能  
  
  
**与源码静态工具融合:**  
风云卫不仅能够独立发挥作用，还可以与公司多款产品实现深度联动，通过综合研判，释放出更大的潜力，创造出超越简单叠加的价值。例如，图7展示了风云卫与静态分析工具结合的案例。通过这种联动，风云卫能够将大模型与传统工具的优势互补，同时弥补各自的不足，从而提升整体效能。这种协同创新的方式，不仅提高了工具的实用性，也为用户带来了更高效的解决方案。  
  
![](https://mmbiz.qpic.cn/mmbiz_png/hiayDdhDbxUYMAwo0X2e7jSicRpJz5TUV5ribcHlvW6wozputYexZOHGQcJftpGKq5zyOCPwPd9ju4GRrzR3DJfRQ/640?wx_fmt=png&from=appmsg "")  
  
图7 代码审计智能体2.0-与源代码静态工具融合分析  
  
3.2  
  
推理模型有望推动代码审计深度优化  
  
DeepSeek-R1通过强化学习框架重构了代码审计的认知路径。该模型创新性地引入思维链可视化机制，在漏洞分析过程中完整呈现推理步骤，不仅为安全人员提供可验证的分析路径，其动态生成的决策日志更形成高质量反哺数据流，持续优化模型对复杂漏洞模式的捕获能力。  
  
![](https://mmbiz.qpic.cn/mmbiz_png/hiayDdhDbxUYMAwo0X2e7jSicRpJz5TUV5Hs3uvmKF0UjWCzoxMkicP7zIJTK8Oib0RzE8JbTcodzBMlcToJGrPYvQ/640?wx_fmt=png&from=appmsg "")  
  
图8 DeepSeek-R1代码审计分析深度思考流程  
  
风云卫通过对漏洞分析数据进行微调来提升性能，而DeepSeek-R1则通过强化学习显著优化效果。作为一个推理型大模型，DeepSeek-R1在安全领域，特别是在代码审计这一垂直应用中，展现出了令人惊艳的表现。如果能将 DeepSeek-R1 的推理强化学习策略与漏洞分析能力数据相结合，并融入现有的代码审计智能体，同时结合安全程序分析进行针对性微调，必将进一步提升大模型在代码安全领域的能力，实现更精准的漏洞检测与智能修复。  
  
3.3  
  
运行性能与优化方向  
  
作为当前备受关注的开源模型，DeepSeek-R1 在代码审计场景中展现了强大的推理能力，但也带来了较高的计算资源消耗。实测数据显示，在4K 代码段范围内，DeepSeek-R1 的漏洞分析平均耗时 0.5-2 分钟，而 绿盟风云卫 在相同硬件环境下的响应速度可达其 5 倍以上。在实际企业级应用中，面对庞大的工程代码规模，DeepSeek-R1 的计算开销可能成为部署的瓶颈。  
  
未来，我们计划进一步优化代码审计智能体，将 DeepSeek-R1 的推理能力与 AST 语法树解析、函数调用图构建、跨文件污点追踪等技术相结合，增强其对复杂代码结构的理解能力。同时，结合 绿盟SDA静态分析产品，利用现有规则库和快速筛查机制，减少大模型的计算负担，从而提升代码审计的整体运行效率。在融合 DeepSeek-R1 推理能力的过程中，我们还将重点优化推理路径裁剪、任务分层执行、缓存复用等机制，确保大模型的高效执行，使其能更好地适应企业级安全需求。  
  
  
四.   
后记和展望  
  
  
  
  
  
  
  
  
  
  
本次评测对比了 DeepSeek-R1 和 风云卫 在代码审计任务中的表现，分析了两者在漏洞识别、推理能力和审计效率上的差异。DeepSeek-R1 作为推理型大模型，在语义理解、少样本泛化和推理能力方面展现了优势，而风云卫依托专业安全数据的预训练和微调，在特定安全场景下具备更精准的漏洞检测能力。在第三节中，详细介绍了基于风云卫大模型代码审计能力打造的“代码审计智能体2.0”，并深入剖析了 DeepSeek-R1 的推理机制。未来，我们将把 DeepSeek-R1 的推理能力与多种安全程序分析方法深度融合，并结合传统的绿盟SDA产品分析规则，全面提升漏洞检测的准确性及效率。  
  
未来，绿盟天枢实验室将继续推进代码审计智能体的升级，拓展从函数级漏洞检测到仓库级漏洞分析的能力，重点突破跨文件逻辑追踪、全局风险链路识别，并结合污点传播和数据流分析优化漏洞检测逻辑。我们将采用多专家协作机制，结合推理模型、规则引擎、知识增强等手段，降低误报率，提升检测准确性，并进一步优化模型架构和定制化微调，使其更契合企业级安全需求，为智能化代码安全审计提供更强的技术支撑。  
  
参考文献  
  
   
  
[1]Forrest Bao,Chenyu Xu,Ofer Mendelevitch. DeepSeek-R1 hallucinates more than DeepSeek-V3, 2025[Z/OL]. (2025). https://www.vectara.com/blog/deepseek-r1-hallucinates-more-than-deepseek-v3.  
  
[2]Pelofske E, Urias V, Liebrock L M. Automated Software Vulnerability Static Code Analysis Using Generative Pre-Trained Transformer Models[J]. arXiv preprint arXiv:2408.00197, 2024.  
  
[3]Yu J, Liang P, Fu Y, et al. Security code review by llms: A deep dive into responses[J]. arXiv preprint arXiv:2401.16310, 2024.  
  
  
  
本公众号原创文章仅代表作者观点，不代表绿盟科技立场。所有原创内容版权均属绿盟科技研究通讯。未经授权，严禁任何媒体以及微信公众号复制、转载、摘编或以其他方式使用，转载须注明来自绿盟科技研究通讯并附上本文链接。  
  
  
**关于我们**  
  
  
绿盟科技研究通讯由绿盟科技创新研究院负责运营，绿盟科技创新研究院是绿盟科技的前沿技术研究部门，包括星云实验室、天枢实验室和孵化中心。团队成员由来自清华、北大、哈工大、中科院、北邮等多所重点院校的博士和硕士组成。  
  
绿盟科技创新研究院作为“中关村科技园区海淀园博士后工作站分站”的重要培养单位之一，与清华大学进行博士后联合培养，科研成果已涵盖各类国家课题项目、国家专利、国家标准、高水平学术论文、出版专业书籍等。  
  
我们持续探索信息安全领域的前沿学术方向，从实践出发，结合公司资源和先进技术，实现概念级的原型系统，进而交付产品线孵化产品并创造巨大的经济价值。  
  
![](https://mmbiz.qpic.cn/mmbiz_jpg/hiayDdhDbxUYMAwo0X2e7jSicRpJz5TUV5dy16RBVSaFxlRia8Q7MTwnLozll9v5OU9lufaaUQJy5AY5S09e4NzUA/640?wx_fmt=jpeg&from=appmsg "")  
  
**长按上方二维码，即可关注我**  
  
  
  
  
  
  
