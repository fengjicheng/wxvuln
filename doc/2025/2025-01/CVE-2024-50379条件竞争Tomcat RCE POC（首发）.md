#  CVE-2024-50379|条件竞争Tomcat RCE POC（首发）   
 TtTeam   2025-01-06 06:41  
  
   
  
此文章只为学习而生，请勿干违法违禁之事，本公众号只在技术的学习上做以分享，只做1day的漏洞复现，  
所有行为与本公众号无关。  
  
   
  
   
  
01  
  
漏洞描述  
  
  
如果默认 servlet 对大小写不敏感的文件系统启用了写入功能（只读初始化参数设置为非默认值 false），则在负载情况下同时读取和上传同一文件时，可能会绕过 Tomcat 的大小写敏感性检查，导致上传的文件被视为 JSP，从而导致远程代码执行。  
  
链接：  
```
https://lists.apache.org/thread/y6lj6q1xnp822g6ro70tn19sgtjmr80r
```  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/hFPkDXcMlMsACNzQfBml6bDplMDaGZaq3eJdnyuUhia4YXO8VuNz35LypoRz9Kza4K5owDeIX5ibUllFlMVrqe9Q/640?wx_fmt=png&from=appmsg "")  
  
即上图  
readonly为  
false的时候。  
  
   
  
02  
  
影响版本  
  
  
   
  
- Apache Tomcat 11.0.0-M1 to 11.0.1  
  
- Apache Tomcat 10.1.0-M1 to 10.1.33  
  
- Apache Tomcat 9.0.0.M1 to 9.0.97  
  
   
  
03  
  
POC  
  
  
 直接上图  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/hFPkDXcMlMsACNzQfBml6bDplMDaGZaq2VEF75lic5fsfcEUAGRFPS0yYE3Dj8EZqWwCU9MHJDJQS5ibPYnG9lhA/640?wx_fmt=png&from=appmsg "")  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/hFPkDXcMlMsACNzQfBml6bDplMDaGZaqpK3hjGx0OVVSzAbjrTrCT6ia4hZKZltnTRsnr4VoDXlEJhoQDVvyMVw/640?wx_fmt=png&from=appmsg "")  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/hFPkDXcMlMsACNzQfBml6bDplMDaGZaqOII8gCDYuQDRmwQjPeOnN2bD4HXPEyGuQMIpnVwrSTuKvrwDLv6yzw/640?wx_fmt=png&from=appmsg "")  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/hFPkDXcMlMsACNzQfBml6bDplMDaGZaqAfS0NSC0N7gKqQErLsTY3IQ3ia1lI5OIvVp0qu4Al2OcribUuNzuHYRg/640?wx_fmt=png&from=appmsg "")  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/hFPkDXcMlMsACNzQfBml6bDplMDaGZaqKc8A5BzwcrVDfibMcPtiaB99nzXW42xPgky6eWK7PV92ZPp9UuOxbOdg/640?wx_fmt=png&from=appmsg "")  
  
这四个一起跑，实际上只要两个PUT就可以了。  
  
   
  
04  
  
修复建议  
  
  
   
  
- 升级到 Apache Tomcat 11.0.2 之后版本  
  
- 升级到 Apache Tomcat 10.1.34 之后版本  
  
- 升级到 Apache Tomcat 9.0.98 之后版本  
  
  
  
  
  
  
