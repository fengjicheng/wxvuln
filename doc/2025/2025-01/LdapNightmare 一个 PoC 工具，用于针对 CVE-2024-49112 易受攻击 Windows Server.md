#  LdapNightmare 一个 PoC 工具，用于针对 CVE-2024-49112 易受攻击 Windows Server   
 Ots安全   2025-01-02 06:46  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/bL2iaicTYdZn7gtxSFZlfuCW6AdQib8Q1onbR0U2h9icP1eRO6wH0AcyJmqZ7USD0uOYncCYIH7ZEE8IicAOPxyb9IA/640?wx_fmt=gif "")  
  
**LDAP 噩梦**  
  
Yuki Chen (@guhe120) 报告的 CVE-2024-49112 漏洞。Windows 轻量级目录访问协议 (LDAP) 中的漏洞。  
  
由 SafeBreach Labs 创建（发布于 2025 年 1 月 1 日）。有关该漏洞的完整技术分析以及我们如何利用它，请查看此处的博客文章  
  
**概述**  
  
CVE-2024-49112 是 Windows LDAP 客户端中的一个严重漏洞，据 Microsoft 称，该漏洞允许远程执行代码。此漏洞利用该漏洞通过与 Netlogon 远程协议 (NRPC) 和 LDAP 客户端交互来使目标 Windows Server 系统崩溃。  
  
**演示**  
  
  
**工作原理**  
  
1.启动漏洞服务器：  
  
该脚本启动一个异步 LDAP 服务器，该服务器侦听指定 UDP 端口上的传入连接。  
  
2.调用DsrGetDcNameEx2：  
  
该脚本DsrGetDcNameEx2通过 Netlogon 远程协议调用该函数来触发受害服务器向攻击者发送 LDAP 查询。  
  
3.触发漏洞：  
  
通过发送特制的响应，该漏洞会触发 CVE-2024-49112 漏洞，导致受害服务器崩溃  
  
**项目地址：**  
  
https://github.com/SafeBreach-Labs/CVE-2024-49112  
  
  
  
感谢您抽出  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWgdSBqOibtgiaYWjL4pkRXwycNnFvFYVgXoExRy0gqCkqvrAghf8KPXnwQaYq77HMsjcVka7kPcBDQw/640?wx_fmt=gif "")  
  
.  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWgdSBqOibtgiaYWjL4pkRXwycd5KMTutPwNWA97H5MPISWXLTXp0ibK5LXCBAXX388gY0ibXhWOxoEKBA/640?wx_fmt=gif "")  
  
.  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWgdSBqOibtgiaYWjL4pkRXwycU99fZEhvngeeAhFOvhTibttSplYbBpeeLZGgZt41El4icmrBibojkvLNw/640?wx_fmt=gif "")  
  
来阅读本文  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWge7Mibiad1tV0iaF8zSD5gzicbxDmfZCEL7vuOevN97CwUoUM5MLeKWibWlibSMwbpJ28lVg1yj1rQflyQ/640?wx_fmt=gif "")  
  
**点它，分享点赞在看都在这里**  
  
