#  【已复现】 Commvault SSRF 致代码执行漏洞（CVE-2025-34028）   
 sec0nd安全   2025-04-29 12:43  
  
↑点击关注，获取更多漏洞预警，技术分享  
  
0x01 组件介绍  
  
    
Commvault Command Center 是 Commvault 提供的一款用于集中管理和监控整个数据保护环境的 Web管理界面。该软件具有高效、安全、稳定的特点，可以为用户提供可靠的  
数据备份  
、恢复和归档服务。Commvault-WebServer支持多种操作系统和数据库，可以与其他Commvault产品无缝集成，为用户提供全面的数据管理解决方案。  
  
搜索语法：  
app="Commvault-WebServer"   
  
  
0x02 漏洞描述  
  
     
2025年4月，互联网上披露CVE-2025-34028，攻击者可利用deployWebpackage.do接口的SSRF造成远程代码执行，控制服务器。官方已发布安全更新，建议升级至最新版本。  
  
<table><tbody><tr><td data-colwidth="143" width="143" style="border-color:#0080ff;"><section><span leaf="">漏洞分类</span></section></td><td colspan="3" data-colwidth="143,143,143" width="143,143,143" style="border-color:#0080ff;"><section><span leaf="">SSRF/文件上传导致代码执行</span></section></td></tr><tr><td data-colwidth="143" width="143" style="border-color:#0080ff;"><section><span leaf="" data-pm-slice="1 1 [&#34;table&#34;,{&#34;interlaced&#34;:null,&#34;align&#34;:null,&#34;class&#34;:null,&#34;style&#34;:null},&#34;table_body&#34;,{},&#34;table_row&#34;,{&#34;class&#34;:null,&#34;style&#34;:null},&#34;table_cell&#34;,{&#34;colspan&#34;:1,&#34;rowspan&#34;:1,&#34;colwidth&#34;:[143],&#34;width&#34;:null,&#34;valign&#34;:null,&#34;align&#34;:null,&#34;style&#34;:null},&#34;para&#34;,null]">CVSS 3.1分数</span></section></td><td data-colwidth="143" width="143" style="border-color:#0080ff;"><section><span leaf=""><span textstyle="" style="color: rgb(255, 0, 0);">9.0</span></span></section></td><td data-colwidth="143" width="143" style="border-color:#0080ff;"><section><span leaf="">漏洞等级</span></section></td><td data-colwidth="143" width="143" style="border-color:#0080ff;"><section><span leaf=""><span textstyle="" style="color: rgb(255, 0, 0);">严重</span></span></section></td></tr><tr><td data-colwidth="143" width="143" style="border-color:#0080ff;"><section><span leaf="">POC/EXP</span></section></td><td data-colwidth="143" width="143" style="border-color:#0080ff;"><section><span leaf=""> </span><span leaf=""><span textstyle="" style="color: rgb(255, 0, 0);">已公开</span></span></section></td><td data-colwidth="143" width="143" style="border-color:#0080ff;"><section><span leaf="">可利用性</span></section></td><td data-colwidth="143" width="143" style="border-color:#0080ff;"><section><span leaf=""><span textstyle="" style="color: rgb(255, 0, 0);">高</span></span></section></td></tr></tbody></table>  
  
0x03 影响版本  
  
11.38.0 ≤ Commvault < 11.38.20  
<table><tbody><tr style="-webkit-tap-highlight-color: transparent;outline: 0px;visibility: visible;"></tr></tbody></table>  
  
0x04 漏洞验证  
  
目前POC/EXP已经公开  
（  
后台留言：  
CVE-2025-34028  
，获取测试POC  
  
概念性验证：  
  
发送数据包，出现下面的即可证明漏洞存在  
  
验证是否存在SSRF漏洞  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/pl2czC0m3eqoela1mHZoj4Fe7l6Ak7ia0TTrHt4C5nGymiceq3icZWpJYdaU3r6PLTIWK7WGbllMCkYwibjBd3WMnw/640?wx_fmt=png&from=appmsg "")  
  
dnslog模块存在解析  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/pl2czC0m3eqoela1mHZoj4Fe7l6Ak7ia0GdibicGMHc2dcDTCW8VHNd6KboebuaAXvDmg2icNmAmqTPZh8J4ntvOxg/640?wx_fmt=png&from=appmsg "")  
  
确定存在ssrf漏洞后，  
即可证明存在文件上传导致代码执行漏洞，这里不做演示  
  
  
0x05 漏洞影响  
  
由于该漏洞影响范围较广，危害较大。通过以上复现过程，我们可以知道该漏洞的利用过程比较简单，  
且能造成的危害是严重的，可以上传weshell文件控制操作系统。企业应该尽快排查是否有使用该组件，并尽快做出对应措施  
  
  
0x06 修复建议  
  
官方已发布最新版本修复该漏洞，建议受影响用户将Commvault更新到11.38.20及以上版本。  
  
官方下载链接：  
  
https://documentation.commvault.com/11.38/essential/list_of_innovation_update_releases_in_11_38.html  
  
0X07 参考链接  
  
https://labs.watchtowr.com/fire-in-the-hole-were-breaching-the-vault-commvault-remote-code-execution-cve-2025-34028/  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/pl2czC0m3eqoela1mHZoj4Fe7l6Ak7ia0VRAEDk2FfxrBqDn5v7JOTicNMwd40MrF4FzIZZN4mess6EQkN7LWejg/640?wx_fmt=png&from=appmsg "")  
  
  
  
0x08 免责声明  
  
> 本文所涉及的任何技术、信息或工具，仅供学习和参考之用。  
  
> 请勿利用本文提供的信息从事任何违法活动或不当行为。任何因使用本文所提供的信息或工具而导致的损失、后果或不良影响，均由使用者个人承担责任，与本文作者无关。  
  
> 作者不对任何因使用本文信息或工具而产生的损失或后果承担任何责任。使用本文所提供的信息或工具即视为同意本免责声明，并承诺遵守相关法律法规和道德规范。  
  
  
  
