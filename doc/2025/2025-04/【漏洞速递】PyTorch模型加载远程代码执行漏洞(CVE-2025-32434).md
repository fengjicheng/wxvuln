#  【漏洞速递】PyTorch模型加载远程代码执行漏洞(CVE-2025-32434)   
 安全狐   2025-04-21 11:31  
  
## 漏洞背景  
  
![GitHub - pytorch/pytorch: Tensors and Dynamic neural networks in Python  with strong GPU acceleration](https://mmbiz.qpic.cn/sz_mmbiz_png/3FexoYn0bleVPXgBJy4JLe7FA6A4tfwYTibbJ01KNtDuibiaI740RibnWLSGuJmwn8hPtPDyT7ep6OzMeVMeSXD7mg/640?wx_fmt=png&from=appmsg "")  
  
PyTorch作为由Meta AI开发的开源深度学习框架，被广泛应用于计算机视觉、自然语言处理等领域。其模型加载机制的安全性问题直接关系到数百万开发者和研究机构的生产环境安全。2025年4月披露的该漏洞颠覆了开发者对weights_only=True  
参数的安全认知，成为近年来机器学习框架领域最严重的安全威胁之一。  
## 漏洞概述  
  
该漏洞存在于PyTorch模型加载函数torch.load()  
中，当使用weights_only=True  
参数时，攻击者可通过构造恶意模型文件实现远程代码执行（RCE）。漏洞CVSS v3评分为9.8（Critical），v4评分达9.3，影响范围覆盖2.5.1及更早版本，成功利用可导致目标系统完全沦陷、敏感数据泄露，并可能在云计算环境中形成横向渗透。  
## 漏洞详情  
1. **漏洞成因**  
  
1. 反序列化过程存在校验缺陷，攻击者可注入恶意序列化对象绕过weights_only  
限制（CWE-502）  
  
1. 安全机制未正确处理特定类型的Python对象，导致非权重数据执行反序列化操作  
  
1. **攻击场景**  
  
1. 攻击者将恶意代码嵌入.pt  
或.pth  
模型文件，通过供应链攻击、钓鱼邮件等方式分发  
  
1. 受害者使用torch.load(file, weights_only=True)  
加载模型时触发漏洞  
  
1. 云服务平台中托管模型的自动加载机制可能成为大规模攻击入口  
  
## 影响范围  
  
<table><thead><tr><th style="color: rgb(0, 0, 0);font-size: 15px;line-height: 1.5em;letter-spacing: 0em;text-align: left;font-weight: bold;background: none 0% 0% / auto no-repeat scroll padding-box border-box rgb(240, 240, 240);height: auto;border-style: solid;border-width: 1px;border-color: rgba(204, 204, 204, 0.4);border-radius: 0px;padding: 5px 10px;min-width: 85px;"><section><span leaf="">类型</span></section></th><th style="color: rgb(0, 0, 0);font-size: 15px;line-height: 1.5em;letter-spacing: 0em;text-align: left;font-weight: bold;background: none 0% 0% / auto no-repeat scroll padding-box border-box rgb(240, 240, 240);height: auto;border-style: solid;border-width: 1px;border-color: rgba(204, 204, 204, 0.4);border-radius: 0px;padding: 5px 10px;min-width: 85px;"><section><span leaf="">版本范围</span></section></th></tr></thead><tbody><tr style="color: rgb(0, 0, 0);background-attachment: scroll;background-clip: border-box;background-color: rgb(255, 255, 255);background-image: none;background-origin: padding-box;background-position-x: 0%;background-position-y: 0%;background-repeat: no-repeat;background-size: auto;width: auto;height: auto;"><td style="padding-top: 5px;padding-right: 10px;padding-bottom: 5px;padding-left: 10px;min-width: 85px;border-top-style: solid;border-bottom-style: solid;border-left-style: solid;border-right-style: solid;border-top-width: 1px;border-bottom-width: 1px;border-left-width: 1px;border-right-width: 1px;border-top-color: rgba(204, 204, 204, 0.4);border-bottom-color: rgba(204, 204, 204, 0.4);border-left-color: rgba(204, 204, 204, 0.4);border-right-color: rgba(204, 204, 204, 0.4);border-top-left-radius: 0px;border-top-right-radius: 0px;border-bottom-right-radius: 0px;border-bottom-left-radius: 0px;"><section><span leaf="">受影响版本</span></section></td><td style="padding-top: 5px;padding-right: 10px;padding-bottom: 5px;padding-left: 10px;min-width: 85px;border-top-style: solid;border-bottom-style: solid;border-left-style: solid;border-right-style: solid;border-top-width: 1px;border-bottom-width: 1px;border-left-width: 1px;border-right-width: 1px;border-top-color: rgba(204, 204, 204, 0.4);border-bottom-color: rgba(204, 204, 204, 0.4);border-left-color: rgba(204, 204, 204, 0.4);border-right-color: rgba(204, 204, 204, 0.4);border-top-left-radius: 0px;border-top-right-radius: 0px;border-bottom-right-radius: 0px;border-bottom-left-radius: 0px;"><section><span leaf="">PyTorch ≤ 2.5.1</span></section></td></tr><tr style="color: rgb(0, 0, 0);background-attachment: scroll;background-clip: border-box;background-color: rgb(248, 248, 248);background-image: none;background-origin: padding-box;background-position-x: 0%;background-position-y: 0%;background-repeat: no-repeat;background-size: auto;width: auto;height: auto;"><td style="padding-top: 5px;padding-right: 10px;padding-bottom: 5px;padding-left: 10px;min-width: 85px;border-top-style: solid;border-bottom-style: solid;border-left-style: solid;border-right-style: solid;border-top-width: 1px;border-bottom-width: 1px;border-left-width: 1px;border-right-width: 1px;border-top-color: rgba(204, 204, 204, 0.4);border-bottom-color: rgba(204, 204, 204, 0.4);border-left-color: rgba(204, 204, 204, 0.4);border-right-color: rgba(204, 204, 204, 0.4);border-top-left-radius: 0px;border-top-right-radius: 0px;border-bottom-right-radius: 0px;border-bottom-left-radius: 0px;"><section><span leaf="">已修复版本</span></section></td><td style="padding-top: 5px;padding-right: 10px;padding-bottom: 5px;padding-left: 10px;min-width: 85px;border-top-style: solid;border-bottom-style: solid;border-left-style: solid;border-right-style: solid;border-top-width: 1px;border-bottom-width: 1px;border-left-width: 1px;border-right-width: 1px;border-top-color: rgba(204, 204, 204, 0.4);border-bottom-color: rgba(204, 204, 204, 0.4);border-left-color: rgba(204, 204, 204, 0.4);border-right-color: rgba(204, 204, 204, 0.4);border-top-left-radius: 0px;border-top-right-radius: 0px;border-bottom-right-radius: 0px;border-bottom-left-radius: 0px;"><section><span leaf="">PyTorch ≥ 2.6.0</span></section></td></tr></tbody></table>  
## 解决措施  
  
**1. 官方修复方案**  
1. 立即升级至PyTorch 2.6.0或更高版本  
  
```
# pip升级命令pip install torch torchvision torchaudio --upgrade# conda升级命令  conda update pytorch torchvision torchaudio -c pytorch
```  
  
  
**2. 临时缓解措施**  
1. 暂停加载来源不明的模型文件  
  
1. 在沙箱环境中运行模型加载操作  
  
## 安全建议  
  
**1. 版本检测**  
1. 执行print(torch.__version__)  
验证当前版本  
  
1. 审查CI/CD流水线中的PyTorch依赖版本  
  
**2. 长期防护策略**  
1. 建立模型文件完整性校验机制  
  
1. 在安全策略中强制规定weights_only  
参数的使用规范  
  
1. 对生产环境中的模型加载操作启用行为监控  
  
（注：本文所述技术细节均来自PyTorch官方安全公告及CVE数据库披露信息）  
  
参考链接：  
  
[1]   
https://github.com/pytorch/pytorch/security/advisories/GHSA-53q9-r3pm-6pq6  
  
[2]   
https://nvd.nist.gov/vuln/detail/CVE-2025-32434  
  
