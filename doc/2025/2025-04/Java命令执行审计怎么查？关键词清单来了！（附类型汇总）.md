#  Java命令执行审计怎么查？关键词清单来了！（附类型汇总）   
原创 火力猫  季升安全   2025-04-17 06:09  
  
## 🔥Java 命令执行类型汇总  
  
<table><thead><tr style="box-sizing: border-box;"><th style="box-sizing: border-box;"><span cid="n8" mdtype="table_cell" style="box-sizing: border-box;"><span md-inline="plain" style="box-sizing: border-box;"><span leaf="">序号</span></span></span></th><th style="box-sizing: border-box;"><span cid="n9" mdtype="table_cell" style="box-sizing: border-box;"><span md-inline="plain" style="box-sizing: border-box;"><span leaf="">执行方式</span></span></span></th><th style="box-sizing: border-box;"><span cid="n10" mdtype="table_cell" style="box-sizing: border-box;"><span md-inline="plain" style="box-sizing: border-box;"><span leaf="">关键类/方法</span></span></span></th><th style="box-sizing: border-box;"><span cid="n11" mdtype="table_cell" style="box-sizing: border-box;"><span md-inline="plain" style="box-sizing: border-box;"><span leaf="">说明</span></span></span></th></tr></thead><tbody><tr style="box-sizing: border-box;"><td style="box-sizing: border-box;"><span cid="n13" mdtype="table_cell" style="box-sizing: border-box;"><span md-inline="plain" style="box-sizing: border-box;"><span leaf="">1</span></span></span></td><td style="box-sizing: border-box;"><span cid="n14" mdtype="table_cell" style="box-sizing: border-box;"><span md-inline="code" spellcheck="false" style="box-sizing: border-box;"><code style="box-sizing: border-box;"><span leaf="">Runtime.exec()</span></code></span></span></td><td style="box-sizing: border-box;"><span cid="n15" mdtype="table_cell" style="box-sizing: border-box;"><span md-inline="code" spellcheck="false" style="box-sizing: border-box;"><code style="box-sizing: border-box;"><span leaf="">java.lang.Runtime</span></code></span></span></td><td style="box-sizing: border-box;"><span cid="n16" mdtype="table_cell" style="box-sizing: border-box;"><span md-inline="plain" style="box-sizing: border-box;"><span leaf="">最经典方式，直接执行命令</span></span></span></td></tr><tr style="box-sizing: border-box;"><td style="box-sizing: border-box;"><span cid="n18" mdtype="table_cell" style="box-sizing: border-box;"><span md-inline="plain" style="box-sizing: border-box;"><span leaf="">2</span></span></span></td><td style="box-sizing: border-box;"><span cid="n19" mdtype="table_cell" style="box-sizing: border-box;"><span md-inline="code" spellcheck="false" style="box-sizing: border-box;"><code style="box-sizing: border-box;"><span leaf="">ProcessBuilder.start()</span></code></span></span></td><td style="box-sizing: border-box;"><span cid="n20" mdtype="table_cell" style="box-sizing: border-box;"><span md-inline="code" spellcheck="false" style="box-sizing: border-box;"><code style="box-sizing: border-box;"><span leaf="">java.lang.ProcessBuilder</span></code></span></span></td><td style="box-sizing: border-box;"><span cid="n21" mdtype="table_cell" style="box-sizing: border-box;"><span md-inline="plain" style="box-sizing: border-box;"><span leaf="">更灵活的命令构造方式</span></span></span></td></tr><tr style="box-sizing: border-box;"><td style="box-sizing: border-box;"><span cid="n23" mdtype="table_cell" style="box-sizing: border-box;"><span md-inline="plain" style="box-sizing: border-box;"><span leaf="">3</span></span></span></td><td style="box-sizing: border-box;"><span cid="n24" mdtype="table_cell" style="box-sizing: border-box;"><span md-inline="plain" style="box-sizing: border-box;"><span leaf="">JavaScript 执行命令</span></span></span></td><td style="box-sizing: border-box;"><span cid="n25" mdtype="table_cell" style="box-sizing: border-box;"><span md-inline="code" spellcheck="false" style="box-sizing: border-box;"><code style="box-sizing: border-box;"><span leaf="">ScriptEngine.eval()</span></code></span></span></td><td style="box-sizing: border-box;"><span cid="n26" mdtype="table_cell" style="box-sizing: border-box;"><span md-inline="plain" style="box-sizing: border-box;"><span leaf="">使用 </span></span><span md-inline="code" spellcheck="false" style="box-sizing: border-box;"><code style="box-sizing: border-box;"><span leaf="">Nashorn</span></code></span><span md-inline="plain" style="box-sizing: border-box;"><span leaf=""> 引擎，JavaScript 调用 Java</span></span></span></td></tr><tr style="box-sizing: border-box;"><td style="box-sizing: border-box;"><span cid="n28" mdtype="table_cell" style="box-sizing: border-box;"><span md-inline="plain" style="box-sizing: border-box;"><span leaf="">4</span></span></span></td><td style="box-sizing: border-box;"><span cid="n29" mdtype="table_cell" style="box-sizing: border-box;"><span md-inline="plain" style="box-sizing: border-box;"><span leaf="">Groovy 执行命令</span></span></span></td><td style="box-sizing: border-box;"><span cid="n30" mdtype="table_cell" style="box-sizing: border-box;"><span md-inline="code" spellcheck="false" style="box-sizing: border-box;"><code style="box-sizing: border-box;"><span leaf="">&#39;cmd&#39;.execute()</span></code></span></span></td><td style="box-sizing: border-box;"><span cid="n31" mdtype="table_cell" style="box-sizing: border-box;"><span md-inline="plain" style="box-sizing: border-box;"><span leaf="">Groovy 特性，动态执行字符串命令</span></span></span></td></tr><tr style="box-sizing: border-box;"><td style="box-sizing: border-box;"><span cid="n33" mdtype="table_cell" style="box-sizing: border-box;"><span md-inline="plain" style="box-sizing: border-box;"><span leaf="">5</span></span></span></td><td style="box-sizing: border-box;"><span cid="n34" mdtype="table_cell" style="box-sizing: border-box;"><span md-inline="plain" style="box-sizing: border-box;"><span leaf="">Apache Commons Exec</span></span></span></td><td style="box-sizing: border-box;"><span cid="n35" mdtype="table_cell" style="box-sizing: border-box;"><span md-inline="code" spellcheck="false" style="box-sizing: border-box;"><code style="box-sizing: border-box;"><span leaf="">CommandLine.parse()</span></code></span></span></td><td style="box-sizing: border-box;"><span cid="n36" mdtype="table_cell" style="box-sizing: border-box;"><span md-inline="plain" style="box-sizing: border-box;"><span leaf="">被广泛使用的第三方命令执行库</span></span></span></td></tr><tr style="box-sizing: border-box;"><td style="box-sizing: border-box;"><span cid="n38" mdtype="table_cell" style="box-sizing: border-box;"><span md-inline="plain" style="box-sizing: border-box;"><span leaf="">6</span></span></span></td><td style="box-sizing: border-box;"><span cid="n39" mdtype="table_cell" style="box-sizing: border-box;"><span md-inline="plain" style="box-sizing: border-box;"><span leaf="">JNDI 远程加载类</span></span></span></td><td style="box-sizing: border-box;"><span cid="n40" mdtype="table_cell" style="box-sizing: border-box;"><span md-inline="code" spellcheck="false" style="box-sizing: border-box;"><code style="box-sizing: border-box;"><span leaf="">InitialContext.lookup()</span></code></span></span></td><td style="box-sizing: border-box;"><span cid="n41" mdtype="table_cell" style="box-sizing: border-box;"><span md-inline="plain" style="box-sizing: border-box;"><span leaf="">远程加载恶意类，常用于链式触发 RCE</span></span></span></td></tr><tr style="box-sizing: border-box;"><td style="box-sizing: border-box;"><span cid="n43" mdtype="table_cell" style="box-sizing: border-box;"><span md-inline="plain" style="box-sizing: border-box;"><span leaf="">7</span></span></span></td><td style="box-sizing: border-box;"><span cid="n44" mdtype="table_cell" style="box-sizing: border-box;"><span md-inline="plain" style="box-sizing: border-box;"><span leaf="">JNI 本地命令执行</span></span></span></td><td style="box-sizing: border-box;"><span cid="n45" mdtype="table_cell" style="box-sizing: border-box;"><span md-inline="code" spellcheck="false" style="box-sizing: border-box;"><code style="box-sizing: border-box;"><span leaf="">System.loadLibrary()</span></code></span></span></td><td style="box-sizing: border-box;"><span cid="n46" mdtype="table_cell" style="box-sizing: border-box;"><span md-inline="plain" style="box-sizing: border-box;"><span leaf="">加载 native C/C++ 库，调用 </span></span><span md-inline="code" spellcheck="false" style="box-sizing: border-box;"><code style="box-sizing: border-box;"><span leaf="">system()</span></code></span></span></td></tr><tr style="box-sizing: border-box;"><td style="box-sizing: border-box;"><span cid="n48" mdtype="table_cell" style="box-sizing: border-box;"><span md-inline="plain" style="box-sizing: border-box;"><span leaf="">8</span></span></span></td><td style="box-sizing: border-box;"><span cid="n49" mdtype="table_cell" style="box-sizing: border-box;"><span md-inline="plain" style="box-sizing: border-box;"><span leaf="">反射链命令执行</span></span></span></td><td style="box-sizing: border-box;"><span cid="n50" mdtype="table_cell" style="box-sizing: border-box;"><span md-inline="code" spellcheck="false" style="box-sizing: border-box;"><code style="box-sizing: border-box;"><span leaf="">Class.forName(...)</span></code></span></span></td><td style="box-sizing: border-box;"><span cid="n51" mdtype="table_cell" style="box-sizing: border-box;"><span md-inline="plain" style="box-sizing: border-box;"><span leaf="">构造隐蔽执行链，常用于绕过审计</span></span></span></td></tr></tbody></table>## 🧠 Java 命令执行源码审计关键词清单  
### ✅ 主动执行关键点  
```
Runtime.getRuntimeexec(ProcessBuilderstart(execute(
```  
### ✅ 动态脚本类  
```
ScriptEngineScriptEngineManagereval(getEngineByNameGroovyShellgroovy.lang.evaluate.execute(
```  
### ✅ 第三方框架命令相关  
```
CommandLine.parseorg.apache.commons.execDefaultExecutor.execute
```  
  
### ✅ JNDI/远程加载/反序列化链入口  
```
InitialContext.lookup(Context.lookupjavax.namingJNDIrmi:ldap:
```  
### ✅ 本地执行接口（JNI）  
```
System.loadSystem.loadLibrarynativeJNIEXPORTsystem(
```  
### ✅ 反射链可疑操作  
```
Class.forNamegetMethodinvoke(Method.invokeField.setAccessible
```  
## 🚩 高危可控点审计辅助词  
```
request.getParameterargs[0]userInputcmd=inputStream.readLineBufferedReadersession.getAttribute
```  
  
这些词常用于命令拼接源头，辅助上面关键词审查，不建议单独使用。  
  
  
详细分析  
👉  
  
 [一文看懂 Java 命令执行的源码审计与防御](https://mp.weixin.qq.com/s?__biz=MzkxNjY5MDc4Ng==&mid=2247484714&idx=1&sn=15f840bd4928ac609b037661ef2a00d4&scene=21#wechat_redirect)  
  
  
  
  
  
