#  Next.js 中间件鉴权绕过漏洞 (CVE-2025-29927)   
 HK安全小屋   2025-04-22 17:17  
  
免责声明  
  
       请勿利用文章内的相关技术从事非法测试，由于传播、利用此文所提供的信息或者工具而造成的任何直接或者间接的后果及损失，均由使用者本人负责，所产生的一切不良后果与文章作者无关。该文章仅供学习用途使用。  
  
漏洞描述：  
  
Next.js 是一个基于 React 的流行 Web 应用框架，提供服务器端渲染、静态网站生成和集成路由系统等功能。当使用中间件进行身份验证和授权时，Next.js 14.2.25 和 15.2.3 之前的版本存在授权绕过漏洞。该漏洞允许攻击者通过操作 x-middleware-subrequest 请求头来绕过基于中间件的安全控制，从而可能获得对受保护资源和敏感数据的未授权访问。  
  
影响版本：  
  
Next.js 11.1.4 ~ 13.5.6：未修补版本  
  
Next.js 14.x：在 14.2.25 之前均受影响  
  
Next.js 15.x：在 15.2.3 之前均受影响  
  
vulhub 环境：  
```
https://github.com/vulhub/vulhub/blob/master/next.js/CVE-2025-29927/README.zh-cn.md
```  
  
poc:  
```
x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware
```  
  
![](https://mmbiz.qpic.cn/mmbiz_png/A8qcyicQXeI35K9IeWW1TOD5iaxh9VibtuPm4eISCJlpLyia3LHtj25IficJDgyOAHdCQVUQADC638wtDSyf0vzibI9w/640?wx_fmt=png&from=appmsg "")  
  
请勿利用文章内的相关技术从事非法测试，由于传播、利用此文所提供的信息或者工具而造成的任何直接或者间接的后果及损失，均由使用者本人负责，所产生的一切不良后果与文章作者无关。该文章仅供学习用途使用。  
  
  
  
