> **原文链接**: https://mp.weixin.qq.com/s?__biz=MzIzNDU5NTI4OQ==&mid=2247489410&idx=1&sn=b24d03bfc7b11cf358dfaed3d83c2a50

#  网络安全周刊#4: APT29利用Gmail应用专用密码(ASP)绕过2FA的新型攻击  
知机安全  知机安全   2025-06-23 01:00  
  
1. 安全焦点  
  
上周，我们观察到攻击者正以前所未有的耐心和创造力，将攻击矛头直指安全链条中最脆弱的一环——人。从BlueNoroff组织利用Deepfake技术在Zoom会议中冒充高管，到APT29组织耗费数周与目标建立信任关系，诱骗其生成并分享用于绕过双因素认证(2FA)的Gmail应用专用密码，这些事件标志着社会工程学攻击已进入一个新阶段。攻击者不再仅仅依赖于制造紧迫感，而是转向精心策划的、长期的心理操纵。  
## 2. 重要资讯  
### 2.1. 数据泄露与攻击事件  
1. **Scattered Spider组织被指攻击多家零售和保险业巨头：**  
网络犯罪组织Scattered Spider被认为是近期针对英国多家大型零售商网络攻击的幕后黑手，该攻击被评估为“单一联合网络事件”，预计造成高达5.92亿美元的经济损失。其攻击手法主要依赖于针对IT帮助台的社会工程学。近期，该组织已将目标转向美国的保险行业，显示出其按行业逐个击破的策略。  
  
1. **伊朗国家电视台及加密货币交易所遭网络攻击：**  
据报道，伊朗国家电视台在播出期间遭到黑客攻击，正常节目被中断，取而代之的是呼吁民众进行街头抗议的视频。与此同时，伊朗最大的加密货币交易所Nobitex也遭到攻击，导致超过9000万美元的资产被盗。这些事件发生在地区地缘政治紧张局势升级的背景下。  
  
### 2.2. 漏洞预警与分析  
1. **Sitecore XP平台存在硬编码密码'b'，可导致远程代码执行：**  
 Sitecore Experience Platform (XP)被发现存在三个可被链接利用的严重漏洞。其中最关键的是一个默认用户账户(sitecore\ServicesAPI)使用了硬编码的单字符密码“b”，攻击者可利用此凭据通过身份验证，并结合另外两个文件上传漏洞（路径遍历和PowerShell扩展漏洞），最终实现未经身份验证的远程代码执行。  
  
1. **CISA就Linux内核及TP-Link路由器漏洞发出在野利用警报：**  
美国网络安全和基础设施安全局(CISA)将两个漏洞添加到其“已知被利用漏洞(KEV)”目录中。其一是Linux内核的OverlayFS子系统中的一个不当所有权管理漏洞(  
CVE-2023-0386  
)，允许本地用户提权。其二是TP-Link多款无线路由器中的命令注入漏洞(  
CVE-2023-33538  
)，未经身份验证的攻击者可通过特制HTTP请求执行任意命令。  
  
1. **Veeam修复备份与复制软件中的严重RCE漏洞：**  
Veeam发布了针对其Backup & Replication软件中一个评分为9.9的严重远程代码执行漏洞(  
CVE-2025-23121  
)的补丁。该漏洞允许经过身份验证的域用户在备份服务器上执行远程代码。  
  
1. **Langflow AI框架RCE漏洞被用于传播DDoS僵尸网络：**  
一个影响Langflow AI应用构建框架的严重远程代码执行漏洞(  
CVE-2025-3248  
)正被积极利用，以传播名为Flodrix的DDoS僵尸网络。攻击者利用该漏洞在受感染的Langflow服务器上执行下载器脚本，进而安装恶意软件。  
  
1. **谷歌Chrome零日漏洞被用于部署Trinper后门：**  
一个已修复的Chrome浏览器沙箱逃逸漏洞(  
CVE-2025-2783  
)被一个名为TaxOff的威胁组织作为零日漏洞利用，通过钓鱼邮件中的恶意链接触发，最终在受害者系统上部署名为Trinper的后门程序。  
  
1. **其他值得关注的漏洞：**  
1. Linux PAM & libblockdev:   
CVE-2025-6018  
,   
CVE-2025-6019  
,   
CVE-2025-6020  
 (本地提权)  
  
1. Zyxel防火墙:   
CVE-2023-28771  
 (命令注入，近期被利用激增)  
  
1. Veeam Backup & Replication:   
CVE-2025-24286  
 (任意代码执行)  
  
1. Veeam Agent for Windows:   
CVE-2025-24287  
 (本地提权)  
  
### 2.3. 恶意软件与威胁情报  
1. **Qilin勒索软件服务升级，提供“呼叫律师”功能：**  
为在竞争激烈的勒索软件市场中脱颖而出，Qilin勒索软件即服务(RaaS)平台为其附属攻击者提供了新功能，包括一个“呼叫律师”的按钮。该功能旨在通过法律威胁向受害者施压，以增加赎金金额。此外，该平台还增加了DDoS攻击、垃圾邮件发送等服务，向一体化网络犯罪平台演变。  
  
1. **BlueNoroff组织利用Deepfake和macOS后门攻击加密货币员工：**  
与朝鲜有关的BlueNoroff组织被发现针对一名Web3领域的员工发起高度复杂的攻击。攻击者通过Telegram建立联系，并利用Deepfake技术在Zoom会议中伪造公司高管，诱骗受害者安装一个伪装成Zoom插件的恶意macOS后门程序，该后门包含键盘记录、信息窃取和远程控制等多种功能。  
  
1. **俄罗斯APT29组织利用Gmail应用专用密码绕过2FA：**  
一个与俄罗斯有关的威胁组织UNC6293（被认为隶属于APT29）被发现采用一种新颖的社会工程学策略。攻击者耗时数周与目标建立信任关系，然后冒充官方机构，指导目标为其Gmail账户创建一个“应用专用密码”(ASP)并分享，从而绕过2FA，获得对受害者邮箱的持久访问权限。  
  
1. **安卓恶意软件激增，采用虚拟化和NFC盗窃等新技术：**  
本周披露了多起安卓恶意软件活动。其中包括利用设备上虚拟化技术劫持合法银行和加密应用的GodFather木马新变种；通过恶意广告或钓鱼传播，具备屏幕录制和覆盖攻击能力的AntiDot木马；以及利用NFC中继攻击进行欺诈性交易的SuperCard X恶意软件。  
  
1. **GitHub成为恶意软件分发重灾区：**  
多个威胁组织被发现滥用GitHub传播恶意软件。一个名为Water Curse的组织劫持了76个GitHub账户分发多阶段恶意软件。另一个名为Banana Squad的活动发布了67个伪装成黑客工具的木马化仓库。此外，超过1500名Minecraft玩家因下载托管在GitHub上的恶意游戏模组而感染了信息窃取软件。  
  
1. **SERPENTINE#CLOUD活动利用Cloudflare Tunnels传播RAT：**  
一个新的恶意活动被命名为SERPENTINE#CLOUD，它利用Cloudflare Tunnel的子域名来托管和分发远程访问木马(RAT)。攻击链始于包含恶意LNK快捷方式的钓鱼邮件，通过多阶段的混淆脚本，最终在内存中执行AsyncRAT或Revenge RAT等恶意软件。  
  
### 2.4. 网络犯罪与执法行动  
1. **美国查获与朝鲜IT工作者网络相关的774万美元加密货币：**  
美国司法部宣布查获价值超过774万美元的加密货币及数字资产，这些资产与朝鲜的全球IT工作者计划有关。该计划通过使用虚假身份为朝鲜IT人员在美国公司获得远程工作，从而赚取外汇以资助其国家项目，并规避国际制裁。  
  
1. **前CIA分析师因泄露国防机密被判刑：**  
一名前美国中央情报局(CIA)分析师因非法保留和传输最高机密的国防信息被判处37个月监禁。他承认在2024年10月未经授权保留了多份机密文件，并通过拍照和编辑图像的方式试图掩盖来源后，将信息泄露给无权接收的个人。  
  
### 2.5. 平台安全与政策  
1. **Meta为Facebook引入Passkey支持：**  
Meta宣布将为其旗舰应用Facebook在安卓和iOS平台上增加对Passkey的支持。Passkey是一种基于FIDO标准的无密码认证方案，允许用户使用设备生物识别或PIN码安全登录，能有效抵抗钓鱼和密码喷洒攻击。该功能预计也将在未来几个月内登陆Messenger。  
  
## 3. 技术剖析  
### 1. BlueNoroff组织利用Deepfake和macOS后门的攻击链分析  
  
与朝鲜有关的BlueNoroff组织近期展示了其高度复杂和耐心的攻击能力，通过结合社会工程学、Deepfake技术和定制化的macOS恶意软件，成功入侵了一名加密货币基金会的员工。其攻击链条揭示了多层次的欺骗和技术手段。  
  
**攻击流程：**  
1. **初始接触与信任建立:**  
1. 攻击者通过Telegram与目标员工取得联系，请求进行会议。  
  
1. 攻击者发送一个Calendly链接来安排会议，该链接指向一个Google Meet事件，但点击后会将用户重定向到一个由攻击者控制的虚假Zoom域名。  
  
1. **Deepfake诱导执行:**  
1. 经过数周的沟通后，目标员工加入了一个包含多名“公司高管”（实际为Deepfake伪造）和外部联系人的Zoom群组会议。  
  
1. 会议期间，当目标员工声称其麦克风无法使用时，这些伪造的与会者便“热心”地建议他下载并安装一个“Zoom扩展程序”来解决问题。  
  
1. **初始载荷投递:**  
1. 攻击者通过Telegram分享了扩展程序的下载链接，该链接下载了一个名为 "zoom_sdk_support.scpt" 的AppleScript脚本。  
  
1. 执行该脚本后，它首先会打开一个合法的Zoom SDK网页以迷惑受害者，同时在后台静默地从远程服务器下载下一阶段的载荷。  
  
1. **后门部署与持久化:**  
1. 下载的shell脚本会执行一系列恶意操作，包括禁用bash历史记录、检查并安装Rosetta 2（用于在Apple Silicon Mac上运行x86_64程序）。  
  
1. 脚本会创建一个名为 ".pwd" 的隐藏文件，并从恶意Zoom站点下载一个Go语言编写的全功能后门（Root Troy V4）到 "/tmp/icloud_helper" 目录。  
  
1. 该后门能够执行远程AppleScript、shell命令，并下载和执行更多恶意模块。  
  
1. **多模块协同作业:**  
1. **Telegram 2:**  
 基于Nim的二进制文件，用于启动主后门。  
  
1. **Root Troy V4:**  
 Go语言编写的核心后门。  
  
1. **InjectWithDyld:**  
 C++编写的加载器，用于进程注入和加载其他Nim语言的植入体。  
  
1. **XScreen:**  
 Objective-C编写的键盘记录器，监控按键、剪贴板和屏幕内容。  
  
1. **CryptoBot:**  
 Go语言编写的信息窃取器，专门收集与加密货币相关的文件。  
  
1. 攻击链中部署了至少八个不同的恶意二进制文件，各司其职。其中包括：  
  
此次攻击充分展示了威胁行为者如何将前沿技术（Deepfake）与传统网络攻击技术（钓鱼、恶意软件）相结合，以突破组织防御。对远程工作者，特别是高价值目标的员工进行针对性安全意识培训至关重要。  
### 2. APT29利用Gmail应用专用密码(ASP)绕过2FA的新型攻击  
  
与俄罗斯有关的APT29组织（又名UNC6293, Cozy Bear）近期采用了一种极具欺骗性和耐心的社会工程学技术，成功绕过了受害者的双因素认证(2FA)，获得了对其Gmail邮箱的持久访问权限。此攻击不依赖任何技术漏洞，完全通过心理操纵实现。  
  
**攻击流程：**  
1. **长期潜伏与建立信任 (Rapport Building):**  
1. 攻击者首先会向目标（通常是学者或对俄持批评态度的人士）发送看似无害的钓鱼邮件，例如冒充美国国务院的会议邀请。  
  
1. 这些邮件通常会将多个虚构的“@state.gov”邮箱地址放在抄送(CC)行，以增加可信度。利用国务院邮件服务器不会对不存在的地址发送退信的特性，使得骗局更难被识破。  
  
1. 攻击者会与目标进行长达数周的邮件往来，耐心建立信任关系，这与传统钓鱼攻击强调紧迫性的做法截然不同。  
  
1. **诱导创建应用专用密码 (ASP):**  
1. 在获得目标信任后，攻击者会以“为了在内外部合作伙伴之间进行安全通信”为由，说服目标需要进行一项“安全设置”。  
  
1. 攻击者会发送一份PDF指南，详细指导目标如何在自己的Google账户中生成一个“应用专用密码”(App Specific Password, ASP)。  
  
1. ASP是Google提供的一种功能，允许在启用2FA的账户上，为不支持标准OAuth 2.0登录流程的“安全性较低的应用”（如某些邮件客户端）生成一个16位的专用密码，使用此密码登录时无需进行2FA验证。  
  
1. **凭证窃取与持久化访问:**  
1. 目标按照指南生成16位ASP后，被要求将其分享给攻击者，以便“完成安全云环境的配置”。  
  
1. 一旦攻击者获得这个ASP，他们就可以使用任何支持基本认证的邮件客户端（如Thunderbird、Outlook等）来配置和登录受害者的Gmail账户。  
  
1. 由于ASP的设计初衷就是绕过2FA，攻击者因此获得了对受害者邮箱的完全、持久的访问权限，可以自由阅读、发送邮件，而受害者几乎不会收到任何异常登录的警报。  
  
**关键点分析：**  
- **利用合法功能：**  
 攻击的核心是滥用Google账户的一项合法功能(ASP)，而非利用软件漏洞。  
  
- **心理操纵：**  
 成功的关键在于长期的信任建立和精心设计的骗局，让受害者主动交出关键凭证。  
  
- **绕过MFA：**  
 该技术有效绕过了基于OTP或推送通知的2FA保护，突显了即使是强大的安全控制也可能因社会工程学而失效。  
  
此案例强调了对“应用专用密码”等特殊登录机制进行严格管理和用户教育的重要性。组织应告诫员工，任何情况下都不应与他人分享任何形式的密码或访问代码。  
## 4. 工具与资源  
1. **Gh0st RAT 及其变种:**  
 HoldingHands RAT (Gh0stBins) 和 Gh0stCringe 均是基于知名开源远控木马 Gh0st RAT 的变种，具备强大的远程控制和信息窃取能力。  
  
1. **Donut:**  
 一个流行的开源shellcode生成工具，能将.NET程序集、VBScript、JScript等文件转换为内存中可执行的shellcode，常被用于无文件攻击中，以规避杀毒软件检测。  
  
1. **Cloudflare Tunnels:**  
 一项合法服务，用于将本地运行的服务安全地暴露到公网。然而，它正被SERPENTINE#CLOUD等威胁活动滥用，作为托管恶意载荷和C2通信的加密通道，增加了检测和封锁的难度。  
  
1. **Eye Pyramid C2:**  
 一款开源的C2框架，近期被发现被Rhysida勒索软件的附属组织用作后渗透工具，以维持对受感染端点的访问并部署额外载荷。项目地址: https://github.com/naksyn/Pyramid  
  
1. **AsyncRAT:**  
 一款开源的.NET远程访问木马，功能齐全，常被多个攻击活动（如SERPENTINE#CLOUD和Shadow Vector）用作最终载荷。  
  
1. **NFCGate:**  
 一款能够捕获和修改NFC流量的工具。其恶意修改版本（如SuperCard X）被用于实施NFC中继攻击，窃取银行卡数据。  
  
1. **Langflow:**  
 一个用于构建AI应用的可视化框架。其旧版本存在的RCE漏洞(  
CVE-2025-3248  
)被用于部署Flodrix僵尸网络。  
  
## 5. 言论  
1. “鉴于该行为者有一次专注于一个行业的历史，保险行业应保持高度警惕，特别是针对那些以其帮助台和呼叫中心为目标的社会工程学骗局。”  
—— John Hultquist, Google Threat Intelligence Group (GTIG) 首席分析师 (关于Scattered Spider)  
  
1. “如果你需要关于目标的法律咨询，只需点击目标界面内的‘呼叫律师’按钮，我们的法律团队将与你私下联系，提供合格的法律支持……律师在聊天中的出现本身就可以对公司施加间接压力，并增加赎金金额。”  
—— Qilin勒索软件团伙 (在其论坛上宣布新功能)  
  
1. “公开可用的源代码仓库（如GitHub）中的后门和木马化代码越来越普遍，代表着一个日益增长的软件供应链攻击向量。对于依赖这些开源平台的开发者来说，务必仔细检查你正在使用的仓库是否确实包含了你所期望的内容。”  
—— Robert Simmons, ReversingLabs研究员  
  
1. “2025年的以色列-伊朗冲突是现代混合战的一个鲜明例证，其中字节和叙事与炸弹和导弹一样，都是战斗的一部分。”  
—— Pascal Geenens, Radware威胁情报总监  
  
1. “默认情况下，近期版本的Sitecore附带一个硬编码密码为‘b’的用户。现在是2025年，我们不敢相信还必须说这个，但这非常糟糕。……如果你正在运行Sitecore，情况没有比这更糟的了——立即轮换凭证并打补丁。”  
—— Benjamin Harris, watchTowr创始人兼CEO  
  
