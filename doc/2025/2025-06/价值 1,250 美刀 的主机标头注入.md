#  价值 1,250 美刀 的主机标头注入  
原创 红云谈安全  红云谈安全   2025-06-09 09:55  
  
**免责声明**  
  
由于传播、利用本公众号红云谈安全所提供的信息而造成的任何直接或者间接的后果及损失，均由使用者本人负责，公众号红云谈安全及作者不为**此**  
承担任何责任，一旦造成后果请自行承担！  
如有侵权烦请告知，我们会立即删除并致歉。谢谢！请在授权的站点测试，遵守网络安全法！  
**仅供**  
**学习使用，****如若非法他用，与平台和本文作者无关，需自行负责！**  
  
**什么是主机标头注入？**  
  
Host 标头注入是一种 Web 安全漏洞，当攻击者在对 Web 服务器的 HTTP 请求中纵“Host”标头时，就会发生此漏洞。此标头是 HTTP 协议的一部分，用于指定应将请求发送到的目标域或主机。Host 标头注入攻击通常针对依赖 “Host” 标头来确定要提供的虚拟主机或网站的网站。以下是它的工作原理以及为什么它会对网站产生重大影响：  
  
**作 Host 标头**  
：在典型的 HTTP 请求中，“Host” 标头指定客户端要与之通信的服务器的域名或 IP 地址。例如：  
```
```  
  
能够控制或影响 “Host” 标头的攻击者可以将其更改为不同的域，可能是他们控制的域：  
```
```  
# 如何利用此漏洞：  
  
显然，从任何人那里获得 1,200 美元并不容易。主机标头注入被视为信息漏洞或 P5 严重性漏洞，除非您能够证明存在重大影响，例如使用“忘记密码”功能接管帐户，或者存在 Web 缓存中毒等其他链式漏洞。  
  
**请求：**  
```
```  
  
**响应：**  
```
```  
# 通过主机标头注入进行帐户接管：  
1. 最初，我首先访问“忘记密码”功能并发起密码重置请求。  
  
1. 随后，我收到一个包含重置密码令牌的链接。  
  
1. 为了评估是否存在漏洞，我特意在重置密码请求中的 **HOST**  
 标头末尾引入句号（句点）字符 （“.”） 并继续传输它。更改后的标头显示如下：Host： target.com。  
  
```
```  
  
4. 这次我检查电子邮件时，收到了一个重置密码令牌，其中包含我在 Host Header 中插入的句号。这确认了该网站容易受到主机标头注入的攻击。  
```
```  
  
5. 当我尝试在句号后添加任何内容时，我收到了 404 错误。这表明我需要绕过此限制才能继续进行进一步的开发。  
  
  
6. 因此，我通过在请求顶部添加完整 URL 来编写重置密码请求，以便接收“200 OK”响应  
```
```  
  
7. 但现在我收到 400 个错误请求：  
  
  
8.经过一番思考和研究，我意识到当前版本的 Burp Suite 可能是产生“400 Bad Request”错误的原因。因此，我决定使用旧版本的 Burp Suite，例如 1.7.34。  
  
9. BOOOOOOOOOOOOOOOOOOOM，我成功了。  
  
  
10. 现在，为了演示完整的漏洞利用，我只需将 Burp Collaborator 链接添加到 Host 标头并发送请求。  
  
  
11. 受害者将收到精心制作的重置密码链接。每当受害者点击此链接时，我都会在我的 Burp Collaborator 中收到他们的重置密码令牌。  
  
  
12. 现在我可以用这个代币来接管受害者的账户，结果，我收到了 1,250 美元的赏金。  
  
  
  
  
  
  
