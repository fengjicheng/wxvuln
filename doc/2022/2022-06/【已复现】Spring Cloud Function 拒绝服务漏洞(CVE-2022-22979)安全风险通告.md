#  【已复现】Spring Cloud Function 拒绝服务漏洞(CVE-2022-22979)安全风险通告   
原创 QAX CERT  奇安信 CERT   2022-06-28 19:32  
  
![](https://mmbiz.qpic.cn/mmbiz_png/EkibxOB3fs4icrhoWdKnhTgicSjB9pXdeZwDibNIBAEMegibEdG1vrjOibsq887TUz3ztMkM6Qvibic7r26sqbUIbicOMYg/640?wx_fmt=png "https://image.ipaiban.com/upload-ueditor-image-20201112-1605175807303084927.png")  
  
奇安信CERT  
  
**致力于**  
第一时间  
为企业级用户提供安全风险  
**通告**  
和  
**有效**  
解决方案。  
  
  
**安全通告**  
  
  
  
近日，奇安信CERT监测到Spring Cloud Function拒绝服务漏洞(CVE-2022-22979)技术细节在互联网上公开，攻击者可以向Spring Cloud Function发送大量特制的HTTP请求消耗服务器资源，从而导致拒绝服务。**鉴于这些漏洞影响范围较大，建议客户尽快做好自查及防护。**  
  
****  
<table><tbody><tr><td style="word-break: break-all;padding: 5px 10px;border-color: rgb(221, 221, 221);" width="89"><p><strong><span style="font-size: 14px;">漏洞名称</span></strong></p></td><td colspan="3" style="padding: 5px 10px;word-break: break-all;border-color: rgb(221, 221, 221);"><p><span style="font-size: 14px;">Spring Cloud Function拒绝服务漏洞</span></p></td></tr><tr><td style="padding: 5px 10px;border-color: rgb(221, 221, 221);" width="110"><p><strong><span style="font-size: 14px;">公开时间</span></strong></p></td><td style="padding: 5px 10px;border-color: rgb(221, 221, 221);" width="207"><p><span style="font-size: 14px;">2022-06-21</span></p></td><td style="word-break: break-all;padding: 5px 10px;border-color: rgb(221, 221, 221);" width="158"><p><strong><span style="font-size: 14px;">更新时间</span></strong></p></td><td style="padding: 5px 10px;border-color: rgb(221, 221, 221);" width="229"><p><span style="font-size: 14px;">2022-06-28</span></p></td></tr><tr><td style="padding: 5px 10px;border-color: rgb(221, 221, 221);" width="128"><p><strong><span style="font-size: 14px;">CVE编号</span></strong></p></td><td style="padding: 5px 10px;border-color: rgb(221, 221, 221);" width="217"><p><span style="font-size: 14px;">CVE-2022-22979</span></p></td><td style="padding: 5px 10px;border-color: rgb(221, 221, 221);" width="168"><p><strong><span style="font-size: 14px;">其他编号</span></strong></p></td><td style="padding: 5px 10px;border-color: rgb(221, 221, 221);" width="232"><p><span style="font-size: 14px;">QVD-2022-9758</span></p></td></tr><tr><td style="padding: 5px 10px;border-color: rgb(221, 221, 221);" width="139"><p><strong><span style="font-size: 14px;">威胁类型</span></strong></p></td><td style="padding: 5px 10px;border-color: rgb(221, 221, 221);" width="217"><p><span style="font-size: 14px;">拒绝服务</span></p></td><td style="padding: 5px 10px;border-color: rgb(221, 221, 221);" width="173"><p><strong><span style="font-size: 14px;">技术类型</span></strong></p></td><td style="padding: 5px 10px;border-color: rgb(221, 221, 221);" width="230"><p><span style="font-size: 14px;">无限制的资源分配</span></p></td></tr><tr><td style="padding: 5px 10px;border-color: rgb(221, 221, 221);" width="146"><p><strong><span style="font-size: 14px;">厂商</span></strong></p></td><td style="padding: 5px 10px;border-color: rgb(221, 221, 221);" width="213"><p><span style="font-size: 14px;">VMware</span></p></td><td style="word-break: break-all;padding: 5px 10px;border-color: rgb(221, 221, 221);" width="175"><p><strong><span style="font-size: 14px;">产品</span></strong></p></td><td style="padding: 5px 10px;border-color: rgb(221, 221, 221);word-break: break-all;" width="227"><p><span style="font-size: 14px;">Spring Cloud Function</span></p></td></tr><tr><td colspan="4" align="center" valign="middle" style="word-break: break-all;padding: 5px 10px;border-color: rgb(221, 221, 221);"><p><strong><span style="font-size: 14px;">风险等级</span></strong></p></td></tr><tr><td colspan="2" align="center" valign="middle" style="padding: 5px 10px;border-color: rgb(221, 221, 221);"><p><strong><span style="font-size: 14px;">奇安信CERT风险评级</span></strong></p></td><td colspan="2" align="center" valign="middle" style="padding: 5px 10px;border-color: rgb(221, 221, 221);"><p><strong><span style="font-size: 14px;">风险等级</span></strong></p></td></tr><tr><td colspan="2" align="center" valign="middle" style="padding: 5px 10px;border-color: rgb(221, 221, 221);"><p><span style="color: rgb(255, 0, 0);"><strong><span style="color: rgb(255, 0, 0);font-size: 14px;">高危</span></strong></span></p></td><td colspan="2" align="center" valign="middle" style="padding: 5px 10px;border-color: rgb(221, 221, 221);"><p><span style="color: rgb(12, 118, 240);"><strong><span style="color: rgb(12, 118, 240);font-size: 14px;">蓝色（一般事件）</span></strong></span></p></td></tr><tr><td colspan="4" align="center" valign="middle" style="padding: 5px 10px;border-color: rgb(221, 221, 221);"><p><strong><span style="font-size: 14px;">现时威胁状态</span></strong></p></td></tr><tr><td align="center" valign="middle" style="padding: 5px 10px;border-color: rgb(221, 221, 221);" width="151"><p><strong><span style="font-size: 14px;">POC状态</span></strong></p></td><td align="center" valign="middle" style="padding: 5px 10px;border-color: rgb(221, 221, 221);" width="212"><p><strong><span style="font-size: 14px;">EXP状态</span></strong></p></td><td align="center" valign="middle" style="padding: 5px 10px;border-color: rgb(221, 221, 221);" width="175"><p><strong><span style="font-size: 14px;">在野利用状态</span></strong></p></td><td align="center" valign="middle" style="padding: 5px 10px;border-color: rgb(221, 221, 221);" width="226"><p><strong><span style="font-size: 14px;">技术细节状态</span></strong></p></td></tr><tr><td align="center" valign="middle" style="padding: 5px 10px;border-color: rgb(221, 221, 221);" width="154"><p><strong><span style="font-size: 14px;color: rgb(255, 0, 0);">已发现</span></strong></p></td><td align="center" valign="middle" style="padding: 5px 10px;border-color: rgb(221, 221, 221);" width="211"><p><span style="font-size: 14px;">未发现</span></p></td><td align="center" valign="middle" style="padding: 5px 10px;border-color: rgb(221, 221, 221);" width="175"><p><span style="font-size: 14px;">未发现</span></p></td><td align="center" valign="middle" style="padding: 5px 10px;border-color: rgb(221, 221, 221);" width="225"><p><span style="color: rgb(255, 0, 0);"><strong><span style="font-size: 14px;">已公开</span></strong></span><span style="font-size: 14px;"></span></p></td></tr><tr><td style="word-break: break-all;padding: 5px 10px;border-color: rgb(221, 221, 221);" width="156"><p><strong><span style="font-size: 14px;">漏洞描述</span></strong></p></td><td colspan="3" style="padding: 5px 10px;border-color: rgb(221, 221, 221);"><p><span style="font-size: 14px;">在Spring Cloud Function 中存在拒绝服务漏洞，攻击者可以发送大量特制的HTTP请求触发漏洞，成功利用此漏洞将消耗大量服务器资源最终导致拒绝服务。</span></p></td></tr><tr><td style="padding: 5px 10px;border-color: rgb(221, 221, 221);" width="158"><p><strong><span style="font-size: 14px;">影响版本</span></strong></p></td><td colspan="3" style="padding: 5px 10px;border-color: rgb(221, 221, 221);"><p><span style="font-size: 14px;">Spring Cloud Function &lt; 3.2.6</span></p><p><span style="font-size: 14px;">旧的、不受支持的版本也会受到影响</span></p></td></tr><tr><td style="padding: 5px 10px;border-color: rgb(221, 221, 221);" width="159"><p><strong><span style="font-size: 14px;">不受影响版本</span></strong></p></td><td colspan="3" style="padding: 5px 10px;border-color: rgb(221, 221, 221);"><p><span style="font-size: 14px;">Spring Cloud Function &gt;= 3.2.6</span></p></td></tr><tr><td style="padding: 5px 10px;border-color: rgb(221, 221, 221);" width="160"><p><strong><span style="font-size: 14px;">其他受影响组件</span></strong></p></td><td colspan="3" style="padding: 5px 10px;border-color: rgb(221, 221, 221);"><p><span style="font-size: 14px;">无</span></p></td></tr></tbody></table>  
  
  
目前奇安信CERT已成功复现**Spring Cloud Function 拒绝服务漏洞(CVE-2022-22979)**，截图如下：  
  
![](https://mmbiz.qpic.cn/mmbiz_png/EkibxOB3fs4ib3xkXKApsbvKS6vvYII6yBOx5PgBgqoWVo3dBGhkIuzmsjztt39gwoEa3uQMYq328btk11nO1UkQ/640?wx_fmt=png "")  
  
  
威胁评估  
  
<table><tbody><tr><td style="word-break: break-all;padding: 5px 10px;" width="13"><p><span style="font-size: 14px;"><strong>漏洞名称</strong></span></p></td><td colspan="4" style="word-break: break-all;padding: 5px 10px;" align="center" valign="middle" width="467"><p><span style="font-size: 14px;">Spring Cloud Function 拒绝服务漏洞</span></p></td></tr><tr><td style="padding: 5px 10px;" width="68"><p><span style="font-size: 14px;"><strong>CVE编号</strong></span></p></td><td align="center" valign="middle" style="padding: 5px 10px;" width="105"><p><span style="font-size: 14px;">CVE-2022-22979</span></p></td><td colspan="2" style="word-break: break-all;padding: 5px 10px;" width="204"><p><span style="font-size: 14px;"><strong>其他编号</strong></span></p></td><td align="center" valign="middle" style="padding: 5px 10px;" width="101"><p><span style="font-size: 14px;">QVD-2022-9758</span></p></td></tr><tr><td style="padding: 5px 10px;" width="13"><p><span style="font-size: 14px;"><strong>CVSS 3.1评级</strong></span></p></td><td style="padding: 5px 10px;" width="105" align="center" valign="middle"><p><span style="font-size: 14px;">高危</span></p></td><td colspan="2" style="word-break: break-all;padding: 5px 10px;" width="78"><p><span style="font-size: 14px;"><strong>CVSS 3.1分数</strong></span></p></td><td style="padding: 5px 10px;" align="center" valign="middle" width="101"><p><span style="font-size: 14px;">7.5</span></p></td></tr><tr><td rowspan="8" style="padding: 5px 10px;" width="13"><p><span style="font-size: 14px;"><strong>CVSS向量</strong></span></p></td><td colspan="2" align="center" valign="middle" style="word-break: break-all;padding: 5px 10px;" width="329"><p><span style="font-size: 14px;"><strong>访问途径（AV）</strong></span></p></td><td colspan="2" align="center" valign="middle" style="padding: 5px 10px;"><p><span style="font-size: 14px;"><strong>攻击复杂度（AC）</strong></span></p></td></tr><tr><td colspan="2" align="center" valign="middle" style="padding: 5px 10px;" width="192"><p><span style="font-size: 14px;">网络</span></p></td><td colspan="2" align="center" valign="middle" style="padding: 5px 10px;" width="78"><p><span style="font-size: 14px;">低</span></p></td></tr><tr><td colspan="2" align="center" valign="middle" style="word-break: break-all;padding: 5px 10px;" width="261"><p><span style="font-size: 14px;"><strong>所需权限（PR）</strong></span></p></td><td colspan="2" align="center" valign="middle" style="padding: 5px 10px;" width="78"><p><span style="font-size: 14px;"><strong>用户交互（UI）</strong></span></p></td></tr><tr><td colspan="2" align="center" valign="middle" style="padding: 5px 10px;" width="275"><p><span style="font-size: 14px;">无</span></p></td><td colspan="2" align="center" valign="middle" style="padding: 5px 10px;" width="78"><p><span style="font-size: 14px;">不需要</span></p></td></tr><tr><td colspan="2" align="center" valign="middle" style="word-break: break-all;padding: 5px 10px;" width="281"><p><span style="font-size: 14px;"><strong>影响范围（S）</strong></span></p></td><td colspan="2" align="center" valign="middle" style="padding: 5px 10px;" width="78"><p><span style="font-size: 14px;"><strong>机密性影响（C）</strong></span></p></td></tr><tr><td colspan="2" align="center" valign="middle" style="padding: 5px 10px;" width="284"><p><span style="font-size: 14px;">不改变</span></p></td><td colspan="2" align="center" valign="middle" style="padding: 5px 10px;" width="78"><p><span style="font-size: 14px;">无</span></p></td></tr><tr><td colspan="2" align="center" valign="middle" style="word-break: break-all;padding: 5px 10px;" width="285"><p><span style="font-size: 14px;"><strong>完整性影响（I）</strong></span></p></td><td colspan="2" align="center" valign="middle" style="padding: 5px 10px;" width="78"><p><span style="font-size: 14px;"><strong>可用性影响（A）</strong></span></p></td></tr><tr><td colspan="2" align="center" valign="middle" style="padding: 5px 10px;" width="286"><p><span style="font-size: 14px;">无</span></p></td><td colspan="2" align="center" valign="middle" style="padding: 5px 10px;" width="78"><p><span style="font-size: 14px;">高</span></p></td></tr><tr><td style="padding: 5px 10px;" width="13"><p><span style="font-size: 14px;"><strong>危害描述</strong></span></p></td><td colspan="4" style="padding: 5px 10px;" width="467"><p><span style="font-size: 14px;">攻击者可以发送特制的HTTP请求触发漏洞，成功利用此漏洞将消耗大量服务器资源，最终导致拒绝服务。</span></p></td></tr></tbody></table>  
  
  
处置建议  
  
目前VMware官方已发布此漏洞修复版本，建议用户尽快升级至Spring Cloud Function 3.2.6及以上版本。  
  
https://github.com/spring-cloud/spring-cloud-function/releases/tag/v3.2.6  
  
  
产品解决方案  
  
**奇安信网站应用安全云防护系统已更新防护特征库**  
  
奇安信网神网站应用安全云防护系统已全面支持对Spring Cloud Function 拒绝服务漏洞(CVE-2022-22979)的防护。  
  
  
**奇安信开源卫士已支持**  
  
奇安信开源卫士20220628. 1112版本已支持对Spring Cloud Function拒绝服务漏洞(CVE-2022-22979)的检测。  
  
  
参考资料  
  
[1]https://tanzu.vmware.com/security/cve-2022-22979  
  
[2]https://checkmarx.com/blog/spring-function-cloud-dos-cve-2022-22979-and-unintended-function-invocation/  
  
  
时间线  
  
2022年6月28日，奇安信 CERT发布安全风险通告  
  
  
点击**阅读原文**  
到奇安信NOX-安全监测平台查询更多漏洞详情  
