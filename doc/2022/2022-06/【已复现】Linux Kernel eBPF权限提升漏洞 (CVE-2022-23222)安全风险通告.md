#  【已复现】Linux Kernel eBPF权限提升漏洞 (CVE-2022-23222)安全风险通告   
原创 QAX CERT  奇安信 CERT   2022-06-13 19:52  
  
![](https://mmbiz.qpic.cn/mmbiz_png/EkibxOB3fs4icrhoWdKnhTgicSjB9pXdeZwDibNIBAEMegibEdG1vrjOibsq887TUz3ztMkM6Qvibic7r26sqbUIbicOMYg/640?wx_fmt=png "https://image.ipaiban.com/upload-ueditor-image-20201112-1605175807303084927.png")  
  
奇安信CERT  
  
**致力于**  
第一时间  
为企业级用户提供安全风险  
**通告**  
和  
**有效**  
解决方案。  
  
  
**安全通告**  
  
  
  
  
  
近日，奇安信CERT监测到Linux Kernel eBPF权限提升漏洞(CVE-2022-23222) 的POC 在互联网上公开。  
由于内核在执行用户提供的 eBPF 程序前缺乏适当的验证，攻击者可利用这个漏洞提升权限并在内核上下文中执行代码。  
要利用此漏洞，攻击者首先需要获得在目标系统上执行低权限代码的能力。  
在大  
多数Linux发行版本中默认禁用非特权运行 BPF 程序。  
经验证，此漏洞 POC 有效。  
  
**目前，此漏洞细节、POC 及 EXP 已在互联网上流传。**  
鉴于此漏洞影响范围较大，危害较大，建议客户尽快做好自查及防护。  
<table><tbody><tr style="height:25px;"><td style="border-width: 1px;border-style: solid;border-color: rgb(221, 221, 221);padding: 0px 7px;" height="25" width="54"><section style="text-align: justify;line-height: 115%;margin-left: 0px;margin-right: 0px;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong><span style="line-height: 115%;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">漏洞名称</span></strong></span></section></td><td colspan="3" style="border-top: 1px solid rgb(221, 221, 221);border-right: 1px solid rgb(221, 221, 221);border-bottom: 1px solid rgb(221, 221, 221);border-left: none rgb(221, 221, 221);padding: 0px 7px;" height="25"><section style="text-align: justify;line-height: 115%;margin-left: 0px;margin-right: 0px;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">Linux Kernel eBPF权限提升漏洞</span></section></td></tr><tr style="height:25px;"><td style="border-right: 1px solid rgb(221, 221, 221);border-bottom: 1px solid rgb(221, 221, 221);border-left: 1px solid rgb(221, 221, 221);border-top: none rgb(221, 221, 221);padding: 0px 7px;" height="25" width="69"><section style="text-align: justify;line-height: 115%;margin-left: 0px;margin-right: 0px;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong><span style="line-height: 115%;color: black;font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">公开时间</span></strong></span></section></td><td style="border-top: none rgb(221, 221, 221);border-left: none rgb(221, 221, 221);border-bottom: 1px solid rgb(221, 221, 221);border-right: 1px solid rgb(221, 221, 221);padding: 0px 7px;" height="25" width="246"><section style="text-align: justify;line-height: 115%;margin-left: 0px;margin-right: 0px;"><span style="color: black;font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">2022-01-14</span></section></td><td style="border-top: none rgb(221, 221, 221);border-left: none rgb(221, 221, 221);border-bottom: 1px solid rgb(221, 221, 221);border-right: 1px solid rgb(221, 221, 221);padding: 0px 7px;" height="25" width="190"><section style="text-align: justify;line-height: 115%;margin-left: 0px;margin-right: 0px;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong><span style="color: black;font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">更新时间</span></strong></span></section></td><td style="border-top: none rgb(221, 221, 221);border-left: none rgb(221, 221, 221);border-bottom: 1px solid rgb(221, 221, 221);border-right: 1px solid rgb(221, 221, 221);padding: 0px 7px;" height="25" width="217"><section style="text-align: justify;line-height: 115%;margin-left: 0px;margin-right: 0px;"><span style="color: black;font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">2022-06-13</span></section></td></tr><tr style="height:25px;"><td style="border-right: 1px solid rgb(221, 221, 221);border-bottom: 1px solid rgb(221, 221, 221);border-left: 1px solid rgb(221, 221, 221);border-top: none rgb(221, 221, 221);padding: 0px 7px;" height="25" width="83"><section style="text-align: justify;line-height: 115%;margin-left: 0px;margin-right: 0px;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong><span style="line-height: 115%;color: black;font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">CVE</span></strong><strong><span style="line-height: 115%;color: black;font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">编号</span></strong></span></section></td><td style="border-top: none rgb(221, 221, 221);border-left: none rgb(221, 221, 221);border-bottom: 1px solid rgb(221, 221, 221);border-right: 1px solid rgb(221, 221, 221);padding: 0px 7px;" height="25" width="251"><section style="text-align: justify;line-height: 115%;margin-left: 0px;margin-right: 0px;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">CVE-2022-23222</span></section></td><td style="border-top: none rgb(221, 221, 221);border-left: none rgb(221, 221, 221);border-bottom: 1px solid rgb(221, 221, 221);border-right: 1px solid rgb(221, 221, 221);padding: 0px 7px;" height="25" width="196"><section style="text-align: justify;line-height: 115%;margin-left: 0px;margin-right: 0px;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong><span style="color: black;font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">其他编号</span></strong></span></section></td><td style="border-top: none rgb(221, 221, 221);border-left: none rgb(221, 221, 221);border-bottom: 1px solid rgb(221, 221, 221);border-right: 1px solid rgb(221, 221, 221);padding: 0px 7px;" height="25" width="221"><section style="text-align: justify;line-height: 115%;margin-left: 0px;margin-right: 0px;"><span style="color: black;font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">QVD-2022-1175</span></section></td></tr><tr style="height:25px;"><td style="border-right: 1px solid rgb(221, 221, 221);border-bottom: 1px solid rgb(221, 221, 221);border-left: 1px solid rgb(221, 221, 221);border-top: none rgb(221, 221, 221);padding: 0px 7px;" height="25" width="93"><section style="text-align: justify;line-height: 115%;margin-left: 0px;margin-right: 0px;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong><span style="line-height: 115%;color: black;font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">威胁类型</span></strong></span></section></td><td style="border-top: none rgb(221, 221, 221);border-left: none rgb(221, 221, 221);border-bottom: 1px solid rgb(221, 221, 221);border-right: 1px solid rgb(221, 221, 221);padding: 0px 7px;" height="25" width="248"><section style="text-align: justify;line-height: 115%;margin-left: 0px;margin-right: 0px;"><span style="line-height: 115%;color: black;font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">权限提升</span></section></td><td style="border-top: none rgb(221, 221, 221);border-left: none rgb(221, 221, 221);border-bottom: 1px solid rgb(221, 221, 221);border-right: 1px solid rgb(221, 221, 221);padding: 0px 7px;" height="25" width="197"><section style="text-align: justify;line-height: 115%;margin-left: 0px;margin-right: 0px;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong><span style="line-height: 115%;color: black;font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">技术类型</span></strong></span></section></td><td style="border-top: none rgb(221, 221, 221);border-left: none rgb(221, 221, 221);border-bottom: 1px solid rgb(221, 221, 221);border-right: 1px solid rgb(221, 221, 221);padding: 0px 7px;" height="25" width="220"><section style="text-align: justify;line-height: 115%;margin-left: 0px;margin-right: 0px;"><span style="line-height: 115%;color: black;font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">空指针引用</span></section></td></tr><tr style="height:25px;"><td style="border-right: 1px solid rgb(221, 221, 221);border-bottom: 1px solid rgb(221, 221, 221);border-left: 1px solid rgb(221, 221, 221);border-top: none rgb(221, 221, 221);padding: 0px 7px;" height="25" width="101"><section style="line-height: 115%;margin-left: 0px;margin-right: 0px;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong><span style="line-height: 115%;color: black;font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">厂商</span></strong></span></section></td><td style="border-top: none rgb(221, 221, 221);border-left: none rgb(221, 221, 221);border-bottom: 1px solid rgb(221, 221, 221);border-right: 1px solid rgb(221, 221, 221);padding: 0px 7px;" height="25" width="246"><section style="text-align: justify;line-height: 115%;margin-left: 0px;margin-right: 0px;"><span style="line-height: 115%;color: black;font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">Linux</span></section></td><td style="border-top: none rgb(221, 221, 221);border-left: none rgb(221, 221, 221);border-bottom: 1px solid rgb(221, 221, 221);border-right: 1px solid rgb(221, 221, 221);padding: 0px 7px;" height="25" width="196"><section style="line-height: 115%;margin-left: 0px;margin-right: 0px;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong><span style="line-height: 115%;color: black;font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">产品</span></strong></span></section></td><td style="border-top: none rgb(221, 221, 221);border-left: none rgb(221, 221, 221);border-bottom: 1px solid rgb(221, 221, 221);border-right: 1px solid rgb(221, 221, 221);padding: 0px 7px;" height="25" width="218"><section style="text-align: justify;line-height: 115%;margin-left: 0px;margin-right: 0px;"><span style="line-height: 115%;color: black;font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">Linux kernel</span></section></td></tr><tr style="height:32px;"><td colspan="4" style="border-right: 1px solid rgb(221, 221, 221);border-bottom: 1px solid rgb(221, 221, 221);border-left: 1px solid rgb(221, 221, 221);border-top: none rgb(221, 221, 221);padding: 0px 7px;" height="32"><section style="text-align: center;margin-left: 0px;margin-right: 0px;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong><span style="line-height: 150%;font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">风险等级</span></strong></span></section></td></tr><tr style="height:32px;"><td colspan="2" style="border-right: 1px solid rgb(221, 221, 221);border-bottom: 1px solid rgb(221, 221, 221);border-left: 1px solid rgb(221, 221, 221);border-top: none rgb(221, 221, 221);padding: 0px 7px;" height="32"><section style="text-align: center;margin-left: 0px;margin-right: 0px;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong><span style="line-height: 150%;font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">奇安信</span></strong><strong><span style="line-height: 150%;font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">CERT</span></strong><strong><span style="line-height: 150%;font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">风险评级</span></strong></span></section></td><td colspan="2" style="border-top: none rgb(221, 221, 221);border-left: none rgb(221, 221, 221);border-bottom: 1px solid rgb(221, 221, 221);border-right: 1px solid rgb(221, 221, 221);padding: 0px 7px;" height="32"><section style="text-align: center;margin-left: 0px;margin-right: 0px;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong><span style="line-height: 150%;font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">风险等级</span></strong></span></section></td></tr><tr style="height:32px;"><td colspan="2" style="border-right: 1px solid rgb(221, 221, 221);border-bottom: 1px solid rgb(221, 221, 221);border-left: 1px solid rgb(221, 221, 221);border-top: none rgb(221, 221, 221);padding: 0px 7px;" height="32"><section style="text-align: center;margin-left: 0px;margin-right: 0px;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong><span style="line-height: 150%;color: red;font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">高危</span></strong></span></section></td><td colspan="2" style="border-top: none rgb(221, 221, 221);border-left: none rgb(221, 221, 221);border-bottom: 1px solid rgb(221, 221, 221);border-right: 1px solid rgb(221, 221, 221);padding: 0px 7px;" height="32"><section style="text-align: center;margin-left: 0px;margin-right: 0px;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong><span style="line-height: 150%;color: rgb(0, 112, 192);font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">蓝色（一般事件）</span></strong></span></section></td></tr><tr style="height:29px;"><td colspan="4" style="border-right: 1px solid rgb(221, 221, 221);border-bottom: 1px solid rgb(221, 221, 221);border-left: 1px solid rgb(221, 221, 221);border-top: none rgb(221, 221, 221);padding: 0px 7px;" height="29"><section style="text-align: center;margin-left: 0px;margin-right: 0px;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong><span style="line-height: 150%;font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">现时威胁状态</span></strong></span></section></td></tr><tr style="height:29px;"><td style="border-right: 1px solid rgb(221, 221, 221);border-bottom: 1px solid rgb(221, 221, 221);border-left: 1px solid rgb(221, 221, 221);border-top: none rgb(221, 221, 221);padding: 0px 7px;" height="29" width="107"><section style="text-align: center;margin-left: 0px;margin-right: 0px;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong><span style="line-height: 150%;font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">POC</span></strong><strong><span style="line-height: 150%;font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">状态</span></strong></span></section></td><td style="border-top: none rgb(221, 221, 221);border-left: none rgb(221, 221, 221);border-bottom: 1px solid rgb(221, 221, 221);border-right: 1px solid rgb(221, 221, 221);padding: 0px 7px;" height="29" width="244"><section style="text-align: center;margin-left: 0px;margin-right: 0px;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong><span style="line-height: 150%;font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">EXP</span></strong><strong><span style="line-height: 150%;font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">状态</span></strong></span></section></td><td style="border-top: none rgb(221, 221, 221);border-left: none rgb(221, 221, 221);border-bottom: 1px solid rgb(221, 221, 221);border-right: 1px solid rgb(221, 221, 221);padding: 0px 7px;" height="29" width="195"><section style="text-align: center;margin-left: 0px;margin-right: 0px;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong><span style="line-height: 150%;font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">在野利用状态</span></strong></span></section></td><td style="border-top: none rgb(221, 221, 221);border-left: none rgb(221, 221, 221);border-bottom: 1px solid rgb(221, 221, 221);border-right: 1px solid rgb(221, 221, 221);padding: 0px 7px;" height="29" width="217"><section style="text-align: center;margin-left: 0px;margin-right: 0px;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong><span style="line-height: 150%;font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">技术细节状态</span></strong></span></section></td></tr><tr style="height:28px;"><td style="border-right: 1px solid rgb(221, 221, 221);border-bottom: 1px solid rgb(221, 221, 221);border-left: 1px solid rgb(221, 221, 221);border-top: none rgb(221, 221, 221);padding: 0px 7px;" height="28" width="112"><section style="text-align: center;margin-left: 0px;margin-right: 0px;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong><span style="line-height: 150%;color: red;font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">已公开</span></strong></span></section></td><td style="border-top: none rgb(221, 221, 221);border-left: none rgb(221, 221, 221);border-bottom: 1px solid rgb(221, 221, 221);border-right: 1px solid rgb(221, 221, 221);padding: 0px 7px;" height="28" width="242"><section style="text-align: center;margin-left: 0px;margin-right: 0px;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong><span style="line-height: 150%;color: red;font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">已公开</span></strong></span></section></td><td style="border-top: none rgb(221, 221, 221);border-left: none rgb(221, 221, 221);border-bottom: 1px solid rgb(221, 221, 221);border-right: 1px solid rgb(221, 221, 221);padding: 0px 7px;" height="28" width="194"><section style="text-align: center;margin-left: 0px;margin-right: 0px;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong><span style="line-height: 150%;font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">未知</span></strong></span></section></td><td style="border-top: none rgb(221, 221, 221);border-left: none rgb(221, 221, 221);border-bottom: 1px solid rgb(221, 221, 221);border-right: 1px solid rgb(221, 221, 221);padding: 0px 7px;" height="28" width="215"><section style="text-align: center;margin-left: 0px;margin-right: 0px;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong><span style="line-height: 150%;color: red;font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">已公开</span></strong></span></section></td></tr><tr style="height:104px;"><td style="border-right: 1px solid rgb(221, 221, 221);border-bottom: 1px solid rgb(221, 221, 221);border-left: 1px solid rgb(221, 221, 221);border-top: none rgb(221, 221, 221);padding: 0px 7px;" height="104" width="115"><p style="text-align:justify;text-justify:inter-ideograph;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong><span style="line-height: 150%;font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">漏洞描述</span></strong></span></p></td><td colspan="3" valign="top" style="border-top: none rgb(221, 221, 221);border-left: none rgb(221, 221, 221);border-bottom: 1px solid rgb(221, 221, 221);border-right: 1px solid rgb(221, 221, 221);padding: 0px 7px;" height="104"><p><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">该漏洞的存在是由于Linux 内核的BPF 验证器没有对 *_OR_NULL指针类型进行限制，允许这些类型进行指针运算。将一个*_OR_NULL类型的NULL指针r0传递给r1，再将r1加1，然后对r0进行NULL检查，此时eBPF会认为r0和r1都为0，但实际上r0为0，r1为1，攻击者可以利用这个漏洞提升本地权限至ROOT。</span></p></td></tr><tr style="height:61px;"><td style="border-right: 1px solid rgb(221, 221, 221);border-bottom: 1px solid rgb(221, 221, 221);border-left: 1px solid rgb(221, 221, 221);border-top: none rgb(221, 221, 221);padding: 0px 7px;" height="61" width="117"><p style="text-align:justify;text-justify:inter-ideograph;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong><span style="line-height: 150%;font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">影响版本</span></strong></span></p></td><td colspan="3" style="border-top: none rgb(221, 221, 221);border-left: none rgb(221, 221, 221);border-bottom: 1px solid rgb(221, 221, 221);border-right: 1px solid rgb(221, 221, 221);padding: 0px 7px;" height="61"><section style="line-height: normal;text-indent: 0em;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">5.8.0 &lt;= Linux   kernel &lt;= 5.16</span></section></td></tr><tr style="height:140px;"><td style="border-right: 1px solid rgb(221, 221, 221);border-bottom: 1px solid rgb(221, 221, 221);border-left: 1px solid rgb(221, 221, 221);border-top: none rgb(221, 221, 221);padding: 0px 7px;" height="140" width="119"><p style="text-align:justify;text-justify:inter-ideograph;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong><span style="line-height: 150%;font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">不受影响版本</span></strong></span></p></td><td colspan="3" style="border-top: none rgb(221, 221, 221);border-left: none rgb(221, 221, 221);border-bottom: 1px solid rgb(221, 221, 221);border-right: 1px solid rgb(221, 221, 221);padding: 0px 7px;" height="140"><pre style="margin-left:32px;"><p style="margin-left: 0px;margin-right: 0px;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">Linux kernel &gt; 5.10.92</span></p></pre><pre style="margin-left:32px;"><p style="text-indent: 0em;margin-left: 0px;margin-right: 0px;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">Linux kernel &gt; 5.15.15</span></p></pre><pre style="margin-left:32px;"><p style="margin-left: 0px;margin-right: 0px;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">Linux kernel &gt; 5.16.1</span></p></pre><pre style="margin-left:32px;"><p style="margin-left: 0px;margin-right: 0px;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">Linux kernel &lt; 5.8.0</span></p></pre></td></tr><tr style="height:110px;"><td style="border-right: 1px solid rgb(221, 221, 221);border-bottom: 1px solid rgb(221, 221, 221);border-left: 1px solid rgb(221, 221, 221);border-top: none rgb(221, 221, 221);padding: 0px 7px;" height="110" width="120"><p style="text-align:justify;text-justify:inter-ideograph;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong><span style="line-height: 150%;font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">其他受影响组件</span></strong></span></p></td><td colspan="3" style="border-top: none rgb(221, 221, 221);border-left: none rgb(221, 221, 221);border-bottom: 1px solid rgb(221, 221, 221);border-right: 1px solid rgb(221, 221, 221);padding: 0px 7px;" height="110"><p><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">暂无</span></p></td></tr></tbody></table>  
奇安信CERT已复现**Linux Kernel 权限提升漏洞 (CVE-2022-23222)**，复现截图：  
  
  
![](https://mmbiz.qpic.cn/mmbiz_png/EkibxOB3fs4ibMYtzhgiaaRhJBunSfCQuh3iadxWDXtEiaok8KP16UxvsCRwBzzyzL0x7Miab1KMBok9ttpCMIh8MAuw/640?wx_fmt=png "")  
  
  
  
风险等级  
  
奇安信 CERT风险评级为：  
高危  
  
风险等级：  
蓝色（一般事件）  
  
  
威胁评估  
  
<table><tbody><tr style="height:25px;"><td style="border-width: 1px;border-style: solid;border-color: windowtext;padding: 0px 7px;" height="25" width="76"><section style="text-align: justify;margin-left: 0px;margin-right: 0px;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong><span style="line-height: 150%;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">漏洞名称</span></strong></span></section></td><td colspan="4" style="border-top: 1px solid windowtext;border-right: 1px solid windowtext;border-bottom: 1px solid windowtext;border-left: none windowtext;padding: 0px 7px;" height="25" width="468"><section style="text-align: center;margin-left: 0px;margin-right: 0px;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">Linux Kernel eBPF权限提升漏洞</span></section></td></tr><tr style="height:25px;"><td style="border-right: 1px solid windowtext;border-bottom: 1px solid windowtext;border-left: 1px solid windowtext;border-top: none windowtext;padding: 0px 7px;" height="25" width="67"><section style="text-align: justify;margin-left: 0px;margin-right: 0px;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong><span style="line-height: 150%;font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">CVE</span></strong><strong><span style="line-height: 150%;font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">编号</span></strong></span></section></td><td style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="25" width="106"><section style="text-align: center;margin-left: 0px;margin-right: 0px;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">CVE-2022-23222</span></section></td><td colspan="2" style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="25" width="234"><section style="text-align: justify;margin-left: 0px;margin-right: 0px;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong><span style="line-height: 150%;font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">其他编号</span></strong></span></section></td><td style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="25" width="89"><section style="text-align: center;margin-left: 0px;margin-right: 0px;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">QVD-2022-1175</span></section></td></tr><tr style="height:25px;"><td style="border-right: 1px solid windowtext;border-bottom: 1px solid windowtext;border-left: 1px solid windowtext;border-top: none windowtext;padding: 0px 7px;" height="25" width="76"><section style="text-align: justify;margin-left: 0px;margin-right: 0px;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong><span style="line-height: 150%;font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">CVSS 3.1</span></strong><strong><span style="line-height: 150%;font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">评级</span></strong></span></section></td><td style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="25" width="106"><section style="text-align: center;margin-left: 0px;margin-right: 0px;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong><span style="line-height: 150%;color: red;font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">高危</span></strong></span></section></td><td colspan="2" style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="25" width="215"><section style="text-align: justify;margin-left: 0px;margin-right: 0px;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong><span style="line-height: 150%;font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">CVSS 3.1</span></strong><strong><span style="line-height: 150%;font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">分数</span></strong></span></section></td><td style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="25" width="89"><section style="text-align: center;margin-left: 0px;margin-right: 0px;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong><span style="line-height: 150%;font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">7.8</span></strong></span></section></td></tr><tr style="height:25px;"><td rowspan="8" style="border-right: 1px solid windowtext;border-bottom: 1px solid windowtext;border-left: 1px solid windowtext;border-top: none windowtext;padding: 0px 7px;" height="25" width="76"><section style="text-align: justify;margin-left: 0px;margin-right: 0px;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong><span style="line-height: 150%;font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">CVSS</span></strong><strong><span style="line-height: 150%;font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">向量</span></strong></span></section></td><td colspan="2" style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="25" width="222"><section style="text-align: center;margin-left: 0px;margin-right: 0px;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong><span style="line-height: 150%;font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">访问途径（</span></strong><strong><span style="line-height: 150%;font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">AV</span></strong><strong><span style="line-height: 150%;font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">）</span></strong></span></section></td><td colspan="2" style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="25"><section style="text-align: center;margin-left: 0px;margin-right: 0px;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong><span style="line-height: 150%;font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">攻击复杂度（</span></strong><strong><span style="line-height: 150%;font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">AC</span></strong><strong><span style="line-height: 150%;font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">）</span></strong></span></section></td></tr><tr style="height:25px;"><td colspan="2" style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="25" width="201"><section style="text-align: center;margin-left: 0px;margin-right: 0px;"><span style="line-height: 150%;font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">本地</span></section></td><td colspan="2" style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="25" width="215"><section style="text-align: center;margin-left: 0px;margin-right: 0px;"><span style="line-height: 150%;font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">高</span></section></td></tr><tr style="height:25px;"><td colspan="2" style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="25" width="201"><section style="text-align: center;margin-left: 0px;margin-right: 0px;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong><span style="line-height: 150%;font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">所需权限（</span></strong><strong><span style="line-height: 150%;font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">PR</span></strong><strong><span style="line-height: 150%;font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">）</span></strong></span></section></td><td colspan="2" style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="25" width="215"><section style="text-align: center;margin-left: 0px;margin-right: 0px;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong><span style="line-height: 150%;font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">用户交互（</span></strong><strong><span style="line-height: 150%;font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">UI</span></strong><strong><span style="line-height: 150%;font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">）</span></strong></span></section></td></tr><tr style="height:25px;"><td colspan="2" style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="25" width="201"><section style="text-align: center;margin-left: 0px;margin-right: 0px;"><span style="line-height: 150%;font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">低</span></section></td><td colspan="2" style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="25" width="215"><section style="text-align: center;margin-left: 0px;margin-right: 0px;"><span style="line-height: 150%;font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">不需要</span></section></td></tr><tr style="height:25px;"><td colspan="2" style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="25" width="201"><section style="text-align: center;margin-left: 0px;margin-right: 0px;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong><span style="line-height: 150%;font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">影响范围（</span></strong><strong><span style="line-height: 150%;font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">S</span></strong><strong><span style="line-height: 150%;font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">）</span></strong></span></section></td><td colspan="2" style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="25" width="215"><section style="text-align: center;margin-left: 0px;margin-right: 0px;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong><span style="line-height: 150%;font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">机密性影响（</span></strong><strong><span style="line-height: 150%;font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">C</span></strong><strong><span style="line-height: 150%;font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">）</span></strong></span></section></td></tr><tr style="height:25px;"><td colspan="2" style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="25" width="201"><section style="text-align: center;margin-left: 0px;margin-right: 0px;"><span style="line-height: 150%;font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">改变</span></section></td><td colspan="2" style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="25" width="215"><section style="text-align: center;margin-left: 0px;margin-right: 0px;"><span style="line-height: 150%;font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">高</span></section></td></tr><tr style="height:25px;"><td colspan="2" style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="25" width="201"><section style="text-align: center;margin-left: 0px;margin-right: 0px;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong><span style="line-height: 150%;font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">完整性影响（</span></strong><strong><span style="line-height: 150%;font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">I</span></strong><strong><span style="line-height: 150%;font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">）</span></strong></span></section></td><td colspan="2" style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="25" width="215"><section style="text-align: center;margin-left: 0px;margin-right: 0px;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong><span style="line-height: 150%;font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">可用性影响（</span></strong><strong><span style="line-height: 150%;font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">A</span></strong><strong><span style="line-height: 150%;font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">）</span></strong></span></section></td></tr><tr style="height:25px;"><td colspan="2" style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="25" width="201"><section style="text-align: center;margin-left: 0px;margin-right: 0px;"><span style="line-height: 150%;font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">高</span></section></td><td colspan="2" style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="25" width="215"><section style="text-align: center;margin-left: 0px;margin-right: 0px;"><span style="line-height: 150%;font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">高</span></section></td></tr><tr style="height:119px;"><td style="border-right: 1px solid windowtext;border-bottom: 1px solid windowtext;border-left: 1px solid windowtext;border-top: none windowtext;padding: 0px 7px;" height="119" width="76"><section style="text-align: justify;margin-left: 0px;margin-right: 0px;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong><span style="line-height: 150%;font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">危害描述</span></strong></span></section></td><td colspan="4" style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="119" width="466"><p style="text-align:justify;text-justify:inter-ideograph;line-height:115%;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">Linux 内核的BPF 验证器没有对*_OR_NULL指针类型进行限制，允许这些类型进行指针运算。本地攻击者可以利用该漏洞将用户权限提升权限至ROOT权限。</span></p></td></tr></tbody></table>  
  
处置建议  
  
1.升级内核至安全版本  
  
2.缓解措施:  
  
禁止非特权用户执行BPF程序，命令:   
```
sudo sysctl kernel.unprivileged_bpf_disabled=2
```  
  
3.排查方法：  
  
可以使用uname -a查看内核版本是否在漏洞影响版本内  
  
![](https://mmbiz.qpic.cn/mmbiz_png/EkibxOB3fs4ibMYtzhgiaaRhJBunSfCQuh3yGZPIuIYFIntaaNe6mE28HxGyqET9KEkjGDCw0lUIXpIiaTsNqGYPqA/640?wx_fmt=png "")  
  
  
参考资料  
  
[1]http://www.openwall.com/lists/oss-security/2022/01/14/1  
  
[2]https://tr3e.ee/posts/cve-2022-23222-linux-kernel-ebpf-lpe.txt  
  
  
时间线  
  
2022年6月13日，奇安信 CERT发布安全风险通告  
  
  
点击**阅读原文**  
到奇安信NOX-安全监测平台查询更多漏洞详情  
