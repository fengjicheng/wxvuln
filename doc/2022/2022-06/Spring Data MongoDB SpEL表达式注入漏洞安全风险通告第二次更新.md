#  Spring Data MongoDB SpEL表达式注入漏洞安全风险通告第二次更新   
 代码卫士   2022-06-23 18:00  
  
![](https://mmbiz.qpic.cn/mmbiz_png/EkibxOB3fs4icrhoWdKnhTgicSjB9pXdeZwDibNIBAEMegibEdG1vrjOibsq887TUz3ztMkM6Qvibic7r26sqbUIbicOMYg/640?wx_fmt=png "https://image.ipaiban.com/upload-ueditor-image-20201112-1605175807303084927.png")  
  
奇安信CERT  
  
**致力于**  
第一时间  
为企业级用户提供安全风险  
**通告**  
和  
**有效**  
解决方案。  
  
  
**安全通告**  
  
  
  
近日，奇安信CERT监测到**Spring Data MongoDB SpEL表达式注入漏洞(CVE-2022-22980)**，当使用@Query或@Aggregation注解进行查询时，若通过SpEL表达式中形如“?0”的占位符来进行参数赋值，同时应用程序未对用户输入进行过滤处理，则可能受到SpEL表达式注入的影响，成功利用该漏洞的攻击者可在目标服务器上执行代码。**鉴于漏洞影响范围较大，建议客户尽快做好自查及防护。**  
  
  
**本次更新内容：**  
  
**新增Spring Data MongoDB SpEL 表达式注入漏洞(CVE-2022-22980)复现截图；**  
  
**新增产品线解决方案。**  
  
<table><tbody style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;visibility: visible;"><tr style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;visibility: visible;"><td width="70" style="margin: 0px;padding: 5px 10px;outline: 0px;word-break: break-all;hyphens: auto;border-width: 1px;border-style: solid;border-color: rgb(221, 221, 221);max-width: 100%;visibility: visible;overflow-wrap: break-word !important;box-sizing: border-box !important;"><p style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;clear: both;min-height: 1em;visibility: visible;"><strong style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;visibility: visible;"><span style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;font-size: 14px;visibility: visible;">漏洞名称</span></strong></p></td><td colspan="3" style="margin: 0px;padding: 5px 10px;outline: 0px;word-break: break-all;hyphens: auto;border-width: 1px;border-style: solid;border-color: rgb(221, 221, 221);max-width: 100%;visibility: visible;overflow-wrap: break-word !important;box-sizing: border-box !important;"><p style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;clear: both;min-height: 1em;visibility: visible;"><span style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;font-size: 14px;visibility: visible;">Spring Data MongoDB SpEL表达式注入漏洞</span></p></td></tr><tr style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;visibility: visible;"><td width="91" style="margin: 0px;padding: 5px 10px;outline: 0px;word-break: break-all;hyphens: auto;border-width: 1px;border-style: solid;border-color: rgb(221, 221, 221);max-width: 100%;visibility: visible;overflow-wrap: break-word !important;box-sizing: border-box !important;"><p draggable="true" style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;clear: both;min-height: 1em;visibility: visible;"><strong style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;visibility: visible;"><span style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;font-size: 14px;visibility: visible;">公开时间</span></strong></p></td><td width="209" style="margin: 0px;padding: 5px 10px;outline: 0px;word-break: break-all;hyphens: auto;border-width: 1px;border-style: solid;border-color: rgb(221, 221, 221);max-width: 100%;visibility: visible;overflow-wrap: break-word !important;box-sizing: border-box !important;"><p style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;clear: both;min-height: 1em;visibility: visible;"><span style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;font-size: 14px;visibility: visible;">2022-06-20</span></p></td><td width="163" style="margin: 0px;padding: 5px 10px;outline: 0px;word-break: break-all;hyphens: auto;border-width: 1px;border-style: solid;border-color: rgb(221, 221, 221);max-width: 100%;visibility: visible;overflow-wrap: break-word !important;box-sizing: border-box !important;"><p style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;clear: both;min-height: 1em;visibility: visible;"><strong style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;visibility: visible;"><span style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;font-size: 14px;visibility: visible;">更新时间</span></strong></p></td><td width="241" style="margin: 0px;padding: 5px 10px;outline: 0px;word-break: break-all;hyphens: auto;border-width: 1px;border-style: solid;border-color: rgb(221, 221, 221);max-width: 100%;visibility: visible;overflow-wrap: break-word !important;box-sizing: border-box !important;"><p style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;clear: both;min-height: 1em;visibility: visible;"><span style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;font-size: 14px;visibility: visible;">2022-06-21</span></p></td></tr><tr style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;visibility: visible;"><td width="110" style="margin: 0px;padding: 5px 10px;outline: 0px;word-break: break-all;hyphens: auto;border-width: 1px;border-style: solid;border-color: rgb(221, 221, 221);max-width: 100%;visibility: visible;overflow-wrap: break-word !important;box-sizing: border-box !important;"><p style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;clear: both;min-height: 1em;visibility: visible;"><strong style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;visibility: visible;"><span style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;font-size: 14px;visibility: visible;">CVE编号</span></strong></p></td><td width="218" style="margin: 0px;padding: 5px 10px;outline: 0px;word-break: break-all;hyphens: auto;border-width: 1px;border-style: solid;border-color: rgb(221, 221, 221);max-width: 100%;visibility: visible;overflow-wrap: break-word !important;box-sizing: border-box !important;"><p style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;clear: both;min-height: 1em;visibility: visible;"><span style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;font-size: 14px;visibility: visible;">CVE-2022-22980</span></p></td><td width="173" style="margin: 0px;padding: 5px 10px;outline: 0px;word-break: break-all;hyphens: auto;border-width: 1px;border-style: solid;border-color: rgb(221, 221, 221);max-width: 100%;visibility: visible;overflow-wrap: break-word !important;box-sizing: border-box !important;"><p style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;clear: both;min-height: 1em;visibility: visible;"><strong style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;visibility: visible;"><span style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;font-size: 14px;visibility: visible;">其他编号</span></strong></p></td><td width="243" style="margin: 0px;padding: 5px 10px;outline: 0px;word-break: break-all;hyphens: auto;border-width: 1px;border-style: solid;border-color: rgb(221, 221, 221);max-width: 100%;visibility: visible;overflow-wrap: break-word !important;box-sizing: border-box !important;"><p style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;clear: both;min-height: 1em;visibility: visible;"><span style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;font-size: 14px;visibility: visible;">QVD-2022-9645</span></p></td></tr><tr style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><td width="122" style="margin: 0px;padding: 5px 10px;outline: 0px;word-break: break-all;hyphens: auto;border-width: 1px;border-style: solid;border-color: rgb(221, 221, 221);max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><p style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;clear: both;min-height: 1em;"><strong style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;font-size: 14px;">威胁类型</span></strong></p></td><td width="218" style="margin: 0px;padding: 5px 10px;outline: 0px;word-break: break-all;hyphens: auto;border-width: 1px;border-style: solid;border-color: rgb(221, 221, 221);max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><p style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;clear: both;min-height: 1em;"><span style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;font-size: 14px;">代码执行</span></p></td><td width="177" style="margin: 0px;padding: 5px 10px;outline: 0px;word-break: break-all;hyphens: auto;border-width: 1px;border-style: solid;border-color: rgb(221, 221, 221);max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><p style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;clear: both;min-height: 1em;"><strong style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;font-size: 14px;">技术类型</span></strong></p></td><td width="239" style="margin: 0px;padding: 5px 10px;outline: 0px;word-break: break-all;hyphens: auto;border-width: 1px;border-style: solid;border-color: rgb(221, 221, 221);max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><p style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;clear: both;min-height: 1em;"><span style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;font-size: 14px;">SpEL表达式注入</span></p></td></tr><tr style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><td width="131" style="margin: 0px;padding: 5px 10px;outline: 0px;word-break: break-all;hyphens: auto;border-width: 1px;border-style: solid;border-color: rgb(221, 221, 221);max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><p style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;clear: both;min-height: 1em;"><strong style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;font-size: 14px;">厂商</span></strong></p></td><td width="214" style="margin: 0px;padding: 5px 10px;outline: 0px;word-break: break-all;hyphens: auto;border-width: 1px;border-style: solid;border-color: rgb(221, 221, 221);max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><p style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;clear: both;min-height: 1em;"><span style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;font-size: 14px;">VMware</span></p></td><td width="178" style="margin: 0px;padding: 5px 10px;outline: 0px;word-break: break-all;hyphens: auto;border-width: 1px;border-style: solid;border-color: rgb(221, 221, 221);max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><p style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;clear: both;min-height: 1em;"><strong style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;font-size: 14px;">产品</span></strong></p></td><td width="236" style="margin: 0px;padding: 5px 10px;outline: 0px;word-break: break-all;hyphens: auto;border-width: 1px;border-style: solid;border-color: rgb(221, 221, 221);max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><p style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;clear: both;min-height: 1em;"><span style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;font-size: 14px;">Spring Data   MongoDB</span></p></td></tr><tr style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><td colspan="4" align="center" valign="middle" style="margin: 0px;padding: 5px 10px;outline: 0px;word-break: break-all;hyphens: auto;border-width: 1px;border-style: solid;border-color: rgb(221, 221, 221);max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><p style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;clear: both;min-height: 1em;"><strong style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;font-size: 14px;">风险等级</span></strong></p></td></tr><tr style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><td colspan="2" align="center" valign="middle" style="margin: 0px;padding: 5px 10px;outline: 0px;word-break: break-all;hyphens: auto;border-width: 1px;border-style: solid;border-color: rgb(221, 221, 221);max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><p style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;clear: both;min-height: 1em;"><strong style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;font-size: 14px;">奇安信CERT风险评级</span></strong></p></td><td colspan="2" align="center" valign="middle" style="margin: 0px;padding: 5px 10px;outline: 0px;word-break: break-all;hyphens: auto;border-width: 1px;border-style: solid;border-color: rgb(221, 221, 221);max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><p style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;clear: both;min-height: 1em;"><strong style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;font-size: 14px;">风险等级</span></strong></p></td></tr><tr style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><td colspan="2" align="center" valign="middle" style="margin: 0px;padding: 5px 10px;outline: 0px;word-break: break-all;hyphens: auto;border-width: 1px;border-style: solid;border-color: rgb(221, 221, 221);max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><p style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;clear: both;min-height: 1em;"><span style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;color: rgb(255, 0, 0);font-size: 14px;box-sizing: border-box !important;overflow-wrap: break-word !important;">高危</span></p></td><td colspan="2" align="center" valign="middle" style="margin: 0px;padding: 5px 10px;outline: 0px;word-break: break-all;hyphens: auto;border-width: 1px;border-style: solid;border-color: rgb(221, 221, 221);max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><p style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;clear: both;min-height: 1em;"><span style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;color: rgb(12, 118, 240);font-size: 14px;box-sizing: border-box !important;overflow-wrap: break-word !important;">蓝色（一般事件）</span></p></td></tr><tr style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><td colspan="4" align="center" valign="middle" style="margin: 0px;padding: 5px 10px;outline: 0px;word-break: break-all;hyphens: auto;border-width: 1px;border-style: solid;border-color: rgb(221, 221, 221);max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><p style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;clear: both;min-height: 1em;"><strong style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;font-size: 14px;">现时威胁状态</span></strong></p></td></tr><tr style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><td align="center" valign="middle" width="138" style="margin: 0px;padding: 5px 10px;outline: 0px;word-break: break-all;hyphens: auto;border-width: 1px;border-style: solid;border-color: rgb(221, 221, 221);max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><p style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;clear: both;min-height: 1em;"><strong style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;font-size: 14px;">POC状态</span></strong></p></td><td align="center" valign="middle" width="212" style="margin: 0px;padding: 5px 10px;outline: 0px;word-break: break-all;hyphens: auto;border-width: 1px;border-style: solid;border-color: rgb(221, 221, 221);max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><p style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;clear: both;min-height: 1em;"><strong style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;font-size: 14px;">EXP状态</span></strong></p></td><td align="center" valign="middle" width="178" style="margin: 0px;padding: 5px 10px;outline: 0px;word-break: break-all;hyphens: auto;border-width: 1px;border-style: solid;border-color: rgb(221, 221, 221);max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><p style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;clear: both;min-height: 1em;"><strong style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;font-size: 14px;">在野利用状态</span></strong></p></td><td align="center" valign="middle" width="234" style="margin: 0px;padding: 5px 10px;outline: 0px;word-break: break-all;hyphens: auto;border-width: 1px;border-style: solid;border-color: rgb(221, 221, 221);max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><p style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;clear: both;min-height: 1em;"><strong style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;font-size: 14px;">技术细节状态</span></strong></p></td></tr><tr style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><td align="center" valign="middle" width="143" style="margin: 0px;padding: 5px 10px;outline: 0px;word-break: break-all;hyphens: auto;border-width: 1px;border-style: solid;border-color: rgb(221, 221, 221);max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><p style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;clear: both;min-height: 1em;"><span style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;font-size: 14px;color: rgb(255, 0, 0);box-sizing: border-box !important;overflow-wrap: break-word !important;">已公开</span></p></td><td align="center" valign="middle" width="211" style="margin: 0px;padding: 5px 10px;outline: 0px;word-break: break-all;hyphens: auto;border-width: 1px;border-style: solid;border-color: rgb(221, 221, 221);max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><p style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;clear: both;min-height: 1em;"><span style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;font-size: 14px;">未发现</span></p></td><td align="center" valign="middle" width="177" style="margin: 0px;padding: 5px 10px;outline: 0px;word-break: break-all;hyphens: auto;border-width: 1px;border-style: solid;border-color: rgb(221, 221, 221);max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><p style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;clear: both;min-height: 1em;"><span style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;font-size: 14px;">未发现</span></p></td><td align="center" valign="middle" width="233" style="margin: 0px;padding: 5px 10px;outline: 0px;word-break: break-all;hyphens: auto;border-width: 1px;border-style: solid;border-color: rgb(221, 221, 221);max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><p style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;clear: both;min-height: 1em;"><span style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;font-size: 14px;">未发现</span></p></td></tr><tr style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><td width="146" style="margin: 0px;padding: 5px 10px;outline: 0px;word-break: break-all;hyphens: auto;border-width: 1px;border-style: solid;border-color: rgb(221, 221, 221);max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><p style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;clear: both;min-height: 1em;"><strong style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;font-size: 14px;">漏洞描述</span></strong></p></td><td colspan="3" style="margin: 0px;padding: 5px 10px;outline: 0px;word-break: break-all;hyphens: auto;border-width: 1px;border-style: solid;border-color: rgb(221, 221, 221);max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><p style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;clear: both;min-height: 1em;"><span style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;font-size: 14px;">当使用@Query或@Aggregation注解进行查询时，若通过SpEL表达式中形如“?0”的占位符来进行参数赋值，同时应用程序未对用户输入进行过滤处理，则可能受到SpEL表达式注入的影响，成功利用该漏洞的攻击者可在目标服务器上执行代码。</span></p></td></tr><tr style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><td width="149" style="margin: 0px;padding: 5px 10px;outline: 0px;word-break: break-all;hyphens: auto;border-width: 1px;border-style: solid;border-color: rgb(221, 221, 221);max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><p style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;clear: both;min-height: 1em;"><strong style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;font-size: 14px;">影响版本</span></strong></p></td><td colspan="3" style="margin: 0px;padding: 5px 10px;outline: 0px;word-break: break-all;hyphens: auto;border-width: 1px;border-style: solid;border-color: rgb(221, 221, 221);max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><p style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;clear: both;min-height: 1em;"><span style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;font-size: 14px;">Spring Data MongoDB == 3.4.0</span></p><p style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;clear: both;min-height: 1em;"><span style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;font-size: 14px;">3.3.0 &lt;= Spring Data MongoDB &lt;= 3.3.4</span></p><p style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;clear: both;min-height: 1em;"><span style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;font-size: 14px;">旧的、不受支持的版本也会受到影响</span></p></td></tr><tr style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><td width="151" style="margin: 0px;padding: 5px 10px;outline: 0px;word-break: break-all;hyphens: auto;border-width: 1px;border-style: solid;border-color: rgb(221, 221, 221);max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><p style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;clear: both;min-height: 1em;"><strong style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;font-size: 14px;">不受影响版本</span></strong></p></td><td colspan="3" style="margin: 0px;padding: 5px 10px;outline: 0px;word-break: break-all;hyphens: auto;border-width: 1px;border-style: solid;border-color: rgb(221, 221, 221);max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><p style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;clear: both;min-height: 1em;"><span style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;font-size: 14px;">Spring Data MongoDB   &gt;= 3.4.1</span></p><p style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;clear: both;min-height: 1em;"><span style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;font-size: 14px;">Spring Data MongoDB   &gt;= 3.3.5</span></p></td></tr><tr style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><td width="152" style="margin: 0px;padding: 5px 10px;outline: 0px;word-break: break-all;hyphens: auto;border-width: 1px;border-style: solid;border-color: rgb(221, 221, 221);max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><p style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;clear: both;min-height: 1em;"><strong style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;font-size: 14px;">其他受影响组件</span></strong></p></td><td colspan="3" style="margin: 0px;padding: 5px 10px;outline: 0px;word-break: break-all;hyphens: auto;border-width: 1px;border-style: solid;border-color: rgb(221, 221, 221);max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><p style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;clear: both;min-height: 1em;"><span style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;font-size: 14px;">使用 Spring Data MongoDB依赖的应用程序</span></p></td></tr></tbody></table>  
  
奇安信CERT已成功复现**Spring Data MongoDB SpEL(CVE-2022-22980)**表达式注入漏洞, 复现截图如下:  
  
![](https://mmbiz.qpic.cn/mmbiz_png/EkibxOB3fs4ic2eQRrphe9pkklEwNurQnmjSyTuczb0ibWSc45ia7N6f4DRKXeDoicJ4YF3x9ia4TN4YUrzKLl2ZlSNQ/640?wx_fmt=png "")  
  
  
风险等级  
  
奇安信 CERT风险评级为：  
高危  
  
风险等级：  
蓝色（一般事件）  
  
  
威胁评估  
  
<table><tbody style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><tr style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><td style="margin: 0px;padding: 5px 10px;outline: 0px;word-break: break-all;hyphens: auto;border-width: 1px;border-style: solid;border-color: rgb(221, 221, 221);max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;" width="85"><p style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;clear: both;min-height: 1em;"><strong style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;font-size: 14px;">漏洞名称</span></strong></p></td><td colspan="4" style="margin: 0px;padding: 5px 10px;outline: 0px;word-break: break-all;hyphens: auto;border-width: 1px;border-style: solid;border-color: rgb(221, 221, 221);max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;" width="472"><p style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;clear: both;min-height: 1em;"><span style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;font-size: 14px;">Spring Data MongoDB SpEL表达式注入漏洞</span></p></td></tr><tr style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><td style="margin: 0px;padding: 5px 10px;outline: 0px;word-break: break-all;hyphens: auto;border-width: 1px;border-style: solid;border-color: rgb(221, 221, 221);max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;" width="63"><p style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;clear: both;min-height: 1em;"><strong style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;font-size: 14px;">CVE编号</span></strong></p></td><td align="center" valign="middle" style="margin: 0px;padding: 5px 10px;outline: 0px;word-break: break-all;hyphens: auto;border-width: 1px;border-style: solid;border-color: rgb(221, 221, 221);max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;" width="111"><p style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;clear: both;min-height: 1em;"><span style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;font-size: 14px;">CVE-2022-22980</span></p></td><td colspan="2" style="margin: 0px;padding: 5px 10px;outline: 0px;word-break: break-all;hyphens: auto;border-width: 1px;border-style: solid;border-color: rgb(221, 221, 221);max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;" width="214"><p style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;clear: both;min-height: 1em;"><strong style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;font-size: 14px;">其他编号</span></strong></p></td><td align="center" valign="middle" style="margin: 0px;padding: 5px 10px;outline: 0px;word-break: break-all;hyphens: auto;border-width: 1px;border-style: solid;border-color: rgb(221, 221, 221);max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;" width="105"><p style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;clear: both;min-height: 1em;"><span style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;font-size: 14px;">QVD-2022-9645</span></p></td></tr><tr style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><td style="margin: 0px;padding: 5px 10px;outline: 0px;word-break: break-all;hyphens: auto;border-width: 1px;border-style: solid;border-color: rgb(221, 221, 221);max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;" width="85"><p style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;clear: both;min-height: 1em;"><strong style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;font-size: 14px;">CVSS 3.1评级</span></strong></p></td><td align="center" valign="middle" style="margin: 0px;padding: 5px 10px;outline: 0px;word-break: break-all;hyphens: auto;border-width: 1px;border-style: solid;border-color: rgb(221, 221, 221);max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;" width="90"><p style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;clear: both;min-height: 1em;"><span style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;font-size: 14px;">高危</span></p></td><td colspan="2" style="margin: 0px;padding: 5px 10px;outline: 0px;word-break: break-all;hyphens: auto;border-width: 1px;border-style: solid;border-color: rgb(221, 221, 221);max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;" width="167"><p style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;clear: both;min-height: 1em;"><strong style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;font-size: 14px;">CVSS 3.1分数</span></strong></p></td><td align="center" valign="middle" style="margin: 0px;padding: 5px 10px;outline: 0px;word-break: break-all;hyphens: auto;border-width: 1px;border-style: solid;border-color: rgb(221, 221, 221);max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;" width="105"><p style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;clear: both;min-height: 1em;"><span style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;font-size: 14px;">8.2</span></p></td></tr><tr style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><td rowspan="8" style="margin: 0px;padding: 5px 10px;outline: 0px;word-break: break-all;hyphens: auto;border-width: 1px;border-style: solid;border-color: rgb(221, 221, 221);max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;" width="85"><p style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;clear: both;min-height: 1em;"><strong style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;font-size: 14px;">CVSS向量</span></strong></p></td><td colspan="2" align="center" valign="middle" style="margin: 0px;padding: 5px 10px;outline: 0px;word-break: break-all;hyphens: auto;border-width: 1px;border-style: solid;border-color: rgb(221, 221, 221);max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;" width="208"><p style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;clear: both;min-height: 1em;"><strong style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;font-size: 14px;">访问途径（AV）</span></strong></p></td><td colspan="2" align="center" valign="middle" style="margin: 0px;padding: 5px 10px;outline: 0px;word-break: break-all;hyphens: auto;border-width: 1px;border-style: solid;border-color: rgb(221, 221, 221);max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;"><p style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;clear: both;min-height: 1em;"><strong style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;font-size: 14px;">攻击复杂度（AC）</span></strong></p></td></tr><tr style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><td colspan="2" align="center" valign="middle" style="margin: 0px;padding: 5px 10px;outline: 0px;word-break: break-all;hyphens: auto;border-width: 1px;border-style: solid;border-color: rgb(221, 221, 221);max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;" width="222"><p style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;clear: both;min-height: 1em;"><span style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;font-size: 14px;">网络</span></p></td><td colspan="2" align="center" valign="middle" style="margin: 0px;padding: 5px 10px;outline: 0px;word-break: break-all;hyphens: auto;border-width: 1px;border-style: solid;border-color: rgb(221, 221, 221);max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;" width="167"><p style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;clear: both;min-height: 1em;"><span style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;font-size: 14px;">高</span></p></td></tr><tr style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><td colspan="2" align="center" valign="middle" style="margin: 0px;padding: 5px 10px;outline: 0px;word-break: break-all;hyphens: auto;border-width: 1px;border-style: solid;border-color: rgb(221, 221, 221);max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;" width="222"><p style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;clear: both;min-height: 1em;"><strong style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;font-size: 14px;">用户认证（Au）</span></strong></p></td><td colspan="2" align="center" valign="middle" style="margin: 0px;padding: 5px 10px;outline: 0px;word-break: break-all;hyphens: auto;border-width: 1px;border-style: solid;border-color: rgb(221, 221, 221);max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;" width="167"><p style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;clear: both;min-height: 1em;"><strong style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;font-size: 14px;">用户交互</span></strong></p></td></tr><tr style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><td colspan="2" align="center" valign="middle" style="margin: 0px;padding: 5px 10px;outline: 0px;word-break: break-all;hyphens: auto;border-width: 1px;border-style: solid;border-color: rgb(221, 221, 221);max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;" width="222"><p style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;clear: both;min-height: 1em;"><span style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;font-size: 14px;">无</span></p></td><td colspan="2" align="center" valign="middle" style="margin: 0px;padding: 5px 10px;outline: 0px;word-break: break-all;hyphens: auto;border-width: 1px;border-style: solid;border-color: rgb(221, 221, 221);max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;" width="167"><p style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;clear: both;min-height: 1em;"><span style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;font-size: 14px;">不需要</span></p></td></tr><tr style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><td colspan="2" align="center" valign="middle" style="margin: 0px;padding: 5px 10px;outline: 0px;word-break: break-all;hyphens: auto;border-width: 1px;border-style: solid;border-color: rgb(221, 221, 221);max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;" width="222"><p style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;clear: both;min-height: 1em;"><strong style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;font-size: 14px;">影响范围</span></strong></p></td><td colspan="2" align="center" valign="middle" style="margin: 0px;padding: 5px 10px;outline: 0px;word-break: break-all;hyphens: auto;border-width: 1px;border-style: solid;border-color: rgb(221, 221, 221);max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;" width="167"><p style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;clear: both;min-height: 1em;"><strong style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;font-size: 14px;">机密性影响（C）</span></strong></p></td></tr><tr style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><td colspan="2" align="center" valign="middle" style="margin: 0px;padding: 5px 10px;outline: 0px;word-break: break-all;hyphens: auto;border-width: 1px;border-style: solid;border-color: rgb(221, 221, 221);max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;" width="222"><p style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;clear: both;min-height: 1em;"><span style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;font-size: 14px;">不改变</span></p></td><td colspan="2" align="center" valign="middle" style="margin: 0px;padding: 5px 10px;outline: 0px;word-break: break-all;hyphens: auto;border-width: 1px;border-style: solid;border-color: rgb(221, 221, 221);max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;" width="167"><p style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;clear: both;min-height: 1em;"><span style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;font-size: 14px;">高</span></p></td></tr><tr style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><td colspan="2" align="center" valign="middle" style="margin: 0px;padding: 5px 10px;outline: 0px;word-break: break-all;hyphens: auto;border-width: 1px;border-style: solid;border-color: rgb(221, 221, 221);max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;" width="222"><p style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;clear: both;min-height: 1em;"><strong style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;font-size: 14px;">完整性影响（I）</span></strong></p></td><td colspan="2" align="center" valign="middle" style="margin: 0px;padding: 5px 10px;outline: 0px;word-break: break-all;hyphens: auto;border-width: 1px;border-style: solid;border-color: rgb(221, 221, 221);max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;" width="167"><p style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;clear: both;min-height: 1em;"><strong style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;font-size: 14px;">可用性影响（A）</span></strong></p></td></tr><tr style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><td colspan="2" align="center" valign="middle" style="margin: 0px;padding: 5px 10px;outline: 0px;word-break: break-all;hyphens: auto;border-width: 1px;border-style: solid;border-color: rgb(221, 221, 221);max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;" width="222"><p style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;clear: both;min-height: 1em;"><span style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;font-size: 14px;">高</span></p></td><td colspan="2" align="center" valign="middle" style="margin: 0px;padding: 5px 10px;outline: 0px;word-break: break-all;hyphens: auto;border-width: 1px;border-style: solid;border-color: rgb(221, 221, 221);max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;" width="167"><p style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;clear: both;min-height: 1em;"><span style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;font-size: 14px;">高</span></p></td></tr><tr style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><td style="margin: 0px;padding: 5px 10px;outline: 0px;word-break: break-all;hyphens: auto;border-width: 1px;border-style: solid;border-color: rgb(221, 221, 221);max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;" width="85"><p style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;clear: both;min-height: 1em;"><strong style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;font-size: 14px;">危害描述</span></strong></p></td><td colspan="4" style="margin: 0px;padding: 5px 10px;outline: 0px;word-break: break-all;hyphens: auto;border-width: 1px;border-style: solid;border-color: rgb(221, 221, 221);max-width: 100%;overflow-wrap: break-word !important;box-sizing: border-box !important;" width="471"><p style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;clear: both;min-height: 1em;"><span style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;font-size: 14px;">当使用@Query或@Aggregation注解进行查询时，若通过SpEL表达式中形如“?0”的占位符来进行参数赋值，同时应用程序未对用户输入进行过滤处理，则可能受到SpEL表达式注入的影响，成功利用该漏洞的攻击者可在目标服务器上执行代码。</span></p></td></tr></tbody></table>  
  
  
处置建议  
  
目前，  
VMware官方已发布漏洞修复补丁，建议用户尽快下载安装补丁程序或采取缓解措施。  
  
**1.补丁升级**  
  
建议尽快升级至官方修护版本：  
  
Spring Data MongoDB 3.4.1版本：  
  
https://github.com/spring-projects/spring-data-mongodb/releases/tag/3.4.1  
  
Spring Data MongoDB 3.3.5版本：  
  
https://github.com/spring-projects/spring-data-mongodb/releases/tag/3.3.5  
  
  
**2. 缓解措施**  
  
（1）如果您的应用程序需要使用由用户输入控制的SpEL表达式，那么使用数组形式语法“[0]”引入SpEL参数而不是“?0”形式；  
  
（2）实现自定义存储库方法，详见：https://docs.spring.io/spring-data/mongodb/docs/current/reference/html/#repositories.single-repository-behavior；  
  
（3）通过BeanPostProcessor和受限的QueryMethodEvaluationContextProvider重新配置存储工厂bean；  
  
（4）在调用查询方法时过滤用户输入内容。  
  
  
更多修复建议请参考官方发布的安全建议文档：  
  
https://spring.io/blog/2022/06/20/spring-data-mongodb-spel-expression-injection-vulnerability-cve-2022-22980  
  
  
产品解决方案  
  
**奇安信开源卫士已支持**  
  
奇安信开源卫士20220622. 1107版本已支持对Spring Data MongoDB SpEL 表达式注入漏洞(CVE-2022-22980)的检测。  
  
  
**奇安信网站应用安全云防护系统已更新防护特征库**  
  
奇安信网神网站应用安全云防护系统已全面支持对Spring Data MongoDB  SpEL 表达式注入漏洞(CVE-2022-22980)的防护。  
  
  
**奇安信天眼检测方案**  
  
奇安信天眼新一代安全感知系统已经能够有效检测针对该漏洞的攻击，请将规则版本升级到3.0.0622.13406或以上版本。规则ID及规则名称：  
  
0x10020F84，Spring Data MongoDB SpEL 表达式注入漏洞(CVE-2022-22980)。奇安信天眼流量探针规则升级方法：系统配置->设备升级->规则升级，选择“网络升级”或“本地升级”。  
  
  
参考资料  
  
[1]https://spring.io/blog/2022/06/20/spring-data-mongodb-spel-expression-injection-vulnerability-cve-2022-22980  
  
  
时间线  
  
  
2022年6月21日，  
奇安信 CERT发布安全风险通告  
  
2022年6月22日，奇安信 CERT发布安全风险通告第二次更新  
  
  
  
代码卫士试用地址：  
https://codesafe.qianxin.com  
  
开源卫士试用地址：  
https://oss.qianxin.com  
  
  
  
  
  
  
  
  
  
  
  
**推荐阅读**  
  
[Spring4Shell 漏洞已遭Mirai 僵尸网络利用](http://mp.weixin.qq.com/s?__biz=MzI2NTg4OTc5Nw==&mid=2247511304&idx=2&sn=157f1ecf43e8268adf1d188b3bdab4db&chksm=ea949c62dde31574804aed120e44fb4c92f7d939f027277177016748f7508403563363b53f6e&scene=21#wechat_redirect)  
  
  
[【安全风险通告】Spring Framework远程代码执行漏洞(CVE-2022-22965)安全风险通告第二次更新](http://mp.weixin.qq.com/s?__biz=MzI2NTg4OTc5Nw==&mid=2247511203&idx=3&sn=17ae3622395ea3b9603c1dd9764af422&chksm=ea949dc9dde314df7186047b4eb6c86a65f948ab001f65145f87556e1e51e49fa989199a539f&scene=21#wechat_redirect)  
  
  
[【缺陷周话】第44期：Spring Boot 配置错误：不安全的 Actuator](http://mp.weixin.qq.com/s?__biz=MzI2NTg4OTc5Nw==&mid=2247490453&idx=1&sn=6f9e8d3fc95a5f24faa9476ab79815ba&chksm=ea972affdde0a3e9b59f7a765a04cb8ef6cee6f884c5d19d12302224698c24567904a6935183&scene=21#wechat_redirect)  
  
  
  
  
  
**转载请注明“转自奇安信代码卫士 https://codesafe.qianxin.com”。**  
  
  
  
  
![](https://mmbiz.qpic.cn/mmbiz_jpg/oBANLWYScMSf7nNLWrJL6dkJp7RB8Kl4zxU9ibnQjuvo4VoZ5ic9Q91K3WshWzqEybcroVEOQpgYfx1uYgwJhlFQ/640?wx_fmt=jpeg "")  
  
![](https://mmbiz.qpic.cn/mmbiz_jpg/oBANLWYScMSN5sfviaCuvYQccJZlrr64sRlvcbdWjDic9mPQ8mBBFDCKP6VibiaNE1kDVuoIOiaIVRoTjSsSftGC8gw/640?wx_fmt=jpeg "")  
  
**奇安信代码卫士 (codesafe)**  
  
国内首个专注于软件开发安全的产品线。  
  
   ![](https://mmbiz.qpic.cn/mmbiz_gif/oBANLWYScMQ5iciaeKS21icDIWSVd0M9zEhicFK0rbCJOrgpc09iaH6nvqvsIdckDfxH2K4tu9CvPJgSf7XhGHJwVyQ/640?wx_fmt=gif "")  
  
   
觉得不错，就点个 “  
在看  
” 或 "  
赞  
” 吧~  
