#  PHP多个远程代码执行漏洞安全风险通告   
原创 QAX CERT  奇安信 CERT   2022-06-10 18:01  
  
![](https://mmbiz.qpic.cn/mmbiz_png/EkibxOB3fs4icrhoWdKnhTgicSjB9pXdeZwDibNIBAEMegibEdG1vrjOibsq887TUz3ztMkM6Qvibic7r26sqbUIbicOMYg/640?wx_fmt=png "https://image.ipaiban.com/upload-ueditor-image-20201112-1605175807303084927.png")  
  
奇安信CERT  
  
**致力于**  
第一时间  
为企业级用户提供安全风险  
**通告**  
和  
**有效**  
解决方案。  
  
  
**安全通告**  
  
  
  
近日，奇安信CERT监测到 PHP 官方发布了多个远程代码执行漏洞，包含CVE-2022-31626、CVE-2022-31625。**PHP 远程代码执行漏洞(CVE-2022-31626)**  
，由于PHP未检查复制的数据长度和缓冲区长度，导致堆溢出，可能导致远程代码执行，基于php的数据库管理软件可能受此漏洞影响，如Adminer、PHPmyAdmin 等工具。**PHP 远程代码执行漏洞(CVE-2022-31625)**  
，由于PHP存在未初始化数组，释放该数组时可能导致远程代码执行。  
  
目前上述两个漏洞细节及PoC已在互联网公开。  
**鉴于这些漏洞影响范围较大，建议客户尽快做好自查及防护。**  
  
**1. CVE-2022-31626 PHP****远程代码执行漏洞**  
****  
<table><tbody><tr style="height:25px;"><td style="border-width: 1px;border-style: solid;border-color: windowtext;padding: 0px 7px;" height="25" width="55"><section style="text-align: justify;margin-left: 0px;margin-right: 0px;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong>漏洞名称</strong></span></section></td><td colspan="3" style="border-top: 1px solid windowtext;border-right: 1px solid windowtext;border-bottom: 1px solid windowtext;border-left: none windowtext;padding: 0px 7px;" height="25"><p style="text-align:justify;text-justify:inter-ideograph;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong>PHP </strong><strong>远程代码执行漏洞</strong><strong>(</strong><strong>CVE-2022-31626</strong><strong>)</strong></span></p></td></tr><tr style="height:25px;"><td style="border-right: 1px solid windowtext;border-bottom: 1px solid windowtext;border-left: 1px solid windowtext;border-top: none windowtext;padding: 0px 7px;" height="25" width="70"><p style="text-align:justify;text-justify:inter-ideograph;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong>公开时间</strong></span></p></td><td style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="25" width="236"><p style="text-align:justify;text-justify:inter-ideograph;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">2022-06-09</span></p></td><td style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="25" width="182"><p style="text-align:justify;text-justify:inter-ideograph;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong>更新时间</strong></span></p></td><td style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="25" width="234"><p style="text-align:justify;text-justify:inter-ideograph;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">2022-06-10</span></p></td></tr><tr style="height:25px;"><td style="border-right: 1px solid windowtext;border-bottom: 1px solid windowtext;border-left: 1px solid windowtext;border-top: none windowtext;padding: 0px 7px;" height="25" width="84"><p style="text-align:justify;text-justify:inter-ideograph;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong>CVE</strong><strong>编号</strong></span></p></td><td style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="25" width="242"><p style="text-align:justify;text-justify:inter-ideograph;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">CVE-2022-31626</span></p></td><td style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="25" width="188"><p style="text-align:justify;text-justify:inter-ideograph;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong>其他编号</strong></span></p></td><td style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="25" width="236"><p style="text-align:justify;text-justify:inter-ideograph;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">QVD-2022-8876</span></p></td></tr><tr style="height:25px;"><td style="border-right: 1px solid windowtext;border-bottom: 1px solid windowtext;border-left: 1px solid windowtext;border-top: none windowtext;padding: 0px 7px;" height="25" width="95"><p style="text-align:justify;text-justify:inter-ideograph;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong>威胁类型</strong></span></p></td><td style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="25" width="240"><p style="text-align:justify;text-justify:inter-ideograph;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">代码执行</span></p></td><td style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="25" width="190"><p style="text-align:justify;text-justify:inter-ideograph;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong>技术类型</strong></span></p></td><td style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="25" width="233"><p style="text-align:justify;text-justify:inter-ideograph;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">基于堆的缓冲区溢出</span></p></td></tr><tr style="height:25px;"><td style="border-right: 1px solid windowtext;border-bottom: 1px solid windowtext;border-left: 1px solid windowtext;border-top: none windowtext;padding: 0px 7px;" height="25" width="104"><p><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong>厂商</strong></span></p></td><td style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="25" width="236"><p style="text-align:justify;text-justify:inter-ideograph;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">PHP</span></p></td><td style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="25" width="189"><p><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong>产品</strong></span></p></td><td style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="25" width="231"><p style="text-align:justify;text-justify:inter-ideograph;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">PHP</span></p></td></tr><tr style="height:25px;"><td colspan="4" style="border-right: 1px solid windowtext;border-bottom: 1px solid windowtext;border-left: 1px solid windowtext;border-top: none windowtext;padding: 0px 7px;" height="25"><p style="text-align:center;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong>风险等级</strong></span></p></td></tr><tr style="height:25px;"><td colspan="2" style="border-right: 1px solid windowtext;border-bottom: 1px solid windowtext;border-left: 1px solid windowtext;border-top: none windowtext;padding: 0px 7px;" height="25"><p style="text-align:center;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong>奇安信</strong><strong>CERT</strong><strong>风险评级</strong></span></p></td><td colspan="2" style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="25"><p style="text-align:center;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong>风险等级</strong></span></p></td></tr><tr style="height:25px;"><td colspan="2" style="border-right: 1px solid windowtext;border-bottom: 1px solid windowtext;border-left: 1px solid windowtext;border-top: none windowtext;padding: 0px 7px;" height="25"><p style="text-align:center;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong><span style="color: red;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">高危</span></strong></span></p></td><td colspan="2" style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="25"><p style="text-align:center;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong><span style="color: rgb(0, 112, 192);font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">蓝色（一般事件）</span></strong></span></p></td></tr><tr style="height:25px;"><td colspan="4" style="border-right: 1px solid windowtext;border-bottom: 1px solid windowtext;border-left: 1px solid windowtext;border-top: none windowtext;padding: 0px 7px;" height="25"><section style="text-align: center;margin-left: 0px;margin-right: 0px;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong>现时威胁状态</strong></span></section></td></tr><tr style="height:25px;"><td style="border-right: 1px solid windowtext;border-bottom: 1px solid windowtext;border-left: 1px solid windowtext;border-top: none windowtext;padding: 0px 7px;" height="25" width="111"><section style="text-align: center;margin-left: 0px;margin-right: 0px;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong>POC</strong><strong>状态</strong></span></section></td><td style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="25" width="234"><section style="text-align: center;margin-left: 0px;margin-right: 0px;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong>EXP</strong><strong>状态</strong></span></section></td><td style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="25" width="187"><section style="text-align: center;margin-left: 0px;margin-right: 0px;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong>在野利用状态</strong></span></section></td><td style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="25" width="229"><section style="text-align: center;margin-left: 0px;margin-right: 0px;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong>技术细节状态</strong></span></section></td></tr><tr style="height:25px;"><td style="border-right: 1px solid windowtext;border-bottom: 1px solid windowtext;border-left: 1px solid windowtext;border-top: none windowtext;padding: 0px 7px;" height="25" width="116"><section style="text-align: center;margin-left: 0px;margin-right: 0px;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong><span style="color: red;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">已公开</span></strong></span></section></td><td style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="25" width="233"><section style="text-align: center;margin-left: 0px;margin-right: 0px;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">未发现</span></section></td><td style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="25" width="186"><section style="text-align: center;margin-left: 0px;margin-right: 0px;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">未发现</span></section></td><td style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="25" width="228"><section style="text-align: center;margin-left: 0px;margin-right: 0px;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong><span style="color: red;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">已公开</span></strong></span></section></td></tr><tr style="height:104px;"><td style="border-right: 1px solid windowtext;border-bottom: 1px solid windowtext;border-left: 1px solid windowtext;border-top: none windowtext;padding: 0px 7px;" height="104" width="120"><p style="text-align:justify;text-justify:inter-ideograph;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong>漏洞描述</strong></span></p></td><td colspan="3" valign="top" style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="104"><p style="line-height:125%;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">PHP的mysqlnd拓展中存在堆缓冲区溢出漏洞，利用该漏洞需要攻击者有连接php连接数据库的权限，通过建立恶意MySQL服务器，使受害主机通过mysqlnd主动连接该服务器，触发缓冲区溢出，从而在受害主机上导致拒绝服务或远程执行代码。基于php的数据库管理软件可能受该漏洞影响，如Adminer、 PHPmyAdmin 等工具。</span></p></td></tr><tr style="height:61px;"><td style="border-right: 1px solid windowtext;border-bottom: 1px solid windowtext;border-left: 1px solid windowtext;border-top: none windowtext;padding: 0px 7px;" height="61" width="123"><p style="line-height:150%;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong>影响版本</strong></span></p></td><td colspan="3" style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="61"><p style="line-height:150%;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">PHP 8.1.x &lt; 8.1.7</span></p><p style="line-height:150%;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">PHP 8.0.x &lt; 8.0.20</span></p><p style="line-height:150%;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">PHP 7.x &lt; 7.4.30</span></p></td></tr><tr style="height:119px;"><td style="border-right: 1px solid windowtext;border-bottom: 1px solid windowtext;border-left: 1px solid windowtext;border-top: none windowtext;padding: 0px 7px;" height="119" width="126"><p style="text-align:justify;text-justify:inter-ideograph;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong>不受影响版本</strong></span></p></td><td colspan="3" style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="119"><p style="line-height:150%;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">PHP 8.1.x &gt;= 8.1.7</span></p><p style="line-height:150%;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">PHP 8.0.x &gt;= 8.0.20</span></p><p style="line-height:150%;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">PHP 7.x &gt;= 7.4.30</span></p></td></tr><tr style="height:110px;"><td style="border-right: 1px solid windowtext;border-bottom: 1px solid windowtext;border-left: 1px solid windowtext;border-top: none windowtext;padding: 0px 7px;" height="110" width="128"><p style="text-align:justify;text-justify:inter-ideograph;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong>其他受影响组件</strong></span></p></td><td colspan="3" style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="110"><p style="text-align:justify;text-justify:inter-ideograph;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">无</span></p></td></tr></tbody></table>  
**2. CVE-2022-31625****PHP****远程代码执行漏洞**  
<table><tbody><tr style="height:25px;"><td style="border-width: 1px;border-style: solid;border-color: windowtext;padding: 0px 7px;" height="25" width="73"><section style="text-align: justify;margin-left: 0px;margin-right: 0px;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong>漏洞名称</strong></span></section></td><td colspan="3" style="border-top: 1px solid windowtext;border-right: 1px solid windowtext;border-bottom: 1px solid windowtext;border-left: none windowtext;padding: 0px 7px;" height="25"><p style="text-align:justify;text-justify:inter-ideograph;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong>PHP </strong><strong>远程代码执行漏洞</strong><strong>(</strong><strong>CVE-2022-31625</strong><strong>)</strong></span></p></td></tr><tr style="height:25px;"><td style="border-right: 1px solid windowtext;border-bottom: 1px solid windowtext;border-left: 1px solid windowtext;border-top: none windowtext;padding: 0px 7px;" height="25" width="88"><p style="text-align:justify;text-justify:inter-ideograph;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong>公开时间</strong></span></p></td><td style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="25" width="240"><p style="text-align:justify;text-justify:inter-ideograph;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">2022-06-06</span></p></td><td style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="25" width="183"><p style="text-align:justify;text-justify:inter-ideograph;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong>更新时间</strong></span></p></td><td style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="25" width="211"><p style="text-align:justify;text-justify:inter-ideograph;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">2022-06-10</span></p></td></tr><tr style="height:25px;"><td style="border-right: 1px solid windowtext;border-bottom: 1px solid windowtext;border-left: 1px solid windowtext;border-top: none windowtext;padding: 0px 7px;" height="25" width="101"><p style="text-align:justify;text-justify:inter-ideograph;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong>CVE</strong><strong>编号</strong></span></p></td><td style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="25" width="246"><p style="text-align:justify;text-justify:inter-ideograph;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">CVE-2022-31625</span></p></td><td style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="25" width="190"><p style="text-align:justify;text-justify:inter-ideograph;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong>其他编号</strong></span></p></td><td style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="25" width="214"><p style="text-align:justify;text-justify:inter-ideograph;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">QVD-2022-8877</span></p></td></tr><tr style="height:25px;"><td style="border-right: 1px solid windowtext;border-bottom: 1px solid windowtext;border-left: 1px solid windowtext;border-top: none windowtext;padding: 0px 7px;" height="25" width="110"><p style="text-align:justify;text-justify:inter-ideograph;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong>威胁类型</strong></span></p></td><td style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="25" width="244"><p style="text-align:justify;text-justify:inter-ideograph;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">代码执行</span></p></td><td style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="25" width="192"><p style="text-align:justify;text-justify:inter-ideograph;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong>技术类型</strong></span></p></td><td style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="25" width="213"><p style="text-align:justify;text-justify:inter-ideograph;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">未初始化数组</span></p></td></tr><tr style="height:25px;"><td style="border-right: 1px solid windowtext;border-bottom: 1px solid windowtext;border-left: 1px solid windowtext;border-top: none windowtext;padding: 0px 7px;" height="25" width="118"><p><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong>厂商</strong></span></p></td><td style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="25" width="241"><p style="text-align:justify;text-justify:inter-ideograph;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">PHP</span></p></td><td style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="25" width="191"><p><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong>产品</strong></span></p></td><td style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="25" width="211"><p style="text-align:justify;text-justify:inter-ideograph;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">PHP</span></p></td></tr><tr style="height:25px;"><td colspan="4" style="border-right: 1px solid windowtext;border-bottom: 1px solid windowtext;border-left: 1px solid windowtext;border-top: none windowtext;padding: 0px 7px;" height="25"><p style="text-align:center;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong>风险等级</strong></span></p></td></tr><tr style="height:25px;"><td colspan="2" style="border-right: 1px solid windowtext;border-bottom: 1px solid windowtext;border-left: 1px solid windowtext;border-top: none windowtext;padding: 0px 7px;" height="25"><p style="text-align:center;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong>奇安信</strong><strong>CERT</strong><strong>风险评级</strong></span></p></td><td colspan="2" style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="25"><p style="text-align:center;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong>风险等级</strong></span></p></td></tr><tr style="height:25px;"><td colspan="2" style="border-right: 1px solid windowtext;border-bottom: 1px solid windowtext;border-left: 1px solid windowtext;border-top: none windowtext;padding: 0px 7px;" height="25"><p style="text-align:center;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong><span style="color: red;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">高危</span></strong></span></p></td><td colspan="2" style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="25"><p style="text-align:center;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong><span style="color: rgb(0, 112, 192);font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">蓝色（一般事件）</span></strong></span></p></td></tr><tr style="height:25px;"><td colspan="4" style="border-right: 1px solid windowtext;border-bottom: 1px solid windowtext;border-left: 1px solid windowtext;border-top: none windowtext;padding: 0px 7px;" height="25"><section style="text-align: center;margin-left: 0px;margin-right: 0px;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong>现时威胁状态</strong></span></section></td></tr><tr style="height:25px;"><td style="border-right: 1px solid windowtext;border-bottom: 1px solid windowtext;border-left: 1px solid windowtext;border-top: none windowtext;padding: 0px 7px;" height="25" width="124"><section style="text-align: center;margin-left: 0px;margin-right: 0px;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong>POC</strong><strong>状态</strong></span></section></td><td style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="25" width="239"><section style="text-align: center;margin-left: 0px;margin-right: 0px;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong>EXP</strong><strong>状态</strong></span></section></td><td style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="25" width="190"><section style="text-align: center;margin-left: 0px;margin-right: 0px;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong>在野利用状态</strong></span></section></td><td style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="25" width="210"><section style="text-align: center;margin-left: 0px;margin-right: 0px;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong>技术细节状态</strong></span></section></td></tr><tr style="height:25px;"><td style="border-right: 1px solid windowtext;border-bottom: 1px solid windowtext;border-left: 1px solid windowtext;border-top: none windowtext;padding: 0px 7px;" height="25" width="128"><section style="text-align: center;margin-left: 0px;margin-right: 0px;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong><span style="color: red;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">已发现</span></strong></span></section></td><td style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="25" width="238"><section style="text-align: center;margin-left: 0px;margin-right: 0px;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">未发现</span></section></td><td style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="25" width="189"><section style="text-align: center;margin-left: 0px;margin-right: 0px;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">未发现</span></section></td><td style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="25" width="209"><section style="text-align: center;margin-left: 0px;margin-right: 0px;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong><span style="color: red;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">已公开</span></strong></span></section></td></tr><tr style="height:104px;"><td style="border-right: 1px solid windowtext;border-bottom: 1px solid windowtext;border-left: 1px solid windowtext;border-top: none windowtext;padding: 0px 7px;" height="104" width="132"><p style="text-align:justify;text-justify:inter-ideograph;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong>漏洞描述</strong></span></p></td><td colspan="3" valign="top" style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="104"><p style="line-height:125%;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">PHP_FUNCTION中分配在堆上的的char* 数组没有被清除，如果发生转换错误，将会调用_php_pgsql_free_params()函数，由于数组没有初始化，导致可以释放之前请求的值，导致远程代码执行。</span></p></td></tr><tr style="height:61px;"><td style="border-right: 1px solid windowtext;border-bottom: 1px solid windowtext;border-left: 1px solid windowtext;border-top: none windowtext;padding: 0px 7px;" height="61" width="135"><p style="text-align:justify;text-justify:inter-ideograph;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong>影响版本</strong></span></p></td><td colspan="3" style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="61"><p style="line-height:150%;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">5.3.0 &lt;= PHP 5.x &lt;= 5.6.40</span></p><p style="line-height:150%;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">7.0.1 &lt;= PHP 7.x &lt; 7.4.30</span></p><p style="line-height:150%;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">8.0.0 &lt;= PHP 8.0.x &lt; 8.0.20</span></p><p style="line-height:150%;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">8.1.0 &lt;= PHP 8.1.x &lt; 8.1.7</span></p></td></tr><tr style="height:120px;"><td style="border-right: 1px solid windowtext;border-bottom: 1px solid windowtext;border-left: 1px solid windowtext;border-top: none windowtext;padding: 0px 7px;" height="120" width="137"><p style="text-align:justify;text-justify:inter-ideograph;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong>不受影响版本</strong></span></p></td><td colspan="3" style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="120"><p style="line-height:150%;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">PHP 7.4.x &gt;= 7.4.30</span></p><p style="line-height:150%;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">PHP 8.0.x &gt;= 8.0.20</span></p><p style="line-height:150%;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">PHP 8.1.x &gt;= 8.1.7</span></p></td></tr><tr style="height:110px;"><td style="border-right: 1px solid windowtext;border-bottom: 1px solid windowtext;border-left: 1px solid windowtext;border-top: none windowtext;padding: 0px 7px;" height="110" width="138"><p style="text-align:justify;text-justify:inter-ideograph;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;"><strong>其他受影响组件</strong></span></p></td><td colspan="3" style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="110"><p style="text-align:justify;text-justify:inter-ideograph;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;Microsoft YaHei&#34;;">无</span></p></td></tr></tbody></table>  
  
威胁评估  
  
**1. CVE-2022-31626  PHP远程代码执行漏洞**  
  
<table><tbody><tr style="height:25px;"><td style="border-width: 1px;border-style: solid;border-color: windowtext;padding: 0px 7px;" height="25" width="66"><section style="text-align: justify;margin-left: 0px;margin-right: 0px;"><span style="font-size: 14px;"><strong>漏洞名称</strong></span></section></td><td colspan="4" style="border-top: 1px solid windowtext;border-right: 1px solid windowtext;border-bottom: 1px solid windowtext;border-left: none windowtext;padding: 0px 7px;word-break: break-all;" height="25" width="28"><p style="text-align:center;"><span style="font-size: 14px;"><span style="font-size: 14px;font-family: Calibri, sans-serif;">PHP </span>远程代码执行漏洞<span style="font-size: 14px;font-family: Calibri, sans-serif;">(CVE-2022-31626)</span></span></p></td></tr><tr style="height:25px;"><td style="border-right: 1px solid windowtext;border-bottom: 1px solid windowtext;border-left: 1px solid windowtext;border-top: none windowtext;padding: 0px 7px;" height="25" width="66"><p style="text-align:justify;text-justify:inter-ideograph;"><span style="font-size: 14px;"><strong><span style="font-size: 14px;font-family: Calibri, sans-serif;">CVE</span></strong><strong>编号</strong></span></p></td><td style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="25" width="83"><p style="text-align:center;"><span style="font-size: 14px;font-family: Calibri, sans-serif;">CVE-2022-31626</span></p></td><td colspan="2" style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="25" width="268"><p style="text-align:justify;text-justify:inter-ideograph;"><span style="font-size: 14px;"><strong>其他编号</strong></span></p></td><td style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="25" width="88"><p style="text-align:center;"><span style="font-size: 14px;font-family: Calibri, sans-serif;">QVD-2022-8876</span></p></td></tr><tr style="height:25px;"><td style="border-right: 1px solid windowtext;border-bottom: 1px solid windowtext;border-left: 1px solid windowtext;border-top: none windowtext;padding: 0px 7px;" height="25" width="66"><p style="text-align:justify;text-justify:inter-ideograph;"><span style="font-size: 14px;"><strong><span style="font-size: 14px;font-family: Calibri, sans-serif;">CVSS 3.1</span></strong><strong>评级</strong></span></p></td><td style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="25" width="83"><p style="text-align:center;"><span style="font-size: 14px;"><strong><span style="color: red;font-size: 14px;">高危</span></strong></span></p></td><td colspan="2" style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="25" width="285"><p style="text-align:justify;text-justify:inter-ideograph;"><span style="font-size: 14px;"><strong><span style="font-size: 14px;font-family: Calibri, sans-serif;">CVSS 3.1</span></strong><strong>分数</strong></span></p></td><td style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="25" width="88"><p style="text-align:center;"><span style="font-size: 14px;font-family: Calibri, sans-serif;">7.5</span></p></td></tr><tr style="height:25px;"><td rowspan="8" style="border-right: 1px solid windowtext;border-bottom: 1px solid windowtext;border-left: 1px solid windowtext;border-top: none windowtext;padding: 0px 7px;" height="25" width="66"><p style="text-align:justify;text-justify:inter-ideograph;"><span style="font-size: 14px;"><strong><span style="font-size: 14px;font-family: Calibri, sans-serif;">CVSS</span></strong><strong>向量</strong></span></p></td><td colspan="2" style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="25" width="28"><p style="text-align:center;"><span style="font-size: 14px;"><strong>访问途径（</strong><strong><span style="font-size: 14px;font-family: Calibri, sans-serif;">AV</span></strong><strong>）</strong></span></p></td><td colspan="2" style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="25"><p style="text-align:center;"><span style="font-size: 14px;"><strong>攻击复杂度（</strong><strong><span style="font-size: 14px;font-family: Calibri, sans-serif;">AC</span></strong><strong>）</strong></span></p></td></tr><tr style="height:25px;"><td colspan="2" style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="25" width="130"><p style="text-align:center;"><span style="font-size: 14px;">网络</span></p></td><td colspan="2" style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="25" width="285"><p style="text-align:center;"><span style="font-size: 14px;">高</span></p></td></tr><tr style="height:25px;"><td colspan="2" style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="25" width="182"><p style="text-align:center;"><span style="font-size: 14px;"><strong>所需权限（</strong><strong><span style="font-size: 14px;font-family: Calibri, sans-serif;">PR</span></strong><strong>）</strong></span></p></td><td colspan="2" style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;word-break: break-all;" height="25" width="285"><p style="text-align:center;"><span style="font-size: 14px;"><strong>用户交互（</strong><strong><span style="font-size: 14px;font-family: Calibri, sans-serif;">UI</span></strong><strong>）</strong></span></p></td></tr><tr style="height:25px;"><td colspan="2" style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="25" width="182"><p style="text-align:center;"><span style="font-size: 14px;">低权限</span></p></td><td colspan="2" style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="25" width="285"><p style="text-align:center;"><span style="font-size: 14px;">不需要</span></p></td></tr><tr style="height:25px;"><td colspan="2" style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="25" width="182"><p style="text-align:center;"><span style="font-size: 14px;"><strong>影响范围（</strong><strong><span style="font-size: 14px;font-family: Calibri, sans-serif;">S</span></strong><strong>）</strong></span></p></td><td colspan="2" style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="25" width="285"><p style="text-align:center;"><span style="font-size: 14px;"><strong>机密性影响（</strong><strong><span style="font-size: 14px;font-family: Calibri, sans-serif;">C</span></strong><strong>）</strong></span></p></td></tr><tr style="height:25px;"><td colspan="2" style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="25" width="182"><p style="text-align:center;"><span style="font-size: 14px;">不改变</span></p></td><td colspan="2" style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="25" width="285"><p style="text-align:center;"><span style="font-size: 14px;">高</span></p></td></tr><tr style="height:25px;"><td colspan="2" style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="25" width="182"><p style="text-align:center;"><span style="font-size: 14px;"><strong>完整性影响（</strong><strong><span style="font-size: 14px;font-family: Calibri, sans-serif;">I</span></strong><strong>）</strong></span></p></td><td colspan="2" style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="25" width="285"><p style="text-align:center;"><span style="font-size: 14px;"><strong>可用性影响（</strong><strong><span style="font-size: 14px;font-family: Calibri, sans-serif;">A</span></strong><strong>）</strong></span></p></td></tr><tr style="height:25px;"><td colspan="2" style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="25" width="182"><p style="text-align:center;"><span style="font-size: 14px;">高</span></p></td><td colspan="2" style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="25" width="285"><p style="text-align:center;"><span style="font-size: 14px;">高</span></p></td></tr><tr style="height:139px;"><td style="border-right: 1px solid windowtext;border-bottom: 1px solid windowtext;border-left: 1px solid windowtext;border-top: none windowtext;padding: 0px 7px;" height="139" width="66"><p style="text-align:justify;text-justify:inter-ideograph;"><span style="font-size: 14px;"><strong>危害描述</strong></span></p></td><td colspan="4" style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="139" width="28"><p style="text-align:justify;text-justify:inter-ideograph;line-height:125%;"><span style="font-size: 14px;"><span style="font-size: 14px;font-family: Calibri, sans-serif;">php</span>存在远程代码执行漏洞，攻击者在获取了连接数据库权限后，如<span style="font-size: 14px;font-family: Calibri, sans-serif;">Adminer</span>、<span style="font-size: 14px;font-family: Calibri, sans-serif;">PHPmyAdmin </span>等工具的权限，通过建立恶意数据库服务器，主动连接至该数据库服务器，造成堆缓冲区溢出，从而导致远程代码执行。</span></p></td></tr></tbody></table>**2. CVE-2022-31625 PHP 远程代码执行漏洞**  
  
****<table><tbody><tr style="height:25px;"><td style="border-width: 1px;border-style: solid;border-color: windowtext;padding: 0px 7px;" height="25" width="61"><section style="text-align: justify;margin-left: 0px;margin-right: 0px;"><span style="font-size: 14px;"><strong>漏洞名称</strong></span></section></td><td colspan="4" style="border-top: 1px solid windowtext;border-right: 1px solid windowtext;border-bottom: 1px solid windowtext;border-left: none windowtext;padding: 0px 7px;word-break: break-all;" height="25" width="481"><p style="text-align:center;"><span style="font-size: 14px;"><span style="font-size: 14px;font-family: Calibri, sans-serif;">PHP </span>远程代码执行漏洞<span style="font-size: 14px;font-family: Calibri, sans-serif;">(CVE-2022-31625)</span></span></p></td></tr><tr style="height:25px;"><td style="border-right: 1px solid windowtext;border-bottom: 1px solid windowtext;border-left: 1px solid windowtext;border-top: none windowtext;padding: 0px 7px;" height="25" width="54"><p style="text-align:justify;text-justify:inter-ideograph;"><span style="font-size: 14px;"><strong><span style="font-size: 14px;font-family: Calibri, sans-serif;">CVE</span></strong><strong>编号</strong></span></p></td><td style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="25" width="73"><p style="text-align:center;"><span style="font-size: 14px;font-family: Calibri, sans-serif;">CVE-2022-31625</span></p></td><td colspan="2" style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="25" width="289"><p style="text-align:justify;text-justify:inter-ideograph;"><span style="font-size: 14px;"><strong>其他编号</strong></span></p></td><td style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="25" width="82"><p style="text-align:center;"><span style="font-size: 14px;font-family: Calibri, sans-serif;">QVD-2022-8877</span></p></td></tr><tr style="height:25px;"><td style="border-right: 1px solid windowtext;border-bottom: 1px solid windowtext;border-left: 1px solid windowtext;border-top: none windowtext;padding: 0px 7px;" height="25" width="61"><p style="text-align:justify;text-justify:inter-ideograph;"><span style="font-size: 14px;"><strong><span style="font-size: 14px;font-family: Calibri, sans-serif;">CVSS 3.1</span></strong><strong>评级</strong></span></p></td><td style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="25" width="67"><p style="text-align:center;"><span style="font-size: 14px;"><strong><span style="color: red;font-size: 14px;">高危</span></strong></span></p></td><td colspan="2" style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="25" width="261"><p style="text-align:justify;text-justify:inter-ideograph;"><span style="font-size: 14px;"><strong><span style="font-size: 14px;font-family: Calibri, sans-serif;">CVSS 3.1</span></strong><strong>分数</strong></span></p></td><td style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="25" width="82"><p style="text-align:center;"><span style="font-size: 14px;font-family: Calibri, sans-serif;">7.5</span></p></td></tr><tr style="height:25px;"><td rowspan="8" style="border-right: 1px solid windowtext;border-bottom: 1px solid windowtext;border-left: 1px solid windowtext;border-top: none windowtext;padding: 0px 7px;" height="25" width="61"><p style="text-align:justify;text-justify:inter-ideograph;"><span style="font-size: 14px;"><strong><span style="font-size: 14px;font-family: Calibri, sans-serif;">CVSS</span></strong><strong>向量</strong></span></p></td><td colspan="2" style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="25" width="234"><p style="text-align:center;"><span style="font-size: 14px;"><strong>访问途径（</strong><strong><span style="font-size: 14px;font-family: Calibri, sans-serif;">AV</span></strong><strong>）</strong></span></p></td><td colspan="2" style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="25"><p style="text-align:center;"><span style="font-size: 14px;"><strong>攻击复杂度（</strong><strong><span style="font-size: 14px;font-family: Calibri, sans-serif;">AC</span></strong><strong>）</strong></span></p></td></tr><tr style="height:25px;"><td colspan="2" style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="25" width="206"><p style="text-align:center;"><span style="font-size: 14px;">网络</span></p></td><td colspan="2" style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="25" width="261"><p style="text-align:center;"><span style="font-size: 14px;">高</span></p></td></tr><tr style="height:25px;"><td colspan="2" style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="25" width="206"><p style="text-align:center;"><span style="font-size: 14px;"><strong>所需权限（</strong><strong><span style="font-size: 14px;font-family: Calibri, sans-serif;">PR</span></strong><strong>）</strong></span></p></td><td colspan="2" style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;word-break: break-all;" height="25" width="261"><p style="text-align:center;"><span style="font-size: 14px;"><strong>用户交互（</strong><strong><span style="font-size: 14px;font-family: Calibri, sans-serif;">UI</span></strong><strong>）</strong></span></p></td></tr><tr style="height:25px;"><td colspan="2" style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="25" width="206"><p style="text-align:center;"><span style="font-size: 14px;">低权限</span></p></td><td colspan="2" style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="25" width="261"><p style="text-align:center;"><span style="font-size: 14px;">不需要</span></p></td></tr><tr style="height:25px;"><td colspan="2" style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="25" width="206"><p style="text-align:center;"><span style="font-size: 14px;"><strong>影响范围（</strong><strong><span style="font-size: 14px;font-family: Calibri, sans-serif;">S</span></strong><strong>）</strong></span></p></td><td colspan="2" style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="25" width="261"><p style="text-align:center;"><span style="font-size: 14px;"><strong>机密性影响（</strong><strong><span style="font-size: 14px;font-family: Calibri, sans-serif;">C</span></strong><strong>）</strong></span></p></td></tr><tr style="height:25px;"><td colspan="2" style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="25" width="206"><p style="text-align:center;"><span style="font-size: 14px;">不改变</span></p></td><td colspan="2" style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="25" width="261"><p style="text-align:center;"><span style="font-size: 14px;">高</span></p></td></tr><tr style="height:25px;"><td colspan="2" style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="25" width="206"><p style="text-align:center;"><span style="font-size: 14px;"><strong>完整性影响（</strong><strong><span style="font-size: 14px;font-family: Calibri, sans-serif;">I</span></strong><strong>）</strong></span></p></td><td colspan="2" style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="25" width="261"><p style="text-align:center;"><span style="font-size: 14px;"><strong>可用性影响（</strong><strong><span style="font-size: 14px;font-family: Calibri, sans-serif;">A</span></strong><strong>）</strong></span></p></td></tr><tr style="height:25px;"><td colspan="2" style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="25" width="206"><p style="text-align:center;"><span style="font-size: 14px;">高</span></p></td><td colspan="2" style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="25" width="261"><p style="text-align:center;"><span style="font-size: 14px;">高</span></p></td></tr><tr style="height:120px;"><td style="border-right: 1px solid windowtext;border-bottom: 1px solid windowtext;border-left: 1px solid windowtext;border-top: none windowtext;padding: 0px 7px;" height="120" width="61"><p style="text-align:justify;text-justify:inter-ideograph;"><span style="font-size: 14px;"><strong>危害描述</strong></span></p></td><td colspan="4" style="border-top: none windowtext;border-left: none windowtext;border-bottom: 1px solid windowtext;border-right: 1px solid windowtext;padding: 0px 7px;" height="120" width="480"><p style="text-align:justify;text-justify:inter-ideograph;line-height:125%;"><span style="font-size: 14px;">在<span style="font-size: 14px;font-family: Calibri, sans-serif;">PHP_FUNCTION</span>中分配在堆上的的<span style="font-size: 14px;font-family: Calibri, sans-serif;">char* </span>数组没有被清除，如果发生转换错误，将会调用<span style="font-size: 14px;font-family: Calibri, sans-serif;">_php_pgsql_free_params()</span>函数，由于数组没有初始化，导致可以释放之前请求的值，导致远程代码执行。</span></p></td></tr></tbody></table><table><tbody><tr height="0"><td style="border-width: initial;border-style: none;border-color: windowtext;padding: 5px 10px;word-break: break-all;" width="141"><br/></td><td style="border-width: initial;border-style: none;border-color: windowtext;padding: 5px 10px;word-break: break-all;" width="267"><br/></td><td style="border-width: initial;border-style: none;border-color: windowtext;padding: 5px 10px;" width="34"><br/></td><td style="border-width: initial;border-style: none;border-color: windowtext;padding: 5px 10px;" width="20"><br/></td><td style="border-width: initial;border-style: none;border-color: windowtext;padding: 5px 10px;" width="242"><br/></td></tr></tbody></table>  
  
处置建议  
  
目前官方已发布修复版本，用户可升级至以下安全版本：  
  
PHP 8.1.7  
  
PHP 8.0.20   
  
PHP 7.4.30  
  
**注：CVE-2022-31625影响的PHP 5.x官方已结束维护，请用户升级到上述安全版本。**  
  
  
  
参考资料  
  
[1]https://bugs.php.net/bug.php?id=81719  
  
[2]https://bugs.php.net/bug.php?id=81720   
  
  
时间线  
  
2022年6月10日，奇安信 CERT发布安全风险通告  
  
  
点击**阅读原文**  
到奇安信NOX-安全监测平台查询更多漏洞详情  
