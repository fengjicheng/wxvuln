#  CVE-2022-2274: OpenSSL RSA 远程代码执行漏洞通告   
原创 360CERT  三六零CERT   2022-07-06 16:08  
  
**赶紧点击上方话题进行订阅吧！**  
  
报告编号：B6-2022-070601  
  
报告来源：360CERT  
  
报告作者：360CERT  
  
更新日期：2022-07-06  
  
1  
  
 漏洞简述  
  
  
  
  
2022年07月06日，360CERT监测发现OpenSSL发布了CVE-2022-2274的风险通告，漏洞等级：严重，漏洞评分：9.8。  
  
OpenSSL RSA 组件中存在一处堆溢出漏洞，攻击者可以通过精心构造 tls 认证请求或其他认证行为来触发该漏洞，并可能导致远程代码执行。  
  
OpenSSL组件是 *nix 系统中底层用于加解密、身份认证的底层库。  
  
对此，360CERT建议广大用户做好资产自查以及预防工作，以免遭受黑客攻击。  
  
2  
  
 风险等级  
  
  
  
  
360CERT对该漏洞的评定结果如下  
<table><tbody style="margin: 0px;padding: 0px;border-width: 0px;border-style: initial;border-color: initial;"><tr style="border-width: 1px 0px 0px;border-right-style: initial;border-bottom-style: initial;border-left-style: initial;border-right-color: initial;border-bottom-color: initial;border-left-color: initial;border-top-style: solid;border-top-color: rgb(204, 204, 204);background-color: white;margin: 0px;padding: 0px;"><th style="font-size: 12px;border-width: 1px;border-style: solid;border-color: rgb(204, 204, 204);margin: 0px;padding: 0.5em 1em;word-break: unset;" align="center" valign="top">评定方式</th><th style="font-size: 12px;border-width: 1px;border-style: solid;border-color: rgb(204, 204, 204);margin: 0px;padding: 0.5em 1em;word-break: unset;" align="center" valign="top">等级</th></tr><tr style="border-width: 1px 0px 0px;border-right-style: initial;border-bottom-style: initial;border-left-style: initial;border-right-color: initial;border-bottom-color: initial;border-left-color: initial;border-top-style: solid;border-top-color: rgb(204, 204, 204);background-color: white;margin: 0px;padding: 0px;"><td style="text-align: center !important;">威胁等级</td><td style="text-align: center !important;">严重</td></tr><tr style="border-width: 1px 0px 0px;border-right-style: initial;border-bottom-style: initial;border-left-style: initial;border-right-color: initial;border-bottom-color: initial;border-left-color: initial;border-top-style: solid;border-top-color: rgb(204, 204, 204);background-color: white;margin: 0px;padding: 0px;"><td style="text-align: center !important;">影响面</td><td style="text-align: center !important;">广泛</td></tr><tr style="border-width: 1px 0px 0px;border-right-style: initial;border-bottom-style: initial;border-left-style: initial;border-right-color: initial;border-bottom-color: initial;border-left-color: initial;border-top-style: solid;border-top-color: rgb(204, 204, 204);background-color: white;margin: 0px;padding: 0px;"><td style="text-align: center !important;">攻击者价值</td><td style="text-align: center !important;">高</td></tr><tr style="border-width: 1px 0px 0px;border-right-style: initial;border-bottom-style: initial;border-left-style: initial;border-right-color: initial;border-bottom-color: initial;border-left-color: initial;border-top-style: solid;border-top-color: rgb(204, 204, 204);background-color: white;margin: 0px;padding: 0px;"><td style="text-align: center !important;">利用难度</td><td style="text-align: center !important;">高</td></tr><tr style="border-width: 1px 0px 0px;border-right-style: initial;border-bottom-style: initial;border-left-style: initial;border-right-color: initial;border-bottom-color: initial;border-left-color: initial;border-top-style: solid;border-top-color: rgb(204, 204, 204);background-color: white;margin: 0px;padding: 0px;"><td style="text-align: center !important;">360CERT评分</td><td style="text-align: center !important;">9.8</td></tr></tbody></table>  
  
3  
  
 漏洞详情  
  
  
  
  
### CVE-2022-2274: OpenSSL RSA 组件远程代码执行漏洞  
  
CVE: CVE-2022-2274  
  
组件: OpenSSL  
  
漏洞类型: 代码执行  
  
影响: 服务器接管  
  
简述: OpenSSL RSA 组件中存在一处堆溢出漏洞，攻击者可以通过精心构造 tls 认证请求来触发该漏洞，并可能导致远程代码执行。  
  
该漏洞有如下限制，（以下为并列条件）  
  
- 使用 RSA 算法，私钥长度2048bit  
  
- CPU架构为 AVX512IFMA （常见为 intel 的x86桌面处理器）  
  
但上述情况是主流*nix服务器的默认配置，需要特别注意  
  
在满足上述条件的服务器上执行以下行为可能受到该漏洞影响  
  
- ssh 认证  
  
- tls 认证  
  
- 文件签名认证  
  
4  
  
 社区漏洞热度态势  
  
  
  
  
在 7月1日当天 OpenSSL 分配该漏洞CVE编号时，该漏洞的热度达到最高点  
![](https://mmbiz.qpic.cn/mmbiz_png/Ic3Rgfdm96fPJuIkcDqKqAQmyajBzFlJg3VLPV3mocT3tARgJxt6T9k7fXLFhf8toicnKcNicYQ1YlmlFDKJY4Iw/640 "")  
  
  
5  
  
 影响版本  
  
  
  
  
<table><tbody style="margin: 0px;padding: 0px;border-width: 0px;border-style: initial;border-color: initial;"><tr style="border-width: 1px 0px 0px;border-right-style: initial;border-bottom-style: initial;border-left-style: initial;border-right-color: initial;border-bottom-color: initial;border-left-color: initial;border-top-style: solid;border-top-color: rgb(204, 204, 204);background-color: white;margin: 0px;padding: 0px;"><th style="font-size: 12px;border-width: 1px;border-style: solid;border-color: rgb(204, 204, 204);margin: 0px;padding: 0.5em 1em;word-break: unset;" align="center" valign="top">组件</th><th style="font-size: 12px;border-width: 1px;border-style: solid;border-color: rgb(204, 204, 204);margin: 0px;padding: 0.5em 1em;word-break: unset;" align="center" valign="top">影响版本</th><th style="font-size: 12px;border-width: 1px;border-style: solid;border-color: rgb(204, 204, 204);margin: 0px;padding: 0.5em 1em;word-break: unset;" align="center" valign="top">安全版本</th></tr><tr style="border-width: 1px 0px 0px;border-right-style: initial;border-bottom-style: initial;border-left-style: initial;border-right-color: initial;border-bottom-color: initial;border-left-color: initial;border-top-style: solid;border-top-color: rgb(204, 204, 204);background-color: white;margin: 0px;padding: 0px;"><td style="text-align: center !important;">OpenSSL</td><td style="text-align: center !important;">&lt;=3.0.4</td><td style="text-align: center !important;">3.0.5</td></tr><tr style="border-width: 1px 0px 0px;border-right-style: initial;border-bottom-style: initial;border-left-style: initial;border-right-color: initial;border-bottom-color: initial;border-left-color: initial;border-top-style: solid;border-top-color: rgb(204, 204, 204);background-color: white;margin: 0px;padding: 0px;"><td style="text-align: center !important;">OpenSSL</td><td style="text-align: center !important;">-</td><td style="text-align: center !important;">1.1.1</td></tr><tr style="border-width: 1px 0px 0px;border-right-style: initial;border-bottom-style: initial;border-left-style: initial;border-right-color: initial;border-bottom-color: initial;border-left-color: initial;border-top-style: solid;border-top-color: rgb(204, 204, 204);background-color: white;margin: 0px;padding: 0px;"><td style="text-align: center !important;">OpenSSL</td><td style="text-align: center !important;">-</td><td style="text-align: center !important;">1.0.2</td></tr></tbody></table>  
  
6  
  
 修复建议  
  
  
  
  
### 通用修补建议  
  
根据影响版本中的信息，排查并升级到安全版本  
### 临时修补建议  
  
使用 OpenSSL 3.0.5 以下版本的用户建议尽快升级，建议在升级完成后重启服务器  
  
若无法及时升级可以尝试以下解决方案  
  
对正在运行的程序进行停止，并加入额外的环境变量export OPENSSL_ia32cap=:~0x200000后重启  
  
值得注意的是使用OpenSSL 1.1.1/1.0.2 的用户不受到该漏洞影响，这意味着常规Linux发行版例如 CentOS、Debain、Ubuntu 在安装系统原生软件包时不会受到影响。  
  
7  
  
 产品侧解决方案  
  
  
  
  
若想了解更多产品信息或有相关业务需求，可移步至http://360.net。  
### 360城市级网络安全监测服务  
  
360CERT的安全分析人员利用360安全大脑的QUAKE资产测绘平台(quake.360.cn)，通过资产测绘技术的方式，对该漏洞进行监测。可联系相关产品区域负责人或(quake#360.cn)获取对应产品。  
![](https://mmbiz.qpic.cn/mmbiz_png/Ic3Rgfdm96cnvL1JNTRV9WhygTAlKPQibk7MxIS09h8nO8DPkAVzrHCiaRT743mfml9SRLHC7fWG7tNnlYgVmT3w/640 "")  
### 360本地安全大脑  
  
360本地安全大脑是将360云端安全大脑核心能力本地化部署的一套开放式全场景安全运营平台，实现安全态势、监控、分析、溯源、研判、响应、管理的智能化安全运营赋能。360本地安全大脑已支持对相关漏洞利用的检测，请及时更新网络神经元（探针）规则和本地安全大脑关联分析规则，做好防护。  
![](https://mmbiz.qpic.cn/mmbiz_jpg/Ic3Rgfdm96eJtWkY4Iq9DIVuxSCmNG3Kk2Tz1u8lSQqX1rw7Zia51p6WaILL9xBHMFtUXVj2BG13gviadr8dpGcA/640 "")  
### 360终端安全管理系统  
  
360终端安全管理系统软件是在360安全大脑极智赋能下，以大数据、云计算等新技术为支撑，以可靠服务为保障，集防病毒与终端安全管控功能于一体的企业级安全产品。  
  
360终端安全管理系统已支持对相关漏洞进行检测和修复，建议用户及时更新漏洞库并安装更新相关补丁。  
![](https://mmbiz.qpic.cn/mmbiz_png/Ic3Rgfdm96fzSgCnRhHkrMfT0tzT60FdWWk3XGcvGLiatseAkG3JfQO8ewibaXSAic2Wrrr5gjKGtR1dMCUaWAANA/640 "")  
  
  
8  
  
 时间线  
  
  
  
  
**2022-06-22** 相关问题提交至OpenSSL  
  
**2022-07-01** OpenSSL分配CVE编号  
  
**2022-07-01** 社区热度达到最高  
  
**2022-07-05** OpenSSL发布版本更新  
  
**2022-07-06** 360CERT发布通告  
  
9  
  
 参考链接  
  
  
  
  
1.https://www.openssl.org/news/secadv/20220705.txt  
  
2.https://github.com/openssl/openssl/issues/18625  
  
10  
  
 特制报告相关说明  
  
  
  
  
一直以来，360CERT对全球重要网络安全事件进行快速通报、应急响应。为更好地为政企用户提供最新漏洞以及信息安全事件的安全通告服务，现360CERT推出了安全通告特制版报告订阅服务，以便用户做资料留存、传阅研究与查询验证。  
  
今后特制报告将不再提供公开下载，用户可扫描下方二维码进行服务订阅。  
  
![](https://mmbiz.qpic.cn/mmbiz_jpg/Ic3Rgfdm96dGuACWTa4BQzhoMl3chI7Tdch7TU5O21ECnPYAkbzMTfjcuvslias51NRldtrfia2XCvoI05Q91X8Q/640?wx_fmt=jpeg "")  
  
  
  
![](https://mmbiz.qpic.cn/mmbiz_png/Ic3Rgfdm96fDEiaYRAwzeORXyPTzIZEicJEJchzE6NNx8UKdqTdwDHNIYmwsIK7JlquzGrjaQS7ssnemOGtsTvYw/640?wx_fmt=png "")  
  
360CERT  
https://cert.360.cn/  
  
进入官网查看更多资讯  
  
长按扫码关注我们  
  
![](https://mmbiz.qpic.cn/mmbiz_png/Ic3Rgfdm96fDEiaYRAwzeORXyPTzIZEicJJ6oj5eUnvicLHzb45xcpgT8bhs83yg8VQjlRo8Av3jvfEv1NNMfHvRA/640 "微信公众号二维码.jpg")  
  
  
  
![](https://mmbiz.qpic.cn/mmbiz_png/Ic3Rgfdm96fDEiaYRAwzeORXyPTzIZEicJLRf9N0If8jPYhCicZ5sao1dWa48hVm5xpUskBUnDMYmvTJHpsWTmBsw/640?wx_fmt=png "")  
  
点击在看，进行分享  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/Ic3Rgfdm96fDEiaYRAwzeORXyPTzIZEicJX2oU8HWWic5QdjaCkRHBK3anwULoleLibhW5SnibSGWCF1fjkYS5ia8JPg/640?wx_fmt=gif "")  
  
