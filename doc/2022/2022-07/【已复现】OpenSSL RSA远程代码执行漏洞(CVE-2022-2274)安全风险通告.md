#  【已复现】OpenSSL RSA远程代码执行漏洞(CVE-2022-2274)安全风险通告   
原创 QAX CERT  奇安信 CERT   2022-07-08 12:49  
  
![](https://mmbiz.qpic.cn/mmbiz_png/EkibxOB3fs4icrhoWdKnhTgicSjB9pXdeZwDibNIBAEMegibEdG1vrjOibsq887TUz3ztMkM6Qvibic7r26sqbUIbicOMYg/640?wx_fmt=png "https://image.ipaiban.com/upload-ueditor-image-20201112-1605175807303084927.png")  
  
奇安信CERT  
  
**致力于**  
第一时间  
为企业级用户提供安全风险  
**通告**  
和  
**有效**  
解决方案。  
  
  
**安全通告**  
  
  
  
近日，奇安信CERT监测到OpenSSL 官方发布OpenSSL RSA 私钥操作中的堆  
内存损坏通告(CVE-2022-2274)，OpenSSL 3.0.4 版本在X86_64 的 RSA 实现中引入了一个严重的错误，运行在支持 AVX512IFMA 扩展指令的X86_64 架构的机器上的SSL/TLS 服务器或其他使用 2048 位 RSA 私钥的服务器会受到影响。攻击者利用此漏洞可能会在目标系统上执行任意代码。  
  
  
**奇安信CERT已复现此漏洞，经研判，此漏洞仅影响 OpenSSL 3.0.4 版本，并且只有支持 AVX512IFMA 扩展指令的系统才会受影响。OpenSSL 1.1.1/1.0.2系列版本不受此漏洞影响，这意味着常规Linux发行版例如 CentOS、Debain、Ubuntu 在安装系统原生软件包时不会受到影响。此漏洞影响范围有限，用户不必惊慌。**  
**建议客户尽快进行排查，若受影响请尽快修复。**  
  
****  
<table><tbody><tr><td style="word-break: break-all;padding: 5px 10px;border-color: rgb(221, 221, 221);" width="57"><p><strong><span style="font-size: 14px;">漏洞名称</span></strong></p></td><td colspan="3" style="word-break: break-all;padding: 5px 10px;border-color: rgb(221, 221, 221);"><p><strong><span style="font-size: 14px;">OpenSSL RSA远程代码执行漏洞</span></strong></p></td></tr><tr><td style="padding: 5px 10px;border-color: rgb(221, 221, 221);" width="78"><p><strong><span style="font-size: 14px;">公开时间</span></strong></p></td><td style="padding: 5px 10px;border-color: rgb(221, 221, 221);" width="162"><p><span style="font-size: 14px;">2022-07-05</span></p></td><td style="word-break: break-all;padding: 5px 10px;border-color: rgb(221, 221, 221);" width="131"><p><strong><span style="font-size: 14px;">更新时间</span></strong></p></td><td style="padding: 5px 10px;border-color: rgb(221, 221, 221);" width="143"><p><span style="font-size: 14px;">2022-07-05</span></p></td></tr><tr><td style="padding: 5px 10px;border-color: rgb(221, 221, 221);" width="96"><p><strong><span style="font-size: 14px;">CVE编号</span></strong></p></td><td style="padding: 5px 10px;border-color: rgb(221, 221, 221);" width="171"><p><span style="font-size: 14px;">CVE-2022-2274</span></p></td><td style="padding: 5px 10px;border-color: rgb(221, 221, 221);" width="140"><p><strong><span style="font-size: 14px;">其他编号</span></strong></p></td><td style="padding: 5px 10px;border-color: rgb(221, 221, 221);" width="149"><p><span style="font-size: 14px;">QVD-2022-10299</span></p></td></tr><tr><td style="padding: 5px 10px;border-color: rgb(221, 221, 221);" width="107"><p><strong><span style="font-size: 14px;">威胁类型</span></strong></p></td><td style="padding: 5px 10px;border-color: rgb(221, 221, 221);" width="169"><p><span style="font-size: 14px;">代码执行</span></p></td><td style="padding: 5px 10px;border-color: rgb(221, 221, 221);" width="143"><p><strong><span style="font-size: 14px;">技术类型</span></strong></p></td><td style="padding: 5px 10px;border-color: rgb(221, 221, 221);" width="150"><p><span style="font-size: 14px;">堆缓冲区溢出</span></p></td></tr><tr><td style="padding: 5px 10px;border-color: rgb(221, 221, 221);" width="114"><p><strong><span style="font-size: 14px;">厂商</span></strong></p></td><td style="padding: 5px 10px;border-color: rgb(221, 221, 221);" width="166"><p><span style="font-size: 14px;">OpenSSL</span></p></td><td style="padding: 5px 10px;border-color: rgb(221, 221, 221);" width="143"><p><strong><span style="font-size: 14px;">产品</span></strong></p></td><td style="padding: 5px 10px;border-color: rgb(221, 221, 221);" width="149"><p><span style="font-size: 14px;">OpenSSL</span></p></td></tr><tr><td colspan="4" align="center" valign="middle" style="word-break: break-all;padding: 5px 10px;border-color: rgb(221, 221, 221);"><p><strong><span style="font-size: 14px;">风险等级</span></strong></p></td></tr><tr><td colspan="2" align="center" valign="middle" style="padding: 5px 10px;border-color: rgb(221, 221, 221);"><p><strong><span style="font-size: 14px;">奇安信CERT风险评级</span></strong></p></td><td colspan="2" align="center" valign="middle" style="padding: 5px 10px;border-color: rgb(221, 221, 221);"><p><strong><span style="font-size: 14px;">风险等级</span></strong></p></td></tr><tr><td colspan="2" align="center" valign="middle" style="padding: 5px 10px;border-color: rgb(221, 221, 221);"><p><span style="color: rgb(255, 0, 0);"><strong><span style="color: rgb(255, 0, 0);font-size: 14px;">高危</span></strong></span></p></td><td colspan="2" align="center" valign="middle" style="padding: 5px 10px;border-color: rgb(221, 221, 221);"><p><strong><span style="font-size: 14px;">蓝色（一般事件）</span></strong></p></td></tr><tr><td colspan="4" align="center" valign="middle" style="padding: 5px 10px;border-color: rgb(221, 221, 221);"><p><strong><span style="font-size: 14px;">现时威胁状态</span></strong></p></td></tr><tr><td align="center" valign="middle" style="padding: 5px 10px;border-color: rgb(221, 221, 221);" width="119"><p><strong><span style="font-size: 14px;">POC状态</span></strong></p></td><td align="center" valign="middle" style="padding: 5px 10px;border-color: rgb(221, 221, 221);" width="165"><p><strong><span style="font-size: 14px;">EXP状态</span></strong></p></td><td align="center" valign="middle" style="padding: 5px 10px;border-color: rgb(221, 221, 221);" width="142"><p><strong><span style="font-size: 14px;">在野利用状态</span></strong></p></td><td align="center" valign="middle" style="padding: 5px 10px;border-color: rgb(221, 221, 221);" width="148"><p><strong><span style="font-size: 14px;">技术细节状态</span></strong></p></td></tr><tr><td align="center" valign="middle" style="word-break: break-all;padding: 5px 10px;border-color: rgb(221, 221, 221);" width="122"><p><span style="color: rgb(255, 0, 0);"><strong><span style="color: rgb(255, 0, 0);font-size: 14px;">已公开</span></strong></span></p></td><td align="center" valign="middle" style="word-break: break-all;padding: 5px 10px;border-color: rgb(221, 221, 221);" width="164"><p><span style="font-size: 14px;">未知</span></p></td><td align="center" valign="middle" style="padding: 5px 10px;border-color: rgb(221, 221, 221);" width="141"><p><span style="font-size: 14px;">未知</span></p></td><td align="center" valign="middle" style="padding: 5px 10px;border-color: rgb(221, 221, 221);" width="147"><p><span style="font-size: 14px;">未知</span></p></td></tr><tr><td style="word-break: break-all;padding: 5px 10px;border-color: rgb(221, 221, 221);" width="124"><p><strong><span style="font-size: 14px;">漏洞描述</span></strong></p></td><td colspan="3" style="padding: 5px 10px;border-color: rgb(221, 221, 221);"><p><span style="font-size: 14px;">OpenSSL RSA存在远程代码执行漏洞，远程攻击者可通过发送特制请求到运行在支持 AVX512IFMA 扩展指令的X86_64 架构的机器上的SSL/TLS 服务器或其他使用 2048 位 RSA 私钥的服务器，从而触发堆缓冲区溢出漏洞，可能允许攻击者在目标机器上执行任意代码。</span></p></td></tr><tr><td style="padding: 5px 10px;border-color: rgb(221, 221, 221);" width="125"><p><strong><span style="font-size: 14px;">影响版本</span></strong></p></td><td colspan="3" style="padding: 5px 10px;border-color: rgb(221, 221, 221);"><p><span style="font-size: 14px;">OpenSSL 3.0.4</span></p></td></tr><tr><td style="padding: 5px 10px;border-color: rgb(221, 221, 221);" width="126"><p><strong><span style="font-size: 14px;">不受影响版本</span></strong></p></td><td colspan="3" style="padding: 5px 10px;border-color: rgb(221, 221, 221);"><p><span style="font-size: 14px;">OpenSSL 1.1.1</span></p><p><span style="font-size: 14px;">OpenSSL 1.0.2</span></p><p><span style="font-size: 14px;">3.0.0 &lt;= OpenSSL &lt; 3.0.4</span></p><p><span style="font-size: 14px;">OpenSSL 3.0.5</span></p></td></tr><tr><td style="padding: 5px 10px;border-color: rgb(221, 221, 221);" width="127"><p><strong><span style="font-size: 14px;">其他受影响组件</span></strong></p></td><td colspan="3" style="padding: 5px 10px;border-color: rgb(221, 221, 221);"><p><span style="font-size: 14px;">无</span></p></td></tr></tbody></table>  
  
目前，奇安信CERT已成功复现**OpenSSL RSA远程代码执行漏洞(CVE-2022-2274)**，截图如下：  
  
  
![](https://mmbiz.qpic.cn/mmbiz_png/EkibxOB3fs4ibhyXibum7SicFVX0C9DicQdzDRlJTxSGqq9iaofJg0GC9LEG0tjwBKWLgK6O2CQEzQa8blt6hiaeGw8uw/640?wx_fmt=png "")  
  
  
威胁评估  
  
<table><tbody><tr><td style="word-break: break-all;padding: 5px 10px;" width="70"><p><strong><span style="font-size: 14px;">漏洞名称</span></strong></p></td><td colspan="4" align="center" valign="middle" style="padding: 5px 10px;" width="465"><p><span style="font-size: 14px;">OpenSSL RSA远程代码执行漏洞</span></p></td></tr><tr><td style="padding: 5px 10px;" width="70"><p><strong><span style="font-size: 14px;">CVE编号</span></strong></p></td><td align="center" valign="middle" style="padding: 5px 10px;" width="106"><p><span style="font-size: 14px;">CVE-2022-2274</span></p></td><td colspan="2" style="word-break: break-all;padding: 5px 10px;" width="209"><p><strong><span style="font-size: 14px;">其他编号</span></strong></p></td><td align="center" valign="middle" style="padding: 5px 10px;" width="108"><p><span style="font-size: 14px;">QVD-2022-10299</span></p></td></tr><tr><td style="padding: 5px 10px;" width="70"><p><strong><span style="font-size: 14px;">CVSS 3.1评级</span></strong></p></td><td align="center" valign="middle" style="padding: 5px 10px;word-break: break-all;" width="106"><p><span style="font-size: 14px;color: rgb(255, 0, 0);">高危</span></p></td><td colspan="2" style="padding: 5px 10px;" width="209"><p><strong><span style="font-size: 14px;">CVSS 3.1分数</span></strong></p></td><td align="center" valign="middle" style="padding: 5px 10px;" width="108"><p><span style="font-size: 14px;">9.8</span></p></td></tr><tr><td rowspan="8" style="padding: 5px 10px;" width="70"><p><strong><span style="font-size: 14px;">CVSS向量</span></strong></p></td><td colspan="2" align="center" valign="middle" style="word-break: break-all;padding: 5px 10px;" width="331"><p><strong><span style="font-size: 14px;">访问途径（AV）</span></strong></p></td><td colspan="2" align="center" valign="middle" style="padding: 5px 10px;"><p><strong><span style="font-size: 14px;">攻击复杂度（AC）</span></strong></p></td></tr><tr><td colspan="2" align="center" valign="middle" style="padding: 5px 10px;" width="319"><p><span style="font-size: 14px;">网络</span></p></td><td colspan="2" align="center" valign="middle" style="padding: 5px 10px;" width="113"><p><span style="font-size: 14px;">低</span></p></td></tr><tr><td colspan="2" align="center" valign="middle" style="word-break: break-all;padding: 5px 10px;" width="319"><p><strong><span style="font-size: 14px;">所需权限（PR）</span></strong></p></td><td colspan="2" align="center" valign="middle" style="padding: 5px 10px;" width="113"><p><strong><span style="font-size: 14px;">用户交互（UI）</span></strong></p></td></tr><tr><td colspan="2" align="center" valign="middle" style="padding: 5px 10px;" width="319"><p><span style="font-size: 14px;">不需要</span></p></td><td colspan="2" align="center" valign="middle" style="padding: 5px 10px;" width="113"><p><span style="font-size: 14px;">不需要</span></p></td></tr><tr><td colspan="2" align="center" valign="middle" style="word-break: break-all;padding: 5px 10px;" width="319"><p><strong><span style="font-size: 14px;">影响范围（S）</span></strong></p></td><td colspan="2" align="center" valign="middle" style="padding: 5px 10px;" width="113"><p><strong><span style="font-size: 14px;">机密性影响（C）</span></strong></p></td></tr><tr><td colspan="2" align="center" valign="middle" style="padding: 5px 10px;" width="319"><p><span style="font-size: 14px;">不改变</span></p></td><td colspan="2" align="center" valign="middle" style="padding: 5px 10px;" width="113"><p draggable="true"><span style="font-size: 14px;">高</span></p></td></tr><tr><td colspan="2" align="center" valign="middle" style="word-break: break-all;padding: 5px 10px;" width="319"><p><strong><span style="font-size: 14px;">完整性影响（I）</span></strong></p></td><td colspan="2" align="center" valign="middle" style="padding: 5px 10px;" width="113"><p><strong><span style="font-size: 14px;">可用性影响（A）</span></strong></p></td></tr><tr><td colspan="2" align="center" valign="middle" style="padding: 5px 10px;" width="319"><p><span style="font-size: 14px;">高</span></p></td><td colspan="2" align="center" valign="middle" style="padding: 5px 10px;" width="113"><p><span style="font-size: 14px;">高</span></p></td></tr><tr><td style="padding: 5px 10px;" width="70"><p><strong><span style="font-size: 14px;">危害描述</span></strong></p></td><td colspan="4" style="padding: 5px 10px;" width="465"><p><span style="font-size: 14px;">攻击者利用此漏洞可在目标系统上执行任意代码或导致目标SSL、TLS 等服务器拒绝服务。</span></p></td></tr></tbody></table>  
  
  
处置建议  
  
**1.版本检测**  
  
通过   
openssl version  
   
命令查看 OpenSSL 版本，确认不是 OpenSSL 3.0.4：  
  
   
  
![](https://mmbiz.qpic.cn/mmbiz_png/EkibxOB3fs4ibhyXibum7SicFVX0C9DicQdzDhGic7kasM8dZyiafrogI2gDfib3w2iaYTU2D2ZgX0ibgZ51HD2QFDyycNqQ/640?wx_fmt=png "")  
  
  
通过   
cat /proc/cpuinfo | grep avx512ifma  
 命令确认系统不支持 AVX512IFMA 扩展指令，如果输出中没有 “avx512ifma” 则代表系统不支持AVX512IFMA 扩展指令，下图是支持的例子：  
  
   
  
![](https://mmbiz.qpic.cn/mmbiz_png/EkibxOB3fs4ibhyXibum7SicFVX0C9DicQdzD4dWVx3mdyGibKwoTYFM2P8icnXLwACViaTiasunNLriaHKTXQSG4SULKsOw/640?wx_fmt=png "")  
  
  
如果版本为OpenSSL 3.0.4，且系统支持AVX512IFMA 扩展指令，则受此漏洞影响。用户可升级至 3.0.5 版本。  
  
  
**2.版本升级**  
  
受影响的用户可升级至OpenSSL 3.0.5 最新版本:  
  
https://github.com/openssl/openssl/releases/tag/openssl-3.0.5  
  
  
**3.缓解方案**  
  
受影响的用户若无法进行版本升级，可采用以下缓解措施缓解此漏洞：  
  
对正在运行的程序进行停止，并加入额外的环境变量后重启。  
```
export OPENSSL_ia32cap=:~0x200000
```  
  
   
  
产品解决方案  
  
**奇安信开源卫士已支持**  
  
奇安信开源卫士20220708. 1121版本已支持对OpenSSL RSA远程代码执行漏洞(CVE-2022-2274)的检测。  
  
  
参考资料  
  
[1]https://www.openssl.org/news/secadv/20220705.txt  
  
  
时间线  
  
2022年7月8日，奇安信 CERT发布安全风险通告。  
  
  
点击**阅读原文**  
到奇安信NOX-安全监测平台查询更多漏洞详情  
